/*! For license information please see main.257e50aa.js.LICENSE.txt */
!function(){var e={7757:function(e,t,n){e.exports=n(9727)},4569:function(e,t,n){e.exports=n(8036)},3381:function(e,t,n){"use strict";var r=n(3589),i=n(7297),a=n(9301),s=n(9774),o=n(1804),l=n(9145),u=n(5411),c=n(6467);e.exports=function(e){return new Promise((function(t,n){var d=e.data,h=e.headers,f=e.responseType;r.isFormData(d)&&delete h["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var y=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(y+":"+g)}var _=o(e.baseURL,e.url);function m(){if(p){var r="getAllResponseHeaders"in p?l(p.getAllResponseHeaders()):null,a={data:f&&"text"!==f&&"json"!==f?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};i(t,n,a),p=null}}if(p.open(e.method.toUpperCase(),s(_,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,"onloadend"in p?p.onloadend=m:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(m)},p.onabort=function(){p&&(n(c("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(c(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var v=(e.withCredentials||u(_))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;v&&(h[e.xsrfHeaderName]=v)}"setRequestHeader"in p&&r.forEach(h,(function(e,t){"undefined"===typeof d&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),f&&"json"!==f&&(p.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),d||(d=null),p.send(d)}))}},8036:function(e,t,n){"use strict";var r=n(3589),i=n(4049),a=n(3773),s=n(777);function o(e){var t=new a(e),n=i(a.prototype.request,t);return r.extend(n,a.prototype,t),r.extend(n,t),n}var l=o(n(221));l.Axios=a,l.create=function(e){return o(s(l.defaults,e))},l.Cancel=n(9346),l.CancelToken=n(6857),l.isCancel=n(5517),l.all=function(e){return Promise.all(e)},l.spread=n(8089),l.isAxiosError=n(9580),e.exports=l,e.exports.default=l},9346:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6857:function(e,t,n){"use strict";var r=n(9346);function i(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},5517:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},3773:function(e,t,n){"use strict";var r=n(3589),i=n(9774),a=n(7470),s=n(2733),o=n(777),l=n(7835),u=l.validators;function c(e){this.defaults=e,this.interceptors={request:new a,response:new a}}c.prototype.request=function(e){"string"===typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,a=[];if(this.interceptors.response.forEach((function(e){a.push(e.fulfilled,e.rejected)})),!r){var c=[s,void 0];for(Array.prototype.unshift.apply(c,n),c=c.concat(a),i=Promise.resolve(e);c.length;)i=i.then(c.shift(),c.shift());return i}for(var d=e;n.length;){var h=n.shift(),f=n.shift();try{d=h(d)}catch(p){f(p);break}}try{i=s(d)}catch(p){return Promise.reject(p)}for(;a.length;)i=i.then(a.shift(),a.shift());return i},c.prototype.getUri=function(e){return e=o(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(o(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,r){return this.request(o(r||{},{method:e,url:t,data:n}))}})),e.exports=c},7470:function(e,t,n){"use strict";var r=n(3589);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},1804:function(e,t,n){"use strict";var r=n(4044),i=n(9549);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},6467:function(e,t,n){"use strict";var r=n(6460);e.exports=function(e,t,n,i,a){var s=new Error(e);return r(s,t,n,i,a)}},2733:function(e,t,n){"use strict";var r=n(3589),i=n(2693),a=n(5517),s=n(221);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return o(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(o(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},6460:function(e){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},777:function(e,t,n){"use strict";var r=n(3589);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],a=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function l(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=l(void 0,e[i])):n[i]=l(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=l(void 0,t[e]))})),r.forEach(a,u),r.forEach(s,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=l(void 0,e[i])):n[i]=l(void 0,t[i])})),r.forEach(o,(function(r){r in t?n[r]=l(e[r],t[r]):r in e&&(n[r]=l(void 0,e[r]))}));var c=i.concat(a).concat(s).concat(o),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===c.indexOf(e)}));return r.forEach(d,u),n}},7297:function(e,t,n){"use strict";var r=n(6467);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},2693:function(e,t,n){"use strict";var r=n(3589),i=n(221);e.exports=function(e,t,n){var a=this||i;return r.forEach(n,(function(n){e=n.call(a,e,t)})),e}},221:function(e,t,n){"use strict";var r=n(3589),i=n(4341),a=n(6460),s={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=n(3381)),e}(),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(o(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(s){if("SyntaxError"===o.name)throw a(o,this,"E_JSON_PARSE");throw o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){l.headers[e]=r.merge(s)})),e.exports=l},4049:function(e){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},9774:function(e,t,n){"use strict";var r=n(3589);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var a;if(n)a=n(t);else if(r.isURLSearchParams(t))a=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),a=s.join("&")}if(a){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},9549:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},9301:function(e,t,n){"use strict";var r=n(3589);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,a,s){var o=[];o.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),r.isString(i)&&o.push("path="+i),r.isString(a)&&o.push("domain="+a),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},4044:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},9580:function(e){"use strict";e.exports=function(e){return"object"===typeof e&&!0===e.isAxiosError}},5411:function(e,t,n){"use strict";var r=n(3589);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},4341:function(e,t,n){"use strict";var r=n(3589);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},9145:function(e,t,n){"use strict";var r=n(3589),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,a,s={};return e?(r.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=r.trim(e.substr(0,a)).toLowerCase(),n=r.trim(e.substr(a+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},8089:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},7835:function(e,t,n){"use strict";var r=n(8593),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var a={},s=r.version.split(".");function o(e,t){for(var n=t?t.split("."):s,r=e.split("."),i=0;i<3;i++){if(n[i]>r[i])return!0;if(n[i]<r[i])return!1}return!1}i.transitional=function(e,t,n){var i=t&&o(t);function s(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,o){if(!1===e)throw new Error(s(r," has been removed in "+t));return i&&!a[r]&&(a[r]=!0,console.warn(s(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},e.exports={isOlderVersion:o,assertOptions:function(e,t,n){if("object"!==typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var a=r[i],s=t[a];if(s){var o=e[a],l=void 0===o||s(o,a,e);if(!0!==l)throw new TypeError("option "+a+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+a)}},validators:i}},3589:function(e,t,n){"use strict";var r=n(4049),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return"undefined"===typeof e}function o(e){return null!==e&&"object"===typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:o,isPlainObject:l,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return o(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:c,merge:function e(){var t={};function n(n,r){l(t[r])&&l(n)?t[r]=e(t[r],n):l(n)?t[r]=e({},n):a(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)c(arguments[r],n);return t},extend:function(e,t,n){return c(t,(function(t,i){e[i]=n&&"function"===typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2110:function(e,t,n){"use strict";var r=n(8309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return r.isMemo(e)?s:o[e.$$typeof]||i}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=s;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=f(n);i&&i!==p&&e(t,i,r)}var s=c(n);d&&(s=s.concat(d(n)));for(var o=l(t),y=l(n),g=0;g<s.length;++g){var _=s[g];if(!a[_]&&(!r||!r[_])&&(!y||!y[_])&&(!o||!o[_])){var m=h(n,_);try{u(t,_,m)}catch(v){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,y=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,_=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,E=n?Symbol.for("react.scope"):60119;function b(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case a:case o:case s:case f:return e;default:switch(e=e&&e.$$typeof){case u:case h:case g:case y:case l:return e;default:return t}}case i:return t}}}function C(e){return b(e)===d}t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=y,t.Portal=i,t.Profiler=o,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return C(e)||b(e)===c},t.isConcurrentMode=C,t.isContextConsumer=function(e){return b(e)===u},t.isContextProvider=function(e){return b(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return b(e)===h},t.isFragment=function(e){return b(e)===a},t.isLazy=function(e){return b(e)===g},t.isMemo=function(e){return b(e)===y},t.isPortal=function(e){return b(e)===i},t.isProfiler=function(e){return b(e)===o},t.isStrictMode=function(e){return b(e)===s},t.isSuspense=function(e){return b(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===d||e===o||e===s||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===y||e.$$typeof===l||e.$$typeof===u||e.$$typeof===h||e.$$typeof===m||e.$$typeof===v||e.$$typeof===E||e.$$typeof===_)},t.typeOf=b},8309:function(e,t,n){"use strict";e.exports=n(746)},2426:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(o(e,t))return!1;return!0}function u(e){return void 0===e}function c(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function h(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function f(e,t){for(var n in t)o(t,n)&&(e[n]=t[n]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,n,r){return Kn(e,t,n,r,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=y()),e._pf}function _(e){if(null==e._isValid){var t=g(e),r=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function m(e){var t=p(NaN);return null!=e?f(g(t),e):g(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var v=r.momentProperties=[],E=!1;function b(e,t){var n,r,i;if(u(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),u(t._i)||(e._i=t._i),u(t._f)||(e._f=t._f),u(t._l)||(e._l=t._l),u(t._strict)||(e._strict=t._strict),u(t._tzm)||(e._tzm=t._tzm),u(t._isUTC)||(e._isUTC=t._isUTC),u(t._offset)||(e._offset=t._offset),u(t._pf)||(e._pf=g(t)),u(t._locale)||(e._locale=t._locale),v.length>0)for(n=0;n<v.length;n++)u(i=t[r=v[n]])||(e[r]=i);return e}function C(e){b(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===E&&(E=!0,r.updateOffset(this),E=!1)}function S(e){return e instanceof C||null!=e&&null!=e._isAMomentObject}function N(e){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function k(e,t){var n=!0;return f((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){var i,a,s,l=[];for(a=0;a<arguments.length;a++){if(i="","object"===typeof arguments[a]){for(s in i+="\n["+a+"] ",arguments[0])o(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[a];l.push(i)}N(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var A,w={};function T(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),w[e]||(N(t),w[e]=!0)}function O(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function I(e){var t,n;for(n in e)o(e,n)&&(O(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(e,t){var n,r=f({},e);for(n in t)o(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)o(e,n)&&!o(t,n)&&s(e[n])&&(r[n]=f({},r[n]));return r}function U(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,A=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)o(e,t)&&n.push(t);return n};var R={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function P(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return O(r)?r.call(t,n):r}function L(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var D=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,x=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,F={},H={};function G(e,t,n,r){var i=r;"string"===typeof r&&(i=function(){return this[r]()}),e&&(H[e]=i),t&&(H[t[0]]=function(){return L(i.apply(this,arguments),t[1],t[2])}),n&&(H[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function j(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function V(e){var t,n,r=e.match(D);for(t=0,n=r.length;t<n;t++)H[r[t]]?r[t]=H[r[t]]:r[t]=j(r[t]);return function(t){var i,a="";for(i=0;i<n;i++)a+=O(r[i])?r[i].call(t,e):r[i];return a}}function B(e,t){return e.isValid()?(t=z(t,e.localeData()),F[t]=F[t]||V(t),F[t](e)):e.localeData().invalidDate()}function z(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(x.lastIndex=0;n>=0&&x.test(e);)e=e.replace(x,r),x.lastIndex=0,n-=1;return e}var Y={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function q(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(D).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var K="Invalid date";function W(){return this._invalidDate}var Q="%d",$=/\d{1,2}/;function J(e){return this._ordinal.replace("%d",e)}var X={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Z(e,t,n,r){var i=this._relativeTime[n];return O(i)?i(e,t,n,r):i.replace(/%d/i,e)}function ee(e,t){var n=this._relativeTime[e>0?"future":"past"];return O(n)?n(t):n.replace(/%s/i,t)}var te={};function ne(e,t){var n=e.toLowerCase();te[n]=te[n+"s"]=te[t]=e}function re(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function ie(e){var t,n,r={};for(n in e)o(e,n)&&(t=re(n))&&(r[t]=e[n]);return r}var ae={};function se(e,t){ae[e]=t}function oe(e){var t,n=[];for(t in e)o(e,t)&&n.push({unit:t,priority:ae[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}function le(e){return e%4===0&&e%100!==0||e%400===0}function ue(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ce(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=ue(t)),n}function de(e,t){return function(n){return null!=n?(fe(this,e,n),r.updateOffset(this,t),this):he(this,e)}}function he(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function fe(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&le(e.year())&&1===e.month()&&29===e.date()?(n=ce(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Ze(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function pe(e){return O(this[e=re(e)])?this[e]():this}function ye(e,t){if("object"===typeof e){var n,r=oe(e=ie(e));for(n=0;n<r.length;n++)this[r[n].unit](e[r[n].unit])}else if(O(this[e=re(e)]))return this[e](t);return this}var ge,_e=/\d/,me=/\d\d/,ve=/\d{3}/,Ee=/\d{4}/,be=/[+-]?\d{6}/,Ce=/\d\d?/,Se=/\d\d\d\d?/,Ne=/\d\d\d\d\d\d?/,ke=/\d{1,3}/,Ae=/\d{1,4}/,we=/[+-]?\d{1,6}/,Te=/\d+/,Oe=/[+-]?\d+/,Ie=/Z|[+-]\d\d:?\d\d/gi,Me=/Z|[+-]\d\d(?::?\d\d)?/gi,Ue=/[+-]?\d+(\.\d{1,3})?/,Re=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Pe(e,t,n){ge[e]=O(t)?t:function(e,r){return e&&n?n:t}}function Le(e,t){return o(ge,e)?ge[e](t._strict,t._locale):new RegExp(De(e))}function De(e){return xe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,i){return t||n||r||i})))}function xe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}ge={};var Fe={};function He(e,t){var n,r=t;for("string"===typeof e&&(e=[e]),c(t)&&(r=function(e,n){n[t]=ce(e)}),n=0;n<e.length;n++)Fe[e[n]]=r}function Ge(e,t){He(e,(function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)}))}function je(e,t,n){null!=t&&o(Fe,e)&&Fe[e](t,n._a,n,e)}var Ve,Be=0,ze=1,Ye=2,qe=3,Ke=4,We=5,Qe=6,$e=7,Je=8;function Xe(e,t){return(e%t+t)%t}function Ze(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=Xe(t,12);return e+=(t-n)/12,1===n?le(e)?29:28:31-n%7%2}Ve=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},G("M",["MM",2],"Mo",(function(){return this.month()+1})),G("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),G("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),ne("month","M"),se("month",8),Pe("M",Ce),Pe("MM",Ce,me),Pe("MMM",(function(e,t){return t.monthsShortRegex(e)})),Pe("MMMM",(function(e,t){return t.monthsRegex(e)})),He(["M","MM"],(function(e,t){t[ze]=ce(e)-1})),He(["MMM","MMMM"],(function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[ze]=i:g(n).invalidMonth=e}));var et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,rt=Re,it=Re;function at(e,t){return e?a(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]:a(this._months)?this._months:this._months.standalone}function st(e,t){return e?a(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ot(e,t,n){var r,i,a,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)a=p([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(a,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,s))?i:null:-1!==(i=Ve.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,s))||-1!==(i=Ve.call(this._longMonthsParse,s))?i:null:-1!==(i=Ve.call(this._longMonthsParse,s))||-1!==(i=Ve.call(this._shortMonthsParse,s))?i:null}function lt(e,t,n){var r,i,a;if(this._monthsParseExact)return ot.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=p([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ut(e,t){var n;if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=ce(t);else if(!c(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Ze(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ct(e){return null!=e?(ut(this,e),r.updateOffset(this,!0),this):he(this,"Month")}function dt(){return Ze(this.year(),this.month())}function ht(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=rt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ft(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=it),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function pt(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],a=[];for(t=0;t<12;t++)n=p([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),a.sort(e),t=0;t<12;t++)r[t]=xe(r[t]),i[t]=xe(i[t]);for(t=0;t<24;t++)a[t]=xe(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function yt(e){return le(e)?366:365}G("Y",0,0,(function(){var e=this.year();return e<=9999?L(e,4):"+"+e})),G(0,["YY",2],0,(function(){return this.year()%100})),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),ne("year","y"),se("year",1),Pe("Y",Oe),Pe("YY",Ce,me),Pe("YYYY",Ae,Ee),Pe("YYYYY",we,be),Pe("YYYYYY",we,be),He(["YYYYY","YYYYYY"],Be),He("YYYY",(function(e,t){t[Be]=2===e.length?r.parseTwoDigitYear(e):ce(e)})),He("YY",(function(e,t){t[Be]=r.parseTwoDigitYear(e)})),He("Y",(function(e,t){t[Be]=parseInt(e,10)})),r.parseTwoDigitYear=function(e){return ce(e)+(ce(e)>68?1900:2e3)};var gt=de("FullYear",!0);function _t(){return le(this.year())}function mt(e,t,n,r,i,a,s){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,r,i,a,s),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,r,i,a,s),o}function vt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Et(e,t,n){var r=7+t-n;return-(7+vt(e,0,r).getUTCDay()-t)%7+r-1}function bt(e,t,n,r,i){var a,s,o=1+7*(t-1)+(7+n-r)%7+Et(e,r,i);return o<=0?s=yt(a=e-1)+o:o>yt(e)?(a=e+1,s=o-yt(e)):(a=e,s=o),{year:a,dayOfYear:s}}function Ct(e,t,n){var r,i,a=Et(e.year(),t,n),s=Math.floor((e.dayOfYear()-a-1)/7)+1;return s<1?r=s+St(i=e.year()-1,t,n):s>St(e.year(),t,n)?(r=s-St(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function St(e,t,n){var r=Et(e,t,n),i=Et(e+1,t,n);return(yt(e)-r+i)/7}function Nt(e){return Ct(e,this._week.dow,this._week.doy).week}G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),ne("week","w"),ne("isoWeek","W"),se("week",5),se("isoWeek",5),Pe("w",Ce),Pe("ww",Ce,me),Pe("W",Ce),Pe("WW",Ce,me),Ge(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=ce(e)}));var kt={dow:0,doy:6};function At(){return this._week.dow}function wt(){return this._week.doy}function Tt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ot(e){var t=Ct(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function It(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Mt(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ut(e,t){return e.slice(t,7).concat(e.slice(0,t))}G("d",0,"do","day"),G("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),G("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),G("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),ne("day","d"),ne("weekday","e"),ne("isoWeekday","E"),se("day",11),se("weekday",11),se("isoWeekday",11),Pe("d",Ce),Pe("e",Ce),Pe("E",Ce),Pe("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Pe("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Pe("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ge(["dd","ddd","dddd"],(function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e})),Ge(["d","e","E"],(function(e,t,n,r){t[r]=ce(e)}));var Rt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Pt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Lt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Dt=Re,xt=Re,Ft=Re;function Ht(e,t){var n=a(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ut(n,this._week.dow):e?n[e.day()]:n}function Gt(e){return!0===e?Ut(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function jt(e){return!0===e?Ut(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Vt(e,t,n){var r,i,a,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)a=p([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(a,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._shortWeekdaysParse,s))||-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,s))||-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,s))||-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._shortWeekdaysParse,s))?i:null}function Bt(e,t,n){var r,i,a;if(this._weekdaysParseExact)return Vt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=p([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function zt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=It(e,this.localeData()),this.add(e-t,"d")):t}function Yt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function qt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Mt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Kt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||$t.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=Dt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Wt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||$t.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=xt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Qt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||$t.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ft),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function $t(){function e(e,t){return t.length-e.length}var t,n,r,i,a,s=[],o=[],l=[],u=[];for(t=0;t<7;t++)n=p([2e3,1]).day(t),r=xe(this.weekdaysMin(n,"")),i=xe(this.weekdaysShort(n,"")),a=xe(this.weekdays(n,"")),s.push(r),o.push(i),l.push(a),u.push(r),u.push(i),u.push(a);s.sort(e),o.sort(e),l.sort(e),u.sort(e),this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Jt(){return this.hours()%12||12}function Xt(){return this.hours()||24}function Zt(e,t){G(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}G("H",["HH",2],0,"hour"),G("h",["hh",2],0,Jt),G("k",["kk",2],0,Xt),G("hmm",0,0,(function(){return""+Jt.apply(this)+L(this.minutes(),2)})),G("hmmss",0,0,(function(){return""+Jt.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)})),G("Hmm",0,0,(function(){return""+this.hours()+L(this.minutes(),2)})),G("Hmmss",0,0,(function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)})),Zt("a",!0),Zt("A",!1),ne("hour","h"),se("hour",13),Pe("a",en),Pe("A",en),Pe("H",Ce),Pe("h",Ce),Pe("k",Ce),Pe("HH",Ce,me),Pe("hh",Ce,me),Pe("kk",Ce,me),Pe("hmm",Se),Pe("hmmss",Ne),Pe("Hmm",Se),Pe("Hmmss",Ne),He(["H","HH"],qe),He(["k","kk"],(function(e,t,n){var r=ce(e);t[qe]=24===r?0:r})),He(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),He(["h","hh"],(function(e,t,n){t[qe]=ce(e),g(n).bigHour=!0})),He("hmm",(function(e,t,n){var r=e.length-2;t[qe]=ce(e.substr(0,r)),t[Ke]=ce(e.substr(r)),g(n).bigHour=!0})),He("hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[qe]=ce(e.substr(0,r)),t[Ke]=ce(e.substr(r,2)),t[We]=ce(e.substr(i)),g(n).bigHour=!0})),He("Hmm",(function(e,t,n){var r=e.length-2;t[qe]=ce(e.substr(0,r)),t[Ke]=ce(e.substr(r))})),He("Hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[qe]=ce(e.substr(0,r)),t[Ke]=ce(e.substr(r,2)),t[We]=ce(e.substr(i))}));var nn=/[ap]\.?m?\.?/i,rn=de("Hours",!0);function an(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var sn,on={calendar:R,longDateFormat:Y,invalidDate:K,ordinal:Q,dayOfMonthOrdinalParse:$,relativeTime:X,months:et,monthsShort:tt,week:kt,weekdays:Rt,weekdaysMin:Lt,weekdaysShort:Pt,meridiemParse:nn},ln={},un={};function cn(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function dn(e){return e?e.toLowerCase().replace("_","-"):e}function hn(e){for(var t,n,r,i,a=0;a<e.length;){for(t=(i=dn(e[a]).split("-")).length,n=(n=dn(e[a+1]))?n.split("-"):null;t>0;){if(r=fn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&cn(i,n)>=t-1)break;t--}a++}return sn}function fn(t){var n=null;if(void 0===ln[t]&&e&&e.exports)try{n=sn._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),pn(n)}catch(r){ln[t]=null}return ln[t]}function pn(e,t){var n;return e&&((n=u(t)?_n(e):yn(e,t))?sn=n:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),sn._abbr}function yn(e,t){if(null!==t){var n,r=on;if(t.abbr=e,null!=ln[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ln[e]._config;else if(null!=t.parentLocale)if(null!=ln[t.parentLocale])r=ln[t.parentLocale]._config;else{if(null==(n=fn(t.parentLocale)))return un[t.parentLocale]||(un[t.parentLocale]=[]),un[t.parentLocale].push({name:e,config:t}),null;r=n._config}return ln[e]=new U(M(r,t)),un[e]&&un[e].forEach((function(e){yn(e.name,e.config)})),pn(e),ln[e]}return delete ln[e],null}function gn(e,t){if(null!=t){var n,r,i=on;null!=ln[e]&&null!=ln[e].parentLocale?ln[e].set(M(ln[e]._config,t)):(null!=(r=fn(e))&&(i=r._config),t=M(i,t),null==r&&(t.abbr=e),(n=new U(t)).parentLocale=ln[e],ln[e]=n),pn(e)}else null!=ln[e]&&(null!=ln[e].parentLocale?(ln[e]=ln[e].parentLocale,e===pn()&&pn(e)):null!=ln[e]&&delete ln[e]);return ln[e]}function _n(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return sn;if(!a(e)){if(t=fn(e))return t;e=[e]}return hn(e)}function mn(){return A(ln)}function vn(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[ze]<0||n[ze]>11?ze:n[Ye]<1||n[Ye]>Ze(n[Be],n[ze])?Ye:n[qe]<0||n[qe]>24||24===n[qe]&&(0!==n[Ke]||0!==n[We]||0!==n[Qe])?qe:n[Ke]<0||n[Ke]>59?Ke:n[We]<0||n[We]>59?We:n[Qe]<0||n[Qe]>999?Qe:-1,g(e)._overflowDayOfYear&&(t<Be||t>Ye)&&(t=Ye),g(e)._overflowWeeks&&-1===t&&(t=$e),g(e)._overflowWeekday&&-1===t&&(t=Je),g(e).overflow=t),e}var En=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cn=/Z|[+-]\d\d(?::?\d\d)?/,Sn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Nn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],kn=/^\/?Date\((-?\d+)/i,An=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Tn(e){var t,n,r,i,a,s,o=e._i,l=En.exec(o)||bn.exec(o);if(l){for(g(e).iso=!0,t=0,n=Sn.length;t<n;t++)if(Sn[t][1].exec(l[1])){i=Sn[t][0],r=!1!==Sn[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=Nn.length;t<n;t++)if(Nn[t][1].exec(l[3])){a=(l[2]||" ")+Nn[t][0];break}if(null==a)return void(e._isValid=!1)}if(!r&&null!=a)return void(e._isValid=!1);if(l[4]){if(!Cn.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(a||"")+(s||""),Gn(e)}else e._isValid=!1}function On(e,t,n,r,i,a){var s=[In(e),tt.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return a&&s.push(parseInt(a,10)),s}function In(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Mn(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Un(e,t,n){return!e||Pt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(g(n).weekdayMismatch=!0,n._isValid=!1,!1)}function Rn(e,t,n){if(e)return wn[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function Pn(e){var t,n=An.exec(Mn(e._i));if(n){if(t=On(n[4],n[3],n[2],n[5],n[6],n[7]),!Un(n[1],t,e))return;e._a=t,e._tzm=Rn(n[8],n[9],n[10]),e._d=vt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function Ln(e){var t=kn.exec(e._i);null===t?(Tn(e),!1===e._isValid&&(delete e._isValid,Pn(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Dn(e,t,n){return null!=e?e:null!=t?t:n}function xn(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Fn(e){var t,n,r,i,a,s=[];if(!e._d){for(r=xn(e),e._w&&null==e._a[Ye]&&null==e._a[ze]&&Hn(e),null!=e._dayOfYear&&(a=Dn(e._a[Be],r[Be]),(e._dayOfYear>yt(a)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=vt(a,0,e._dayOfYear),e._a[ze]=n.getUTCMonth(),e._a[Ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[qe]&&0===e._a[Ke]&&0===e._a[We]&&0===e._a[Qe]&&(e._nextDay=!0,e._a[qe]=0),e._d=(e._useUTC?vt:mt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[qe]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}function Hn(e){var t,n,r,i,a,s,o,l,u;null!=(t=e._w).GG||null!=t.W||null!=t.E?(a=1,s=4,n=Dn(t.GG,e._a[Be],Ct(Wn(),1,4).year),r=Dn(t.W,1),((i=Dn(t.E,1))<1||i>7)&&(l=!0)):(a=e._locale._week.dow,s=e._locale._week.doy,u=Ct(Wn(),a,s),n=Dn(t.gg,e._a[Be],u.year),r=Dn(t.w,u.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a),r<1||r>St(n,a,s)?g(e)._overflowWeeks=!0:null!=l?g(e)._overflowWeekday=!0:(o=bt(n,r,i,a,s),e._a[Be]=o.year,e._dayOfYear=o.dayOfYear)}function Gn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],g(e).empty=!0;var t,n,i,a,s,o,l=""+e._i,u=l.length,c=0;for(i=z(e._f,e._locale).match(D)||[],t=0;t<i.length;t++)a=i[t],(n=(l.match(Le(a,e))||[])[0])&&((s=l.substr(0,l.indexOf(n))).length>0&&g(e).unusedInput.push(s),l=l.slice(l.indexOf(n)+n.length),c+=n.length),H[a]?(n?g(e).empty=!1:g(e).unusedTokens.push(a),je(a,n,e)):e._strict&&!n&&g(e).unusedTokens.push(a);g(e).charsLeftOver=u-c,l.length>0&&g(e).unusedInput.push(l),e._a[qe]<=12&&!0===g(e).bigHour&&e._a[qe]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[qe]=jn(e._locale,e._a[qe],e._meridiem),null!==(o=g(e).era)&&(e._a[Be]=e._locale.erasConvertYear(o,e._a[Be])),Fn(e),vn(e)}else Pn(e);else Tn(e)}function jn(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function Vn(e){var t,n,r,i,a,s,o=!1;if(0===e._f.length)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)a=0,s=!1,t=b({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Gn(t),_(t)&&(s=!0),a+=g(t).charsLeftOver,a+=10*g(t).unusedTokens.length,g(t).score=a,o?a<r&&(r=a,n=t):(null==r||a<r||s)&&(r=a,n=t,s&&(o=!0));f(e,n||t)}function Bn(e){if(!e._d){var t=ie(e._i),n=void 0===t.day?t.date:t.day;e._a=h([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Fn(e)}}function zn(e){var t=new C(vn(Yn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Yn(e){var t=e._i,n=e._f;return e._locale=e._locale||_n(e._l),null===t||void 0===n&&""===t?m({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),S(t)?new C(vn(t)):(d(t)?e._d=t:a(n)?Vn(e):n?Gn(e):qn(e),_(e)||(e._d=null),e))}function qn(e){var t=e._i;u(t)?e._d=new Date(r.now()):d(t)?e._d=new Date(t.valueOf()):"string"===typeof t?Ln(e):a(t)?(e._a=h(t.slice(0),(function(e){return parseInt(e,10)})),Fn(e)):s(t)?Bn(e):c(t)?e._d=new Date(t):r.createFromInputFallback(e)}function Kn(e,t,n,r,i){var o={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&l(e)||a(e)&&0===e.length)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=e,o._f=t,o._strict=r,zn(o)}function Wn(e,t,n,r){return Kn(e,t,n,r,!1)}r.createFromInputFallback=k("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var Qn=k("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Wn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()})),$n=k("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Wn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:m()}));function Jn(e,t){var n,r;if(1===t.length&&a(t[0])&&(t=t[0]),!t.length)return Wn();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Xn(){return Jn("isBefore",[].slice.call(arguments,0))}function Zn(){return Jn("isAfter",[].slice.call(arguments,0))}var er=function(){return Date.now?Date.now():+new Date},tr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function nr(e){var t,n,r=!1;for(t in e)if(o(e,t)&&(-1===Ve.call(tr,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<tr.length;++n)if(e[tr[n]]){if(r)return!1;parseFloat(e[tr[n]])!==ce(e[tr[n]])&&(r=!0)}return!0}function rr(){return this._isValid}function ir(){return wr(NaN)}function ar(e){var t=ie(e),n=t.year||0,r=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,s=t.day||0,o=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=nr(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*o*60*60,this._days=+s+7*a,this._months=+i+3*r+12*n,this._data={},this._locale=_n(),this._bubble()}function sr(e){return e instanceof ar}function or(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function lr(e,t,n){var r,i=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&ce(e[r])!==ce(t[r]))&&s++;return s+a}function ur(e,t){G(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+L(~~(e/60),2)+t+L(~~e%60,2)}))}ur("Z",":"),ur("ZZ",""),Pe("Z",Me),Pe("ZZ",Me),He(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=dr(Me,e)}));var cr=/([\+\-]|\d\d)/gi;function dr(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(cr)||["-",0,0])[1]+ce(n[2]))?0:"+"===n[0]?r:-r}function hr(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(S(e)||d(e)?e.valueOf():Wn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):Wn(e).local()}function fr(e){return-Math.round(e._d.getTimezoneOffset())}function pr(e,t,n){var i,a=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=dr(Me,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=fr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),a!==e&&(!t||this._changeInProgress?Ur(this,wr(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?a:fr(this)}function yr(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function gr(e){return this.utcOffset(0,e)}function _r(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(fr(this),"m")),this}function mr(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=dr(Ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function vr(e){return!!this.isValid()&&(e=e?Wn(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Er(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function br(){if(!u(this._isDSTShifted))return this._isDSTShifted;var e,t={};return b(t,this),(t=Yn(t))._a?(e=t._isUTC?p(t._a):Wn(t._a),this._isDSTShifted=this.isValid()&&lr(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Cr(){return!!this.isValid()&&!this._isUTC}function Sr(){return!!this.isValid()&&this._isUTC}function Nr(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var kr=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ar=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wr(e,t){var n,r,i,a=e,s=null;return sr(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:c(e)||!isNaN(+e)?(a={},t?a[t]=+e:a.milliseconds=+e):(s=kr.exec(e))?(n="-"===s[1]?-1:1,a={y:0,d:ce(s[Ye])*n,h:ce(s[qe])*n,m:ce(s[Ke])*n,s:ce(s[We])*n,ms:ce(or(1e3*s[Qe]))*n}):(s=Ar.exec(e))?(n="-"===s[1]?-1:1,a={y:Tr(s[2],n),M:Tr(s[3],n),w:Tr(s[4],n),d:Tr(s[5],n),h:Tr(s[6],n),m:Tr(s[7],n),s:Tr(s[8],n)}):null==a?a={}:"object"===typeof a&&("from"in a||"to"in a)&&(i=Ir(Wn(a.from),Wn(a.to)),(a={}).ms=i.milliseconds,a.M=i.months),r=new ar(a),sr(e)&&o(e,"_locale")&&(r._locale=e._locale),sr(e)&&o(e,"_isValid")&&(r._isValid=e._isValid),r}function Tr(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Or(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ir(e,t){var n;return e.isValid()&&t.isValid()?(t=hr(t,e),e.isBefore(t)?n=Or(e,t):((n=Or(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Mr(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(T(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Ur(this,wr(n,r),e),this}}function Ur(e,t,n,i){var a=t._milliseconds,s=or(t._days),o=or(t._months);e.isValid()&&(i=null==i||i,o&&ut(e,he(e,"Month")+o*n),s&&fe(e,"Date",he(e,"Date")+s*n),a&&e._d.setTime(e._d.valueOf()+a*n),i&&r.updateOffset(e,s||o))}wr.fn=ar.prototype,wr.invalid=ir;var Rr=Mr(1,"add"),Pr=Mr(-1,"subtract");function Lr(e){return"string"===typeof e||e instanceof String}function Dr(e){return S(e)||d(e)||Lr(e)||c(e)||Fr(e)||xr(e)||null===e||void 0===e}function xr(e){var t,n,r=s(e)&&!l(e),i=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(t=0;t<a.length;t+=1)n=a[t],i=i||o(e,n);return r&&i}function Fr(e){var t=a(e),n=!1;return t&&(n=0===e.filter((function(t){return!c(t)&&Lr(e)})).length),t&&n}function Hr(e){var t,n,r=s(e)&&!l(e),i=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<a.length;t+=1)n=a[t],i=i||o(e,n);return r&&i}function Gr(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function jr(e,t){1===arguments.length&&(arguments[0]?Dr(arguments[0])?(e=arguments[0],t=void 0):Hr(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||Wn(),i=hr(n,this).startOf("day"),a=r.calendarFormat(this,i)||"sameElse",s=t&&(O(t[a])?t[a].call(this,n):t[a]);return this.format(s||this.localeData().calendar(a,this,Wn(n)))}function Vr(){return new C(this)}function Br(e,t){var n=S(e)?e:Wn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function zr(e,t){var n=S(e)?e:Wn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Yr(e,t,n,r){var i=S(e)?e:Wn(e),a=S(t)?t:Wn(t);return!!(this.isValid()&&i.isValid()&&a.isValid())&&("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(a,n):!this.isAfter(a,n))}function qr(e,t){var n,r=S(e)?e:Wn(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Kr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Wr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Qr(e,t,n){var r,i,a;if(!this.isValid())return NaN;if(!(r=hr(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=re(t)){case"year":a=$r(this,r)/12;break;case"month":a=$r(this,r);break;case"quarter":a=$r(this,r)/3;break;case"second":a=(this-r)/1e3;break;case"minute":a=(this-r)/6e4;break;case"hour":a=(this-r)/36e5;break;case"day":a=(this-r-i)/864e5;break;case"week":a=(this-r-i)/6048e5;break;default:a=this-r}return n?a:ue(a)}function $r(e,t){if(e.date()<t.date())return-$r(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Jr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Xr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?B(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):O(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",B(n,"Z")):B(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Zr(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r,i="moment",a="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",a="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",r=a+'[")]',this.format(e+t+n+r)}function ei(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=B(this,e);return this.localeData().postformat(t)}function ti(e,t){return this.isValid()&&(S(e)&&e.isValid()||Wn(e).isValid())?wr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ni(e){return this.from(Wn(),e)}function ri(e,t){return this.isValid()&&(S(e)&&e.isValid()||Wn(e).isValid())?wr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ii(e){return this.to(Wn(),e)}function ai(e){var t;return void 0===e?this._locale._abbr:(null!=(t=_n(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var si=k("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function oi(){return this._locale}var li=1e3,ui=60*li,ci=60*ui,di=3506328*ci;function hi(e,t){return(e%t+t)%t}function fi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-di:new Date(e,t,n).valueOf()}function pi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-di:Date.UTC(e,t,n)}function yi(e){var t,n;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?pi:fi,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=hi(t+(this._isUTC?0:this.utcOffset()*ui),ci);break;case"minute":t=this._d.valueOf(),t-=hi(t,ui);break;case"second":t=this._d.valueOf(),t-=hi(t,li)}return this._d.setTime(t),r.updateOffset(this,!0),this}function gi(e){var t,n;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?pi:fi,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=ci-hi(t+(this._isUTC?0:this.utcOffset()*ui),ci)-1;break;case"minute":t=this._d.valueOf(),t+=ui-hi(t,ui)-1;break;case"second":t=this._d.valueOf(),t+=li-hi(t,li)-1}return this._d.setTime(t),r.updateOffset(this,!0),this}function _i(){return this._d.valueOf()-6e4*(this._offset||0)}function mi(){return Math.floor(this.valueOf()/1e3)}function vi(){return new Date(this.valueOf())}function Ei(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function bi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ci(){return this.isValid()?this.toISOString():null}function Si(){return _(this)}function Ni(){return f({},g(this))}function ki(){return g(this).overflow}function Ai(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function wi(e,t){var n,i,a,s=this._eras||_n("en")._eras;for(n=0,i=s.length;n<i;++n)switch("string"===typeof s[n].since&&(a=r(s[n].since).startOf("day"),s[n].since=a.valueOf()),typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":a=r(s[n].until).startOf("day").valueOf(),s[n].until=a.valueOf()}return s}function Ti(e,t,n){var r,i,a,s,o,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(a=l[r].name.toUpperCase(),s=l[r].abbr.toUpperCase(),o=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[r];break;case"NNNN":if(a===e)return l[r];break;case"NNNNN":if(o===e)return l[r]}else if([a,s,o].indexOf(e)>=0)return l[r]}function Oi(e,t){var n=e.since<=e.until?1:-1;return void 0===t?r(e.since).year():r(e.since).year()+(t-e.offset)*n}function Ii(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function Mi(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Ui(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Ri(){var e,t,n,i,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(n=a[e].since<=a[e].until?1:-1,i=this.clone().startOf("day").valueOf(),a[e].since<=i&&i<=a[e].until||a[e].until<=i&&i<=a[e].since)return(this.year()-r(a[e].since).year())*n+a[e].offset;return this.year()}function Pi(e){return o(this,"_erasNameRegex")||ji.call(this),e?this._erasNameRegex:this._erasRegex}function Li(e){return o(this,"_erasAbbrRegex")||ji.call(this),e?this._erasAbbrRegex:this._erasRegex}function Di(e){return o(this,"_erasNarrowRegex")||ji.call(this),e?this._erasNarrowRegex:this._erasRegex}function xi(e,t){return t.erasAbbrRegex(e)}function Fi(e,t){return t.erasNameRegex(e)}function Hi(e,t){return t.erasNarrowRegex(e)}function Gi(e,t){return t._eraYearOrdinalRegex||Te}function ji(){var e,t,n=[],r=[],i=[],a=[],s=this.eras();for(e=0,t=s.length;e<t;++e)r.push(xe(s[e].name)),n.push(xe(s[e].abbr)),i.push(xe(s[e].narrow)),a.push(xe(s[e].name)),a.push(xe(s[e].abbr)),a.push(xe(s[e].narrow));this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function Vi(e,t){G(0,[e,e.length],0,t)}function Bi(e){return Qi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function zi(e){return Qi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Yi(){return St(this.year(),1,4)}function qi(){return St(this.isoWeekYear(),1,4)}function Ki(){var e=this.localeData()._week;return St(this.year(),e.dow,e.doy)}function Wi(){var e=this.localeData()._week;return St(this.weekYear(),e.dow,e.doy)}function Qi(e,t,n,r,i){var a;return null==e?Ct(this,r,i).year:(t>(a=St(e,r,i))&&(t=a),$i.call(this,e,t,n,r,i))}function $i(e,t,n,r,i){var a=bt(e,t,n,r,i),s=vt(a.year,0,a.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}G("N",0,0,"eraAbbr"),G("NN",0,0,"eraAbbr"),G("NNN",0,0,"eraAbbr"),G("NNNN",0,0,"eraName"),G("NNNNN",0,0,"eraNarrow"),G("y",["y",1],"yo","eraYear"),G("y",["yy",2],0,"eraYear"),G("y",["yyy",3],0,"eraYear"),G("y",["yyyy",4],0,"eraYear"),Pe("N",xi),Pe("NN",xi),Pe("NNN",xi),Pe("NNNN",Fi),Pe("NNNNN",Hi),He(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?g(n).era=i:g(n).invalidEra=e})),Pe("y",Te),Pe("yy",Te),Pe("yyy",Te),Pe("yyyy",Te),Pe("yo",Gi),He(["y","yy","yyy","yyyy"],Be),He(["yo"],(function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[Be]=n._locale.eraYearOrdinalParse(e,i):t[Be]=parseInt(e,10)})),G(0,["gg",2],0,(function(){return this.weekYear()%100})),G(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Vi("gggg","weekYear"),Vi("ggggg","weekYear"),Vi("GGGG","isoWeekYear"),Vi("GGGGG","isoWeekYear"),ne("weekYear","gg"),ne("isoWeekYear","GG"),se("weekYear",1),se("isoWeekYear",1),Pe("G",Oe),Pe("g",Oe),Pe("GG",Ce,me),Pe("gg",Ce,me),Pe("GGGG",Ae,Ee),Pe("gggg",Ae,Ee),Pe("GGGGG",we,be),Pe("ggggg",we,be),Ge(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=ce(e)})),Ge(["gg","GG"],(function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)})),G("Q",0,"Qo","quarter"),ne("quarter","Q"),se("quarter",7),Pe("Q",_e),He("Q",(function(e,t){t[ze]=3*(ce(e)-1)})),G("D",["DD",2],"Do","date"),ne("date","D"),se("date",9),Pe("D",Ce),Pe("DD",Ce,me),Pe("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),He(["D","DD"],Ye),He("Do",(function(e,t){t[Ye]=ce(e.match(Ce)[0])}));var Xi=de("Date",!0);function Zi(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}G("DDD",["DDDD",3],"DDDo","dayOfYear"),ne("dayOfYear","DDD"),se("dayOfYear",4),Pe("DDD",ke),Pe("DDDD",ve),He(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=ce(e)})),G("m",["mm",2],0,"minute"),ne("minute","m"),se("minute",14),Pe("m",Ce),Pe("mm",Ce,me),He(["m","mm"],Ke);var ea=de("Minutes",!1);G("s",["ss",2],0,"second"),ne("second","s"),se("second",15),Pe("s",Ce),Pe("ss",Ce,me),He(["s","ss"],We);var ta,na,ra=de("Seconds",!1);for(G("S",0,0,(function(){return~~(this.millisecond()/100)})),G(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),G(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),G(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),G(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),G(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),G(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),ne("millisecond","ms"),se("millisecond",16),Pe("S",ke,_e),Pe("SS",ke,me),Pe("SSS",ke,ve),ta="SSSS";ta.length<=9;ta+="S")Pe(ta,Te);function ia(e,t){t[Qe]=ce(1e3*("0."+e))}for(ta="S";ta.length<=9;ta+="S")He(ta,ia);function aa(){return this._isUTC?"UTC":""}function sa(){return this._isUTC?"Coordinated Universal Time":""}na=de("Milliseconds",!1),G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var oa=C.prototype;function la(e){return Wn(1e3*e)}function ua(){return Wn.apply(null,arguments).parseZone()}function ca(e){return e}oa.add=Rr,oa.calendar=jr,oa.clone=Vr,oa.diff=Qr,oa.endOf=gi,oa.format=ei,oa.from=ti,oa.fromNow=ni,oa.to=ri,oa.toNow=ii,oa.get=pe,oa.invalidAt=ki,oa.isAfter=Br,oa.isBefore=zr,oa.isBetween=Yr,oa.isSame=qr,oa.isSameOrAfter=Kr,oa.isSameOrBefore=Wr,oa.isValid=Si,oa.lang=si,oa.locale=ai,oa.localeData=oi,oa.max=$n,oa.min=Qn,oa.parsingFlags=Ni,oa.set=ye,oa.startOf=yi,oa.subtract=Pr,oa.toArray=Ei,oa.toObject=bi,oa.toDate=vi,oa.toISOString=Xr,oa.inspect=Zr,"undefined"!==typeof Symbol&&null!=Symbol.for&&(oa[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),oa.toJSON=Ci,oa.toString=Jr,oa.unix=mi,oa.valueOf=_i,oa.creationData=Ai,oa.eraName=Ii,oa.eraNarrow=Mi,oa.eraAbbr=Ui,oa.eraYear=Ri,oa.year=gt,oa.isLeapYear=_t,oa.weekYear=Bi,oa.isoWeekYear=zi,oa.quarter=oa.quarters=Ji,oa.month=ct,oa.daysInMonth=dt,oa.week=oa.weeks=Tt,oa.isoWeek=oa.isoWeeks=Ot,oa.weeksInYear=Ki,oa.weeksInWeekYear=Wi,oa.isoWeeksInYear=Yi,oa.isoWeeksInISOWeekYear=qi,oa.date=Xi,oa.day=oa.days=zt,oa.weekday=Yt,oa.isoWeekday=qt,oa.dayOfYear=Zi,oa.hour=oa.hours=rn,oa.minute=oa.minutes=ea,oa.second=oa.seconds=ra,oa.millisecond=oa.milliseconds=na,oa.utcOffset=pr,oa.utc=gr,oa.local=_r,oa.parseZone=mr,oa.hasAlignedHourOffset=vr,oa.isDST=Er,oa.isLocal=Cr,oa.isUtcOffset=Sr,oa.isUtc=Nr,oa.isUTC=Nr,oa.zoneAbbr=aa,oa.zoneName=sa,oa.dates=k("dates accessor is deprecated. Use date instead.",Xi),oa.months=k("months accessor is deprecated. Use month instead",ct),oa.years=k("years accessor is deprecated. Use year instead",gt),oa.zone=k("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",yr),oa.isDSTShifted=k("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",br);var da=U.prototype;function ha(e,t,n,r){var i=_n(),a=p().set(r,t);return i[n](a,e)}function fa(e,t,n){if(c(e)&&(t=e,e=void 0),e=e||"",null!=t)return ha(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=ha(e,r,n,"month");return i}function pa(e,t,n,r){"boolean"===typeof e?(c(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,c(t)&&(n=t,t=void 0),t=t||"");var i,a=_n(),s=e?a._week.dow:0,o=[];if(null!=n)return ha(t,(n+s)%7,r,"day");for(i=0;i<7;i++)o[i]=ha(t,(i+s)%7,r,"day");return o}function ya(e,t){return fa(e,t,"months")}function ga(e,t){return fa(e,t,"monthsShort")}function _a(e,t,n){return pa(e,t,n,"weekdays")}function ma(e,t,n){return pa(e,t,n,"weekdaysShort")}function va(e,t,n){return pa(e,t,n,"weekdaysMin")}da.calendar=P,da.longDateFormat=q,da.invalidDate=W,da.ordinal=J,da.preparse=ca,da.postformat=ca,da.relativeTime=Z,da.pastFuture=ee,da.set=I,da.eras=wi,da.erasParse=Ti,da.erasConvertYear=Oi,da.erasAbbrRegex=Li,da.erasNameRegex=Pi,da.erasNarrowRegex=Di,da.months=at,da.monthsShort=st,da.monthsParse=lt,da.monthsRegex=ft,da.monthsShortRegex=ht,da.week=Nt,da.firstDayOfYear=wt,da.firstDayOfWeek=At,da.weekdays=Ht,da.weekdaysMin=jt,da.weekdaysShort=Gt,da.weekdaysParse=Bt,da.weekdaysRegex=Kt,da.weekdaysShortRegex=Wt,da.weekdaysMinRegex=Qt,da.isPM=tn,da.meridiem=an,pn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===ce(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=k("moment.lang is deprecated. Use moment.locale instead.",pn),r.langData=k("moment.langData is deprecated. Use moment.localeData instead.",_n);var Ea=Math.abs;function ba(){var e=this._data;return this._milliseconds=Ea(this._milliseconds),this._days=Ea(this._days),this._months=Ea(this._months),e.milliseconds=Ea(e.milliseconds),e.seconds=Ea(e.seconds),e.minutes=Ea(e.minutes),e.hours=Ea(e.hours),e.months=Ea(e.months),e.years=Ea(e.years),this}function Ca(e,t,n,r){var i=wr(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Sa(e,t){return Ca(this,e,t,1)}function Na(e,t){return Ca(this,e,t,-1)}function ka(e){return e<0?Math.floor(e):Math.ceil(e)}function Aa(){var e,t,n,r,i,a=this._milliseconds,s=this._days,o=this._months,l=this._data;return a>=0&&s>=0&&o>=0||a<=0&&s<=0&&o<=0||(a+=864e5*ka(Ta(o)+s),s=0,o=0),l.milliseconds=a%1e3,e=ue(a/1e3),l.seconds=e%60,t=ue(e/60),l.minutes=t%60,n=ue(t/60),l.hours=n%24,s+=ue(n/24),o+=i=ue(wa(s)),s-=ka(Ta(i)),r=ue(o/12),o%=12,l.days=s,l.months=o,l.years=r,this}function wa(e){return 4800*e/146097}function Ta(e){return 146097*e/4800}function Oa(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+wa(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Ta(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Ia(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ce(this._months/12):NaN}function Ma(e){return function(){return this.as(e)}}var Ua=Ma("ms"),Ra=Ma("s"),Pa=Ma("m"),La=Ma("h"),Da=Ma("d"),xa=Ma("w"),Fa=Ma("M"),Ha=Ma("Q"),Ga=Ma("y");function ja(){return wr(this)}function Va(e){return e=re(e),this.isValid()?this[e+"s"]():NaN}function Ba(e){return function(){return this.isValid()?this._data[e]:NaN}}var za=Ba("milliseconds"),Ya=Ba("seconds"),qa=Ba("minutes"),Ka=Ba("hours"),Wa=Ba("days"),Qa=Ba("months"),$a=Ba("years");function Ja(){return ue(this.days()/7)}var Xa=Math.round,Za={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function es(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function ts(e,t,n,r){var i=wr(e).abs(),a=Xa(i.as("s")),s=Xa(i.as("m")),o=Xa(i.as("h")),l=Xa(i.as("d")),u=Xa(i.as("M")),c=Xa(i.as("w")),d=Xa(i.as("y")),h=a<=n.ss&&["s",a]||a<n.s&&["ss",a]||s<=1&&["m"]||s<n.m&&["mm",s]||o<=1&&["h"]||o<n.h&&["hh",o]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(h=h||c<=1&&["w"]||c<n.w&&["ww",c]),(h=h||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=r,es.apply(null,h)}function ns(e){return void 0===e?Xa:"function"===typeof e&&(Xa=e,!0)}function rs(e,t){return void 0!==Za[e]&&(void 0===t?Za[e]:(Za[e]=t,"s"===e&&(Za.ss=t-1),!0))}function is(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,a=Za;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(a=Object.assign({},Za,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1)),r=ts(this,!i,a,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)}var as=Math.abs;function ss(e){return(e>0)-(e<0)||+e}function os(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,a,s,o,l=as(this._milliseconds)/1e3,u=as(this._days),c=as(this._months),d=this.asSeconds();return d?(e=ue(l/60),t=ue(e/60),l%=60,e%=60,n=ue(c/12),c%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=d<0?"-":"",a=ss(this._months)!==ss(d)?"-":"",s=ss(this._days)!==ss(d)?"-":"",o=ss(this._milliseconds)!==ss(d)?"-":"",i+"P"+(n?a+n+"Y":"")+(c?a+c+"M":"")+(u?s+u+"D":"")+(t||e||l?"T":"")+(t?o+t+"H":"")+(e?o+e+"M":"")+(l?o+r+"S":"")):"P0D"}var ls=ar.prototype;return ls.isValid=rr,ls.abs=ba,ls.add=Sa,ls.subtract=Na,ls.as=Oa,ls.asMilliseconds=Ua,ls.asSeconds=Ra,ls.asMinutes=Pa,ls.asHours=La,ls.asDays=Da,ls.asWeeks=xa,ls.asMonths=Fa,ls.asQuarters=Ha,ls.asYears=Ga,ls.valueOf=Ia,ls._bubble=Aa,ls.clone=ja,ls.get=Va,ls.milliseconds=za,ls.seconds=Ya,ls.minutes=qa,ls.hours=Ka,ls.days=Wa,ls.weeks=Ja,ls.months=Qa,ls.years=$a,ls.humanize=is,ls.toISOString=os,ls.toString=os,ls.toJSON=os,ls.locale=ai,ls.localeData=oi,ls.toIsoString=k("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",os),ls.lang=si,G("X",0,0,"unix"),G("x",0,0,"valueOf"),Pe("x",Oe),Pe("X",Ue),He("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),He("x",(function(e,t,n){n._d=new Date(ce(e))})),r.version="2.29.1",i(Wn),r.fn=oa,r.min=Xn,r.max=Zn,r.now=er,r.utc=p,r.unix=la,r.months=ya,r.isDate=d,r.locale=pn,r.invalid=m,r.duration=wr,r.isMoment=S,r.weekdays=_a,r.parseZone=ua,r.localeData=_n,r.isDuration=sr,r.monthsShort=ga,r.weekdaysMin=va,r.defineLocale=yn,r.updateLocale=gn,r.locales=mn,r.weekdaysShort=ma,r.normalizeUnits=re,r.relativeTimeRounding=ns,r.relativeTimeThreshold=rs,r.calendarFormat=Gr,r.prototype=oa,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()},1725:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,a){for(var s,o,l=i(e),u=1;u<arguments.length;u++){for(var c in s=Object(arguments[u]))n.call(s,c)&&(l[c]=s[c]);if(t){o=t(s);for(var d=0;d<o.length;d++)r.call(s,o[d])&&(l[o[d]]=s[o[d]])}}return l}},4463:function(e,t,n){"use strict";var r=n(2791),i=n(1725),a=n(5296);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var o=new Set,l={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},y={};function g(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){_[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];_[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){_[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){_[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){_[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){_[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){_[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){_[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){_[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function E(e,t,n,r){var i=_.hasOwnProperty(t)?_[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!f.call(y,e)||!f.call(p,e)&&(h.test(e)?y[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,v);_[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,v);_[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,v);_[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){_[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),_.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){_[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=60103,S=60106,N=60107,k=60108,A=60114,w=60109,T=60110,O=60112,I=60113,M=60120,U=60115,R=60116,P=60121,L=60128,D=60129,x=60130,F=60131;if("function"===typeof Symbol&&Symbol.for){var H=Symbol.for;C=H("react.element"),S=H("react.portal"),N=H("react.fragment"),k=H("react.strict_mode"),A=H("react.profiler"),w=H("react.provider"),T=H("react.context"),O=H("react.forward_ref"),I=H("react.suspense"),M=H("react.suspense_list"),U=H("react.memo"),R=H("react.lazy"),P=H("react.block"),H("react.scope"),L=H("react.opaque.id"),D=H("react.debug_trace_mode"),x=H("react.offscreen"),F=H("react.legacy_hidden")}var G,j="function"===typeof Symbol&&Symbol.iterator;function V(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}function B(e){if(void 0===G)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);G=t&&t[1]||""}return"\n"+G+e}var z=!1;function Y(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o])return"\n"+i[s].replace(" at new "," at ")}while(1<=s&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function q(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=Y(e.type,!1);case 11:return e=Y(e.type.render,!1);case 22:return e=Y(e.type._render,!1);case 1:return e=Y(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case S:return"Portal";case A:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case w:return(e._context.displayName||"Context")+".Provider";case O:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case U:return K(e.type);case P:return K(e._render);case R:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function W(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=Q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&E(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function se(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function le(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ue(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ce(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml",he="http://www.w3.org/2000/svg";function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ye,ge,_e=(ge=function(e,t){if(e.namespaceURI!==he||"innerHTML"in e)e.innerHTML=t;else{for((ye=ye||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ye.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ge(e,t)}))}:ge);function me(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ve={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ee=["Webkit","ms","Moz","O"];function be(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||ve.hasOwnProperty(e)&&ve[e]?(""+t).trim():t+"px"}function Ce(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=be(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(ve).forEach((function(e){Ee.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ve[t]=ve[e]}))}));var Se=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ne(e,t){if(t){if(Se[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ae(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Te=null,Oe=null;function Ie(e){if(e=ri(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=ai(t),we(e.stateNode,e.type,t))}}function Me(e){Te?Oe?Oe.push(e):Oe=[e]:Te=e}function Ue(){if(Te){var e=Te,t=Oe;if(Oe=Te=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Re(e,t){return e(t)}function Pe(e,t,n,r,i){return e(t,n,r,i)}function Le(){}var De=Re,xe=!1,Fe=!1;function He(){null===Te&&null===Oe||(Le(),Ue())}function Ge(e,t){var n=e.stateNode;if(null===n)return null;var r=ai(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var je=!1;if(d)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){je=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(ge){je=!1}function Be(e,t,n,r,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var ze=!1,Ye=null,qe=!1,Ke=null,We={onError:function(e){ze=!0,Ye=e}};function Qe(e,t,n,r,i,a,s,o,l){ze=!1,Ye=null,Be.apply(We,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Xe(e){if($e(e)!==e)throw Error(s(188))}function Ze(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Xe(i),e;if(a===r)return Xe(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,it,at=!1,st=[],ot=null,lt=null,ut=null,ct=new Map,dt=new Map,ht=[],ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function yt(e,t){switch(e){case"focusin":case"focusout":ot=null;break;case"dragenter":case"dragleave":lt=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function gt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=pt(t,n,r,i,a),null!==t&&(null!==(t=ri(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function _t(e){var t=ni(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void it(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ri(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function vt(e,t,n){mt(e)&&n.delete(t)}function Et(){for(at=!1;0<st.length;){var e=st[0];if(null!==e.blockedOn){null!==(e=ri(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&st.shift()}null!==ot&&mt(ot)&&(ot=null),null!==lt&&mt(lt)&&(lt=null),null!==ut&&mt(ut)&&(ut=null),ct.forEach(vt),dt.forEach(vt)}function bt(e,t){e.blockedOn===t&&(e.blockedOn=null,at||(at=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Et)))}function Ct(e){function t(t){return bt(t,e)}if(0<st.length){bt(st[0],e);for(var n=1;n<st.length;n++){var r=st[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ot&&bt(ot,e),null!==lt&&bt(lt,e),null!==ut&&bt(ut,e),ct.forEach(t),dt.forEach(t),n=0;n<ht.length;n++)(r=ht[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ht.length&&null===(n=ht[0]).blockedOn;)_t(n),null===n.blockedOn&&ht.shift()}function St(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nt={animationend:St("Animation","AnimationEnd"),animationiteration:St("Animation","AnimationIteration"),animationstart:St("Animation","AnimationStart"),transitionend:St("Transition","TransitionEnd")},kt={},At={};function wt(e){if(kt[e])return kt[e];if(!Nt[e])return e;var t,n=Nt[e];for(t in n)if(n.hasOwnProperty(t)&&t in At)return kt[e]=n[t];return e}d&&(At=document.createElement("div").style,"AnimationEvent"in window||(delete Nt.animationend.animation,delete Nt.animationiteration.animation,delete Nt.animationstart.animation),"TransitionEvent"in window||delete Nt.transitionend.transition);var Tt=wt("animationend"),Ot=wt("animationiteration"),It=wt("animationstart"),Mt=wt("transitionend"),Ut=new Map,Rt=new Map,Pt=["abort","abort",Tt,"animationEnd",Ot,"animationIteration",It,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Mt,"transitionEnd","waiting","waiting"];function Lt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Rt.set(r,t),Ut.set(r,i),u(i,[r])}}(0,a.unstable_now)();var Dt=8;function xt(e){if(0!==(1&e))return Dt=15,1;if(0!==(2&e))return Dt=14,2;if(0!==(4&e))return Dt=13,4;var t=24&e;return 0!==t?(Dt=12,t):0!==(32&e)?(Dt=11,32):0!==(t=192&e)?(Dt=10,t):0!==(256&e)?(Dt=9,256):0!==(t=3584&e)?(Dt=8,t):0!==(4096&e)?(Dt=7,4096):0!==(t=4186112&e)?(Dt=6,t):0!==(t=62914560&e)?(Dt=5,t):67108864&e?(Dt=4,67108864):0!==(134217728&e)?(Dt=3,134217728):0!==(t=805306368&e)?(Dt=2,t):0!==(1073741824&e)?(Dt=1,1073741824):(Dt=8,e)}function Ft(e,t){var n=e.pendingLanes;if(0===n)return Dt=0;var r=0,i=0,a=e.expiredLanes,s=e.suspendedLanes,o=e.pingedLanes;if(0!==a)r=a,i=Dt=15;else if(0!==(a=134217727&n)){var l=a&~s;0!==l?(r=xt(l),i=Dt):0!==(o&=a)&&(r=xt(o),i=Dt)}else 0!==(a=n&~s)?(r=xt(a),i=Dt):0!==o&&(r=xt(o),i=Dt);if(0===r)return 0;if(r=n&((0>(r=31-zt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&s)){if(xt(t),i<=Dt)return t;Dt=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-zt(t)),r|=e[n],t&=~i;return r}function Ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Gt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=jt(24&~t))?Gt(10,t):e;case 10:return 0===(e=jt(192&~t))?Gt(8,t):e;case 8:return 0===(e=jt(3584&~t))&&(0===(e=jt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=jt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function jt(e){return e&-e}function Vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Bt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-zt(t)]=n}var zt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Yt(e)/qt|0)|0},Yt=Math.log,qt=Math.LN2;var Kt=a.unstable_UserBlockingPriority,Wt=a.unstable_runWithPriority,Qt=!0;function $t(e,t,n,r){xe||Le();var i=Xt,a=xe;xe=!0;try{Pe(i,e,t,n,r)}finally{(xe=a)||He()}}function Jt(e,t,n,r){Wt(Kt,Xt.bind(null,e,t,n,r))}function Xt(e,t,n,r){var i;if(Qt)if((i=0===(4&t))&&0<st.length&&-1<ft.indexOf(e))e=pt(null,e,t,n,r),st.push(e);else{var a=Zt(e,t,n,r);if(null===a)i&&yt(e,r);else{if(i){if(-1<ft.indexOf(e))return e=pt(a,e,t,n,r),void st.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return ot=gt(ot,e,t,n,r,i),!0;case"dragenter":return lt=gt(lt,e,t,n,r,i),!0;case"mouseover":return ut=gt(ut,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return ct.set(a,gt(ct.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,dt.set(a,gt(dt.get(a)||null,e,t,n,r,i)),!0}return!1}(a,e,t,n,r))return;yt(e,r)}Lr(e,t,r,null,n)}}}function Zt(e,t,n,r){var i=Ae(r);if(null!==(i=ni(i))){var a=$e(i);if(null===a)i=null;else{var s=a.tag;if(13===s){if(null!==(i=Je(a)))return i;i=null}else if(3===s){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Lr(e,t,r,i,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,i="value"in en?en.value:en.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return nn=i.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function sn(){return!0}function on(){return!1}function ln(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?sn:on,this.isPropagationStopped=on,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=sn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=sn)},persist:function(){},isPersistent:sn}),t}var un,cn,dn,hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=ln(hn),pn=i({},hn,{view:0,detail:0}),yn=ln(pn),gn=i({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dn&&(dn&&"mousemove"===e.type?(un=e.screenX-dn.screenX,cn=e.screenY-dn.screenY):cn=un=0,dn=e),un)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),_n=ln(gn),mn=ln(i({},gn,{dataTransfer:0})),vn=ln(i({},pn,{relatedTarget:0})),En=ln(i({},hn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=i({},hn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cn=ln(bn),Sn=ln(i({},hn,{data:0})),Nn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},An={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=An[e])&&!!t[e]}function Tn(){return wn}var On=i({},pn,{key:function(e){if(e.key){var t=Nn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=ln(On),Mn=ln(i({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Un=ln(i({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Rn=ln(i({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=i({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=ln(Pn),Dn=[9,13,27,32],xn=d&&"CompositionEvent"in window,Fn=null;d&&"documentMode"in document&&(Fn=document.documentMode);var Hn=d&&"TextEvent"in window&&!Fn,Gn=d&&(!xn||Fn&&8<Fn&&11>=Fn),jn=String.fromCharCode(32),Vn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Yn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){Me(r),0<(t=xr(t,"onChange")).length&&(n=new fn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Qn=null,$n=null;function Jn(e){Or(e,0)}function Xn(e){if(J(ii(e)))return e}function Zn(e,t){if("change"===e)return t}var er=!1;if(d){var tr;if(d){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ir(){Qn&&(Qn.detachEvent("onpropertychange",ar),$n=Qn=null)}function ar(e){if("value"===e.propertyName&&Xn($n)){var t=[];if(Wn(t,$n,e,Ae(e)),e=Jn,xe)e(t);else{xe=!0;try{Re(e,t)}finally{xe=!1,He()}}}}function sr(e,t,n){"focusin"===e?(ir(),$n=n,(Qn=t).attachEvent("onpropertychange",ar)):"focusout"===e&&ir()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn($n)}function lr(e,t){if("click"===e)return Xn(t)}function ur(e,t){if("input"===e||"change"===e)return Xn(t)}var cr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},dr=Object.prototype.hasOwnProperty;function hr(e,t){if(cr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!dr.call(t,n[r])||!cr(e[n[r]],t[n[r]]))return!1;return!0}function fr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pr(e,t){var n,r=fr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fr(r)}}function yr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?yr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function _r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mr=d&&"documentMode"in document&&11>=document.documentMode,vr=null,Er=null,br=null,Cr=!1;function Sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Cr||null==vr||vr!==X(r)||("selectionStart"in(r=vr)&&_r(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&hr(br,r)||(br=r,0<(r=xr(Er,"onSelect")).length&&(t=new fn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}Lt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Lt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Lt(Pt,2);for(var Nr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),kr=0;kr<Nr.length;kr++)Rt.set(Nr[kr],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ar));function Tr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,u){if(Qe.apply(this,arguments),ze){if(!ze)throw Error(s(198));var c=Ye;ze=!1,Ye=null,qe||(qe=!0,Ke=c)}}(r,t,void 0,e),e.currentTarget=null}function Or(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;Tr(i,o,u),a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;Tr(i,o,u),a=l}}}if(qe)throw e=Ke,qe=!1,Ke=null,e}function Ir(e,t){var n=si(t),r=e+"__bubble";n.has(r)||(Pr(t,e,2,!1),n.add(r))}var Mr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){e[Mr]||(e[Mr]=!0,o.forEach((function(t){wr.has(t)||Rr(t,!1,e,null),Rr(t,!0,e,null)})))}function Rr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===e&&9!==n.nodeType&&(a=n.ownerDocument),null!==r&&!t&&wr.has(e)){if("scroll"!==e)return;i|=2,a=r}var s=si(a),o=e+"__"+(t?"capture":"bubble");s.has(o)||(t&&(i|=4),Pr(a,e,i,t),s.add(o))}function Pr(e,t,n,r){var i=Rt.get(t);switch(void 0===i?2:i){case 0:i=$t;break;case 1:i=Jt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Lr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=ni(o)))return;if(5===(l=s.tag)||6===l){r=a=s;continue e}o=o.parentNode}}r=r.return}!function(e,t,n){if(Fe)return e(t,n);Fe=!0;try{De(e,t,n)}finally{Fe=!1,He()}}((function(){var r=a,i=Ae(n),s=[];e:{var o=Ut.get(e);if(void 0!==o){var l=fn,u=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":u="focus",l=vn;break;case"focusout":u="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=_n;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Un;break;case Tt:case Ot:case It:l=En;break;case Mt:l=Rn;break;case"scroll":l=yn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=Cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==o?o+"Capture":null:o;c=[];for(var f,p=r;null!==p;){var y=(f=p).stateNode;if(5===f.tag&&null!==y&&(f=y,null!==h&&(null!=(y=Ge(p,h))&&c.push(Dr(p,y,f)))),d)break;p=p.return}0<c.length&&(o=new l(o,u,null,n,i),s.push({event:o,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(u=n.relatedTarget||n.fromElement)||!ni(u)&&!u[ei])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?ni(u):null)&&(u!==(d=$e(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=_n,y="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Mn,y="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:ii(l),f=null==u?o:ii(u),(o=new c(y,p+"leave",l,n,i)).target=d,o.relatedTarget=f,y=null,ni(i)===r&&((c=new c(h,p+"enter",u,n,i)).target=f,c.relatedTarget=d,y=c),d=y,l&&u)e:{for(h=u,p=0,f=c=l;f;f=Fr(f))p++;for(f=0,y=h;y;y=Fr(y))f++;for(;0<p-f;)c=Fr(c),p--;for(;0<f-p;)h=Fr(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Fr(c),h=Fr(h)}c=null}else c=null;null!==l&&Hr(s,o,l,c,!1),null!==u&&null!==d&&Hr(s,d,u,c,!0)}if("select"===(l=(o=r?ii(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Zn;else if(Kn(o))if(er)g=ur;else{g=or;var _=sr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=lr);switch(g&&(g=g(e,r))?Wn(s,g,n,i):(_&&_(e,o,r),"focusout"===e&&(_=o._wrapperState)&&_.controlled&&"number"===o.type&&ie(o,"number",o.value)),_=r?ii(r):window,e){case"focusin":(Kn(_)||"true"===_.contentEditable)&&(vr=_,Er=r,br=null);break;case"focusout":br=Er=vr=null;break;case"mousedown":Cr=!0;break;case"contextmenu":case"mouseup":case"dragend":Cr=!1,Sr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":Sr(s,n,i)}var m;if(xn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Yn?Bn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Gn&&"ko"!==n.locale&&(Yn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Yn&&(m=rn()):(tn="value"in(en=i)?en.value:en.textContent,Yn=!0)),0<(_=xr(r,v)).length&&(v=new Sn(v,e,null,n,i),s.push({event:v,listeners:_}),m?v.data=m:null!==(m=zn(n))&&(v.data=m))),(m=Hn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Vn=!0,jn);case"textInput":return(e=t.data)===jn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Yn)return"compositionend"===e||!xn&&Bn(e,t)?(e=rn(),nn=tn=en=null,Yn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Gn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=xr(r,"onBeforeInput")).length&&(i=new Sn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=m))}Or(s,t)}))}function Dr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function xr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ge(e,n))&&r.unshift(Dr(e,a,i)),null!=(a=Ge(e,t))&&r.push(Dr(e,a,i))),e=e.return}return r}function Fr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hr(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==u&&(o=u,i?null!=(l=Ge(n,a))&&s.unshift(Dr(n,l,o)):i||null!=(l=Ge(n,a))&&s.push(Dr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}function Gr(){}var jr=null,Vr=null;function Br(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function zr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Yr="function"===typeof setTimeout?setTimeout:void 0,qr="function"===typeof clearTimeout?clearTimeout:void 0;function Kr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Wr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Qr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var $r=0;var Jr=Math.random().toString(36).slice(2),Xr="__reactFiber$"+Jr,Zr="__reactProps$"+Jr,ei="__reactContainer$"+Jr,ti="__reactEvents$"+Jr;function ni(e){var t=e[Xr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ei]||n[Xr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Qr(e);null!==e;){if(n=e[Xr])return n;e=Qr(e)}return t}n=(e=n).parentNode}return null}function ri(e){return!(e=e[Xr]||e[ei])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ii(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function ai(e){return e[Zr]||null}function si(e){var t=e[ti];return void 0===t&&(t=e[ti]=new Set),t}var oi=[],li=-1;function ui(e){return{current:e}}function ci(e){0>li||(e.current=oi[li],oi[li]=null,li--)}function di(e,t){li++,oi[li]=e.current,e.current=t}var hi={},fi=ui(hi),pi=ui(!1),yi=hi;function gi(e,t){var n=e.type.contextTypes;if(!n)return hi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function _i(e){return null!==(e=e.childContextTypes)&&void 0!==e}function mi(){ci(pi),ci(fi)}function vi(e,t,n){if(fi.current!==hi)throw Error(s(168));di(fi,t),di(pi,n)}function Ei(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(s(108,K(t)||"Unknown",a));return i({},n,r)}function bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hi,yi=fi.current,di(fi,e),di(pi,pi.current),!0}function Ci(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ei(e,t,yi),r.__reactInternalMemoizedMergedChildContext=e,ci(pi),ci(fi),di(fi,e)):ci(pi),di(pi,n)}var Si=null,Ni=null,ki=a.unstable_runWithPriority,Ai=a.unstable_scheduleCallback,wi=a.unstable_cancelCallback,Ti=a.unstable_shouldYield,Oi=a.unstable_requestPaint,Ii=a.unstable_now,Mi=a.unstable_getCurrentPriorityLevel,Ui=a.unstable_ImmediatePriority,Ri=a.unstable_UserBlockingPriority,Pi=a.unstable_NormalPriority,Li=a.unstable_LowPriority,Di=a.unstable_IdlePriority,xi={},Fi=void 0!==Oi?Oi:function(){},Hi=null,Gi=null,ji=!1,Vi=Ii(),Bi=1e4>Vi?Ii:function(){return Ii()-Vi};function zi(){switch(Mi()){case Ui:return 99;case Ri:return 98;case Pi:return 97;case Li:return 96;case Di:return 95;default:throw Error(s(332))}}function Yi(e){switch(e){case 99:return Ui;case 98:return Ri;case 97:return Pi;case 96:return Li;case 95:return Di;default:throw Error(s(332))}}function qi(e,t){return e=Yi(e),ki(e,t)}function Ki(e,t,n){return e=Yi(e),Ai(e,t,n)}function Wi(){if(null!==Gi){var e=Gi;Gi=null,wi(e)}Qi()}function Qi(){if(!ji&&null!==Hi){ji=!0;var e=0;try{var t=Hi;qi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Hi=null}catch(n){throw null!==Hi&&(Hi=Hi.slice(e+1)),Ai(Ui,Wi),n}finally{ji=!1}}}var $i=b.ReactCurrentBatchConfig;function Ji(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Xi=ui(null),Zi=null,ea=null,ta=null;function na(){ta=ea=Zi=null}function ra(e){var t=Xi.current;ci(Xi),e.type._context._currentValue=t}function ia(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function aa(e,t){Zi=e,ta=ea=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ds=!0),e.firstContext=null)}function sa(e,t){if(ta!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(ta=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ea){if(null===Zi)throw Error(s(308));ea=t,Zi.dependencies={lanes:0,firstContext:t,responders:null}}else ea=ea.next=t;return e._currentValue}var oa=!1;function la(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ua(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ca(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function da(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function ha(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fa(e,t,n,r){var a=e.updateQueue;oa=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var u=l,c=u.next;u.next=null,null===o?s=c:o.next=c,o=u;var d=e.alternate;if(null!==d){var h=(d=d.updateQueue).lastBaseUpdate;h!==o&&(null===h?d.firstBaseUpdate=c:h.next=c,d.lastBaseUpdate=u)}}if(null!==s){for(h=a.baseState,o=0,d=c=u=null;;){l=s.lane;var f=s.eventTime;if((r&l)===l){null!==d&&(d=d.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,y=s;switch(l=t,f=n,y.tag){case 1:if("function"===typeof(p=y.payload)){h=p.call(f,h,l);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(l="function"===typeof(p=y.payload)?p.call(f,h,l):p)||void 0===l)break e;h=i({},h,l);break e;case 2:oa=!0}}null!==s.callback&&(e.flags|=32,null===(l=a.effects)?a.effects=[s]:l.push(s))}else f={eventTime:f,lane:l,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,u=h):d=d.next=f,o|=l;if(null===(s=s.next)){if(null===(l=a.shared.pending))break;s=l.next,l.next=null,a.lastBaseUpdate=l,a.shared.pending=null}}null===d&&(u=h),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=d,jo|=o,e.lanes=o,e.memoizedState=h}}function pa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var ya=(new r.Component).refs;function ga(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var _a={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=hl(),i=fl(e),a=ca(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),da(e,a),pl(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=hl(),i=fl(e),a=ca(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),da(e,a),pl(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=hl(),r=fl(e),i=ca(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),da(e,i),pl(e,r,n)}};function ma(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!hr(n,r)||!hr(i,a))}function va(e,t,n){var r=!1,i=hi,a=t.contextType;return"object"===typeof a&&null!==a?a=sa(a):(i=_i(t)?yi:fi.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?gi(e,i):hi),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=_a,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ea(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&_a.enqueueReplaceState(t,t.state,null)}function ba(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ya,la(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=sa(a):(a=_i(t)?yi:fi.current,i.context=gi(e,a)),fa(e,n,i,r),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ga(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&_a.enqueueReplaceState(i,i.state,null),fa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var Ca=Array.isArray;function Sa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===ya&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Na(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function ka(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=ql(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=$l(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Sa(e,t,n),r.return=e,r):((r=Kl(n.type,n.key,n.props,null,e.mode,r)).ref=Sa(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Jl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Wl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=$l(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case C:return(n=Kl(t.type,t.key,t.props,null,e.mode,n)).ref=Sa(e,null,t),n.return=e,n;case S:return(t=Jl(t,e.mode,n)).return=e,t}if(Ca(t)||V(t))return(t=Wl(t,e.mode,n,null)).return=e,t;Na(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===i?n.type===N?d(e,t,n.props.children,r,i):u(e,t,n,r):null;case S:return n.key===i?c(e,t,n,r):null}if(Ca(n)||V(n))return null!==i?null:d(e,t,n,r,null);Na(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case C:return e=e.get(null===r.key?n:r.key)||null,r.type===N?d(t,e,r.props.children,i,r.key):u(t,e,r,i);case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Ca(r)||V(r))return d(t,e=e.get(n)||null,r,i,null);Na(t,r)}return null}function y(i,s,o,l){for(var u=null,c=null,d=s,y=s=0,g=null;null!==d&&y<o.length;y++){d.index>y?(g=d,d=null):g=d.sibling;var _=f(i,d,o[y],l);if(null===_){null===d&&(d=g);break}e&&d&&null===_.alternate&&t(i,d),s=a(_,s,y),null===c?u=_:c.sibling=_,c=_,d=g}if(y===o.length)return n(i,d),u;if(null===d){for(;y<o.length;y++)null!==(d=h(i,o[y],l))&&(s=a(d,s,y),null===c?u=d:c.sibling=d,c=d);return u}for(d=r(i,d);y<o.length;y++)null!==(g=p(d,i,y,o[y],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?y:g.key),s=a(g,s,y),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),u}function g(i,o,l,u){var c=V(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var d=c=null,y=o,g=o=0,_=null,m=l.next();null!==y&&!m.done;g++,m=l.next()){y.index>g?(_=y,y=null):_=y.sibling;var v=f(i,y,m.value,u);if(null===v){null===y&&(y=_);break}e&&y&&null===v.alternate&&t(i,y),o=a(v,o,g),null===d?c=v:d.sibling=v,d=v,y=_}if(m.done)return n(i,y),c;if(null===y){for(;!m.done;g++,m=l.next())null!==(m=h(i,m.value,u))&&(o=a(m,o,g),null===d?c=m:d.sibling=m,d=m);return c}for(y=r(i,y);!m.done;g++,m=l.next())null!==(m=p(y,i,g,m.value,u))&&(e&&null!==m.alternate&&y.delete(null===m.key?g:m.key),o=a(m,o,g),null===d?c=m:d.sibling=m,d=m);return e&&y.forEach((function(e){return t(i,e)})),c}return function(e,r,a,l){var u="object"===typeof a&&null!==a&&a.type===N&&null===a.key;u&&(a=a.props.children);var c="object"===typeof a&&null!==a;if(c)switch(a.$$typeof){case C:e:{for(c=a.key,u=r;null!==u;){if(u.key===c){if(7===u.tag){if(a.type===N){n(e,u.sibling),(r=i(u,a.props.children)).return=e,e=r;break e}}else if(u.elementType===a.type){n(e,u.sibling),(r=i(u,a.props)).ref=Sa(e,u,a),r.return=e,e=r;break e}n(e,u);break}t(e,u),u=u.sibling}a.type===N?((r=Wl(a.props.children,e.mode,l,a.key)).return=e,e=r):((l=Kl(a.type,a.key,a.props,null,e.mode,l)).ref=Sa(e,r,a),l.return=e,e=l)}return o(e);case S:e:{for(u=a.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=i(r,a.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Jl(a,e.mode,l)).return=e,e=r}return o(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,a)).return=e,e=r):(n(e,r),(r=$l(a,e.mode,l)).return=e,e=r),o(e);if(Ca(a))return y(e,r,a,l);if(V(a))return g(e,r,a,l);if(c&&Na(e,a),"undefined"===typeof a&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,K(e.type)||"Component"))}return n(e,r)}}var Aa=ka(!0),wa=ka(!1),Ta={},Oa=ui(Ta),Ia=ui(Ta),Ma=ui(Ta);function Ua(e){if(e===Ta)throw Error(s(174));return e}function Ra(e,t){switch(di(Ma,t),di(Ia,e),di(Oa,Ta),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ci(Oa),di(Oa,t)}function Pa(){ci(Oa),ci(Ia),ci(Ma)}function La(e){Ua(Ma.current);var t=Ua(Oa.current),n=pe(t,e.type);t!==n&&(di(Ia,e),di(Oa,n))}function Da(e){Ia.current===e&&(ci(Oa),ci(Ia))}var xa=ui(0);function Fa(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ha=null,Ga=null,ja=!1;function Va(e,t){var n=zl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ba(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function za(e){if(ja){var t=Ga;if(t){var n=t;if(!Ba(e,t)){if(!(t=Wr(n.nextSibling))||!Ba(e,t))return e.flags=-1025&e.flags|2,ja=!1,void(Ha=e);Va(Ha,n)}Ha=e,Ga=Wr(t.firstChild)}else e.flags=-1025&e.flags|2,ja=!1,Ha=e}}function Ya(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ha=e}function qa(e){if(e!==Ha)return!1;if(!ja)return Ya(e),ja=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!zr(t,e.memoizedProps))for(t=Ga;t;)Va(e,t),t=Wr(t.nextSibling);if(Ya(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ga=Wr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ga=null}}else Ga=Ha?Wr(e.stateNode.nextSibling):null;return!0}function Ka(){Ga=Ha=null,ja=!1}var Wa=[];function Qa(){for(var e=0;e<Wa.length;e++)Wa[e]._workInProgressVersionPrimary=null;Wa.length=0}var $a=b.ReactCurrentDispatcher,Ja=b.ReactCurrentBatchConfig,Xa=0,Za=null,es=null,ts=null,ns=!1,rs=!1;function is(){throw Error(s(321))}function as(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function ss(e,t,n,r,i,a){if(Xa=a,Za=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$a.current=null===e||null===e.memoizedState?Us:Rs,e=n(r,i),rs){a=0;do{if(rs=!1,!(25>a))throw Error(s(301));a+=1,ts=es=null,t.updateQueue=null,$a.current=Ps,e=n(r,i)}while(rs)}if($a.current=Ms,t=null!==es&&null!==es.next,Xa=0,ts=es=Za=null,ns=!1,t)throw Error(s(300));return e}function os(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ts?Za.memoizedState=ts=e:ts=ts.next=e,ts}function ls(){if(null===es){var e=Za.alternate;e=null!==e?e.memoizedState:null}else e=es.next;var t=null===ts?Za.memoizedState:ts.next;if(null!==t)ts=t,es=e;else{if(null===e)throw Error(s(310));e={memoizedState:(es=e).memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},null===ts?Za.memoizedState=ts=e:ts=ts.next=e}return ts}function us(e,t){return"function"===typeof t?t(e):t}function cs(e){var t=ls(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=es,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=o=a=null,u=i;do{var c=u.lane;if((Xa&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var d={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(o=l=d,a=r):l=l.next=d,Za.lanes|=c,jo|=c}u=u.next}while(null!==u&&u!==i);null===l?a=r:l.next=o,cr(r,t.memoizedState)||(Ds=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ds(e){var t=ls(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);cr(a,t.memoizedState)||(Ds=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function hs(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Xa&e)===e)&&(t._workInProgressVersionPrimary=r,Wa.push(t))),e)return n(t._source);throw Wa.push(t),Error(s(350))}function fs(e,t,n,r){var i=Ro;if(null===i)throw Error(s(349));var a=t._getVersion,o=a(t._source),l=$a.current,u=l.useState((function(){return hs(i,t,n)})),c=u[1],d=u[0];u=ts;var h=e.memoizedState,f=h.refs,p=f.getSnapshot,y=h.source;h=h.subscribe;var g=Za;return e.memoizedState={refs:f,source:t,subscribe:r},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=c;var e=a(t._source);if(!cr(o,e)){e=n(t._source),cr(d,e)||(c(e),e=fl(g),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var l=31-zt(s),u=1<<l;r[l]|=e,s&=~u}}}),[n,t,r]),l.useEffect((function(){return r(t._source,(function(){var e=f.getSnapshot,n=f.setSnapshot;try{n(e(t._source));var r=fl(g);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),cr(p,n)&&cr(y,t)&&cr(h,r)||((e={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:d}).dispatch=c=Is.bind(null,Za,e),u.queue=e,u.baseQueue=null,d=hs(i,t,n),u.memoizedState=u.baseState=d),d}function ps(e,t,n){return fs(ls(),e,t,n)}function ys(e){var t=os();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:e}).dispatch=Is.bind(null,Za,e),[t.memoizedState,e]}function gs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Za.updateQueue)?(t={lastEffect:null},Za.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function _s(e){return e={current:e},os().memoizedState=e}function ms(){return ls().memoizedState}function vs(e,t,n,r){var i=os();Za.flags|=e,i.memoizedState=gs(1|t,n,void 0,void 0===r?null:r)}function Es(e,t,n,r){var i=ls();r=void 0===r?null:r;var a=void 0;if(null!==es){var s=es.memoizedState;if(a=s.destroy,null!==r&&as(r,s.deps))return void gs(t,n,a,r)}Za.flags|=e,i.memoizedState=gs(1|t,n,a,r)}function bs(e,t){return vs(516,4,e,t)}function Cs(e,t){return Es(516,4,e,t)}function Ss(e,t){return Es(4,2,e,t)}function Ns(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ks(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Es(4,2,Ns.bind(null,t,e),n)}function As(){}function ws(e,t){var n=ls();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&as(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ts(e,t){var n=ls();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&as(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Os(e,t){var n=zi();qi(98>n?98:n,(function(){e(!0)})),qi(97<n?97:n,(function(){var n=Ja.transition;Ja.transition=1;try{e(!1),t()}finally{Ja.transition=n}}))}function Is(e,t,n){var r=hl(),i=fl(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},s=t.pending;if(null===s?a.next=a:(a.next=s.next,s.next=a),t.pending=a,s=e.alternate,e===Za||null!==s&&s===Za)rs=ns=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,l=s(o,n);if(a.eagerReducer=s,a.eagerState=l,cr(l,o))return}catch(u){}pl(e,i,r)}}var Ms={readContext:sa,useCallback:is,useContext:is,useEffect:is,useImperativeHandle:is,useLayoutEffect:is,useMemo:is,useReducer:is,useRef:is,useState:is,useDebugValue:is,useDeferredValue:is,useTransition:is,useMutableSource:is,useOpaqueIdentifier:is,unstable_isNewReconciler:!1},Us={readContext:sa,useCallback:function(e,t){return os().memoizedState=[e,void 0===t?null:t],e},useContext:sa,useEffect:bs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,vs(4,2,Ns.bind(null,t,e),n)},useLayoutEffect:function(e,t){return vs(4,2,e,t)},useMemo:function(e,t){var n=os();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=os();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Is.bind(null,Za,e),[r.memoizedState,e]},useRef:_s,useState:ys,useDebugValue:As,useDeferredValue:function(e){var t=ys(e),n=t[0],r=t[1];return bs((function(){var t=Ja.transition;Ja.transition=1;try{r(e)}finally{Ja.transition=t}}),[e]),n},useTransition:function(){var e=ys(!1),t=e[0];return _s(e=Os.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=os();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},fs(r,e,t,n)},useOpaqueIdentifier:function(){if(ja){var e=!1,t=function(e){return{$$typeof:L,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+($r++).toString(36))),Error(s(355))})),n=ys(t)[1];return 0===(2&Za.mode)&&(Za.flags|=516,gs(5,(function(){n("r:"+($r++).toString(36))}),void 0,null)),t}return ys(t="r:"+($r++).toString(36)),t},unstable_isNewReconciler:!1},Rs={readContext:sa,useCallback:ws,useContext:sa,useEffect:Cs,useImperativeHandle:ks,useLayoutEffect:Ss,useMemo:Ts,useReducer:cs,useRef:ms,useState:function(){return cs(us)},useDebugValue:As,useDeferredValue:function(e){var t=cs(us),n=t[0],r=t[1];return Cs((function(){var t=Ja.transition;Ja.transition=1;try{r(e)}finally{Ja.transition=t}}),[e]),n},useTransition:function(){var e=cs(us)[0];return[ms().current,e]},useMutableSource:ps,useOpaqueIdentifier:function(){return cs(us)[0]},unstable_isNewReconciler:!1},Ps={readContext:sa,useCallback:ws,useContext:sa,useEffect:Cs,useImperativeHandle:ks,useLayoutEffect:Ss,useMemo:Ts,useReducer:ds,useRef:ms,useState:function(){return ds(us)},useDebugValue:As,useDeferredValue:function(e){var t=ds(us),n=t[0],r=t[1];return Cs((function(){var t=Ja.transition;Ja.transition=1;try{r(e)}finally{Ja.transition=t}}),[e]),n},useTransition:function(){var e=ds(us)[0];return[ms().current,e]},useMutableSource:ps,useOpaqueIdentifier:function(){return ds(us)[0]},unstable_isNewReconciler:!1},Ls=b.ReactCurrentOwner,Ds=!1;function xs(e,t,n,r){t.child=null===e?wa(t,null,n,r):Aa(t,e.child,n,r)}function Fs(e,t,n,r,i){n=n.render;var a=t.ref;return aa(t,i),r=ss(e,t,n,r,a,i),null===e||Ds?(t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,io(e,t,i))}function Hs(e,t,n,r,i,a){if(null===e){var s=n.type;return"function"!==typeof s||Yl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Kl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Gs(e,t,s,r,i,a))}return s=e.child,0===(i&a)&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:hr)(i,r)&&e.ref===t.ref)?io(e,t,a):(t.flags|=1,(e=ql(s,r)).ref=t.ref,e.return=t,t.child=e)}function Gs(e,t,n,r,i,a){if(null!==e&&hr(e.memoizedProps,r)&&e.ref===t.ref){if(Ds=!1,0===(a&i))return t.lanes=e.lanes,io(e,t,a);0!==(16384&e.flags)&&(Ds=!0)}return Bs(e,t,n,r,a)}function js(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},Cl(t,n);else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Cl(t,e),null;t.memoizedState={baseLanes:0},Cl(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Cl(t,r);return xs(e,t,i,n),t.child}function Vs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Bs(e,t,n,r,i){var a=_i(n)?yi:fi.current;return a=gi(t,a),aa(t,i),n=ss(e,t,n,r,a,i),null===e||Ds?(t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,io(e,t,i))}function zs(e,t,n,r,i){if(_i(n)){var a=!0;bi(t)}else a=!1;if(aa(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),va(t,n,r),ba(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=n.contextType;"object"===typeof u&&null!==u?u=sa(u):u=gi(t,u=_i(n)?yi:fi.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==u)&&Ea(t,s,r,u),oa=!1;var h=t.memoizedState;s.state=h,fa(t,r,s,i),l=t.memoizedState,o!==r||h!==l||pi.current||oa?("function"===typeof c&&(ga(t,n,c,r),l=t.memoizedState),(o=oa||ma(t,n,o,r,h,l,u))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4)):("function"===typeof s.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4),r=!1)}else{s=t.stateNode,ua(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ji(t.type,o),s.props=u,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=sa(l):l=gi(t,l=_i(n)?yi:fi.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==l)&&Ea(t,s,r,l),oa=!1,h=t.memoizedState,s.state=h,fa(t,r,s,i);var p=t.memoizedState;o!==d||h!==p||pi.current||oa?("function"===typeof f&&(ga(t,n,f,r),p=t.memoizedState),(u=oa||ma(t,n,u,r,h,p,l))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),r=!1)}return Ys(e,t,n,r,a,i)}function Ys(e,t,n,r,i,a){Vs(e,t);var s=0!==(64&t.flags);if(!r&&!s)return i&&Ci(t,n,!1),io(e,t,a);r=t.stateNode,Ls.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Aa(t,e.child,null,a),t.child=Aa(t,null,o,a)):xs(e,t,o,a),t.memoizedState=r.state,i&&Ci(t,n,!0),t.child}function qs(e){var t=e.stateNode;t.pendingContext?vi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vi(0,t.context,!1),Ra(e,t.containerInfo)}var Ks,Ws,Qs,$s={dehydrated:null,retryLane:0};function Js(e,t,n){var r,i=t.pendingProps,a=xa.current,s=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),di(xa,1&a),null===e?(void 0!==i.fallback&&za(t),e=i.children,a=i.fallback,s?(e=Xs(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=$s,e):"number"===typeof i.unstable_expectedLoadTime?(e=Xs(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=$s,t.lanes=33554432,e):((n=Ql({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,s?(i=eo(e,t,i.children,i.fallback,n),s=t.child,a=e.child.memoizedState,s.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},s.childLanes=e.childLanes&~n,t.memoizedState=$s,i):(n=Zs(e,t,i.children,n),t.memoizedState=null,n))}function Xs(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=Ql(t,i,0,null),n=Wl(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function Zs(e,t,n,r){var i=e.child;return e=i.sibling,n=ql(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function eo(e,t,n,r,i){var a=t.mode,s=e.child;e=s.sibling;var o={mode:"hidden",children:n};return 0===(2&a)&&t.child!==s?((n=t.child).childLanes=0,n.pendingProps=o,null!==(s=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=s,s.nextEffect=null):t.firstEffect=t.lastEffect=null):n=ql(s,o),null!==e?r=ql(e,r):(r=Wl(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function to(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ia(e.return,t)}function no(e,t,n,r,i,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.lastEffect=a)}function ro(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=xa.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&to(e,n);else if(19===e.tag)to(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(di(xa,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Fa(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),no(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Fa(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}no(t,!0,n,null,a,t.lastEffect);break;case"together":no(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function io(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jo|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=ql(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ql(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function ao(e,t){if(!ja)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function so(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return _i(t.type)&&mi(),null;case 3:return Pa(),ci(pi),ci(fi),Qa(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qa(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Da(t);var a=Ua(Ma.current);if(n=t.type,null!==e&&null!=t.stateNode)Ws(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Ua(Oa.current),qa(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Xr]=t,r[Zr]=o,n){case"dialog":Ir("cancel",r),Ir("close",r);break;case"iframe":case"object":case"embed":Ir("load",r);break;case"video":case"audio":for(e=0;e<Ar.length;e++)Ir(Ar[e],r);break;case"source":Ir("error",r);break;case"img":case"image":case"link":Ir("error",r),Ir("load",r);break;case"details":Ir("toggle",r);break;case"input":ee(r,o),Ir("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ir("invalid",r);break;case"textarea":le(r,o),Ir("invalid",r)}for(var u in Ne(n,o),e=null,o)o.hasOwnProperty(u)&&(a=o[u],"children"===u?"string"===typeof a?r.textContent!==a&&(e=["children",a]):"number"===typeof a&&r.textContent!==""+a&&(e=["children",""+a]):l.hasOwnProperty(u)&&null!=a&&"onScroll"===u&&Ir("scroll",r));switch(n){case"input":$(r),re(r,o,!0);break;case"textarea":$(r),ce(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Gr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(u=9===a.nodeType?a:a.ownerDocument,e===de&&(e=fe(n)),e===de?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[Xr]=t,e[Zr]=r,Ks(e,t),t.stateNode=e,u=ke(n,r),n){case"dialog":Ir("cancel",e),Ir("close",e),a=r;break;case"iframe":case"object":case"embed":Ir("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ar.length;a++)Ir(Ar[a],e);a=r;break;case"source":Ir("error",e),a=r;break;case"img":case"image":case"link":Ir("error",e),Ir("load",e),a=r;break;case"details":Ir("toggle",e),a=r;break;case"input":ee(e,r),a=Z(e,r),Ir("invalid",e);break;case"option":a=ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=i({},r,{value:void 0}),Ir("invalid",e);break;case"textarea":le(e,r),a=oe(e,r),Ir("invalid",e);break;default:a=r}Ne(n,a);var c=a;for(o in c)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?Ce(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&_e(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&me(e,d):"number"===typeof d&&me(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(l.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Ir("scroll",e):null!=d&&E(e,o,d,u))}switch(n){case"input":$(e),re(e,r,!1);break;case"textarea":$(e),ce(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?se(e,!!r.multiple,o,!1):null!=r.defaultValue&&se(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Gr)}Br(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Qs(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));n=Ua(Ma.current),Ua(Oa.current),qa(t)?(r=t.stateNode,n=t.memoizedProps,r[Xr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Xr]=t,t.stateNode=r)}return null;case 13:return ci(xa),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qa(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&xa.current)?0===Fo&&(Fo=3):(0!==Fo&&3!==Fo||(Fo=4),null===Ro||0===(134217727&jo)&&0===(134217727&Vo)||ml(Ro,Lo))),(r||n)&&(t.flags|=4),null);case 4:return Pa(),null===e&&Ur(t.stateNode.containerInfo),null;case 10:return ra(t),null;case 19:if(ci(xa),null===(r=t.memoizedState))return null;if(o=0!==(64&t.flags),null===(u=r.rendering))if(o)ao(r,!1);else{if(0!==Fo||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(u=Fa(e))){for(t.flags|=64,ao(r,!1),null!==(o=u.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return di(xa,1&xa.current|2),t.child}e=e.sibling}null!==r.tail&&Bi()>qo&&(t.flags|=64,o=!0,ao(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=Fa(u))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ao(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!ja)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Bi()-r.renderingStartTime>qo&&1073741824!==n&&(t.flags|=64,o=!0,ao(r,!1),t.lanes=33554432);r.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=r.last)?n.sibling=u:t.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Bi(),n.sibling=null,t=xa.current,di(xa,o?1&t|2:1&t),n):null;case 23:case 24:return Sl(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function oo(e){switch(e.tag){case 1:_i(e.type)&&mi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Pa(),ci(pi),ci(fi),Qa(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return Da(e),null;case 13:return ci(xa),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ci(xa),null;case 4:return Pa(),null;case 10:return ra(e),null;case 23:case 24:return Sl(),null;default:return null}}function lo(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ks=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ws=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ua(Oa.current);var s,o=null;switch(n){case"input":a=Z(e,a),r=Z(e,r),o=[];break;case"option":a=ae(e,a),r=ae(e,r),o=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),o=[];break;case"textarea":a=oe(e,a),r=oe(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Gr)}for(d in Ne(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var u=a[d];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(u=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(null!=c||null!=u))if("style"===d)if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ir("scroll",e),o||u===c||(o=[])):"object"===typeof c&&null!==c&&c.$$typeof===L?c.toString():(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Qs=function(e,t,n,r){n!==r&&(t.flags|=4)};var co="function"===typeof WeakMap?WeakMap:Map;function ho(e,t,n){(n=ca(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$o||($o=!0,Jo=r),uo(0,t)},n}function fo(e,t,n){(n=ca(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return uo(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Xo?Xo=new Set([this]):Xo.add(this),uo(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var po="function"===typeof WeakSet?WeakSet:Set;function yo(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Gl(e,n)}else t.current=null}function go(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Ji(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Kr(t.stateNode.containerInfo))}throw Error(s(163))}function _o(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(xl(n,e),Dl(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Ji(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&pa(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}pa(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Br(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Ct(n)))))}throw Error(s(163))}function mo(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=be("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function vo(e,t){if(Ni&&"function"===typeof Ni.onCommitFiberUnmount)try{Ni.onCommitFiberUnmount(Si,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))xl(t,n);else{r=t;try{i()}catch(a){Gl(r,a)}}n=n.next}while(n!==e)}break;case 1:if(yo(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Gl(t,a)}break;case 5:yo(t);break;case 4:ko(e,t)}}function Eo(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function bo(e){return 5===e.tag||3===e.tag||4===e.tag}function Co(e){e:{for(var t=e.return;null!==t;){if(bo(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(me(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||bo(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?So(e,n,t):No(e,n,t)}function So(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Gr));else if(4!==r&&null!==(e=e.child))for(So(e,t,n),e=e.sibling;null!==e;)So(e,t,n),e=e.sibling}function No(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(No(e,t,n),e=e.sibling;null!==e;)No(e,t,n),e=e.sibling}function ko(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(s(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var o=e,l=i,u=l;;)if(vo(o,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===l)break e;for(;null===u.sibling;){if(null===u.return||u.return===l)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(o=n,l=i.stateNode,8===o.nodeType?o.parentNode.removeChild(l):o.removeChild(l)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(vo(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function Ao(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[Zr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),ke(e,i),t=ke(e,r),i=0;i<a.length;i+=2){var o=a[i],l=a[i+1];"style"===o?Ce(n,l):"dangerouslySetInnerHTML"===o?_e(n,l):"children"===o?me(n,l):E(n,o,l,t)}switch(e){case"input":ne(n,r);break;case"textarea":ue(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(a=r.value)?se(n,!!r.multiple,a,!1):e!==!!r.multiple&&(null!=r.defaultValue?se(n,!!r.multiple,r.defaultValue,!0):se(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,Ct(n.containerInfo)));case 13:return null!==t.memoizedState&&(Yo=Bi(),mo(t.child,!0)),void wo(t);case 19:return void wo(t);case 23:case 24:return void mo(t,null!==t.memoizedState)}throw Error(s(163))}function wo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new po),t.forEach((function(t){var r=Vl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function To(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Oo=Math.ceil,Io=b.ReactCurrentDispatcher,Mo=b.ReactCurrentOwner,Uo=0,Ro=null,Po=null,Lo=0,Do=0,xo=ui(0),Fo=0,Ho=null,Go=0,jo=0,Vo=0,Bo=0,zo=null,Yo=0,qo=1/0;function Ko(){qo=Bi()+500}var Wo,Qo=null,$o=!1,Jo=null,Xo=null,Zo=!1,el=null,tl=90,nl=[],rl=[],il=null,al=0,sl=null,ol=-1,ll=0,ul=0,cl=null,dl=!1;function hl(){return 0!==(48&Uo)?Bi():-1!==ol?ol:ol=Bi()}function fl(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===zi()?1:2;if(0===ll&&(ll=Go),0!==$i.transition){0!==ul&&(ul=null!==zo?zo.pendingLanes:0),e=ll;var t=4186112&~ul;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=zi(),0!==(4&Uo)&&98===e?e=Gt(12,ll):e=Gt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ll),e}function pl(e,t,n){if(50<al)throw al=0,sl=null,Error(s(185));if(null===(e=yl(e,t)))return null;Bt(e,t,n),e===Ro&&(Vo|=t,4===Fo&&ml(e,Lo));var r=zi();1===t?0!==(8&Uo)&&0===(48&Uo)?vl(e):(gl(e,n),0===Uo&&(Ko(),Wi())):(0===(4&Uo)||98!==r&&99!==r||(null===il?il=new Set([e]):il.add(e)),gl(e,n)),zo=e}function yl(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function gl(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-zt(o),u=1<<l,c=a[l];if(-1===c){if(0===(u&r)||0!==(u&i)){c=t,xt(u);var d=Dt;a[l]=10<=d?c+250:6<=d?c+5e3:-1}}else c<=t&&(e.expiredLanes|=u);o&=~u}if(r=Ft(e,e===Ro?Lo:0),t=Dt,0===r)null!==n&&(n!==xi&&wi(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==xi&&wi(n)}15===t?(n=vl.bind(null,e),null===Hi?(Hi=[n],Gi=Ai(Ui,Qi)):Hi.push(n),n=xi):14===t?n=Ki(99,vl.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),n=Ki(n,_l.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function _l(e){if(ol=-1,ul=ll=0,0!==(48&Uo))throw Error(s(327));var t=e.callbackNode;if(Ll()&&e.callbackNode!==t)return null;var n=Ft(e,e===Ro?Lo:0);if(0===n)return null;var r=n,i=Uo;Uo|=16;var a=Al();for(Ro===e&&Lo===r||(Ko(),Nl(e,r));;)try{Ol();break}catch(l){kl(e,l)}if(na(),Io.current=a,Uo=i,null!==Po?r=0:(Ro=null,Lo=0,r=Fo),0!==(Go&Vo))Nl(e,0);else if(0!==r){if(2===r&&(Uo|=64,e.hydrate&&(e.hydrate=!1,Kr(e.containerInfo)),0!==(n=Ht(e))&&(r=wl(e,n))),1===r)throw t=Ho,Nl(e,0),ml(e,n),gl(e,Bi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:case 5:Ul(e);break;case 3:if(ml(e,n),(62914560&n)===n&&10<(r=Yo+500-Bi())){if(0!==Ft(e,0))break;if(((i=e.suspendedLanes)&n)!==n){hl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Yr(Ul.bind(null,e),r);break}Ul(e);break;case 4:if(ml(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var o=31-zt(n);a=1<<o,(o=r[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=Bi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Oo(n/1960))-n)){e.timeoutHandle=Yr(Ul.bind(null,e),n);break}Ul(e);break;default:throw Error(s(329))}}return gl(e,Bi()),e.callbackNode===t?_l.bind(null,e):null}function ml(e,t){for(t&=~Bo,t&=~Vo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zt(t),r=1<<n;e[n]=-1,t&=~r}}function vl(e){if(0!==(48&Uo))throw Error(s(327));if(Ll(),e===Ro&&0!==(e.expiredLanes&Lo)){var t=Lo,n=wl(e,t);0!==(Go&Vo)&&(n=wl(e,t=Ft(e,t)))}else n=wl(e,t=Ft(e,0));if(0!==e.tag&&2===n&&(Uo|=64,e.hydrate&&(e.hydrate=!1,Kr(e.containerInfo)),0!==(t=Ht(e))&&(n=wl(e,t))),1===n)throw n=Ho,Nl(e,0),ml(e,t),gl(e,Bi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ul(e),gl(e,Bi()),null}function El(e,t){var n=Uo;Uo|=1;try{return e(t)}finally{0===(Uo=n)&&(Ko(),Wi())}}function bl(e,t){var n=Uo;Uo&=-2,Uo|=8;try{return e(t)}finally{0===(Uo=n)&&(Ko(),Wi())}}function Cl(e,t){di(xo,Do),Do|=t,Go|=t}function Sl(){Do=xo.current,ci(xo)}function Nl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,qr(n)),null!==Po)for(n=Po.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&mi();break;case 3:Pa(),ci(pi),ci(fi),Qa();break;case 5:Da(r);break;case 4:Pa();break;case 13:case 19:ci(xa);break;case 10:ra(r);break;case 23:case 24:Sl()}n=n.return}Ro=e,Po=ql(e.current,null),Lo=Do=Go=t,Fo=0,Ho=null,Bo=Vo=jo=0}function kl(e,t){for(;;){var n=Po;try{if(na(),$a.current=Ms,ns){for(var r=Za.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ns=!1}if(Xa=0,ts=es=Za=null,rs=!1,Mo.current=null,null===n||null===n.return){Fo=1,Ho=t,Po=null;break}e:{var a=e,s=n.return,o=n,l=t;if(t=Lo,o.flags|=2048,o.firstEffect=o.lastEffect=null,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l;if(0===(2&o.mode)){var c=o.alternate;c?(o.updateQueue=c.updateQueue,o.memoizedState=c.memoizedState,o.lanes=c.lanes):(o.updateQueue=null,o.memoizedState=null)}var d=0!==(1&xa.current),h=s;do{var f;if(f=13===h.tag){var p=h.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var y=h.memoizedProps;f=void 0!==y.fallback&&(!0!==y.unstable_avoidThisFallback||!d)}}if(f){var g=h.updateQueue;if(null===g){var _=new Set;_.add(u),h.updateQueue=_}else g.add(u);if(0===(2&h.mode)){if(h.flags|=64,o.flags|=16384,o.flags&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var m=ca(-1,1);m.tag=2,da(o,m)}o.lanes|=1;break e}l=void 0,o=t;var v=a.pingCache;if(null===v?(v=a.pingCache=new co,l=new Set,v.set(u,l)):void 0===(l=v.get(u))&&(l=new Set,v.set(u,l)),!l.has(o)){l.add(o);var E=jl.bind(null,a,u,o);u.then(E,E)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);l=Error((K(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Fo&&(Fo=2),l=lo(l,o),h=s;do{switch(h.tag){case 3:a=l,h.flags|=4096,t&=-t,h.lanes|=t,ha(h,ho(0,a,t));break e;case 1:a=l;var b=h.type,C=h.stateNode;if(0===(64&h.flags)&&("function"===typeof b.getDerivedStateFromError||null!==C&&"function"===typeof C.componentDidCatch&&(null===Xo||!Xo.has(C)))){h.flags|=4096,t&=-t,h.lanes|=t,ha(h,fo(h,a,t));break e}}h=h.return}while(null!==h)}Ml(n)}catch(S){t=S,Po===n&&null!==n&&(Po=n=n.return);continue}break}}function Al(){var e=Io.current;return Io.current=Ms,null===e?Ms:e}function wl(e,t){var n=Uo;Uo|=16;var r=Al();for(Ro===e&&Lo===t||Nl(e,t);;)try{Tl();break}catch(i){kl(e,i)}if(na(),Uo=n,Io.current=r,null!==Po)throw Error(s(261));return Ro=null,Lo=0,Fo}function Tl(){for(;null!==Po;)Il(Po)}function Ol(){for(;null!==Po&&!Ti();)Il(Po)}function Il(e){var t=Wo(e.alternate,e,Do);e.memoizedProps=e.pendingProps,null===t?Ml(e):Po=t,Mo.current=null}function Ml(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=so(n,t,Do)))return void(Po=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Do)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=oo(t)))return n.flags&=2047,void(Po=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Po=t);Po=t=e}while(null!==t);0===Fo&&(Fo=5)}function Ul(e){var t=zi();return qi(99,Rl.bind(null,e,t)),null}function Rl(e,t){do{Ll()}while(null!==el);if(0!==(48&Uo))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var o=e.eventTimes,l=e.expirationTimes;0<a;){var u=31-zt(a),c=1<<u;i[u]=0,o[u]=-1,l[u]=-1,a&=~c}if(null!==il&&0===(24&r)&&il.has(e)&&il.delete(e),e===Ro&&(Po=Ro=null,Lo=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Uo,Uo|=32,Mo.current=null,jr=Qt,_r(o=gr())){if("selectionStart"in o)l={start:o.selectionStart,end:o.selectionEnd};else e:if(l=(l=o.ownerDocument)&&l.defaultView||window,(c=l.getSelection&&l.getSelection())&&0!==c.rangeCount){l=c.anchorNode,a=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{l.nodeType,u.nodeType}catch(A){l=null;break e}var d=0,h=-1,f=-1,p=0,y=0,g=o,_=null;t:for(;;){for(var m;g!==l||0!==a&&3!==g.nodeType||(h=d+a),g!==u||0!==c&&3!==g.nodeType||(f=d+c),3===g.nodeType&&(d+=g.nodeValue.length),null!==(m=g.firstChild);)_=g,g=m;for(;;){if(g===o)break t;if(_===l&&++p===a&&(h=d),_===u&&++y===c&&(f=d),null!==(m=g.nextSibling))break;_=(g=_).parentNode}g=m}l=-1===h||-1===f?null:{start:h,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Vr={focusedElem:o,selectionRange:l},Qt=!1,cl=null,dl=!1,Qo=r;do{try{Pl()}catch(A){if(null===Qo)throw Error(s(330));Gl(Qo,A),Qo=Qo.nextEffect}}while(null!==Qo);cl=null,Qo=r;do{try{for(o=e;null!==Qo;){var v=Qo.flags;if(16&v&&me(Qo.stateNode,""),128&v){var E=Qo.alternate;if(null!==E){var b=E.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&v){case 2:Co(Qo),Qo.flags&=-3;break;case 6:Co(Qo),Qo.flags&=-3,Ao(Qo.alternate,Qo);break;case 1024:Qo.flags&=-1025;break;case 1028:Qo.flags&=-1025,Ao(Qo.alternate,Qo);break;case 4:Ao(Qo.alternate,Qo);break;case 8:ko(o,l=Qo);var C=l.alternate;Eo(l),null!==C&&Eo(C)}Qo=Qo.nextEffect}}catch(A){if(null===Qo)throw Error(s(330));Gl(Qo,A),Qo=Qo.nextEffect}}while(null!==Qo);if(b=Vr,E=gr(),v=b.focusedElem,o=b.selectionRange,E!==v&&v&&v.ownerDocument&&yr(v.ownerDocument.documentElement,v)){null!==o&&_r(v)&&(E=o.start,void 0===(b=o.end)&&(b=E),"selectionStart"in v?(v.selectionStart=E,v.selectionEnd=Math.min(b,v.value.length)):(b=(E=v.ownerDocument||document)&&E.defaultView||window).getSelection&&(b=b.getSelection(),l=v.textContent.length,C=Math.min(o.start,l),o=void 0===o.end?C:Math.min(o.end,l),!b.extend&&C>o&&(l=o,o=C,C=l),l=pr(v,C),a=pr(v,o),l&&a&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==a.node||b.focusOffset!==a.offset)&&((E=E.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),C>o?(b.addRange(E),b.extend(a.node,a.offset)):(E.setEnd(a.node,a.offset),b.addRange(E))))),E=[];for(b=v;b=b.parentNode;)1===b.nodeType&&E.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof v.focus&&v.focus(),v=0;v<E.length;v++)(b=E[v]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Qt=!!jr,Vr=jr=null,e.current=n,Qo=r;do{try{for(v=e;null!==Qo;){var S=Qo.flags;if(36&S&&_o(v,Qo.alternate,Qo),128&S){E=void 0;var N=Qo.ref;if(null!==N){var k=Qo.stateNode;Qo.tag,E=k,"function"===typeof N?N(E):N.current=E}}Qo=Qo.nextEffect}}catch(A){if(null===Qo)throw Error(s(330));Gl(Qo,A),Qo=Qo.nextEffect}}while(null!==Qo);Qo=null,Fi(),Uo=i}else e.current=n;if(Zo)Zo=!1,el=e,tl=t;else for(Qo=r;null!==Qo;)t=Qo.nextEffect,Qo.nextEffect=null,8&Qo.flags&&((S=Qo).sibling=null,S.stateNode=null),Qo=t;if(0===(r=e.pendingLanes)&&(Xo=null),1===r?e===sl?al++:(al=0,sl=e):al=0,n=n.stateNode,Ni&&"function"===typeof Ni.onCommitFiberRoot)try{Ni.onCommitFiberRoot(Si,n,void 0,64===(64&n.current.flags))}catch(A){}if(gl(e,Bi()),$o)throw $o=!1,e=Jo,Jo=null,e;return 0!==(8&Uo)||Wi(),null}function Pl(){for(;null!==Qo;){var e=Qo.alternate;dl||null===cl||(0!==(8&Qo.flags)?et(Qo,cl)&&(dl=!0):13===Qo.tag&&To(e,Qo)&&et(Qo,cl)&&(dl=!0));var t=Qo.flags;0!==(256&t)&&go(e,Qo),0===(512&t)||Zo||(Zo=!0,Ki(97,(function(){return Ll(),null}))),Qo=Qo.nextEffect}}function Ll(){if(90!==tl){var e=97<tl?97:tl;return tl=90,qi(e,Fl)}return!1}function Dl(e,t){nl.push(t,e),Zo||(Zo=!0,Ki(97,(function(){return Ll(),null})))}function xl(e,t){rl.push(t,e),Zo||(Zo=!0,Ki(97,(function(){return Ll(),null})))}function Fl(){if(null===el)return!1;var e=el;if(el=null,0!==(48&Uo))throw Error(s(331));var t=Uo;Uo|=32;var n=rl;rl=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],o=i.destroy;if(i.destroy=void 0,"function"===typeof o)try{o()}catch(u){if(null===a)throw Error(s(330));Gl(a,u)}}for(n=nl,nl=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var l=i.create;i.destroy=l()}catch(u){if(null===a)throw Error(s(330));Gl(a,u)}}for(l=e.current.firstEffect;null!==l;)e=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=e;return Uo=t,Wi(),!0}function Hl(e,t,n){da(e,t=ho(0,t=lo(n,t),1)),t=hl(),null!==(e=yl(e,1))&&(Bt(e,1,t),gl(e,t))}function Gl(e,t){if(3===e.tag)Hl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Hl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xo||!Xo.has(r))){var i=fo(n,e=lo(t,e),1);if(da(n,i),i=hl(),null!==(n=yl(n,1)))Bt(n,1,i),gl(n,i);else if("function"===typeof r.componentDidCatch&&(null===Xo||!Xo.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function jl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=hl(),e.pingedLanes|=e.suspendedLanes&n,Ro===e&&(Lo&n)===n&&(4===Fo||3===Fo&&(62914560&Lo)===Lo&&500>Bi()-Yo?Nl(e,0):Bo|=n),gl(e,t)}function Vl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===zi()?1:2:(0===ll&&(ll=Go),0===(t=jt(62914560&~ll))&&(t=4194304))),n=hl(),null!==(e=yl(e,t))&&(Bt(e,t,n),gl(e,n))}function Bl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function zl(e,t,n,r){return new Bl(e,t,n,r)}function Yl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ql(e,t){var n=e.alternate;return null===n?((n=zl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Kl(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Yl(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Wl(n.children,i,a,t);case D:o=8,i|=16;break;case k:o=8,i|=1;break;case A:return(e=zl(12,n,t,8|i)).elementType=A,e.type=A,e.lanes=a,e;case I:return(e=zl(13,n,t,i)).type=I,e.elementType=I,e.lanes=a,e;case M:return(e=zl(19,n,t,i)).elementType=M,e.lanes=a,e;case x:return Ql(n,i,a,t);case F:return(e=zl(24,n,t,i)).elementType=F,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case T:o=9;break e;case O:o=11;break e;case U:o=14;break e;case R:o=16,r=null;break e;case P:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=zl(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Wl(e,t,n,r){return(e=zl(7,e,r,t)).lanes=n,e}function Ql(e,t,n,r){return(e=zl(23,e,r,t)).elementType=x,e.lanes=n,e}function $l(e,t,n){return(e=zl(6,e,null,t)).lanes=n,e}function Jl(e,t,n){return(t=zl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Xl(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Vt(0),this.expirationTimes=Vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.mutableSourceEagerHydrationData=null}function Zl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function eu(e,t,n,r){var i=t.current,a=hl(),o=fl(i);e:if(n){t:{if($e(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(_i(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var u=n.type;if(_i(u)){n=Ei(n,u,l);break e}}n=l}else n=hi;return null===t.context?t.context=n:t.pendingContext=n,(t=ca(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),da(i,t),pl(i,o,a),o}function tu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ru(e,t){nu(e,t),(e=e.alternate)&&nu(e,t)}function iu(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Xl(e,t,null!=n&&!0===n.hydrate),t=zl(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,la(t),e[ei]=n.current,Ur(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function au(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function su(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a._internalRoot;if("function"===typeof i){var o=i;i=function(){var e=tu(s);o.call(e)}}eu(t,s,e,i)}else{if(a=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new iu(e,0,t?{hydrate:!0}:void 0)}(n,r),s=a._internalRoot,"function"===typeof i){var l=i;i=function(){var e=tu(s);l.call(e)}}bl((function(){eu(t,s,e,i)}))}return tu(s)}function ou(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!au(t))throw Error(s(200));return Zl(e,t,null,n)}Wo=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||pi.current)Ds=!0;else{if(0===(n&r)){switch(Ds=!1,t.tag){case 3:qs(t),Ka();break;case 5:La(t);break;case 1:_i(t.type)&&bi(t);break;case 4:Ra(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;di(Xi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Js(e,t,n):(di(xa,1&xa.current),null!==(t=io(e,t,n))?t.sibling:null);di(xa,1&xa.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return ro(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),di(xa,xa.current),r)break;return null;case 23:case 24:return t.lanes=0,js(e,t,n)}return io(e,t,n)}Ds=0!==(16384&e.flags)}else Ds=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=gi(t,fi.current),aa(t,n),i=ss(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,_i(r)){var a=!0;bi(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,la(t);var o=r.getDerivedStateFromProps;"function"===typeof o&&ga(t,r,o,e),i.updater=_a,t.stateNode=i,i._reactInternals=t,ba(t,r,e,n),t=Ys(null,t,r,!0,a,n)}else t.tag=0,xs(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Yl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===O)return 11;if(e===U)return 14}return 2}(i),e=Ji(i,e),a){case 0:t=Bs(null,t,i,e,n);break e;case 1:t=zs(null,t,i,e,n);break e;case 11:t=Fs(null,t,i,e,n);break e;case 14:t=Hs(null,t,i,Ji(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Bs(e,t,r,i=t.elementType===r?i:Ji(r,i),n);case 1:return r=t.type,i=t.pendingProps,zs(e,t,r,i=t.elementType===r?i:Ji(r,i),n);case 3:if(qs(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,ua(e,t),fa(t,r,null,n),(r=t.memoizedState.element)===i)Ka(),t=io(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(Ga=Wr(t.stateNode.containerInfo.firstChild),Ha=t,a=ja=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],Wa.push(a);for(n=wa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else xs(e,t,r,n),Ka();t=t.child}return t;case 5:return La(t),null===e&&za(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,zr(r,i)?o=null:null!==a&&zr(r,a)&&(t.flags|=16),Vs(e,t),xs(e,t,o,n),t.child;case 6:return null===e&&za(t),null;case 13:return Js(e,t,n);case 4:return Ra(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Aa(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Fs(e,t,r,i=t.elementType===r?i:Ji(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value;var l=t.type._context;if(di(Xi,l._currentValue),l._currentValue=a,null!==o)if(l=o.value,0===(a=cr(l,a)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(l,a):1073741823))){if(o.children===i.children&&!pi.current){t=io(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var u=l.dependencies;if(null!==u){o=l.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&a)){1===l.tag&&((c=ca(-1,n&-n)).tag=2,da(l,c)),l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),ia(l.return,n),u.lanes|=n;break}c=c.next}}else o=10===l.tag&&l.type===t.type?null:l.child;if(null!==o)o.return=l;else for(o=l;null!==o;){if(o===t){o=null;break}if(null!==(l=o.sibling)){l.return=o.return,o=l;break}o=o.return}l=o}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,aa(t,n),r=r(i=sa(i,a.unstable_observedBits)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return a=Ji(i=t.type,t.pendingProps),Hs(e,t,i,a=Ji(i.type,a),r,n);case 15:return Gs(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ji(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,_i(r)?(e=!0,bi(t)):e=!1,aa(t,n),va(t,r,i),ba(t,r,i,n),Ys(null,t,r,!0,e,n);case 19:return ro(e,t,n);case 23:case 24:return js(e,t,n)}throw Error(s(156,t.tag))},iu.prototype.render=function(e){eu(e,this._internalRoot,null,null)},iu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;eu(null,e,null,(function(){t[ei]=null}))},tt=function(e){13===e.tag&&(pl(e,4,hl()),ru(e,4))},nt=function(e){13===e.tag&&(pl(e,67108864,hl()),ru(e,67108864))},rt=function(e){if(13===e.tag){var t=hl(),n=fl(e);pl(e,n,t),ru(e,n)}},it=function(e,t){return t()},we=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ai(r);if(!i)throw Error(s(90));J(r),ne(r,i)}}}break;case"textarea":ue(e,n);break;case"select":null!=(t=n.value)&&se(e,!!n.multiple,t,!1)}},Re=El,Pe=function(e,t,n,r,i){var a=Uo;Uo|=4;try{return qi(98,e.bind(null,t,n,r,i))}finally{0===(Uo=a)&&(Ko(),Wi())}},Le=function(){0===(49&Uo)&&(function(){if(null!==il){var e=il;il=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,gl(e,Bi())}))}Wi()}(),Ll())},De=function(e,t){var n=Uo;Uo|=2;try{return e(t)}finally{0===(Uo=n)&&(Ko(),Wi())}};var lu={Events:[ri,ii,ai,Me,Ue,Ll,{current:!1}]},uu={findFiberByHostInstance:ni,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},cu={bundleType:uu.bundleType,version:uu.version,rendererPackageName:uu.rendererPackageName,rendererConfig:uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:uu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{Si=du.inject(cu),Ni=du}catch(ge){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lu,t.createPortal=ou,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Uo;if(0!==(48&n))return e(t);Uo|=1;try{if(e)return qi(99,e.bind(null,t))}finally{Uo=n,Wi()}},t.hydrate=function(e,t,n){if(!au(t))throw Error(s(200));return su(null,e,t,!0,n)},t.render=function(e,t,n){if(!au(t))throw Error(s(200));return su(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!au(e))throw Error(s(40));return!!e._reactRootContainer&&(bl((function(){su(null,null,e,!1,(function(){e._reactRootContainer=null,e[ei]=null}))})),!0)},t.unstable_batchedUpdates=El,t.unstable_createPortal=function(e,t){return ou(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!au(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return su(e,t,n,!1,r)},t.version="17.0.2"},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},1372:function(e,t){"use strict";var n=60103,r=60106,i=60107,a=60108,s=60114,o=60109,l=60110,u=60112,c=60113,d=60120,h=60115,f=60116,p=60121,y=60122,g=60117,_=60129,m=60131;if("function"===typeof Symbol&&Symbol.for){var v=Symbol.for;n=v("react.element"),r=v("react.portal"),i=v("react.fragment"),a=v("react.strict_mode"),s=v("react.profiler"),o=v("react.provider"),l=v("react.context"),u=v("react.forward_ref"),c=v("react.suspense"),d=v("react.suspense_list"),h=v("react.memo"),f=v("react.lazy"),p=v("react.block"),y=v("react.server.block"),g=v("react.fundamental"),_=v("react.debug_trace_mode"),m=v("react.legacy_hidden")}function E(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case s:case a:case c:case d:return e;default:switch(e=e&&e.$$typeof){case l:case u:case f:case h:case o:return e;default:return t}}case r:return t}}}},7441:function(e,t,n){"use strict";n(1372)},6374:function(e,t,n){"use strict";n(1725);var r=n(2791),i=60103;if(60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),a("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,a={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:a,_owner:s.current}}t.jsx=u,t.jsxs=u},9117:function(e,t,n){"use strict";var r=n(1725),i=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var s=60109,o=60110,l=60112;t.Suspense=60113;var u=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),a=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),s=d("react.provider"),o=d("react.context"),l=d("react.forward_ref"),t.Suspense=d("react.suspense"),u=d("react.memo"),c=d("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function _(){}function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=g.prototype;var v=m.prototype=new _;v.constructor=m,r(v,g.prototype),v.isPureReactComponent=!0;var E={current:null},b=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var r,a={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)b.call(t,r)&&!C.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:i,type:e,key:s,ref:o,props:a,_owner:E.current}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var k=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function w(e,t,n,r,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case a:l=!0}}if(l)return s=s(l=e),e=""===r?"."+A(l,0):r,Array.isArray(s)?(n="",null!=e&&(n=e.replace(k,"$&/")+"/"),w(s,t,n,"",(function(e){return e}))):null!=s&&(N(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=r+A(o=e[u],u);l+=w(o,t,n,c,s)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(o=e.next()).done;)l+=w(o=o.value,t,n,c=r+A(o,u++),s);else if("object"===o)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function T(e,t,n){if(null==e)return e;var r=[],i=0;return w(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function O(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var I={current:null};function M(){var e=I.current;if(null===e)throw Error(f(321));return e}var U={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!N(e))throw Error(f(143));return e}},t.Component=g,t.PureComponent=m,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(f(267,e));var a=r({},e.props),s=e.key,o=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,l=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)b.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];a.children=u}return{$$typeof:i,type:e.type,key:s,ref:o,props:a,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:o,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:c,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return M().useCallback(e,t)},t.useContext=function(e,t){return M().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return M().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return M().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return M().useLayoutEffect(e,t)},t.useMemo=function(e,t){return M().useMemo(e,t)},t.useReducer=function(e,t,n){return M().useReducer(e,t,n)},t.useRef=function(e){return M().useRef(e)},t.useState=function(e){return M().useState(e)},t.version="17.0.2"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},9727:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(M){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),s=new T(r||[]);return a._invoke=function(e,t,n){var r=d;return function(i,a){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return I()}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var o=k(s,n);if(o){if(o===y)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var l=c(e,t,n);if("normal"===l.type){if(r=n.done?p:h,l.arg===y)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=p,n.method="throw",n.arg=l.arg)}}}(e,n,s),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(M){return{type:"throw",arg:M}}}e.wrap=u;var d="suspendedStart",h="suspendedYield",f="executing",p="completed",y={};function g(){}function _(){}function m(){}var v={};l(v,a,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(O([])));b&&b!==n&&r.call(b,a)&&(v=b);var C=m.prototype=g.prototype=Object.create(v);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function N(e,t){function n(i,a,s,o){var l=c(e[i],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"===typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,o)}))}o(l.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function k(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:I}}function I(){return{value:t,done:!0}}return _.prototype=m,l(C,"constructor",m),l(m,"constructor",_),_.displayName=l(m,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,o,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},S(N.prototype),l(N.prototype,s,(function(){return this})),e.AsyncIterator=N,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var s=new N(u(t,n,r,i),a);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(C),l(C,o,"Generator"),l(C,a,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return o.type="throw",o.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},6813:function(e,t){"use strict";var n,r,i,a;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,c=null,d=function e(){if(null!==u)try{var n=t.unstable_now();u(!0,n),u=null}catch(r){throw setTimeout(e,0),r}};n=function(e){null!==u?setTimeout(n,0,e):(u=e,setTimeout(d,0))},r=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},t.unstable_shouldYield=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var p=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var y=!1,g=null,_=-1,m=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<e?Math.floor(1e3/e):5};var E=new MessageChannel,b=E.port2;E.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();v=e+m;try{g(!0,e)?b.postMessage(null):(y=!1,g=null)}catch(n){throw b.postMessage(null),n}}else y=!1},n=function(e){g=e,y||(y=!0,b.postMessage(null))},r=function(e,n){_=h((function(){e(t.unstable_now())}),n)},i=function(){f(_),_=-1}}function C(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<k(i,t)))break e;e[r]=t,e[n]=i,n=r}}function S(e){return void 0===(e=e[0])?null:e}function N(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,s=e[a],o=a+1,l=e[o];if(void 0!==s&&0>k(s,n))void 0!==l&&0>k(l,s)?(e[r]=l,e[o]=n,r=o):(e[r]=s,e[a]=n,r=a);else{if(!(void 0!==l&&0>k(l,n)))break e;e[r]=l,e[o]=n,r=o}}}return t}return null}function k(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var A=[],w=[],T=1,O=null,I=3,M=!1,U=!1,R=!1;function P(e){for(var t=S(w);null!==t;){if(null===t.callback)N(w);else{if(!(t.startTime<=e))break;N(w),t.sortIndex=t.expirationTime,C(A,t)}t=S(w)}}function L(e){if(R=!1,P(e),!U)if(null!==S(A))U=!0,n(D);else{var t=S(w);null!==t&&r(L,t.startTime-e)}}function D(e,n){U=!1,R&&(R=!1,i()),M=!0;var a=I;try{for(P(n),O=S(A);null!==O&&(!(O.expirationTime>n)||e&&!t.unstable_shouldYield());){var s=O.callback;if("function"===typeof s){O.callback=null,I=O.priorityLevel;var o=s(O.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?O.callback=o:O===S(A)&&N(A),P(n)}else N(A);O=S(A)}if(null!==O)var l=!0;else{var u=S(w);null!==u&&r(L,u.startTime-n),l=!1}return l}finally{O=null,I=a,M=!1}}var x=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){U||M||(U=!0,n(D))},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return S(A)},t.unstable_next=function(e){switch(I){case 1:case 2:case 3:var t=3;break;default:t=I}var n=I;I=t;try{return e()}finally{I=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=x,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=I;I=e;try{return t()}finally{I=n}},t.unstable_scheduleCallback=function(e,a,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:T++,callback:a,priorityLevel:e,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>o?(e.sortIndex=s,C(w,e),null===S(A)&&e===S(w)&&(R?i():R=!0,r(L,s-o))):(e.sortIndex=l,C(A,e),U||M||(U=!0,n(D))),e},t.unstable_wrapCallback=function(e){var t=I;return function(){var n=I;I=t;try{return e.apply(this,arguments)}finally{I=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},8037:function(e,t,n){e.exports=function(e,t,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=i(e),s=i(t),o=i(r);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function C(){return(C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=b(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return a}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=k(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}var T=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return"3.1.8"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}(),O={},I=function(){function e(e){this._container=e}return e.create=function(t,n){return O[t]=new e(n),O[t]},e.get=function(e){return e||(e=Ri.getInstance()._iid),O[e]},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this._container[e]},e.prototype.set=function(e,t){this._container[e]=t},e.prototype.remove=function(e){this._container.hasOwnProperty(e)&&delete this._container[e]},e}(),M=function(e,t){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}M(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var R=function(){return(R=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function P(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}function L(e,t){var n,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function D(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var x,F=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="SendBirdException",r.code=n||0,r.message=t,r}return U(t,e),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===t.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===t.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenRevokedError",{get:function(){return this.code===t.SESSION_TOKEN_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_KEY_EXPIRED",{get:function(){return 400309},enumerable:!1,configurable:!0}),Object.defineProperty(t,"USER_DEACTIVATED",{get:function(){return 400300},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NON_EXISTING_USER",{get:function(){return 400301},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_EXPIRED",{get:function(){return 400302},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_REVOKED",{get:function(){return 400310},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVALID_INITIALIZATION",{get:function(){return 800100},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CONNECTION_REQUIRED",{get:function(){return 800101},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CONNECTION_CANCELED",{get:function(){return 800102},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVALID_PARAMETER",{get:function(){return 800110},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NETWORK_ERROR",{get:function(){return 800120},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NETWORK_ROUTING_ERROR",{get:function(){return 800121},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MALFORMED_DATA",{get:function(){return 800130},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MALFORMED_ERROR_DATA",{get:function(){return 800140},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WRONG_CHANNEL_TYPE",{get:function(){return 800150},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MARK_AS_READ_RATE_LIMIT_EXCEEDED",{get:function(){return 800160},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QUERY_IN_PROGRESS",{get:function(){return 800170},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ACK_TIMEOUT",{get:function(){return 800180},enumerable:!1,configurable:!0}),Object.defineProperty(t,"LOGIN_TIMEOUT",{get:function(){return 800190},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WEBSOCKET_CONNECTION_CLOSED",{get:function(){return 800200},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WEBSOCKET_CONNECTION_FAILED",{get:function(){return 800210},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_FAILED",{get:function(){return 800220},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILE_UPLOAD_CANCEL_FAILED",{get:function(){return 800230},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_CANCELED",{get:function(){return 800240},enumerable:!1,configurable:!0}),Object.defineProperty(t,"REQUEST_DUPLICATED",{get:function(){return 800250},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILE_SIZE_LIMIT_EXCEEDED",{get:function(){return 800260},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_TOKEN_REQUEST_FAILED",{get:function(){return 800500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_REFRESH_SUCCESS",{get:function(){return 800501},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SESSION_REFRESH_FAILED",{get:function(){return 800502},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CHANNEL_NOT_FOUND",{get:function(){return 900500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"USER_NOT_MEMBER",{get:function(){return 900020},enumerable:!1,configurable:!0}),t}(Error),H=function(){function e(){this.sessionToken=null,this.sessionKey=null,this.eKey=null}return e.prototype.hasSession=function(){return!!this.sessionKey},e}(),G={},j=function(){function e(e,t){var n=this;void 0===t&&(t={}),this._iid=e,Object.keys(t).forEach((function(e){var r=t[e];"function"==typeof r&&(n[e]=n.getClonedClass(r))})),G[e]=this}return e.get=function(e){return e?G[e]:{}},e.prototype.getClonedClass=function(e){var t=this._iid;return function(n){function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(this,e)||this}return U(r,n),Object.defineProperty(r,"_iid",{get:function(){return t},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_name",{get:function(){return e.name},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_iid",{get:function(){return t},enumerable:!1,configurable:!0}),r}(e)},e}(),V={verbose:"VERBOSE",info:"INFO",debug:"DEBUG",warn:"WARN",error:"ERROR",none:"NONE"},B=function(e){y(n,e);var t=E(n);function n(){return d(this,n),t.apply(this,arguments)}return f(n,[{key:"log",value:function(e){for(var t,n,r,i,a,s=this.getLogLevelText(e);s.length<8;)s+=" ";for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];switch(l.unshift("[".concat(s,"]")),e){case"verbose":(t=console).log.apply(t,l);break;case"debug":(n=console).log.apply(n,l);break;case"info":(r=console).info.apply(r,l);break;case"warn":(i=console).warn.apply(i,l);break;case"error":(a=console).error.apply(a,l)}}},{key:"groupStart",value:function(){var e;(e=console).group.apply(e,arguments)}},{key:"groupEnd",value:function(){var e;(e=console).groupEnd.apply(e,arguments)}}]),n}(function(){function e(){d(this,e)}return f(e,[{key:"getLogLevelText",value:function(e){return V[e]}}]),e}()),z={DEBUG:"debug",PRODUCTION:"production"},Y=z.PRODUCTION,q={VERBOSE:"verbose",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error",NONE:"none"},K=[q.NONE,q.ERROR,q.WARN,q.INFO,q.DEBUG,q.VERBOSE],W=q.WARN,Q=K.indexOf(W),$=[new B],J=function(){function e(){d(this,e)}return f(e,null,[{key:"Mode",get:function(){return z}},{key:"mode",get:function(){return Y},set:function(t){Object.keys(e.Mode).map((function(t){return e.Mode[t]})).indexOf(t)>-1&&(Y=t)}},{key:"supportedLogLevels",get:function(){return q}},{key:"logLevel",get:function(){return K[Q]},set:function(e){K.includes(e)||(e=W),Q=K.indexOf(e)}},{key:"defaultLogLevel",get:function(){return W}},{key:"isDisplayableLogLevel",value:function(e){var t=K.indexOf(e);return 0<=t&&t<=Q}},{key:"log",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.isDisplayableLogLevel(t)&&$.forEach((function(e){return e.log.apply(e,[t].concat(r))}))}},{key:"verbose",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[q.VERBOSE].concat(n))}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[q.DEBUG].concat(n))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[q.INFO].concat(n))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[q.WARN].concat(n))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.log.apply(e,[q.ERROR].concat(n))}},{key:"group",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=[];Array.isArray(n[n.length-1])&&(i=n.pop()),i.some((function(t){return e.isDisplayableLogLevel(t.level)}))&&$.filter((function(e){return e instanceof B})).forEach((function(e){e.groupStart.apply(e,n),i.forEach((function(t){return e.log.apply(e,[t.level].concat(N(t.messages)))})),e.groupEnd()}))}}]),e}(),X=function(){function e(){d(this,e),this._queue=[],this.locked=!1}return f(e,[{key:"lock",value:function(e){var t=this;this.locked?this._queue.push(e):(this.locked=!0,e((function(){return t.unlock()})))}},{key:"unlock",value:function(){if(this.locked=!1,this._queue.length>0){var e=this._queue.shift();this.lock(e)}}}]),e}(),Z=function(){function e(t){d(this,e),this.sb=t,this.mutex=new X,this.pingTimer=null,this.pingTimeoutTimer=null}return f(e,[{key:"ping",value:function(){var e=this,t=j.get(this.sb._iid).Command.bPing(),n=I.get(this.sb._iid).container,r=n.wsAdapter,i=n.pongTimeout;r.client.send(t),J.debug("`PING`"),this.pingTimeoutTimer=setTimeout((function(){J.debug("`PING` timeout."),e.stop(),r.client.handler&&r.client.handler.onError()}),i)}},{key:"pong",value:function(){this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}},{key:"refreshTimer",value:function(){var e=this,t=I.get(this.sb._iid).container.pingInterval;this.mutex.lock((function(n){e.stop(),e.pingTimer=setInterval((function(){e.ping()}),t),n()}))}},{key:"start",value:function(){this.refreshTimer(),this.ping()}},{key:"stop",value:function(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),this.pingTimeoutTimer&&(clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null)}}]),e}(),ee=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},te=function(){return"undefined"==typeof window&&"undefined"!=typeof process&&("node"===process.title||void 0!==process.versions&&process.versions.node||"[object process]"===String(process))},ne=[F.CONNECTION_REQUIRED,F.NETWORK_ERROR,F.ACK_TIMEOUT,F.WEBSOCKET_CONNECTION_CLOSED,F.WEBSOCKET_CONNECTION_FAILED,F.FILE_UPLOAD_CANCEL_FAILED,F.REQUEST_CANCELED,500901,500910,900200],re=[F.SESSION_TOKEN_EXPIRED,F.SESSION_TOKEN_REVOKED,F.USER_DEACTIVATED,F.NON_EXISTING_USER],ie=[F.WEBSOCKET_CONNECTION_CLOSED,F.WEBSOCKET_CONNECTION_FAILED],ae=function(){function e(){}return e.deepEqual=function(e,t){if(e!==t){var n=R({},e),r=R({},t);return(!n.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||n.messageId===r.messageId)&&(!n.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||n.reqId===r.reqId)&&(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)===JSON.stringify(r))}return!0},e.isResendableError=function(e){return e>0&&ne.indexOf(e)>=0},e.isAutoResendableError=function(e){return e>0&&ie.indexOf(e)>=0},e.isNonAutoReconnectableError=function(e){return e>0&&re.indexOf(e)>=0},e.isFile=function(e){var t="object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!t)if(te()){if("undefined"!=typeof Buffer)return e instanceof Buffer}else{if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return t},e}();!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"}(x||(x={}));var se=function(){function e(){}var t;return e.isFileLikeObject=function(e){return"object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type},t=e,e.convertFileToDataUrl=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(r.result)},r.onerror=function(e){return n(r.error)},r.readAsDataURL(e)}))},e.convertFileToArrayBuffer=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(r.result)},r.onerror=function(e){return n(r.error)},r.readAsArrayBuffer(e)}))},e.convertDataUrlToByteArray=function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,a=new Uint8Array(i);i--;)a[i]=r.charCodeAt(i);return[a,n]},e.convertDataURLtoFile=function(e,n){var r=t.convertDataUrlToByteArray(e),i=r[0],a=r[1];return new File([i],n,{type:a})},e.convertDataURLtoBlob=function(e){var n=t.convertDataUrlToByteArray(e),r=n[0],i=n[1];return new Blob([r],{type:i})},e.convertArrayBufferToFile=function(e,t){return new File([e],t)},e.isFile=function(e){return"undefined"!=typeof window&&"File"in window&&"undefined"!=typeof File&&e instanceof File},e.isBlob=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},e.isFileTypeBlob=function(e){return e===x.BLOB||e===x.FILE},e.convertBlobToBuffer=function(n){return P(void 0,void 0,void 0,(function(){var r;return L(t,(function(t){switch(t.label){case 0:return[4,e.convertFileToArrayBuffer(n)];case 1:return r=t.sent(),[2,Buffer.from(r)]}}))}))},e}(),oe=function(){function e(e){var t=this;this.fields={},e&&Object.keys(e).forEach((function(n){t.fields[n]={value:e[n]},ae.isFile(e[n])&&(t.fields[n].filename=e[n].name)})),this.options={},this.internal=!1,this.upload={reqId:null,deleteRequest:null,progressHandler:null}}return e.prototype.add=function(e,t,n){void 0===n&&(n=null),this.fields[e]={value:t,filename:n}},e.prototype.remove=function(e){this.fields.hasOwnProperty(e)&&delete this.fields[e]},e.prototype.yield=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a,o,l,u,c,d,h,f=this;return L(this,(function(p){switch(p.label){case 0:for(e=!1,t=Object.keys(this.fields),n=0,r=t;n<r.length;n++)if(l=r[n],ae.isFile(this.fields[l].value)){e=!0;break}if(!e)return[3,10];i=new s.default,a=0,o=t,p.label=1;case 1:return a<o.length?(l=o[a],u=this.fields[l],ae.isFile(u.value)?(c=u.value).filename||c.name?(i.append(l,u.value,c.filename||c.name),[3,6]):[3,2]:[3,7]):[3,9];case 2:return c.data?(i.append(l,u.value,c.data.name),[3,6]):[3,3];case 3:return d=u.value,"undefined"!=typeof window&&"undefined"!=typeof process&&process.title.endsWith("node")&&process.versions&&process.versions.node&&"undefined"!=typeof Blob&&d instanceof Blob||"undefined"!=typeof File&&d instanceof File?[4,se.convertBlobToBuffer(d)]:[3,5];case 4:d=p.sent(),p.label=5;case 5:i.append(l,d,"unnamed"),p.label=6;case 6:return[3,8];case 7:ee()&&Array.isArray(u.value)?i.append(l,String(u.value)):i.append(l,u.value),p.label=8;case 8:return a++,[3,1];case 9:return[2,i];case 10:return h={},Object.keys(this.fields).forEach((function(e){h[e]=f.fields[e].value})),[2,h]}}))}))},e}(),le=function(e,t,n){return void 0===n&&(n=null),new Promise((function(r,i){t((function(t,a){void 0===a&&(a=null),n&&(I.get(e).get("isErrorFirstInCallback")?n(t,a):n(a,t)),t?i(t):r(a)}))}))},ue=888e3,ce=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid)}return f(e,[{key:"checkRouting",value:function(e){if(this.sb.customApiHost&&this.sb.customWsHost)"function"==typeof e&&e(null,{apiHost:this.sb.customApiHost,wsHost:this.sb.customWsHost});else{var t=this.sb.getApplicationId();e(null,{apiHost:"https://api-".concat(t,".sendbird.com"),wsHost:"wss://ws-".concat(t,".sendbird.com")})}}},{key:"_buildUrl",value:function(e){var t=e.apiHost,n=e.url,r=e.params;return n?r&&r.internal?"".concat(t,"/v").concat(T.SDK_MAJOR_VERSION,"/sdk").concat(n):"".concat(t,"/v").concat(T.SDK_MAJOR_VERSION).concat(n):t}},{key:"_createHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.noSessionKey,r=void 0!==n&&n,i=t.accessToken,a=void 0===i?null:i,o=e instanceof s.default&&"function"==typeof e.getHeaders?e.getHeaders():{},l=I.get(this.sb._iid).container,u=l.appId,c=l.auth,d=l.extensions,h=l.getUserAgentWithExtensions,f=Ri.getAppVersion(),p="JS,".concat(T.OS_VERSION,",").concat(T.SDK_VERSION,",").concat(u);return f&&(p+=",".concat(f)),o.SendBird=p,o["SB-User-Agent"]=encodeURIComponent(h(d)),!r&&c.sessionKey&&(o["Session-Key"]=c.sessionKey),a&&(o["App-Id"]=u,o["Access-Token"]=a),o["Request-Sent-Timestamp"]=(new Date).getTime().toString(),o}},{key:"_createQuery",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=[];return Object.keys(t).forEach((function(e){var r=t[e];if(null!=r){var i="";i="object"===c(r)?Array.isArray(r)?r.map((function(e){return encodeURIComponent("string"==typeof e?e.trim():e)})).join(","):encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r),n.push("".concat(e,"=").concat(i))}})),n.length>0?"".concat(e,"?").concat(n.join("&")):e}catch(t){return J.debug("createWithEncodedGetParams is failed. - ",t),e}}},{key:"_request",value:function(e,t,n,r){var i=this;this.checkRouting((function(o,l){if(o)r(new F("Request failed.",F.REQUEST_FAILED),null);else{var u=i._buildUrl({apiHost:l.apiHost,url:t,params:n});(n?n.yield():Promise.resolve({})).then((function(o){var l=i._createHeader(o,n?n.options:{}),c=[{level:J.supportedLogLevels.DEBUG,messages:["url:",t]},{level:J.supportedLogLevels.DEBUG,messages:["data:",o]}],d=null;switch(e){case"GET":case"DELETE":d=i._createQuery(u,o);break;case"POST":case"PUT":d=u}var h=null;if("undefined"==typeof ServiceWorker||"undefined"==typeof ServiceWorkerRegistration||"undefined"!=typeof ServiceWorkerContainer||te()||"function"!=typeof fetch)switch(e){case"GET":h=a.default.get(d,{headers:l,validateStatus:i._validateStatus});break;case"POST":var f=null;if(o instanceof s.default){var p=a.default.CancelToken.source();f=p.token;var y=i.cls.FileMessageQueue,g=n.upload.reqId;g&&(c.push({level:J.supportedLogLevels.DEBUG,messages:["request id:",g]}),y.uploadRequest[g]=p)}h=a.default.post(d,"function"==typeof o.getBuffer?o.getBuffer():o,{headers:l,validateStatus:i._validateStatus,cancelToken:f,onUploadProgress:function(e){n.upload.progressHandler&&n.upload.progressHandler(e,n.upload.reqId)}});break;case"PUT":h=a.default.put(d,o,{headers:l,validateStatus:i._validateStatus});break;case"DELETE":h=a.default.delete(d,{headers:l,validateStatus:i._validateStatus})}else{var _={method:e,headers:l};switch(e){case"GET":break;case"POST":if(o instanceof s.default){if("function"==typeof AbortController){var m=new AbortController,v=m.signal;_.signal=v;var E=i.cls.FileMessageQueue,b=n.upload.reqId;b&&(c.push({level:J.supportedLogLevels.DEBUG,messages:["request id:",b]}),E.uploadRequest[b]=m)}_.body="function"==typeof o.getBuffer?o.getBuffer():o}else l["Content-Type"]="application/json; charset=utf-8",_.body=JSON.stringify(o);break;case"PUT":o instanceof s.default?_.body="function"==typeof o.getBuffer?o.getBuffer():o:(l["Content-Type"]="application/json; charset=utf-8",_.body=JSON.stringify(o))}h=fetch(d,_).then((function(e){return e.json().then((function(t){if(!i._validateStatus(e.status))throw{request:{isAbort:!1},response:{data:t}};return Promise.resolve({data:t})}))}))}J.group("".concat(e," request"),c),c=[],h.then((function(t){try{var i=t.data;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest(),c.push({level:J.supportedLogLevels.DEBUG,messages:["data:",i]}),r(null,i)}catch(e){throw{code:ue,rawError:e}}})).catch((function(a){if(a.code===ue)throw a.rawError;"POST"===e&&"function"==typeof n.upload.deleteRequest&&n.upload.deleteRequest();var s=i._handleError(a);if(c.push({level:J.supportedLogLevels.DEBUG,messages:["error:",s]}),t&&n)if(n.options&&n.options.isSessionRefresh)r(s,null);else{var o=I.get(i.sb._iid).container.sessionManager;o.isSessionError(s)?o.refreshSessionIfExpiredError(s).then((function(){return r(new F("Session is refreshed successfully.",F.SESSION_REFRESH_SUCCESS),null)})).catch((function(e){return r(new F("Session refresh failed.",F.SESSION_REFRESH_FAILED),null)})):r(s,null)}else r(s,null)})).finally((function(){return J.group("".concat(e," response"),c)}))}))}}))}},{key:"_validateStatus",value:function(e){return e>=200&&e<400}},{key:"_handleError",value:function(e){var t=e.request,n=e.response;if(t){if(t.isAbort||t.aborted)return new F("Request has been canceled.",F.REQUEST_CANCELED);if(n){var r=n.data,i=r?r.message:"Request failed.",a=r?r.code:F.REQUEST_FAILED;return new F(i,a)}return new F("Request failed.",F.REQUEST_FAILED)}return new F("There was a network error.",F.NETWORK_ERROR)}},{key:"get",value:function(e,t,n){this._request("GET",e,t,n)}},{key:"dummyCall",value:function(e){this._request("GET",null,null,e)}},{key:"post",value:function(e,t,n){this._request("POST",e,t,n)}},{key:"put",value:function(e,t,n){this._request("PUT",e,t,n)}},{key:"delete",value:function(e,t,n){this._request("DELETE",e,t,n)}},{key:"refreshSessionKey",value:function(t,n){var r=this,i=t.accessToken;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_SESSION_KEY.replace("%s",encodeURIComponent(a.userId)),o=new oe;o.options.isSessionRefresh=!0,o.options.noSessionKey=!0,o.options.accessToken=i,r.post(s,o,n)}}))}},{key:"updateCurrentUserInfo",value:function(t,n){var r=this,i=t.nickname,a=t.profileUrl,s=t.profileImage,o=t.preferredLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=e.Path.USERS_USERID.replace("%s",encodeURIComponent(l.userId)),c=new oe;i&&c.add("nickname",i),a&&c.add("profile_url",a),s&&c.add("profile_file",s,s.name),o&&c.add("preferred_languages",o),r.put(u,c,n)}}))}},{key:"getMyGroupChannelChangeLogs",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.ts,a=t.token,s=t.customTypes,o=t.includeEmpty,l=t.includeFrozen;r.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS.replace("%s",encodeURIComponent(u.userId)),d=new oe({show_read_receipt:!0,show_delivery_receipt:!0,show_member:!0});a&&d.add("token",a),i&&d.add("change_ts",i),s&&s.length>0&&d.add("custom_types",s),"boolean"==typeof o&&d.add("show_empty",o),"boolean"==typeof l&&d.add("show_frozen",l),r.get(c,d,n)}}))}),n)}},{key:"getChannelInvitationPreference",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"getGroupChannelCount",value:function(t,n){var r=this,i=t.memberStateFilter;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=r.cls.GroupChannel,o=e.Path.USERS_USERID_GROUP_CHANNEL_COUNT.replace("%s",encodeURIComponent(a.userId)),l="";switch(i){case s.MemberStateFilter.JOINED:l="joined";break;case s.MemberStateFilter.INVITED:l="invited";break;case s.MemberStateFilter.INVITED_BY_FRIEND:l="invited_by_friend";break;case s.MemberStateFilter.INVITED_BY_NON_FRIEND:l="invited_by_non_friend";break;default:l="all"}var u=new oe({state:l});r.get(o,u,n)}}))}},{key:"getUnreadItemCount",value:function(t,n){var r=this,i=t.keys;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_UNREAD_ITEM_COUNT.replace("%s",encodeURIComponent(a.userId)),o=new oe({item_keys:i});r.get(s,o,n)}}))}},{key:"getTotalUnreadMessageCount",value:function(t,n){var r=this,i=t.customTypesFilter,a=t.superChannelFilter;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_USERID_UNREAD_MESSAGE_COUNT.replace("%s",encodeURIComponent(s.userId)),l=new oe({super_mode:a});null!==i&&i.length>0&&l.add("custom_types",i),r.get(o,l,n)}}))}},{key:"getTotalUnreadChannelCount",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_UNREAD_CHANNEL_COUNT.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"searchMessages",value:function(t,n){var r=this,i=t.keyword,a=t.limit,s=t.reverse,o=t.exactMatch,l=t.channelUrl,u=t.channelCustomType,c=t.messageTimestampFrom,d=t.messageTimestampTo,h=t.order,f=t.nextToken,p=t.advancedQuery,y=t.targetFields;this.sb.ConnectionManager.ready((function(t,g){if(t)n(t,null);else{var _=e.Path.SEARCH_MESSAGE,m=new oe({limit:a,reverse:s,query:i,custom_type:u});c&&m.add("message_ts_from",c),d&&m.add("message_ts_to",d),l&&m.add("channel_url",l),h&&m.add("sort_field",h),"boolean"==typeof o&&m.add("exact_match",o),null!==f&&f.length>0&&m.add("after",f),"boolean"==typeof p&&m.add("advanced_query",p),y&&Array.isArray(y)&&m.add("target_fields",y),r.get(_,m,n)}}))}},{key:"markAsReadAll",value:function(t,n){var r=this,i=t.channelUrls;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(a.userId)),o=new oe;i&&o.add("channel_urls",i),r.put(s,o,n)}}))}},{key:"markAsDelivered",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED.replace("%s",encodeURIComponent(i)),l=new oe;a&&l.add("user_id",a),r.put(o,l,n)}}))}},{key:"setChannelInvitationPreference",value:function(t,n){var r=this,i=t.isAutoAccept;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(a.userId)),o=new oe({auto_accept:i});r.put(s,o,n)}}))}},{key:"blockUser",value:function(t,n){var r=this,i=t.blockedUserId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(a.userId)),o=new oe({target_id:i});r.post(s,o,n)}}))}},{key:"unblockUser",value:function(t,n){var r=this,i=t.unblockedUserId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"getPushTriggerOption",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setPushTriggerOption",value:function(t,n){var r=this,i=t.pushTriggerOption;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(a.userId)),o=new oe({push_trigger_option:i});r.put(s,o,n)}}))}},{key:"getPushTokens",value:function(t,n){var r=this,i=t.ts,a=t.token,s=t.type;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSH_DEVICE_TOKENS.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(s)),u=new oe;a&&u.add("token",a),i&&u.add("created_ts",i),r.get(l,u,n)}}))}},{key:"getPushTemplate",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setPushTemplate",value:function(t,n){var r=this,i=t.templateName;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(a.userId)),o=new oe({name:i});r.put(s,o,n)}}))}},{key:"getDoNotDisturb",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setDoNotDisturb",value:function(t,n){var r=this,i=t.doNotDisturbOn,a=t.startHour,s=t.startMin,o=t.endHour,l=t.endMin,u=t.timezone;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(c.userId)),h=new oe({do_not_disturb:i,start_hour:a,start_min:s,end_hour:o,end_min:l,timezone:u});r.put(d,h,n)}}))}},{key:"getSnoozePeriod",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(i.userId));r.get(a,null,n)}}))}},{key:"setSnoozePeriod",value:function(t,n){var r=this,i=t.snoozeOn,a=t.startTs,s=t.endTs;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(o.userId)),u=new oe({snooze_enabled:i,snooze_start_ts:a,snooze_end_ts:s});r.put(l,u,n)}}))}},{key:"registerGCMPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(a.userId)),o=new oe({gcm_reg_token:i,always_push:!0});r.post(s,o,n)}}))}},{key:"unregisterGCMPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"unregisterAllGCMPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"registerAPNSPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(a.userId)),o=new oe({apns_device_token:i,always_push:!0});r.post(s,o,n)}}))}},{key:"unregisterAPNSPushToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"unregisterAllAPNSPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"unregisterAllPushTokens",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_PUSH.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"loadFriendList",value:function(t,n){var r=this,i=t.token,a=t.limit;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.FRIENDS.replace("%s",encodeURIComponent(s.userId)),l=new oe({limit:a,token:i});r.get(o,l,n)}}))}},{key:"getFriendChangeLogsByToken",value:function(t,n){var r=this,i=t.token;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_CHANGE_LOGS.replace("%s",encodeURIComponent(a.userId)),o=new oe;i&&o.add("token",i),r.get(s,o,n)}}))}},{key:"addFriends",value:function(t,n){var r=this,i=t.userIds;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS.replace("%s",encodeURIComponent(a.userId)),o=new oe({user_ids:i});r.post(s,o,n)}}))}},{key:"deleteFriends",value:function(t,n){var r=this,i=t.userIds;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS.replace("%s",encodeURIComponent(a.userId)),o=new oe({user_ids:i});r.delete(s,o,n)}}))}},{key:"uploadFriendDiscoveries",value:function(t,n){var r=this,i=t.discoveries;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(a.userId)),o=[];i.forEach((function(e){o.push({friend_discovery_key:e.friendDiscoveryKey,friend_name:"string"==typeof e.friendName||e.friendName?e.friendName:null})}));var l=new oe({friend_discoveries:o});r.put(s,l,n)}}))}},{key:"deleteFriendDiscoveries",value:function(t,n){var r=this,i=t.discoveryKeys;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(a.userId)),o=new oe({friend_discovery_keys:i});r.delete(s,o,n)}}))}},{key:"loadUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.userIdsFilter,o=t.metaDataKeyFilter,l=t.metaDataValuesFilter,u=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.USERS,h=new oe({token:i,limit:a});s&&s.length>0&&h.add("user_ids",s),o&&l&&l.length>0&&(h.add("metadatakey",o),h.add("metadatavalues_in",l)),u&&h.add("nickname_startswith",u),r.get(d,h,n)}}))}},{key:"loadBlockedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.userIdsFilter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(o.userId)),u=new oe({token:i,limit:a});s&&s.length>0&&u.add("user_ids",s),r.get(l,u,n)}}))}},{key:"createUserMetaData",value:function(t,n){var r=this,i=t.metaData;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(a.userId)),o=new oe({metadata:i});r.post(s,o,n)}}))}},{key:"updateUserMetaData",value:function(t,n){var r=this,i=t.metaData,a=t.upsert;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(s.userId)),l=new oe({metadata:i,upsert:a});r.put(o,l,n)}}))}},{key:"deleteUserMetaData",value:function(t,n){var r=this,i=t.metaDataKey;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_METADATA_KEY.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"deleteAllUserMetaData",value:function(t,n){var r=this;this.sb.ConnectionManager.ready((function(t,i){if(t)n(t,null);else{var a=e.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(i.userId));r.delete(a,null,n)}}))}},{key:"getMessageChangeLogs",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channelUrl,a=t.ts,s=t.timestamp,o=t.token,l=t.isOpenChannel,u=t.includeMetaArray,c=t.includeReaction,d=t.includeReactions,h=t.includeReplies,f=t.includeParentMessageText,p=t.includeThreadInfo,y=t.replyType,g=t.includeParentMessageInfo,_=t.includePollDetails;r.sb.ConnectionManager.ready((function(t,m){if(t)n(t,null);else{var v=l?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(i)),E=new oe;o&&E.add("token",o),a&&E.add("change_ts",a),s&&E.add("change_ts",s),"boolean"==typeof u&&E.add("with_sorted_meta_array",u),"boolean"==typeof d?E.add("include_reactions",d):E.add("include_reactions","boolean"==typeof c&&c),"boolean"==typeof p&&E.add("include_thread_info",p),"string"==typeof y?E.add("include_reply_type",y):E.add("include_reply_type","boolean"==typeof h&&h?r.cls.BaseMessage.ReplyType.ALL:r.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof g?E.add("include_parent_message_info",g):E.add("include_parent_message_info","boolean"==typeof f&&f),"boolean"==typeof _&&E.add("include_poll_details",_),r.get(v,E,n)}}))}),n)}},{key:"getMyMutedInfo",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.get(l,null,n)}}))}},{key:"loadBannedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)),c=new oe({token:i,limit:a});r.get(u,c,n)}}))}},{key:"loadMutedUserList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl,o=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=o?e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)),c=new oe({token:i,limit:a});r.get(u,c,n)}}))}},{key:"getMessageList",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channel,a=t.token,s=t.tokenType,o=t.isInclusive,l=t.prevResultSize,u=void 0===l?0:l,c=t.nextResultSize,d=void 0===c?0:c,h=t.shouldReverse,f=t.messageType,p=t.customType,y=t.customTypes,g=t.senderUserIds,_=t.includeMetaArray,m=t.includeReaction,v=t.includeReactions,E=t.includeReplies,b=t.includeParentMessageText,C=t.includeThreadInfo,S=t.replyType,N=t.includeParentMessageInfo,k=t.showSubchannelMessagesOnly,A=t.includePollDetails,w=t.rootMessageId,T=t.parentMessageId;r.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var c=i.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",i.url):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",i.url),O=new oe({is_sdk:String(!0),prev_limit:String(u),next_limit:String(d),include:String(o),reverse:String(h)});"timestamp"===s?O.add("message_ts",a):"messageId"===s&&O.add("message_id",String(a)),f&&O.add("message_type",String(f)),Array.isArray(y)&&(0===y.length&&("string"==typeof p?y.push(p):y.push("*")),O.add("custom_types",y)),Array.isArray(g)&&g.length>0&&O.add("sender_ids",g),"boolean"==typeof _&&O.add("with_sorted_meta_array",_),"boolean"==typeof v?O.add("include_reactions",v):O.add("include_reactions","boolean"==typeof m&&m),"boolean"==typeof C&&O.add("include_thread_info",C),"string"==typeof S?O.add("include_reply_type",S):O.add("include_reply_type","boolean"==typeof E&&E?r.cls.BaseMessage.ReplyType.ALL:r.cls.BaseMessage.ReplyType.NONE),"boolean"==typeof N?O.add("include_parent_message_info",N):O.add("include_parent_message_info","boolean"==typeof b&&b),"boolean"==typeof k&&i.isOpenChannel()&&O.add("show_subchannel_messages_only",k),"boolean"==typeof A&&O.add("include_poll_details",A),w&&O.add("root_message_id",w),T&&O.add("parent_message_id",T),r.get(c,O,n)}}))}),n)}},{key:"checkMessageHugeGap",value:function(t,n){var r=this;return le(this.sb._iid,(function(n){var i=t.channelUrl;t.channelType;var a=t.messageType,s=void 0===a?"":a,o=t.customTypes,l=void 0===o?["*"]:o,u=t.senderUserIds,c=void 0===u?[]:u,d=t.includeReactions,h=void 0===d||d,f=t.includeMetaArray,p=void 0!==f&&f,y=t.showSubchannelMessagesOnly,g=void 0!==y&&y,_=t.threshold,m=t.previous,v=t.next,E="".concat(e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_GAP.replace("%s",encodeURIComponent(i))),b=new oe({huge_gap_threshold:_,prev_start_ts:m.from,prev_end_ts:m.to,prev_cache_count:m.cachedCount,next_start_ts:v.from,next_end_ts:v.to,next_cache_count:v.cachedCount,reverse:!0,custom_types:l,message_type:s,include_reactions:h,with_sorted_meta_array:p,show_subchannel_messages_only:g});Array.isArray(c)&&c.length>0&&b.add("sender_ids",c),r.get(E,b,n)}),n)}},{key:"translateUserMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId,o=t.translationTargetLanguages;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(i)).replace("%s",s),c=new oe({target_langs:o});r.post(u,c,n)}}))}},{key:"getMessage",value:function(t,n){var r=this,i=t.channel,a=t.messageId,s=t.includeMetaArray,o=t.includeReactions,l=t.includeParentMessageText,u=t.includeThreadInfo,c=t.includeParentMessageInfo,d=t.includePollDetails;this.sb.ConnectionManager.ready((function(t,h){if(t)n(t,null);else{var f=i.isOpenChannel()?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i.url)).replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i.url)).replace("%s",encodeURIComponent(a)),p=new oe({is_sdk:String(!0)});"boolean"==typeof s&&p.add("with_sorted_meta_array",s),"boolean"==typeof o&&p.add("include_reactions",o),"boolean"==typeof u&&p.add("include_thread_info",u),"boolean"==typeof c?p.add("include_parent_message_info",c):p.add("include_parent_message_info","boolean"==typeof l&&l),"boolean"==typeof d&&p.add("include_poll_details",d),r.get(f,p,n)}}))}},{key:"deleteMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s));r.delete(l,null,n)}}))}},{key:"muteUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(i)),d=new oe({user_id:a});o&&(o>0||-1!==o)&&d.add("seconds",o),s&&d.add("description",s),r.post(c,d,n)}}))}},{key:"unmuteUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.delete(l,null,n)}}))}},{key:"banUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.description,o=t.seconds,l=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=l?e.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(i)),d=new oe({user_id:a});s&&d.add("description",s),d.add("seconds",String(o)),r.post(c,d,n)}}))}},{key:"unbanUser",value:function(t,n){var r=this,i=t.channelUrl,a=t.userId,s=t.isGroupChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.GROUPCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a)):e.Path.OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(a));r.delete(l,null,n)}}))}},{key:"getMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),u=new oe({keys:s});r.get(l,u,n)}}))}},{key:"createMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaCounter;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),u=new oe({metacounter:s});r.post(l,u,n)}}))}},{key:"updateMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaCounter,o=t.upsert,l=t.mode;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)),d=new oe({metacounter:s,upsert:o,mode:l});r.put(c,d,n)}}))}},{key:"deleteMetaCounter",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s);r.delete(l,null,n)}}))}},{key:"deleteAllMetaCounters",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=a?e.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(i));r.delete(o,null,n)}}))}},{key:"getMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.keys;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),u=new oe({keys:s,include_ts:!0});r.get(l,u,n)}}))}},{key:"createMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaData;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),u=new oe({metadata:s,include_ts:!0});r.post(l,u,n)}}))}},{key:"updateMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.metaData,o=t.upsert;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),c=new oe({metadata:s,upsert:o,include_ts:!0});r.put(u,c,n)}}))}},{key:"deleteMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.key;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s):e.Path.GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(i)).replace("%s",s),u=new oe({include_ts:!0});r.delete(l,u,n)}}))}},{key:"deleteAllMetaData",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=a?e.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(i)),l=new oe({include_ts:!0});r.delete(o,l,n)}}))}},{key:"loadOperatorList",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.token,o=t.limit;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=a?e.Path.OPENCHANNELS_OPERATORS.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_OPERATORS.replace("%s",encodeURIComponent(i)),c=new oe({token:s,limit:o});r.get(u,c,n)}}))}},{key:"getOpenChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.internalCall;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),l=new oe({});l.internal=a===T.INTERNAL_CALL,r.get(o,l,n)}}))}},{key:"loadOpenChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.nameKeyword,o=t.urlKeyword,l=t.customTypes,u=t.includeFrozen,c=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.OPENCHANNELS,f=new oe({token:i,limit:a});s&&f.add("name_contains",s),o&&f.add("url_contains",o),l&&l.length>0&&f.add("custom_types",l),"boolean"==typeof u&&f.add("show_frozen",u),"boolean"==typeof c&&f.add("show_metadata",c),r.get(h,f,n)}}))}},{key:"loadParticipantList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.channelUrl;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",encodeURIComponent(s)),u=new oe({token:i,limit:a});r.get(l,u,n)}}))}},{key:"createOpenChannel",value:function(t,n){var r=this,i=t.name,a=t.coverUrlOrImage,s=t.data,o=t.operatorUserIds,l=t.customType,u=t.channelUrl;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS,h=new oe;"string"==typeof a&&h.add("cover_url",a),ae.isFile(a)&&h.add("cover_file",a),null!==u&&"string"==typeof u&&h.add("channel_url",u),null!==i&&"string"==typeof i&&h.add("name",i),s&&h.add("data",s),o&&(Array.isArray(o)?h.add("operators",o):h.add("operators",[o])),l&&h.add("custom_type",l),r.post(d,h,n)}}))}},{key:"updateOpenChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.name,s=t.coverUrlOrImage,o=t.data,l=t.operatorUserIds,u=t.customType;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),h=new oe;"string"==typeof s&&h.add("cover_url",s),ae.isFile(s)&&h.add("cover_file",s,s.name),null!==a&&"string"==typeof a&&h.add("name",a),null!==o&&"string"==typeof o&&h.add("data",o),null!==l&&(Array.isArray(l)?h.add("operator_ids",l):h.add("operator_ids",[l])),null!==u&&"string"==typeof u&&h.add("custom_type",u),r.put(d,h,n)}}))}},{key:"deleteOpenChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"getGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.showMember,s=t.internalCall;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i)),u=new oe({show_member:a,show_read_receipt:!0,show_delivery_receipt:!0});u.internal=s===T.INTERNAL_CALL,r.get(l,u,n)}}))}},{key:"loadGroupChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.includeEmpty,o=t.order,l=t.userIdsFilter,u=t.nicknameContainsFilter,c=t.channelNameContainsFilter,d=t.channelUrlsFilter,h=t.customTypesFilter,f=t.customTypeStartsWithFilter,p=t.memberStateFilter,y=t.superChannelFilter,g=t.publicChannelFilter,_=t.unreadChannelFilter,m=t.metadataOrderKeyFilter,v=t.metadataKey,E=t.metadataValues,b=t.metadataValueStartsWith,C=t.hiddenChannelFilter,S=t.searchFilter,N=t.includeFrozen,k=t.includeMetaData;return le(this.sb._iid,(function(t){r.sb.ConnectionManager.ready((function(n,A){if(n)t(n,null);else{var w=e.Path.MYGROUPCHANNELS.replace("%s",encodeURIComponent(A.userId)),T=new oe({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(s),member_state_filter:p});h&&h.length>0&&T.add("custom_types",h),u&&T.add("members_nickname_contains",u),c&&T.add("name_contains",c),S&&S.hasOwnProperty("search_query")&&S.hasOwnProperty("search_fields")&&(T.add("search_query",S.search_query),T.add("search_fields",S.search_fields)),l&&l.userIds&&l.userIds.length>0&&(l.includeMode?(T.add("members_include_in",l.userIds),T.add("query_type",l.queryType.toUpperCase())):T.add("members_exactly_in",l.userIds)),d&&d.length>0&&T.add("channel_urls",d),T.add("super_mode",y),T.add("public_mode",g),T.add("unread_filter",_),m&&T.add("metadata_order_key",m),v&&T.add("metadata_key",v),E&&E.length>0&&T.add("metadata_values",E),b&&T.add("metadata_value_startswith",b),f&&T.add("custom_type_startswith",f),C&&T.add("hidden_mode",C),"boolean"==typeof N&&T.add("show_frozen",N),"boolean"==typeof k&&T.add("show_metadata",k),r.get(w,T,t)}}))}),n)}},{key:"loadPublicGroupChannelList",value:function(t,n){var r=this,i=t.token,a=t.limit,s=t.includeEmpty,o=t.order,l=t.channelNameContainsFilter,u=t.channelUrlsFilter,c=t.customTypesFilter,d=t.customTypeStartsWithFilter,h=t.superChannelFilter,f=t.membershipFilter,p=t.metadataOrderKeyFilter,y=t.metadataKey,g=t.metadataValues,_=t.metadataValueStartsWith,m=t.includeFrozen,v=t.includeMetaData;this.sb.ConnectionManager.ready((function(t,E){if(t)n(t,null);else{var b=r.cls.GroupChannel,C=e.Path.GROUPCHANNELS,S=new oe({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(s),public_mode:b.PublicChannelFilter.PUBLIC,public_membership_mode:f});c&&c.length>0&&S.add("custom_types",c),l&&S.add("name_contains",l),u&&u.length>0&&S.add("channel_urls",u),S.add("super_mode",h),p&&S.add("metadata_order_key",p),y&&S.add("metadata_key",y),g&&g.length>0&&S.add("metadata_values",g),_&&S.add("metadata_value_startswith",_),d&&S.add("custom_type_startswith",d),"boolean"==typeof m&&S.add("show_frozen",m),"boolean"==typeof v&&S.add("show_metadata",v),r.get(C,S,n)}}))}},{key:"createGroupChannel",value:function(t,n){var r=this,i=t.isDistinct,a=t.isSuper,s=t.isBroadcast,o=t.isPublic,l=t.channelUrl,u=t.isDiscoverable,c=t.isStrict,d=t.name,h=t.data,f=t.customType,p=t.coverUrl,y=t.coverImage,g=t.accessCode,_=t.isEphemeral,m=t._invitedUserIds,v=void 0===m?[]:m,E=t.operatorUserIds,b=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,m){if(t)n(t,null);else{var C=e.Path.GROUPCHANNELS,S=new oe({user_ids:[m.userId].concat(N(v)).filter((function(e,t,n){return t===n.indexOf(e)}))});null!==p&&"string"==typeof p&&S.add("cover_url",p),ae.isFile(y)&&S.add("cover_file",y,y.name),null!==l&&S.add("channel_url",l),null!==i&&S.add("is_distinct",i),null!==a&&S.add("is_super",a),null!==s&&S.add("is_broadcast",s),null!==o&&S.add("is_public",o),null!==u&&S.add("is_discoverable",u),null!==c&&S.add("strict",c),null!==_&&S.add("is_ephemeral",_),g&&S.add("access_code",g),null!==d&&"string"==typeof d&&S.add("name",d),h&&S.add("data",h),f&&S.add("custom_type",f),Array.isArray(E)&&E.length>0&&S.add("operator_ids",E),null!==b&&b>-1&&S.add("message_survival_seconds",b),r.post(C,S,n)}}))}},{key:"updateGroupChannel",value:function(t,n){var r=this,i=t.isDistinct,a=t.isPublic,s=t.channelUrl,o=t.isDiscoverable,l=t.name,u=t.data,c=t.customType,d=t.coverUrl,h=t.coverImage,f=t.accessCode,p=t.operatorUserIds,y=t.messageSurvivalSeconds;this.sb.ConnectionManager.ready((function(t,g){if(t)n(t,null);else{var _=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(s)),m=new oe;null!==i&&m.add("is_distinct",i),null!==a&&m.add("is_public",a),null!==o&&m.add("is_discoverable",o),null!==f&&m.add("access_code",f),null!==d&&"string"==typeof d&&m.add("cover_url",d),ae.isFile(h)&&m.add("cover_file",h,h.name),null!==l&&"string"==typeof l&&m.add("name",l),null!==u&&"string"==typeof u&&m.add("data",u),null!==c&&"string"==typeof c&&m.add("custom_type",c),null!==p&&(Array.isArray(p)?m.add("operator_ids",p):p&&m.add("operator_ids",[p])),null!==y&&y>-1&&m.add("message_survival_seconds",y),r.put(_,m,n)}}))}},{key:"addOperators",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=void 0!==a&&a,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,a){if(!t){var l=(s?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(i)),u=new oe({operator_ids:o});r.post(l,u,n)}}))}},{key:"removeOperators",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=void 0!==a&&a,o=t.operatorUserIds;this.sb.ConnectionManager.ready((function(t,a){if(!t){var l=(s?e.Path.OPENCHANNELS_CHANNELURL_OPERATORS:e.Path.GROUPCHANNELS_CHANNELURL_OPERATORS).replace("%s",encodeURIComponent(i)),u=new oe({operator_ids:o});r.delete(l,u,n)}}))}},{key:"inviteToGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.userIds;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(i)),l=new oe({user_ids:a});r.post(o,l,n)}}))}},{key:"acceptInvitation",value:function(t,n){var r=this,i=t.channelUrl,a=t.accessCode;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION.replace("%s",encodeURIComponent(i)),l=new oe({user_id:s.userId});a&&l.add("access_code",a),r.put(o,l,n)}}))}},{key:"declineInvitation",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION.replace("%s",encodeURIComponent(i)),o=new oe({user_id:a.userId});r.put(s,o,n)}}))}},{key:"joinGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.accessCode;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.GROUPCHANNELS_CHANNELURL_JOIN.replace("%s",encodeURIComponent(i)),l=new oe({user_id:s.userId});a&&l.add("access_code",a),r.put(o,l,n)}}))}},{key:"leaveGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(i)),o=new oe({user_id:a.userId});r.put(s,o,n)}}))}},{key:"hideGroupChannel",value:function(t,n){var r=this,i=t.channelUrl,a=t.hidePreviousMessages,s=t.allowAutoUnhide;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(i)),u=new oe({user_id:o.userId,hide_previous_messages:a,allow_auto_unhide:s});r.put(l,u,n)}}))}},{key:"unhideGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"freeze",value:function(t,n){var r=this,i=t.channelUrl,a=t.isGroupChannel,s=t.freezing;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=a?e.Path.GROUPCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(i)):e.Path.OPENCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(i)),u=new oe({freeze:s});r.put(l,u,n)}}))}},{key:"deleteGroupChannel",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(i));r.delete(s,null,n)}}))}},{key:"loadMemberList",value:function(t,n){var r=this,i=t.channelUrl,a=t.token,s=t.limit,o=t.mutedMemberFilter,l=t.order,u=t.memberStateFilter,c=t.nicknameStartsWithFilter;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.GROUPCHANNELS_MEMBERS.replace("%s",encodeURIComponent(i)),f=new oe({token:a,limit:s,order:l.toLowerCase(),muted_member_filter:o.toLowerCase(),member_state_filter:u,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0});c&&f.add("nickname_startswith",c),r.get(h,f,n)}}))}},{key:"report",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.reportCategory,o=t.reportingUserId,l=t.reportDescription;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.REPORT_CHANNELS.replace("%s",encodeURIComponent(a?"open_channels":"group_channels")).replace("%s",encodeURIComponent(i)),d=new oe({report_category:s});null!=o&&d.add("reporting_user_id",o),null!=l&&d.add("report_description",l),r.post(c,d,n)}}))}},{key:"reportUser",value:function(t,n){var r=this,i=t.offendingUserId,a=t.channelUrl,s=t.isOpenChannel,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription;this.sb.ConnectionManager.ready((function(t,c){if(t)n(t,null);else{var d=e.Path.REPORT_USERS.replace("%s",encodeURIComponent(i)),h=new oe({channel_url:a,channel_type:s?"open_channels":"group_channels",report_category:o});null!=l&&h.add("reporting_user_id",l),null!=u&&h.add("report_description",u),r.post(d,h,n)}}))}},{key:"reportMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.messageId,o=t.reportCategory,l=t.reportingUserId,u=t.reportDescription,c=t.offendingUserId;this.sb.ConnectionManager.ready((function(t,d){if(t)n(t,null);else{var h=e.Path.REPORT_MESSAGES.replace("%s",encodeURIComponent(a?"open_channels":"group_channels")).replace("%s",encodeURIComponent(i)).replace("%s",encodeURIComponent(s)),f=new oe({report_category:o,offending_user_id:c});null!=l&&f.add("reporting_user_id",l),null!=u&&f.add("report_description",u),r.post(h,f,n)}}))}},{key:"sendUserMessage",value:function(t,n){var r=this,i=t.channelUrl,a=t.isOpenChannel,s=t.message,o=t.data,l=t.customType,u=t.translationTargetLanguages,c=t.metaArrays,d=t.mentionType,h=t.mentionedUserIds,f=t.pushNotificationDeliveryOption,p=t.rootMessageId,y=t.parentMessageId,g=t.appleCriticalAlertOptions,_=t.pollId,m=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,v){if(t)n(t,null);else{var E=r.cls.FileMessageParams,b=a?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(i)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(i)),C=new oe({message_type:"MESG",user_id:v.userId,message:s,mention_type:d,mentioned_user_ids:[]});null!=o&&C.add("data",o),null!=l&&C.add("custom_type",l),u&&C.add("translation_target_langs",u),c&&c.length>0&&C.add("sorted_metaarray",c.map((function(e){return e.encode()}))),d===r.cls.BaseMessageParams.MentionType.CHANNEL?C.add("mentioned_user_ids",[]):Array.isArray(h)&&h.length>0&&C.add("mentioned_user_ids",h),f&&f!==E.PushNotificationDeliveryOption.DEFAULT&&C.add("push_option",f),p&&C.add("root_message_id",p),y&&C.add("parent_message_id",y),g&&C.add("apple_critical_alert_options",g.serialize()),"number"==typeof _?C.add("poll_id",_):null===_&&C.add("poll_id",-1),m&&C.add("reply_to_channel",m),r.post(b,C,n)}}))}},{key:"sendFileMessage",value:function(t,n){var r=this,i=t.reqId,a=t.channelUrl,s=t.isOpenChannel,o=t.fileUrl,l=t.fileName,u=t.fileSize,c=t.fileType,d=t.data,h=t.customType,f=t.thumbnailSizes,p=t.requireAuth,y=t.metaArrays,g=t.mentionType,_=t.mentionedUserIds,m=t.pushNotificationDeliveryOption,v=t.rootMessageId,E=t.parentMessageId,b=t.appleCriticalAlertOptions,C=t.isReplyToChannel;this.sb.ConnectionManager.ready((function(t,S){if(t)n(t,null);else{var N=r.cls.FileMessageParams,k=s?e.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(a)),A=new oe({message_type:"FILE",user_id:S.userId,url:o,mention_type:g,mentioned_user_ids:[],req_id:i});null!=l&&A.add("file_name",l),null!=u&&A.add("file_size",u),null!=c&&A.add("file_type",c),null!=d&&A.add("custom_field",d),null!=h&&A.add("custom_type",h),f&&A.add("thumbnails",f),p&&A.add("require_auth",p),y&&y.length>0&&A.add("sorted_metaarray",y.map((function(e){return e.encode()}))),g===r.cls.BaseMessageParams.MentionType.CHANNEL?A.add("mentioned_user_ids",[]):Array.isArray(_)&&_.length>0&&A.add("mentioned_user_ids",_),m&&m!==N.PushNotificationDeliveryOption.DEFAULT&&A.add("push_option",m),v&&A.add("root_message_id",v),E&&A.add("parent_message_id",E),b&&A.add("apple_critical_alert_options",b.serialize()),C&&A.add("reply_to_channel",C),r.post(k,A,n)}}))}},{key:"uploadFile",value:function(t,n){var r=this,i=t.file,a=t.thumbnailSizes,s=t.channelUrl,o=t.progressHandler,l=t.reqId;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=I.get(r.sb._iid).container.appInfo;if(c)if("number"==typeof i.size||i.size||(i.size=0),"number"==typeof i.size)if(i.size<=c.uploadSizeLimit){var d=e.Path.STORAGE_FILE,h=new oe;if(h.add("file",i,i.name),s&&"string"==typeof s&&h.add("channel_url",s),a)for(var f=0;f<a.length;f++)h.add("thumbnail"+(f+1),a[f].maxWidth+","+a[f].maxHeight);h.upload.reqId=l,h.upload.deleteRequest=function(){var e=r.cls.FileMessageQueue;e.uploadRequest[l]&&delete e.uploadRequest[l]},h.upload.progressHandler=function(e){o&&"function"==typeof o&&o(e,l)},r.post(d,h,n)}else n(new F("The file size exceeded the upload limit: ".concat(c.uploadSizeLimit),F.FILE_SIZE_LIMIT_EXCEEDED),null);else n(new F("Invalid file size: ".concat(i.size),F.INVALID_PARAMETER),null);else n(new F("Connection should be made first.",F.CONNECTION_REQUIRED),null)}}))}},{key:"registerScheduledUserMessage",value:function(t,n){var r=this,i=t.groupChannelParams,a=t.channelUrl,s=t.isOpenChannel;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=s?e.Path.OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(a)):e.Path.GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(a)),u=new oe({scheduled_dt:i._getScheduleString(),user_id:o.userId,message:i.message,data:i.data});i.customType&&u.add("custom_type",i.customType),i.metaArrayKeys&&Object.keys(i.metaArrayKeys).length>0&&u.add("metaarray",i.metaArrayKeys),i.mentionType&&u.add("mention_type",i._mentionType),i._mentionType===r.cls.BaseMessageParams.MentionType.CHANNEL?u.add("mentioned_user_ids",[]):Array.isArray(i._mentionedUserIds)&&i._mentionedUserIds.length>0&&u.add("mentioned_user_ids",i._mentionedUserIds),i.translationTargetLanguages&&i.translationTargetLanguages.length>0&&u.add("translation_target_langs",i.translationTargetLanguages),i.pushNotificationDeliveryOption&&i.pushNotificationDeliveryOption!==r.cls.BaseMessageParams.PushNotificationDeliveryOption.DEFAULT&&u.add("push_option",i.pushNotificationDeliveryOption),i.appleCriticalAlertOptions&&u.add("apple_critical_alert_options",i.appleCriticalAlertOptions.serialize()),r.post(l,u,n)}}))}},{key:"getMyPushTriggerOption",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(a.userId)).replace("%s",encodeURIComponent(i));r.get(s,null,n)}}))}},{key:"setMyPushTriggerOption",value:function(t,n){var r=this,i=t.channelUrl,a=t.pushTriggerOption,s=t.enable;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(o.userId)).replace("%s",encodeURIComponent(i)),u=new oe;a&&u.add("push_trigger_option",a),"boolean"==typeof s&&u.add("enable",s),r.put(l,u,n)}}))}},{key:"setMyCountPreference",value:function(t,n){var r=this,i=t.channelUrl,a=t.countPreference;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.USERS_COUNT_PREFERENCE.replace("%s",encodeURIComponent(s.userId)).replace("%s",encodeURIComponent(i)),l=new oe({count_preference:a});r.put(o,l,n)}}))}},{key:"resetMyHistory",value:function(t,n){var r=this,i=t.channelUrl;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.GROUPCHANNELS_RESET_USER_HISTORY.replace("%s",encodeURIComponent(i));r.put(s,null,n)}}))}},{key:"addReaction",value:function(t,n){var r=this,i=t.isGroupChannel,a=t.channelUrl,s=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=i?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)),c=new oe({reaction:o});r.post(u,c,n)}}))}},{key:"deleteReaction",value:function(t,n){var r=this,i=t.isGroupChannel,a=t.channelUrl,s=t.messageId,o=t.key;this.sb.ConnectionManager.ready((function(t,l){if(t)n(t,null);else{var u=i?e.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):e.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)),c=new oe({reaction:o});r.delete(u,c,n)}}))}},{key:"getAllEmoji",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(r,i){r?t(r,null):n.get(e.Path.EMOJI_CATEGORIES,null,t)}))}},{key:"getEmojiCategory",value:function(t,n){var r=this,i=t.categoryId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.EMOJI_CATEGORIES_CATEGORYID.replace("%s",i);r.get(s,null,n)}}))}},{key:"getEmoji",value:function(t,n){var r=this,i=t.emojiKey;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.EMOJIS_EMOJIKEY.replace("%s",i);r.get(s,null,n)}}))}},{key:"getAllowFriendDiscovery",value:function(t){var n=this;this.sb.ConnectionManager.ready((function(r,i){if(r)t(r,null);else{var a=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(i.userId));n.get(a,null,t)}}))}},{key:"setAllowFriendDiscovery",value:function(t,n){var r=this,i=t.allowFriendDiscovery;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.USERS_USERID_ALLOW_FRIEND_DISCOVERY.replace("%s",encodeURIComponent(a.userId)),o=new oe;"boolean"==typeof i&&o.add("allow_friend_discovery",i),r.put(s,o,n)}}))}},{key:"getPollList",value:function(t,n){var r=this,i=t.channelUrl,a=t.token,s=t.limit;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS,u=new oe({channel_url:i});a&&u.add("token",a),s&&u.add("limit",s),r.get(l,u,n)}}))}},{key:"getPoll",value:function(t,n){var r=this,i=t.channelUrl,a=t.pollId,s=t.showPartialVoters;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID.replace("%s",a),u=new oe({channel_url:i});"boolean"==typeof s&&u.add("show_partial_voter_list",s),r.get(l,u,n)}}))}},{key:"createPoll",value:function(t,n){var r=this,i=t.title,a=t.options,s=t.data,o=t.isAnonymous,l=t.allowUserSuggestion,u=t.allowMultipleVotes,d=t.closeAt;this.sb.ConnectionManager.ready((function(t,h){if(t)n(t,null);else{var f=e.Path.POLLS,p=new oe({title:i,options:a});"object"===c(s)&&p.add("data",s),"boolean"==typeof o&&p.add("is_anonymous",o),"boolean"==typeof l&&p.add("allow_user_suggestion",l),"boolean"==typeof u&&p.add("allow_multiple_votes",u),"number"==typeof d&&p.add("close_at",d),r.post(f,p,n)}}))}},{key:"updatePoll",value:function(t,n){var r=this,i=t.pollId,a=t.title,s=t.options,o=t.data,l=t.isAnonymous,u=t.allowUserSuggestion,d=t.allowMultipleVotes,h=t.closeAt;this.sb.ConnectionManager.ready((function(t,f){if(t)n(t,null);else{var p=e.Path.POLLS_POLLID.replace("%s",i),y=new oe;"string"==typeof a&&y.add("title",a),Array.isArray(s)&&y.add("options",s),"object"===c(o)&&y.add("data",o),"boolean"==typeof l&&y.add("is_anonymous",l),"boolean"==typeof u&&y.add("allow_user_suggestion",u),"boolean"==typeof d&&y.add("allow_multiple_votes",d),"number"==typeof h&&y.add("close_at",h),r.put(p,y,n)}}))}},{key:"deletePoll",value:function(t,n){var r=this,i=t.pollId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.POLLS_POLLID.replace("%s",i);r.delete(s,null,n)}}))}},{key:"votePoll",value:function(t,n){var r=this,i=t.channelUrl,a=t.pollId,s=t.optionIds;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_VOTE.replace("%s",a),u=new oe({channel_url:i});Array.isArray(s)&&u.add("option_ids",s),r.put(l,u,n)}}))}},{key:"closePoll",value:function(t,n){var r=this,i=t.pollId;this.sb.ConnectionManager.ready((function(t,a){if(t)n(t,null);else{var s=e.Path.POLLS_POLLID_CLOSE.replace("%s",i);r.put(s,null,n)}}))}},{key:"getPollOption",value:function(t,n){var r=this,i=t.channelUrl,a=t.pollId,s=t.optionId;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",a).replace("%s",s),u=new oe({channel_url:i});r.get(l,u,n)}}))}},{key:"addPollOption",value:function(t,n){var r=this,i=t.channelUrl,a=t.pollId,s=t.text;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS.replace("%s",a),u=new oe({channel_url:i,text:s});r.post(l,u,n)}}))}},{key:"updatePollOption",value:function(t,n){var r=this,i=t.pollId,a=t.optionId,s=t.text;this.sb.ConnectionManager.ready((function(t,o){if(t)n(t,null);else{var l=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",i).replace("%s",a),u=new oe({text:s});r.put(l,u,n)}}))}},{key:"deletePollOption",value:function(t,n){var r=this,i=t.pollId,a=t.optionId;this.sb.ConnectionManager.ready((function(t,s){if(t)n(t,null);else{var o=e.Path.POLLS_POLLID_OPTIONS_OPTIONID.replace("%s",i).replace("%s",a);r.delete(o,null,n)}}))}},{key:"getPollOptionVoterList",value:function(t,n){var r=this,i=t.channelUrl,a=t.pollId,s=t.optionId,o=t.token,l=t.limit;this.sb.ConnectionManager.ready((function(t,u){if(t)n(t,null);else{var c=e.Path.POLLS_POLLID_OPTIONS_OPTIONID_VOTERS.replace("%s",a).replace("%s",s),d=new oe({channel_url:i});o&&d.add("token",o),l&&d.add("limit",l),r.get(c,d,n)}}))}}],[{key:"Path",get:function(){return{USERS:"/users",USERS_USERID:"/users/%s",USERS_USERID_LOGIN:"/users/%s/login",USERS_USERID_SESSION_KEY:"/users/%s/session_key",USERS_USERID_METADATA:"/users/%s/metadata",USERS_USERID_METADATA_KEY:"/users/%s/metadata/%s",USERS_USERID_MARKASREADALL:"/users/%s/mark_as_read_all",USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS:"/users/%s/my_group_channels/changelogs",USERS_USERID_UNREAD_ITEM_COUNT:"/users/%s/unread_item_count",USERS_USERID_UNREAD_MESSAGE_COUNT:"/users/%s/unread_message_count",USERS_USERID_UNREAD_CHANNEL_COUNT:"/users/%s/unread_channel_count",USERS_USERID_PUSH_GCM_TOKEN:"/users/%s/push/gcm/%s",USERS_USERID_PUSH_GCM:"/users/%s/push/gcm",USERS_USERID_PUSH_DEVICE_TOKENS:"/users/%s/push/%s/device_tokens",USERS_USERID_PUSHPREFERENCE_CHANNELURL:"/users/%s/push_preference/%s",USERS_USERID_PUSHPREFERENCE:"/users/%s/push_preference/",USERS_USERID_PUSH_TEMPLATE:"/users/%s/push/template",USERS_USERID_BLOCK:"/users/%s/block",USERS_USERID_BLOCK_TARGETID:"/users/%s/block/%s",USERS_USERID_PUSH_APNS_TOKEN:"/users/%s/push/apns/%s",USERS_USERID_PUSH_APNS:"/users/%s/push/apns",USERS_USERID_PUSH:"/users/%s/push",USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE:"/users/%s/channel_invitation_preference",USERS_USERID_GROUP_CHANNEL_COUNT:"/users/%s/group_channel_count",USERS_COUNT_PREFERENCE:"/users/%s/count_preference/%s",USERS_USERID_ALLOW_FRIEND_DISCOVERY:"/users/%s/allow_friend_discovery",OPENCHANNELS:"/open_channels",OPENCHANNELS_CHANNELURL:"/open_channels/%s",OPENCHANNELS_CHANNELURL_MESSAGES:"/open_channels/%s/messages",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/open_channels/%s/messages/%s",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/open_channels/%s/messages/%s/translation",OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/open_channels/%s/messages/changelogs",OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/open_channels/%s/scheduled_messages",OPENCHANNELS_CHANNELURL_PARTICIPANTS:"/open_channels/%s/participants",OPENCHANNELS_CHANNELURL_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_METADATA:"/open_channels/%s/metadata",OPENCHANNELS_CHANNELURL_METADATA_KEY:"/open_channels/%s/metadata/%s",OPENCHANNELS_CHANNELURL_METACOUNTER:"/open_channels/%s/metacounter",OPENCHANNELS_CHANNELURL_METACOUNTER_KEY:"/open_channels/%s/metacounter/%s",OPENCHANNELS_CHANNELURL_BAN:"/open_channels/%s/ban",OPENCHANNELS_CHANNELURL_BAN_USERID:"/open_channels/%s/ban/%s",OPENCHANNELS_CHANNELURL_MUTE:"/open_channels/%s/mute",OPENCHANNELS_CHANNELURL_MUTE_USERID:"/open_channels/%s/mute/%s",OPENCHANNELS_CHANNELURL_FREEZE:"/open_channels/%s/freeze",OPENCHANNELS_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/open_channels/%s/messages/%s/reactions",GROUPCHANNELS:"/group_channels",MYGROUPCHANNELS:"/users/%s/my_group_channels",GROUPCHANNELS_CHANNELURL:"/group_channels/%s",GROUPCHANNELS_CHANNELURL_INVITE:"/group_channels/%s/invite",GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION:"/group_channels/%s/accept",GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION:"/group_channels/%s/decline",GROUPCHANNELS_CHANNELURL_HIDE:"/group_channels/%s/hide",GROUPCHANNELS_CHANNELURL_LEAVE:"/group_channels/%s/leave",GROUPCHANNELS_CHANNELURL_JOIN:"/group_channels/%s/join",GROUPCHANNELS_CHANNELURL_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_CHANNELURL_MESSAGES:"/group_channels/%s/messages",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD:"/group_channels/%s/messages/mark_as_read",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED:"/group_channels/%s/messages/mark_as_delivered",GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT:"/group_channels/%s/messages/total_count",GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT:"/group_channels/%s/messages/unread_count",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/group_channels/%s/messages/%s",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/group_channels/%s/messages/%s/translation",GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/group_channels/%s/messages/changelogs",GROUPCHANNELS_CHANNELURL_MESSAGES_GAP:"/group_channels/%s/messages_gap",GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/group_channels/%s/scheduled_messages",GROUPCHANNELS_CHANNELURL_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_METADATA:"/group_channels/%s/metadata",GROUPCHANNELS_CHANNELURL_METADATA_KEY:"/group_channels/%s/metadata/%s",GROUPCHANNELS_CHANNELURL_METACOUNTER:"/group_channels/%s/metacounter",GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY:"/group_channels/%s/metacounter/%s",GROUPCHANNELS_RESET_USER_HISTORY:"/group_channels/%s/reset_user_history",GROUPCHANNELS_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_BAN:"/group_channels/%s/ban",GROUPCHANNELS_CHANNELURL_BAN_USERID:"/group_channels/%s/ban/%s",GROUPCHANNELS_CHANNELURL_MUTE:"/group_channels/%s/mute",GROUPCHANNELS_CHANNELURL_MUTE_USERID:"/group_channels/%s/mute/%s",GROUPCHANNELS_CHANNELURL_FREEZE:"/group_channels/%s/freeze",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/group_channels/%s/messages/%s/reactions",STORAGE_FILE:"/storage/file",STORAGE_PROFILE:"/storage/profile_image",FRIENDS:"/users/%s/friends",FRIENDS_CHANGE_LOGS:"/users/%s/friends/changelogs",FRIENDS_DISCOVERIES:"/users/%s/friend_discoveries",SEARCH_MESSAGE:"/search/messages",REPORT_USERS:"/report/users/%s",REPORT_CHANNELS:"/report/%s/%s",REPORT_MESSAGES:"/report/%s/%s/messages/%s",EMOJIS_EMOJIKEY:"/emojis/%s",EMOJI_CATEGORIES:"/emoji_categories",EMOJI_CATEGORIES_CATEGORYID:"/emoji_categories/%s",POLLS:"/polls",POLLS_POLLID:"/polls/%s",POLLS_POLLID_VOTE:"/polls/%s/vote",POLLS_POLLID_CLOSE:"/polls/%s/close",POLLS_POLLID_OPTIONS:"/polls/%s/options",POLLS_POLLID_OPTIONS_OPTIONID:"/polls/%s/options/%s",POLLS_POLLID_OPTIONS_OPTIONID_VOTERS:"/polls/%s/options/%s/voters"}}}]),e}(),de=function(){function e(t,n){d(this,e),this.sb=t,this.ws=null,this.wsHost=null,this.WebSocket=null,this.handler=n||new e.ConnectionHandler,this.explicitDisconnect=!1,this.lastActiveMillis=0;try{this.WebSocket="undefined"==typeof WebSocket?o.default:WebSocket}catch(e){this.WebSocket=WebSocket}}return f(e,[{key:"connect",value:function(e,t,n){var r=this;J.debug("`WebSocketClient.connect` called.");var i=I.get(this.sb._iid).container,a=i.pinger,s=i.auth,o=i.extensions,l=i.getUserAgentWithExtensions,u=i.sessionManager,c=Ri.getAppVersion();this.wsHost=n;try{var d="/?p=JS"+"&pv=".concat(encodeURIComponent(T.OS_VERSION))+"&sv=".concat(encodeURIComponent(T.SDK_VERSION))+"&ai=".concat(encodeURIComponent(this.sb.getApplicationId()));if(c&&(d+="&av=".concat(encodeURIComponent(c))),s.sessionKey?d+="&key=".concat(encodeURIComponent(s.sessionKey)):d+="&user_id=".concat(encodeURIComponent(e),"&access_token=").concat(encodeURIComponent(t)),d+="&active=1",d+="&SB-User-Agent=".concat(encodeURIComponent(l(o))),d+="&Request-Sent-Timestamp=".concat((new Date).getTime().toString()),d+="&include_extra_data=".concat(encodeURIComponent(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash"].join(","))),u.handler&&(d+="&expiring_session=1"),this.sb.Options.includePollDetails&&(d+="&include_poll_details=1"),d+="&use_local_cache=1",this.ws=new this.WebSocket(this.wsHost+d),!this.ws)return this.sb.isReconnectingOnError=!0,void this.handler.onError("ws does not exist.")}catch(e){return this.sb.isReconnectingOnError=!0,void this.handler.onError(e)}try{this.sb.getDebugMode()&&"undefined"!=typeof window&&(window.ws=this.ws)}catch(e){J.debug("`window` object does not exist.")}var h=!1;this.ws.onopen=function(e){J.debug("`WebSocket.onopen` called."),r.handler.onOpen(e)},this.ws.onmessage=function(e){r.active();for(var t=e.data.split("\n"),n=0;n<t.length;n++){var i=t[n];if(i&&"string"==typeof i){try{if("PONG"===i.substring(0,4)){a.pong();continue}}catch(e){J.debug("`WebSocket.onmessage` command check error:",e)}r.handler.onMessage(i)}}},this.ws.onerror=function(e){J.debug("`WebSocket.onerror` called:",e),a&&a.stop(),h=!0,r.sb.isReconnectingOnError=!0,r.handler.onError(e)},this.ws.onclose=function(e){J.group("`WebSocket.onclose` called.",[{level:J.supportedLogLevels.DEBUG,messages:["e",e]},{level:J.supportedLogLevels.DEBUG,messages:["explicitDisconnect",r.explicitDisconnect]}]),a&&a.stop(),r.explicitDisconnect?r.handler.onClose(e):h||r.handler.onError(e),r.explicitDisconnect=!1}}},{key:"disconnect",value:function(e,t){J.group("`WebSocketClient.onclose` called.",[{level:J.supportedLogLevels.DEBUG,messages:["explicit",e]}]);var n=I.get(this.sb._iid).container.pinger;n&&n.stop(),this.explicitDisconnect=!0===e,this.ws&&(this.ws.onopen=function(){},this.ws.onmessage=function(){},this.ws.onclose=function(){t&&t()},this.ws.onerror=function(){},this.ws.close(),this.ws=null),this.explicitDisconnect?this.handler.onClose():this.handler.onError(),this.explicitDisconnect=!1}},{key:"send",value:function(e,t){if(1!==this.ws.readyState)t&&t(new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),null);else{var n=I.get(this.sb._iid).container.pinger;this.ws.send(e.encode()),"PING"!==e.command&&n.refreshTimer(),t&&t(null,null)}}},{key:"active",value:function(){this.lastActiveMillis=(new Date).getTime()}},{key:"getConnectionState",value:function(){try{return 1===this.ws.readyState?this.sb.ConnectionState.OPEN:0===this.ws.readyState?this.sb.ConnectionState.CONNECTING:this.sb.ConnectionState.CLOSED}catch(e){return this.sb.ConnectionState.CLOSED}}}]),e}();de.ConnectionHandler=function e(){d(this,e),this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onMessage=function(){},this.onError=function(){}};var he,fe={},pe=function(){function e(){this._observers=[]}return e.of=function(t){return fe[t]||(fe[t]=new e),fe[t]},e.prototype.invokeConnect=function(){for(var e=0,t=this._observers;e<t.length;e++){var n=t[e];n.onConnect&&n.onConnect()}},e.prototype.invokeDisconnect=function(){for(var e=0,t=this._observers;e<t.length;e++){var n=t[e];n.onDisconnect&&n.onDisconnect()}},e.prototype.addObserver=function(e){this._observers.push(e)},e.prototype.removeObserver=function(e){var t=this._observers.indexOf(e);t>-1&&this._observers.splice(t,1)},e}(),ye=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid),this.client=new de(this.sb),this.connectParams={retryCount:1},this.reconnectParams={interval:3,retryCount:3,multiplier:2,maxInterval:24},this.connectCount=0,this.reconnectCount=0,this.reconnectDelay=0}return f(e,[{key:"isConnected",get:function(){return this.client&&this.client.getConnectionState()===this.sb.ConnectionState.OPEN}},{key:"connect",value:function(e,t){var n=this,r=I.get(this.sb._iid).container,i=r.auth,a=r.apiClient,s=r.commandHandler;i.sessionToken=t||null;var o=this.cls.GroupChannel,l=null,u=new de.ConnectionHandler;this.client=new de(this.sb,u),u.onMessage=function(e){s.onRawCommandReceived(e)},this.sb.loginHandler=function(e,t){if(n.sb.connecting=!1,n.sb.reconnecting=!1,e)n.disconnect({clearSession:!0,err:e},null);else{clearInterval(n.sb.globalTimer);var r=function(){o.cachedChannels&&Object.keys(o.cachedChannels).forEach((function(e){var t=o.cachedChannels[e];t.invalidateTypingStatus()&&Object.keys(n.sb.channelHandlers).forEach((function(e){n.sb.channelHandlers[e].onTypingStatusUpdated(t)}))}))};r(),n.sb.globalTimer=setInterval((function(){return r()}),1e3),n.flushConnectionCallbacks(null,t),n.sb.ConnectionManager.processAllReadyHandler(null)}},u.onOpen=function(){n.connectCount=0,n.sb.loginTimer=setTimeout((function(){n.sb.loginTimer=null,n.sb.onLoginTimerCancel=null,n.flushConnectionCallbacks(new F("Connection timeout.",F.LOGIN_TIMEOUT),null),n.sb.disconnect(null)}),n.sb.Options.websocketResponseTimeout),n.sb.onLoginTimerCancel=function(){n.connectCount=0,n.flushConnectionCallbacks(new F("Connection has been canceled.",F.REQUEST_FAILED),null)},n.sb.connecting=!1},u.onError=function(r){J.debug("Connect: `WebSocketClient.ConnectionHandler.onError` called.",r),i.sessionKey?(n.sb.isReconnectingOnError=!0,n.sb.ConnectionManager.errorAllReadyHandler(),n.reconnect(e,!0),n.sb.connecting=!1):n.connectCount<n.connectParams.retryCount?(n.connectCount++,n.client.connect(e,t,l)):(n.connectCount=0,n.flushConnectionCallbacks(new F("Websocket connection failed.",F.WEBSOCKET_CONNECTION_FAILED),null),n.sb.connecting=!1)},u.onClose=function(){J.debug("Connect: `WebSocketClient.ConnectionHandler.onClose` called."),n.connectCount=0,n.sb.connecting=!1},a.checkRouting((function(r,i){if(r)return n.sb.connecting=!1,void n.flushConnectionCallbacks(new F("Connection routing failed.",F.REQUEST_FAILED),null);l=i.wsHost,a.dummyCall((function(e){e&&J.error("API dummy call failed:",e)})),n.client.connect(e,t,l)}))}},{key:"reconnect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=I.get(this.sb._iid).container,i=r.auth,a=r.apiClient,s=r.commandHandler,o=r.ackStateMap,l=r.sessionManager,u=this.cls.OpenChannel;if(this.sb.connecting=!1,this.sb.reconnecting=!0,this.sb.reconnectTimer)J.debug("Reconnect: still reconnecting.");else{if(this.reconnectCount+=1,this.reconnectCount<=1?(n&&(Object.keys(o).forEach((function(e){var t=o[e];t&&(clearTimeout(t.timer),(0,t.handler)(new F("Command received no ack.",F.ACK_TIMEOUT),null)),delete o[e]})),pe.of(this.sb._iid).invokeDisconnect(),Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectStarted()}))),this.reconnectDelay=0):this.reconnectDelay=Math.min(1e3*this.reconnectParams.interval*Math.pow(this.reconnectParams.multiplier,this.reconnectCount-2),this.reconnectParams.maxInterval>0?1e3*this.reconnectParams.maxInterval:Number.MAX_SAFE_INTEGER),!e||!i.sessionKey||this.reconnectParams.retryCount>0&&this.reconnectCount>this.reconnectParams.retryCount)return this.disconnect({clearSession:!1,err:new F("Websocket connection failed.",F.WEBSOCKET_CONNECTION_FAILED)},null),this.reconnectCount=0,Object.keys(this.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectFailed()})),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1,void this.sb.ConnectionManager.errorAllReadyHandler();this.sb.onReconnectTimerCancel=function(){t.reconnectCount=0},this.sb.reconnectTimer=setTimeout((function(){t.sb.reconnectTimer=null,t.sb.onReconnectTimerCancel=null,t.client&&t.client.disconnect(!0);var n=new de.ConnectionHandler;t.client=new de(t.sb,n),t.sb.loginHandler=function(n,r){n?l.isSessionError(n)?l.refreshSessionIfExpiredError(n).then((function(){clearTimeout(t.sb.reconnectTimer),t.sb.reconnectTimer=null,t.reconnectCount=0,t.reconnect(e,!1)})).catch((function(){})):(clearTimeout(t.sb.reconnectTimer),t.sb.reconnectTimer=null,t.reconnect(e,!1)):(t.reconnectCount=0,t.sb.connecting=!1,t.sb.reconnecting=!1,t.sb.isReconnectingOnError=!1,pe.of(t.sb._iid).invokeConnect(),Object.keys(t.sb.connectionHandlers).forEach((function(e){t.sb.connectionHandlers[e].onReconnectSucceeded()})),t.sb.ConnectionManager.processAllReadyHandler(null),t.sb.isReconnectingOnError&&Object.keys(t.sb.ConnectionManager.networkHandlers).forEach((function(e){t.sb.ConnectionManager.networkHandlers[e].onReconnected()})),Object.keys(u.enteredChannels).forEach((function(e){u.enteredChannels[e].enter((function(n,r){if(n){var i=t.cls.FileMessageQueue;delete u.enteredChannels[e],i.delete(e)}}))})))},n.onOpen=function(){J.debug("Reconnect: `WebSocketClient.ConnectionHandler.onOpen` called."),t.sb.loginTimer=setTimeout((function(){J.debug("Reconnect: `loginTimer` timeout."),t.sb.loginTimer=null,t.reconnect(e,!0)}),t.sb.Options.websocketResponseTimeout),t.sb.onLoginTimerCancel=null},n.onMessage=function(e){s.onRawCommandReceived(e)},n.onError=function(n){J.debug("Reconnect: `WebSocketClient.ConnectionHandler.onError` called.",n),t.sb.isReconnectingOnError=!0,t.sb.ConnectionManager.errorAllReadyHandler(),t.reconnect(e,!0)},n.onClose=function(){J.debug("Reconnect: `WebSocketClient.ConnectionHandler.onClose` called."),t.sb.reconnecting=!1},a.checkRouting((function(n,r){n?t.reconnect(e,!0):(t.sb.getCurrentApiHost()!==r.apiHost&&a.get("/",null,(function(){})),t.client.connect(e,null,r.wsHost))}))}),this.reconnectDelay)}}},{key:"disconnect",value:function(e,t){var n=I.get(this.sb._iid),r=n.container.ackStateMap,i=this.cls,a=i.GroupChannel,s=i.OpenChannel,o=e.clearSession,l=e.err;this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.onLoginTimerCancel&&(this.sb.onLoginTimerCancel(),this.sb.onLoginTimerCancel=null),this.sb.loginTimer=null),this.sb.reconnectTimer&&(clearTimeout(this.sb.reconnectTimer),this.sb.onReconnectTimerCancel&&(this.sb.onReconnectTimerCancel(),this.sb.onReconnectTimerCancel=null),this.sb.reconnectTimer=null),this.client&&(this.reconnectCount=0,this.client.disconnect(!0),this.client=null),o&&(s.clearEnteredChannels(),s.clearCache(),a.clearCache(),this.sb.globalTimer&&(clearInterval(this.sb.globalTimer),this.sb.globalTimer=null),Object.keys(r).forEach((function(e){clearTimeout(r[e].timer)})),this.sb.currentUser=null,n.set("ackStateMap",{}),n.set("subscribedUnreadMessageCount",{all:0,custom_types:{},ts:0}),n.set("auth",new H)),l&&(this.flushConnectionCallbacks(l,null),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1),t&&t(null,null)}},{key:"flushConnectionCallbacks",value:function(e,t){var n=this,r=I.get(this.sb._iid).container,i=r.store,a=r.localCacheEnabled,s=this.sb.connectionCallbacks;if(this.sb.connectionCallbacks=[],e)if(a){var o=this.sb._getCurrentUserDataKey();ae.isNonAutoReconnectableError(e.code)?i.remove(o).catch((function(e){return J.debug("Sendbird connect store remove error: ",e)})).finally((function(){return s.forEach((function(t){return t(e,null)}))})):i.get(o).then((function(e){n.sb._populateVaultFromCurrentUserData(e)})).catch((function(e){J.debug("Sendbird connect store fetch error: ",e)})).finally((function(){n.sb.currentUser?s.forEach((function(t){return t(e,n.sb.currentUser)})):s.forEach((function(t){return t(e,null)}))}))}else s.forEach((function(t){return t(e,null)}));else pe.of(this.sb._iid).invokeConnect(),a?i.set({key:this.sb._getCurrentUserDataKey(),value:this._createCurrentUserData(t),generation:1}).catch((function(e){return J.debug("Sendbird connect store write error: ",e)})).finally((function(){return s.forEach((function(e){return e(null,n.sb.currentUser)}))})):s.forEach((function(e){return e(null,t)}))}},{key:"_createCurrentUserData",value:function(e){var t=I.get(this.sb._iid).container,n=t.auth,r=t.maxUnreadCountOfSuperGroupChannel,i=t.profileImageEncryption,a=t.appInfo,s=t.connectedAt,o=t.firstConnectedAt,l=t.concurrentCallLimit,u=t.backOffDelay,c={currentUser:(e||this.sb.currentUser).serialize(),maxUnreadCountOfSuperGroupChannel:T.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,profileImageEncryption:!1};return n.sessionKey&&(c.sessionKey=n.sessionKey),n.eKey&&(c.eKey=n.eKey),r&&(c.maxUnreadCountOfSuperGroupChannel=r),i&&(c.profileImageEncryption=i),a&&(c.appInfo=a._objectify()),s&&o&&(c.connectedAt=s,c.firstConnectedAt=o),l&&u&&(c.concurrentCallLimit=l,c.backOffDelay=u),c}}]),e}(),ge=function(){function e(t){var n=t.type,r=t.nullable,i=void 0!==r&&r,a=t.optional,s=void 0!==a&&a,o=t.optionalIf,l=void 0===o?null:o,u=t.ignoreIf,c=void 0===u?null:u,h=t.defaultValue,f=void 0===h?null:h,p=t.constraint,y=void 0===p?null:p;d(this,e),this.type=n,this.nullable=i,this.optional=s,this.optionalIf=l,this.ignoreIf=c,this.defaultValue=f,this.constraint=y}return f(e,[{key:"isMatchingType",value:function(e){var t=function(t,n){return"string"==typeof n?c(t)===n||"array"===n&&Array.isArray(t)||"file"===n&&ae.isFile(t)||"null"===n&&null===t||"date"===n&&t instanceof Date:"function"==typeof n?t instanceof n:"object"===c(n)&&Object.keys(n).map((function(e){return n[e]})).indexOf(e)>-1};return t(e,this.type)||Array.isArray(this.type)&&this.type.some((function(n){return t(e,n)}))||this.nullable&&null===e}}],[{key:"parse",value:function(t,n){for(t=e.toArray(t);t.length>0&&void 0===t[t.length-1];)t.pop();var r=!1,i=null;"callback"===n[n.length-1].type&&("function"==typeof t[t.length-1]&&(i=t.pop()),n.pop(),r=!0);var a=[],s=null,o=0;return n.forEach((function(n){"function"==typeof n.ignoreIf&&n.ignoreIf(t)?a.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):n.isMatchingType(t[o])?(n.nullable&&null===t[o]||!n.constraint||n.constraint(t[o])||(s=e.error),a.push(t[o]),o++):n.optional||"function"==typeof n.optionalIf&&n.optionalIf(t)?a.push(n.hasOwnProperty("defaultValue")?n.defaultValue:null):(s=e.error,a.push(t[o]),o++)})),r&&i&&a.push(i),t.length!==o&&(s=e.error),[s].concat(a)}},{key:"error",get:function(){return new F("Invalid parameter.",F.INVALID_PARAMETER)}},{key:"toArray",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}}]),e}(),_e=function(){function e(t){d(this,e),this.sb=t,this.authCount=0,this.readyHandlers=[],this.networkHandlers={},this.authenticateTimer=1e4,this.authInfoRequester=null}return f(e,[{key:"addReadyHandler",value:function(e){e&&"function"==typeof e&&this.readyHandlers.push(e)}},{key:"ready",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=I.get(this.sb._iid).container,r=n.auth,i=n.isInBackground;t&&r.hasSession()?e&&(this.sb.currentUser?e(null,this.sb.currentUser):(this.addReadyHandler(e),this.errorAllReadyHandler()),this.sb.getConnectionState()!==this.sb.ConnectionState.CLOSED||i||this.sb.reconnect()):(this.addReadyHandler(e),this.sb.isReconnectingOnError?this.errorAllReadyHandler():this.sb.getConnectionState()===this.sb.ConnectionState.OPEN?this.processAllReadyHandler(null):this.sb.getConnectionState()===this.sb.ConnectionState.CONNECTING||this.errorAllReadyHandler())}},{key:"processAllReadyHandler",value:function(e){if(this.readyHandlers.length>0){var t=this.sb.currentUser,n=this.readyHandlers;this.readyHandlers=[],n.forEach((function(n){n&&"function"==typeof n&&n(e,t)}))}}},{key:"errorAllReadyHandler",value:function(){var e=I.get(this.sb._iid).container.auth;this.processAllReadyHandler(e&&e.hasSession()?new F("WebSocket connection must be made first.",F.WEBSOCKET_CONNECTION_CLOSED):new F("Connection should be made first.",F.CONNECTION_REQUIRED))}},{key:"NetworkHandler",value:function(){this.onReconnected=function(){}}},{key:"addNetworkHandler",value:function(e,t){this.networkHandlers[e]=t}},{key:"removeNetworkHandler",value:function(e){delete this.networkHandlers[e]}},{key:"removeAllNetworkHandler",value:function(){this.networkHandlers={}}},{key:"authenticate",value:function(e){var t=this;if(this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnecting)this.sb.connecting=!1,e(null,this.sb.currentUser);else if(this.authInfoRequester&&"function"==typeof this.authInfoRequester){this.sb.connecting=!0,this.authCount++;var n=setTimeout((function(){n=null,t.authCount--,0===t.authCount&&0===t.sb.connectionCallbacks.length&&(t.sb.connecting=!1),t.errorAllReadyHandler(),e(new F("Connection should be made first.",F.CONNECTION_REQUIRED),null)}),this.authenticateTimer);this.authInfoRequester((function(r){if(n){clearTimeout(n),n=null,t.authCount--;var i=function(n,r){t.sb.connecting=!1,e(n,null)};r&&r.hasOwnProperty("userId")?r.accessToken?r.apiHost&&r.wsHost?t.sb.connect(r.userId,r.accessToken,r.apiHost,r.wsHost,i):t.sb.connect(r.userId,r.accessToken,i):r.apiHost&&r.wsHost?t.sb.connect(r.userId,r.apiHost,r.wsHost,i):t.sb.connect(r.userId,i):e(ge.error,null)}}))}else e(ge.error,null)}}]),e}(),me=function(){this.onSessionExpired=function(){},this.onSessionTokenRequired=function(e,t){return e(null)},this.onSessionError=function(e){},this.onSessionRefreshed=function(){},this.onSessionClosed=function(){}},ve=function(){function e(){d(this,e),this.handler=null,this.resolvers=[]}return f(e,[{key:"_refreshSessionToken",value:function(){var t=this;return new Promise((function(n,r){var i=null,a=function(){i&&(clearTimeout(i),i=null)},s=function(){i&&(a(),r(e.sessionTokenRequestFailedError))};i=setTimeout((function(){return s()}),3e4),t.handler.onSessionTokenRequired((function(e){i&&(a(),n(e))}),s)}))}},{key:"_refreshSessionKey",value:function(){var t=this;return new Promise((function(n,r){var i=I.get(t._iid).container,a=i.auth,s=i.wsAdapter;a.sessionToken?s.isConnected?t._refreshSessionKeyByCommand().then((function(){return n()})).catch((function(e){e.isSessionTokenExpiredError?r(e):t._refreshSessionKeyByApi().then((function(){return n()})).catch((function(e){return r(e)}))})):t._refreshSessionKeyByApi().then((function(){return n()})).catch((function(e){return r(e)})):r(e.sessionTokenNotFoundError)}))}},{key:"_refreshSessionKeyByCommand",value:function(){var t=this;return new Promise((function(n,r){var i=Ri.getInstance(t._iid),a=I.get(t._iid).container.auth,s=j.get(t._iid).Command,o=s.bSessionRefresh({token:a.sessionToken,requestId:s.generateRequestId()});i.sendCommand(o,(function(t,s){if(!i.getErrorFirstCallback()){var o=[t,s];s=o[0],t=o[1]}t?r(t):s?s.hasOwnProperty("error")?r(e.sessionKeyRefreshFailedError):(s.hasOwnProperty("new_key")&&(a.sessionKey=s.new_key),n()):r(e.sessionKeyRefreshFailedError)}))}))}},{key:"_refreshSessionKeyByApi",value:function(){var t=this;return new Promise((function(n,r){!function i(a){if(a<3){var s=I.get(t._iid).container,o=s.auth,l=s.apiClient,u={};o.sessionToken&&(u.accessToken=o.sessionToken),l.refreshSessionKey(u,(function(e,t){if(e)e.isSessionTokenExpiredError||e.isSessionTokenRevokedError?r(e):i(a+1);else{var s=t.key;o.sessionKey=s,n()}}))}else r(e.sessionKeyRefreshFailedError)}(0)}))}},{key:"_handleSessionToken",value:function(t){var n=this;t?(I.get(this._iid).container.auth.sessionToken=t,this._refreshSessionKey().then((function(){return n._handleSessionRefreshSuccess()})).catch((function(){return n._handleSessionRefreshError(e.sessionTokenRequestFailedError)}))):this._handleSessionClosed(e.sessionTokenRequestFailedError)}},{key:"_handleSessionRefreshSuccess",value:function(){this.handler.onSessionRefreshed(),this._flushResolvers(null)}},{key:"_handleSessionRefreshError",value:function(e){this._cancelConnection(),this.handler.onSessionError(e),this._flushResolvers(e)}},{key:"_handleSessionClosed",value:function(e){this._cancelConnection(),this.handler.onSessionClosed(),this._flushResolvers(e)}},{key:"_cancelConnection",value:function(){var e=Ri.getInstance(this._iid);e.reconnecting&&(Object.keys(e.connectionHandlers).forEach((function(t){e.connectionHandlers[t].onReconnectFailed()})),e.reconnecting=!1),e.disconnect()}},{key:"_flushResolvers",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<this.resolvers.length;n++)e?this.resolvers[n].reject(e):this.resolvers[n].resolve(t);this.resolvers=[]}},{key:"setHandler",value:function(e){e instanceof me&&(this.handler=e)}},{key:"isSessionError",value:function(e){return e.isSessionTokenExpiredError||e.isSessionTokenRevokedError||e.isSessionKeyExpiredError}},{key:"refreshSessionToken",value:function(){var t=this;return new Promise((function(n,r){t.handler?(t.resolvers.push({resolve:n,reject:r}),1===t.resolvers.length&&t._refreshSessionToken().then((function(e){return t._handleSessionToken(e)})).catch((function(){return t._handleSessionRefreshError(e.sessionTokenRequestFailedError)}))):n()}))}},{key:"refreshSessionKey",value:function(){var e=this;return new Promise((function(t,n){e.handler?(e.resolvers.push({resolve:t,reject:n}),1===e.resolvers.length&&e._refreshSessionKey().then((function(){return e._handleSessionRefreshSuccess()})).catch((function(t){t.isSessionTokenExpiredError?e._refreshSessionToken().then((function(t){return e._handleSessionToken(t)})).catch((function(t){return e._handleSessionRefreshError(t)})):t.isSessionTokenRevokedError?e._handleSessionClosed(t):e._handleSessionRefreshError(t)}))):t()}))}},{key:"refreshSessionIfExpiredError",value:function(e){var t=this;return e.isSessionTokenExpiredError?this.refreshSessionToken():e.isSessionKeyExpiredError?this.refreshSessionKey():e.isSessionTokenRevokedError?new Promise((function(e,n){return n(t.closeSession())})):Promise.reject(e)}},{key:"closeSession",value:function(){var t=e.sessionTokenRequestFailedError;return this._handleSessionClosed(t),t}}],[{key:"sessionTokenNotFoundError",get:function(){return new F("Session token is not found.",F.SESSION_TOKEN_EXPIRED)}},{key:"sessionTokenExpiredError",get:function(){return new F("Session token is expired.",F.SESSION_TOKEN_EXPIRED)}},{key:"sessionKeyRefreshFailedError",get:function(){return new F("Failed to refresh the session key.",F.SESSION_KEY_REFRESH_FAILED)}},{key:"sessionTokenRequestFailedError",get:function(){return new F("Failed to get the session token.",F.SESSION_TOKEN_REQUEST_FAILED)}}]),e}(),Ee=function(){function e(t){d(this,e),this.sb=t}return f(e,[{key:"onlineWorker",value:function(){try{if("undefined"!=typeof navigator&&navigator.onLine){var e=I.get(this.sb._iid).container.auth;this.sb.reconnecting||this.sb.connecting||!e.sessionKey||this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnect()}}catch(e){J.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"offlineWorker",value:function(){try{if(this.sb.setIsProcessingAutoResend(!1),"undefined"!=typeof navigator&&!navigator.onLine){var e=I.get(this.sb._iid).container,t=e.auth,n=e.pinger;this.sb.reconnecting||this.sb.connecting||!t.sessionKey||(n&&n.stop(),this.sb.reconnect())}}catch(e){J.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"start",value:function(){try{"undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine&&(window.addEventListener("online",this.onlineWorker),window.addEventListener("offline",this.offlineWorker))}catch(e){J.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}},{key:"stop",value:function(){try{window.removeEventListener("online",this.onlineWorker,!1),window.removeEventListener("offline",this.offlineWorker,!1)}catch(e){J.debug("There is no `window.addEventListener.ononline` or `navigator.onLine`")}}}]),e}(),be=(new Date).getTime(),Ce=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(d(this,e),this.command=t,this.requestId=r,arguments.length){case 1:if(!t||t.length<=4)this.command="NOOP",this.payload="{}";else if(this.decode(t),this.isRequestIdCommand){var i=this.getJsonElement();i&&(this.requestId=i.req_id||"")}break;case 2:case 3:!this.requestId&&this.isRequestIdCommand&&(this.requestId=e.generateRequestId()),n.req_id=this.requestId||"",this.payload=JSON.stringify(n)}}return f(e,[{key:"isRequestIdCommand",get:function(){return this.isAckRequired||"EROR"===this.command}},{key:"isAckRequired",get:function(){return"LOGI"===this.command||"MESG"===this.command||"FILE"===this.command||"ENTR"===this.command||"EXIT"===this.command||"READ"===this.command||"MEDI"===this.command||"FEDI"===this.command}},{key:"encode",value:function(){return this.command+this.payload+"\n"}},{key:"decode",value:function(e){e=e.trim(),this.command=e.substring(0,4),this.payload=e.substring(4)}},{key:"getJsonElement",value:function(){return JSON.parse(this.payload)}}],[{key:"bSessionRefresh",value:function(e){return new this("LOGI",{token:e.token},e.requestId)}},{key:"bPing",value:function(){return new this("PING",{id:(new Date).getTime(),active:1})}},{key:"bMessage",value:function(e){var t=e.channelUrl,n=e.message,r=e.data,i=e.customType,a=e.metaArrays,s=e.mentionType,o=e.mentionedUserIds,l=e.translationTargetLanguages,u=e.pushNotificationDeliveryOption,c=e.appleCriticalAlertOptions,d=e.requestId,h=void 0===d?null:d,f=e.silent,p=void 0!==f&&f,y=e.rootMessageId,g=void 0===y?null:y,_=e.parentMessageId,m=void 0===_?null:_,v=e.pollId,E=e.isReplyToChannel,b=void 0!==E&&E,C=j.get(this._iid),S=C.UserMessageParams,N=C.BaseMessageParams,k={};return k.channel_url=t,k.message=n,k.data=r,a&&a.length>0&&(k.metaarray=a.map((function(e){return e.encode()}))),s&&(k.mention_type=s),k.mentioned_user_ids=[],s===N.MentionType.CHANNEL?k.mentioned_user_ids=[]:Array.isArray(o)&&o.length>0&&(k.mentioned_user_ids=o),i&&(k.custom_type=i),l&&l.length>0&&(k.target_langs=l),u&&u!==S.PushNotificationDeliveryOption.DEFAULT&&(k.push_option=u),c&&(k.apple_critical_alert_options=c.serialize()),p&&(k.silent=p),g&&(k.root_message_id=g),m&&(k.parent_message_id=m),"number"==typeof v?k.poll_id=v:null===v&&(k.poll_id=-1),b&&(k.reply_to_channel=b),new this("MESG",k,h)}},{key:"bFile",value:function(e){var t=e.channelUrl,n=e.url,r=e.name,i=e.type,a=e.size,s=e.data,o=e.customType,l=e.thumbnailSizes,u=e.requireAuth,c=e.metaArrays,d=e.mentionType,h=e.mentionedUserIds,f=e.pushNotificationDeliveryOption,p=e.appleCriticalAlertOptions,y=e.requestId,g=void 0===y?null:y,_=e.silent,m=void 0!==_&&_,v=e.rootMessageId,E=void 0===v?null:v,b=e.parentMessageId,C=void 0===b?null:b,S=e.isReplyToChannel,N=void 0!==S&&S,k=j.get(this._iid),A=k.BaseMessageParams,w=k.FileMessageParams,T={};return T.channel_url=t,T.url=n,T.name=r||"",T.type=i||"",T.size=a||0,T.custom=s,o&&(T.custom_type=o),l&&(T.thumbnails=l),u&&(T.require_auth=u),c&&c.length>0&&(T.metaarray=c.map((function(e){return e.encode()}))),d&&(T.mention_type=d),T.mentioned_user_ids=[],d===A.MentionType.CHANNEL?T.mentioned_user_ids=[]:Array.isArray(h)&&h.length>0&&(T.mentioned_user_ids=h),f&&f!==w.PushNotificationDeliveryOption.DEFAULT&&(T.push_option=f),p&&(T.apple_critical_alert_options=p.serialize()),m&&(T.silent=m),E&&(T.root_message_id=E),C&&(T.parent_message_id=C),N&&(T.reply_to_channel=N),new this("FILE",T,g)}},{key:"bUpdateUserMessage",value:function(e){var t=e.channelUrl,n=e.messageId,r=e.appleCriticalAlertOptions,i=e.message,a=void 0===i?null:i,s=e.data,o=void 0===s?null:s,l=e.customType,u=void 0===l?null:l,c=e.mentionType,d=void 0===c?null:c,h=e.mentionedUserIds,f=void 0===h?null:h,p=e.metaArrayParams,y=void 0===p?null:p,g=e.pollId,_=j.get(this._iid).BaseMessageParams,m={};return m.channel_url=t,m.msg_id=n,null!=a&&void 0!==a&&(m.message=a),null!=o&&void 0!==o&&(m.data=o),null!=u&&void 0!==u&&(m.custom_type=u),d&&(m.mention_type=d),d===_.MentionType.CHANNEL?m.mentioned_user_ids=[]:Array.isArray(f)&&f.length>0&&(m.mentioned_user_ids=f),y&&(m.metaarray=y),r&&(m.apple_critical_alert_options=r.serialize()),"number"==typeof g?m.poll_id=g:null===g&&(m.poll_id=-1),new this("MEDI",m)}},{key:"bUpdateFileMessage",value:function(e){var t=e.channelUrl,n=e.messageId,r=e.appleCriticalAlertOptions,i=e.data,a=void 0===i?null:i,s=e.customType,o=void 0===s?null:s,l=e.mentionType,u=void 0===l?null:l,c=e.mentionedUserIds,d=void 0===c?null:c,h=e.metaArrayParams,f=void 0===h?null:h,p=j.get(this._iid).BaseMessageParams,y={};return y.channel_url=t,y.msg_id=n,null!=a&&void 0!==a&&(y.data=a),null!=o&&void 0!==o&&(y.custom_type=o),u&&(y.mention_type=u),u===p.MentionType.CHANNEL?y.mentioned_user_ids=[]:Array.isArray(d)&&d.length>0&&(y.mentioned_user_ids=d),f&&(y.metaarray=f),r&&(y.apple_critical_alert_options=r.serialize()),new this("FEDI",y)}},{key:"bRead",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("READ",n)}},{key:"bMessageAck",value:function(e){var t=e.channelUrl,n=e.messageId,r={};return r.channel_url=t,r.msg_id=n,new this("MACK",r)}},{key:"bTypeStart",value:function(e){var t=e.channelUrl,n=e.time,r={};return r.channel_url=t,r.time=n,new this("TPST",r)}},{key:"bTypeEnd",value:function(e){var t=e.channelUrl,n=e.time,r={};return r.channel_url=t,r.time=n,new this("TPEN",r)}},{key:"bEnter",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("ENTR",n)}},{key:"bExit",value:function(e){var t=e.channelUrl,n={};return n.channel_url=t,new this("EXIT",n)}},{key:"generateRequestId",value:function(){return be++,String(be)}}]),e}(),Se=1048576,Ne=function(){function e(e){void 0===e&&(e={}),this._emojiHash=e.emoji_hash||"",this._uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*Se:Number.MAX_VALUE,this._useReaction=!!e.use_reaction,this._applicationAttributes=e.application_attributes||[],this._premiumFeatureList=e.premium_feature_list||[],this._disableSupergroupMack=e.disable_supergroup_mack||!1}return Object.defineProperty(e.prototype,"emojiHash",{get:function(){return this._emojiHash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uploadSizeLimit",{get:function(){return this._uploadSizeLimit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUsingReaction",{get:function(){return this._useReaction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationAttributes",{get:function(){return this._applicationAttributes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"premiumFeatureList",{get:function(){return this._premiumFeatureList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupergroupMackDisabled",{get:function(){return this._disableSupergroupMack},enumerable:!1,configurable:!0}),e.prototype._objectify=function(){var e={};return e.emoji_hash=this._emojiHash,this._uploadSizeLimit!==Number.MAX_VALUE&&(e.file_upload_size_limit=this._uploadSizeLimit/Se),e.use_reaction=this._useReaction,e.application_attributes=this._applicationAttributes,e.premium_feature_list=this._premiumFeatureList,e.disable_supergroup_mack=this._disableSupergroupMack,e},e}();!function(e){e[e.EVENT_CHANNEL_CHANGED=0]="EVENT_CHANNEL_CHANGED",e[e.EVENT_USER_RECEIVED_INVITATION=1]="EVENT_USER_RECEIVED_INVITATION",e[e.EVENT_USER_DECLINED_INVITATION=2]="EVENT_USER_DECLINED_INVITATION",e[e.EVENT_USER_JOINED=3]="EVENT_USER_JOINED",e[e.EVENT_USER_LEFT=4]="EVENT_USER_LEFT",e[e.EVENT_CHANNEL_ENTER=5]="EVENT_CHANNEL_ENTER",e[e.EVENT_CHANNEL_EXIT=6]="EVENT_CHANNEL_EXIT",e[e.EVENT_CHANNEL_FROZEN=7]="EVENT_CHANNEL_FROZEN",e[e.EVENT_CHANNEL_UNFROZEN=8]="EVENT_CHANNEL_UNFROZEN",e[e.EVENT_CHANNEL_HIDDEN=9]="EVENT_CHANNEL_HIDDEN",e[e.EVENT_CHANNEL_UNHIDDEN=10]="EVENT_CHANNEL_UNHIDDEN",e[e.EVENT_TYPING_STATUS_UPDATED=11]="EVENT_TYPING_STATUS_UPDATED",e[e.EVENT_OPERATOR_UPDATED=12]="EVENT_OPERATOR_UPDATED",e[e.EVENT_CHANNEL_METADATA_UPDATED=13]="EVENT_CHANNEL_METADATA_UPDATED",e[e.EVENT_CHANNEL_METADATA_DELETED=14]="EVENT_CHANNEL_METADATA_DELETED",e[e.EVENT_CHANNEL_METACOUNTER_UPDATED=15]="EVENT_CHANNEL_METACOUNTER_UPDATED",e[e.EVENT_CHANNEL_METACOUNTER_DELETED=16]="EVENT_CHANNEL_METACOUNTER_DELETED",e[e.EVENT_CHANNEL_DELETED=17]="EVENT_CHANNEL_DELETED",e[e.EVENT_USER_MUTED=18]="EVENT_USER_MUTED",e[e.EVENT_USER_UNMUTED=19]="EVENT_USER_UNMUTED",e[e.EVENT_USER_BANNED=20]="EVENT_USER_BANNED",e[e.EVENT_USER_UNBANNED=21]="EVENT_USER_UNBANNED",e[e.EVENT_MESSAGE_RECEIVED=22]="EVENT_MESSAGE_RECEIVED",e[e.EVENT_MESSAGE_SENT=23]="EVENT_MESSAGE_SENT",e[e.EVENT_MESSAGE_UPDATED=24]="EVENT_MESSAGE_UPDATED",e[e.EVENT_MESSAGE_DELETED=25]="EVENT_MESSAGE_DELETED",e[e.EVENT_READ_RECEIPT_UPDATED=26]="EVENT_READ_RECEIPT_UPDATED",e[e.EVENT_DELIVERY_RECEIPT_UPDATED=27]="EVENT_DELIVERY_RECEIPT_UPDATED",e[e.EVENT_MENTION=28]="EVENT_MENTION",e[e.EVENT_REACTION_UPDATED=29]="EVENT_REACTION_UPDATED",e[e.EVENT_THREAD_INFO_UPDATED=30]="EVENT_THREAD_INFO_UPDATED",e[e.CHANNEL_BACKGROUND=1e3]="CHANNEL_BACKGROUND",e[e.CHANNEL_CHANGELOG=1001]="CHANNEL_CHANGELOG",e[e.MESSAGE_BACKGROUND=1002]="MESSAGE_BACKGROUND",e[e.MESSAGE_FILL=1003]="MESSAGE_FILL",e[e.MESSAGE_CHANGELOG=1004]="MESSAGE_CHANGELOG",e[e.LOCAL_MESSAGE_PENDING_CREATED=2e3]="LOCAL_MESSAGE_PENDING_CREATED",e[e.LOCAL_MESSAGE_FAILED=2001]="LOCAL_MESSAGE_FAILED",e[e.LOCAL_MESSAGE_CANCELED=2002]="LOCAL_MESSAGE_CANCELED",e[e.LOCAL_MESSAGE_RESEND_STARTED=2003]="LOCAL_MESSAGE_RESEND_STARTED",e[e.MESSAGE_COLLECTION_FILTER_MISMATCH=2004]="MESSAGE_COLLECTION_FILTER_MISMATCH"}(he||(he={}));var ke,Ae={},we=function(){function e(){this._observers=[]}return e.of=function(t){return Ae[t]||(Ae[t]=new e),Ae[t]},e.prototype.addObserver=function(e){this._observers.push(e)},e.prototype.removeObserver=function(e){var t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)},e.prototype.send=function(e){for(var t=0,n=this._observers;t<n.length;t++)n[t].onevent(e)},e}(),Te=function(){function e(e){this._source=e}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFromEvent",{get:function(){return this._source>=2e3},enumerable:!1,configurable:!0}),e}(),Oe=function(){},Ie={NAME_ALPHABETICAL:["name","-pk"],CHRONOLOGICAL:["-createdAt","-pk"],LATEST_LAST_MESSAGE:["-lastMessageCreatedAt","-createdAt","-pk"]},Me={LATEST:["channelUrl","-createdAt","-messageId"],LATEST_UNSENT:["channelUrl","sendingStatus","createdAt"],CHILD_MESSAGE_FIRST:["channelUrl","-parentMessageId","-createdAt"]},Ue=function(){function e(e,t){this._source=e,this._sendingStatus=t}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFromEvent",{get:function(){return this._source>=2e3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sendingStatus",{get:function(){return this._sendingStatus},enumerable:!1,configurable:!0}),e}(),Re=function(){function e(){this.messageType="",this.customTypes=[],this.senderUserIds=[],this.sendingStatus=null}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){if(this.messageType&&this.messageType!==e.messageType)return!1;if(this.customTypes.length>0&&!this.customTypes.includes(e.customType))return!1;if(this.senderUserIds.length>0){if(!e.isUserMessage()&&!e.isFileMessage())return!1;if(!this.senderUserIds.includes(e.sender.userId))return!1}return!this.sendingStatus||this.sendingStatus===e.sendingStatus},e}(),Pe=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,i=Math.floor((n+r)/2);n<r;){var a=e[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((n+r)/2);else{if(!(a<0))return i;n=i+1,i=Math.floor((n+r)/2)}}return e[i].createdAt>t.createdAt?i:i+1}return e.length},Le=function(e){var t=e.channel,n=e.ts,r=e.prevLimit,i=void 0===r?0:r,a=e.nextLimit,s=void 0===a?0:a,o=e.filter,l={channel:t,token:n,tokenType:"timestamp",isInclusive:!0,prevResultSize:i,nextResultSize:s,shouldReverse:!1,includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeReplies:!0,includeParentMessageText:!0,showSubchannelMessagesOnly:!0};if(o){var u=o.messageType,c=o.customTypes,d=o.senderUserIds;u&&(l.messageType=u),c.length>0&&(l.customTypes=c),d.length>0&&(l.senderUserIds=d)}return l},De=function(e,t,n){if(n.length>0){var r=n.map((function(e){return e.createdAt}));t.includes("prev")&&(e.top=Math.min.apply(Math,D([e.top],r,!1))),t.includes("next")&&(e.bottom=Math.max.apply(Math,D([e.bottom],r,!1)))}},xe=function(e){return new Promise((function(t,n){setTimeout((function(){return t()}),e)}))},Fe={};!function(e){e.SUCCEEDED="succeeded",e.UNSENT="unsent"}(ke||(ke={}));var He,Ge=function(){function e(e){var t=e.iid,n=e.collections;this._iid=t,this._collections=n,Fe[t]=this}return e.of=function(e){return Fe[e]},e.prototype._serialize=function(e){return e.serialize()},e.prototype._deserialize=function(e){if(e){var t=R(R({},e),{messageId:parseInt(e.messageId)}),n=j.get(this._iid),r=n.UserMessage,i=n.FileMessage,a=n.AdminMessage;if("user"===t.messageType)return r.buildFromSerializedData(t);if("file"===t.messageType)return i.buildFromSerializedData(t);if("admin"===t.messageType)return a.buildFromSerializedData(t)}return null},e.deserialize=function(e,t){if(t){var n=R(R({},t),{messageId:parseInt(t.messageId)}),r=j.get(e),i=r.UserMessage,a=r.FileMessage,s=r.AdminMessage;if("user"===n.messageType)return i.buildFromSerializedData(n);if("file"===n.messageType)return a.buildFromSerializedData(n);if("admin"===n.messageType)return s.buildFromSerializedData(n)}return null},Object.defineProperty(e.prototype,"_localCacheEnabled",{get:function(){return I.get(this._iid).get("localCacheEnabled")},enumerable:!1,configurable:!0}),e.prototype._getMessageCollectionByType=function(e){return e?this._collections[e]:this._collections.succeeded},e.prototype._getIndexByCollection=function(e){return"UnsentMessage"===e.name?Me.LATEST_UNSENT:Me.LATEST},e.prototype._fetch=function(e,t,n){return P(this,void 0,void 0,(function(){var r,i,a=this;return L(this,(function(s){switch(s.label){case 0:return this._localCacheEnabled?(r={where:function(r){if(!r)return!1;if(e&&r.channelUrl!==e)return!1;if(n.parentMessageId&&r.parentMessageId!==n.parentMessageId)return!1;if(n.backward){if(r.createdAt<=n.token)return!1}else if(r.createdAt>=n.token)return!1;return!!t.match(a._deserialize(r))},index:n.index,backward:n.backward},[4,n.collection.query(r)]):[3,3];case 1:return[4,s.sent().fetch({limit:n.limit})];case 2:return i=s.sent(),[2,Promise.all(i.map((function(e){return P(a,void 0,void 0,(function(){var t,r,i;return L(this,(function(a){switch(a.label){case 0:return t=this._deserialize(e),(r=e.messageParams)&&r.file?(i=t._messageParams,[4,n.collection.getBlob(r.file)]):[3,2];case 1:i._file=a.sent(),a.label=2;case 2:return[2,t]}}))}))})))];case 3:return[2,[]]}}))}))},e.fetch=function(t,n,r){return P(this,void 0,void 0,(function(){var i,a,s=this;return L(this,(function(o){switch(o.label){case 0:return i={where:function(i){if(!i)return!1;if(r.backward){if(i.createdAt<=r.token)return!1}else if(i.createdAt>=r.token)return!1;return!!n.match(e.deserialize(t,i))},index:r.index,backward:r.backward},[4,r.collection.query(i)];case 1:return[4,o.sent().fetch({limit:r.limit})];case 2:return a=o.sent(),[2,Promise.all(a.map((function(n){return P(s,void 0,void 0,(function(){var i,a,s;return L(this,(function(o){switch(o.label){case 0:return i=e.deserialize(t,n),(a=n.messageParams)&&a.file&&se.isFileTypeBlob(a.fileType)&&"string"==typeof i._messageParams.file?(s=i._messageParams,[4,r.collection.getBlob(a.file)]):[3,2];case 1:s.file=o.sent(),o.label=2;case 2:return[2,i]}}))}))})))]}}))}))},e.prototype.get=function(e,t){return P(this,void 0,void 0,(function(){var n,r;return L(this,(function(i){switch(i.label){case 0:return this._localCacheEnabled?(n=this._getMessageCollectionByType(t),r=this._deserialize,[4,n.getByKey(e)]):[3,2];case 1:return[2,r.apply(this,[i.sent()])];case 2:return[2,null]}}))}))},e.prototype.getPreviousAndNextMessages=function(e,t,n,r,i){return void 0===r&&(r=30),P(this,void 0,void 0,(function(){var a,s;return L(this,(function(o){switch(o.label){case 0:return[4,this.getPreviousMessages(e,t,n,r/2,i)];case 1:return a=o.sent(),[4,this.getNextMessages(e,t,n,r/2,i)];case 2:return s=o.sent(),[2,function(e){for(var t=[],n={},r=0,i=e;r<i.length;r++){var a=i[r];a.messageId?n[a.messageId]||(n[a.messageId]=!0,t.push(a)):t.push(a)}return t}(D(D([],a,!0),s,!0))]}}))}))},e.prototype.getPreviousMessages=function(e,t,n,r,i){return void 0===r&&(r=30),P(this,void 0,void 0,(function(){var a;return L(this,(function(s){switch(s.label){case 0:return a=this._getMessageCollectionByType(i),[4,this._fetch(e,t,{token:n,limit:r,backward:!1,collection:a,index:this._getIndexByCollection(a)})];case 1:return[2,s.sent().reverse()]}}))}))},e.prototype.getNextMessages=function(e,t,n,r,i){return void 0===r&&(r=30),P(this,void 0,void 0,(function(){var a;return L(this,(function(s){switch(s.label){case 0:return a=this._getMessageCollectionByType(i),[4,this._fetch(e,t,{token:n,limit:r,backward:!0,collection:a,index:this._getIndexByCollection(a)})];case 1:return[2,s.sent()]}}))}))},e.prototype.getAllChildMessages=function(e,t,n){return P(this,void 0,void 0,(function(){return L(this,(function(r){switch(r.label){case 0:return[4,this._fetch(e.channelUrl,t,{token:Date.now(),limit:null,collection:n,backward:!1,index:Me.CHILD_MESSAGE_FIRST,parentMessageId:e.messageId})];case 1:return[2,r.sent()]}}))}))},e.prototype.getUnsentMessages=function(e,t){return P(this,void 0,void 0,(function(){var n;return L(this,(function(r){switch(r.label){case 0:return n=this._getMessageCollectionByType(ke.UNSENT),[4,this._fetch(e,t,{token:0,limit:null,collection:n,backward:!0,index:Me.LATEST_UNSENT})];case 1:return[2,r.sent()]}}))}))},e.prototype.getAllUnsentMessages=function(t){return P(this,void 0,void 0,(function(){var n;return L(this,(function(r){switch(r.label){case 0:return n=this._getMessageCollectionByType(ke.UNSENT),[4,e.fetch(this._iid,t,{token:Date.now(),limit:null,collection:n,backward:!1,index:Me.LATEST_UNSENT})];case 1:return[2,r.sent()]}}))}))},e.prototype.countBetween=function(e,t,n,r,i){return P(this,void 0,void 0,(function(){var a,s=this;return L(this,(function(o){switch(o.label){case 0:return this._localCacheEnabled?(a={where:function(i){return i.channelUrl===e&&!(n>i.createdAt||i.createdAt>r)&&t.match(s._deserialize(i))},index:Me.LATEST},[4,this._getMessageCollectionByType(i).query(a)]):[3,3];case 1:return[4,o.sent().count()];case 2:return[2,o.sent()];case 3:return[2,0]}}))}))},e.prototype._serializeMessages=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i=this;return L(this,(function(a){switch(a.label){case 0:return n=this._getMessageCollectionByType(t),r=[],[4,Promise.all(e.map((function(e){return P(i,void 0,void 0,(function(){var t,i;return L(this,(function(a){switch(a.label){case 0:return(t=e.serialize())?((t=R({},t)).messageParams&&(t.messageParams=R({},t.messageParams)),e.sendingStatus&&"succeeded"!==e.sendingStatus?t.messageId="unsent-"+e.reqId:t.messageId=""+e.messageId,e.isFileMessage()&&e._messageParams&&e._messageParams.file&&se.isBlob(e._messageParams.file)&&se.isFileTypeBlob(e._messageParams.fileType)?[4,n.saveBlob(e._messageParams.file,e.reqId)]:[3,2]):[3,3];case 1:i=a.sent(),t.messageParams.file=i,a.label=2;case 2:r.push(t),a.label=3;case 3:return[2]}}))}))})))];case 1:return a.sent(),[2,r]}}))}))},e.prototype.upsert=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i,a,s,o,l,u,c,d,h,f,p,y,g;return L(this,(function(_){switch(_.label){case 0:return this._localCacheEnabled?(n=Ri.getInstance(this._iid),r=this._getMessageCollectionByType(t),[4,this._serializeMessages(e,t)]):[3,13];case 1:return i=_.sent(),[4,r.upsertMany(i)];case 2:if(_.sent(),t&&t!==ke.SUCCEEDED)return[3,13];a=[],s=[],o=0,_.label=3;case 3:return o<e.length?(l=e[o]).sendingStatus&&l.sendingStatus===n.MessageSendingStatus.SUCCEEDED&&l.updatedAt>0?(c=(u=a).concat,[4,this._locallyUpdateChildMessages(l,ke.SUCCEEDED)]):[3,6]:[3,7];case 4:return a=c.apply(u,[_.sent()]),h=(d=s).concat,[4,this._locallyUpdateChildMessages(l,ke.UNSENT)];case 5:s=h.apply(d,[_.sent()]),_.label=6;case 6:return o++,[3,3];case 7:return a.length>0?(f=this._getMessageCollectionByType(ke.SUCCEEDED),[4,this._serializeMessages(a,ke.SUCCEEDED)]):[3,10];case 8:return p=_.sent(),[4,f.upsertMany(p)];case 9:_.sent(),_.label=10;case 10:return s.length>0?(y=this._getMessageCollectionByType(ke.UNSENT),[4,this._serializeMessages(s,ke.UNSENT)]):[3,13];case 11:return g=_.sent(),[4,y.upsertMany(g)];case 12:_.sent(),_.label=13;case 13:return[2]}}))}))},e.prototype._locallyUpdateChildMessages=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i;return L(this,(function(a){switch(a.label){case 0:return n=new Re,r=[],i=this._getMessageCollectionByType(t),[4,this.getAllChildMessages(e,n,i)];case 1:return a.sent().forEach((function(t){t.applyParentMessage(e)&&r.push(t)})),[2,r]}}))}))},e.prototype.remove=function(e,t){return P(this,void 0,void 0,(function(){return L(this,(function(n){switch(n.label){case 0:return this._localCacheEnabled?[4,xe(500)]:[3,3];case 1:return n.sent(),[4,this._getMessageCollectionByType(t).removeIf({messageId:{"/in":e.map((function(e){return""+e}))}})];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.removeUnsentMessages=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s;return L(this,(function(o){switch(o.label){case 0:return t=e.channelUrl,n=e.sendingStatus,r=e.reqIds,i=[],this._localCacheEnabled?[4,xe(500)]:[3,3];case 1:return o.sent(),a=this._getMessageCollectionByType(ke.UNSENT),s={channelUrl:{"=":t}},n&&(s.sendingStatus={"=":n}),r&&r.length>0&&(s.reqId={"/in":r}),[4,a.removeIf(s)];case 2:i=o.sent(),o.label=3;case 3:return[2,i]}}))}))},e.prototype.removeFailedMessages=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return n=[],this._localCacheEnabled?[4,xe(500)]:[3,3];case 1:return s.sent(),r=this._getMessageCollectionByType(ke.UNSENT),i=Ri.getInstance(this._iid),a={channelUrl:{"=":e},sendingStatus:{"=":i.MessageSendingStatus.FAILED}},t&&t.length>0&&(a.reqId={"/in":t}),[4,r.removeIf(a)];case 2:n=s.sent(),s.label=3;case 3:return[2,n]}}))}))},e.prototype.clearByChannelUrl=function(e){return P(this,void 0,void 0,(function(){var t=this;return L(this,(function(n){switch(n.label){case 0:return[4,Promise.all(Object.keys(ke).map((function(n){var r=t._getMessageCollectionByType(ke[n]),i={channelUrl:{"=":e}};return r.removeIf(i)})))];case 1:return n.sent(),[2]}}))}))},e.prototype.clear=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,this._getMessageCollectionByType(e).clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.clearAll=function(){return P(this,void 0,void 0,(function(){var e=this;return L(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,Promise.all(Object.keys(ke).map((function(t){return e.clear(ke[t])})))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.clearAbove=function(e,t){return P(this,void 0,void 0,(function(){return L(this,(function(n){switch(n.label){case 0:return this._localCacheEnabled?[4,this._getMessageCollectionByType(t).removeIf({createdAt:{"<":e}})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},e}(),je=function(){function e(e){var t=e.top,n=e.bottom;this.top=t,this.bottom=n}return e.prototype.include=function(e){return this.top<=e&&e<=this.bottom},e.prototype.overlap=function(e){return this.include(e.top)||this.include(e.bottom)},e}(),Ve={},Be=function(e,t){return"sendbird:"+e+"@channel/"+t+"/message/sync"},ze=function(){function e(e){var t=this,n=e.iid,r=e.channel,i=e.limit,a=void 0===i?Ze:i;this._prevSync=null,this._nextSync=null,this._syncRange=new je({top:Number.MAX_SAFE_INTEGER,bottom:-1}),this._isPrevSyncComplete=!1,this._isNextSyncComplete=!1,this._iid=n,this._channel=r,this._limit=a;var s=j.get(this._iid).BaseChannel,o=I.get(this._iid),l=o.get("currentUserId"),u=o.get("store"),c=o.get("apiClient"),d=Ge.of(this._iid),h=we.of(this._iid),f=Be(l,this._channel.url),p=o.container.concurrentCallLimit,y=o.container.backOffDelay;this._prevSync=new ct(f,(function(e){return P(t,void 0,void 0,(function(){var e,t,n,i,a,o,l,p,y,g=this;return L(this,(function(_){switch(_.label){case 0:return e={hasNext:!0,nextParams:null},[4,u.get(f)];case 1:return(t=_.sent())&&t.isPrevSyncComplete?[3,7]:(t&&(this._syncRange=t.range,this._isPrevSyncComplete=t.isPrevSyncComplete),n=Le({channel:this._channel,ts:this._syncRange.top,prevLimit:this._limit}),[4,c.getMessageList(n)]);case 2:return i=_.sent(),a=[],o=i.messages.map((function(e){var t=s.buildMessage(e,g._channel);return(t.isUserMessage()||t.isFileMessage())&&t._isSentByMe()&&a.push(t.reqId),t})),l=this.getMinCreatedAt(o),this._syncRange.top=Math.min(this._syncRange.top,l),this._syncRange.bottom<0&&(this._syncRange.bottom=this.getMaxCreatedAt(o)),this._isPrevSyncComplete=o.length<this._limit,J.debug("Message collection background sync fetched messages count: ",o.length),[4,d.upsert(o)];case 3:return _.sent(),a.length>0?[4,d.removeUnsentMessages({channelUrl:this._channel.url,reqIds:a})]:[3,5];case 4:_.sent(),_.label=5;case 5:return p={range:this._syncRange,isPrevSyncComplete:this._isPrevSyncComplete,isNextSyncComplete:t?t.isNextSyncComplete:this._isNextSyncComplete},[4,u.set({key:f,value:p,generation:1})];case 6:return _.sent(),y={source:he.MESSAGE_BACKGROUND,payload:{channel:r,messages:o}},h.send(y),e.hasNext=!this._isPrevSyncComplete,[3,8];case 7:J.debug("Message collection background sync has finished."),e.hasNext=!1,_.label=8;case 8:return[2,e]}}))}))}),p,y),this._nextSync=new ct(f,(function(e){return P(t,void 0,void 0,(function(){var e,t,n,i,a,o,l,p,y,g=this;return L(this,(function(_){switch(_.label){case 0:return e={hasNext:!0,nextParams:null},[4,u.get(f)];case 1:return(t=_.sent())?(this._syncRange=t.range,n=Le({channel:this._channel,ts:this._syncRange.bottom,nextLimit:this._limit}),[4,c.getMessageList(n)]):[3,7];case 2:return i=_.sent(),a=[],o=i.messages.map((function(e){var t=s.buildMessage(e,g._channel);return(t.isUserMessage()||t.isFileMessage())&&t._isSentByMe()&&a.push(t.reqId),t})),l=this.getMaxCreatedAt(o),this._syncRange.bottom=Math.max(this._syncRange.bottom,l),this._isNextSyncComplete=o.length<this._limit,[4,d.upsert(o)];case 3:return _.sent(),a.length>0?[4,d.removeUnsentMessages({channelUrl:this._channel.url,reqIds:a})]:[3,5];case 4:_.sent(),_.label=5;case 5:return p={range:this._syncRange,isPrevSyncComplete:t?t.isPrevSyncComplete:this._isPrevSyncComplete,isNextSyncComplete:this._isNextSyncComplete},[4,u.set({key:f,value:p,generation:1})];case 6:_.sent(),y={source:he.MESSAGE_BACKGROUND,payload:{channel:r,messages:o}},h.send(y),e.hasNext=!this._isNextSyncComplete,_.label=7;case 7:return[2,e]}}))}))}),p,y)}return e.of=function(t,n,r){return void 0===r&&(r=Ze),Ve[t]||(Ve[t]={}),Ve[t][n.url]||(Ve[t][n.url]=new e({iid:t,channel:n,limit:r})),Ve[t][n.url]},Object.defineProperty(e.prototype,"priority",{set:function(e){this._prevSync.priority=e,this._nextSync.priority=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this._syncRange},enumerable:!1,configurable:!0}),e.prototype.resume=function(){J.debug("Message collection background sync has resumed."),this._isPrevSyncComplete||this._prevSync.resume(null),this._isNextSyncComplete||this._nextSync.resume(null)},e.prototype.pause=function(){J.debug("Message collection background sync has paused."),this._prevSync.stop(),this._nextSync.stop()},e.prototype.getMinCreatedAt=function(e){var t=Number.MAX_SAFE_INTEGER;return e.forEach((function(e){var n=e.createdAt;n<t&&(t=n)})),t},e.prototype.getMaxCreatedAt=function(e){var t=0;return e.forEach((function(e){var n=e.createdAt;n>t&&(t=n)})),t},e}(),Ye={},qe=function(e,t){return"sendbird:"+e+"@channel/"+t+"/message/changelogs"},Ke=function(){function e(e){var t=this,n=e.iid,r=e.channel;this._token=0,this._sync=null,this._iid=n,this._channel=r;var i=j.get(this._iid).BaseChannel,a=I.get(this._iid),s=a.get("currentUserId"),o=a.get("store"),l=a.get("apiClient"),u=a.container.localCacheEnabled,c=Ge.of(this._iid),d=we.of(this._iid),h=qe(s,this._channel.url);this._sync=new ct(h,(function(e){return P(t,void 0,void 0,(function(){var e,t,n,s,f,p,y,g,_,m=this;return L(this,(function(v){switch(v.label){case 0:return e={hasNext:!0,nextParams:""},u?[4,o.get(h)]:[3,2];case 1:return n=v.sent(),[3,3];case 2:n=null,v.label=3;case 3:return t=n,this._token=t?t.token:a.get("firstConnectedAt")/1e3,s={channelUrl:this._channel.url,isOpenChannel:this._channel.isOpenChannel(),includeMetaArray:!1,includeReactions:!0,includeReplies:!0,includeParentMessageText:!0,includeThreadInfo:!0},"number"==typeof this._token?s.timestamp=this._token:s.token=this._token,[4,l.getMessageChangeLogs(s)];case 4:return f=v.sent(),p=f.updated.map((function(e){return i.buildMessage(e,m._channel)})),y={updatedMessages:p,deletedMessageIds:f.deleted.map((function(e){return parseInt(e.message_id)}))},e.hasNext=f.has_more,e.nextParams=this._token=f.next,u?(g=[],p.forEach((function(e){(e.isUserMessage()||e.isFileMessage())&&e._isSentByMe()&&g.push(e.reqId)})),g.length>0?[4,c.removeUnsentMessages({channelUrl:this._channel.url,reqIds:g})]:[3,6]):[3,10];case 5:v.sent(),v.label=6;case 6:return[4,c.upsert(p)];case 7:return v.sent(),[4,c.remove(y.deletedMessageIds)];case 8:return v.sent(),[4,o.set({key:h,value:{token:this._token},generation:1})];case 9:v.sent(),v.label=10;case 10:return J.debug("Message collection changelog sync update messages count: ",y.updatedMessages.length),J.debug("Message collection changelog sync deleted message ids count: ",y.deletedMessageIds.length),_={source:he.MESSAGE_CHANGELOG,payload:R({channel:r},y)},d.send(_),[2,e]}}))}))}))}return e.of=function(t,n){return Ye[t]||(Ye[t]={}),Ye[t][n.url]||(Ye[t][n.url]=new e({iid:t,channel:n})),Ye[t][n.url]},e.prototype.resume=function(){J.debug("Message collection changelog sync has resumed."),this._sync.resume(null,!0)},e.prototype.pause=function(){J.debug("Message collection changelog sync has paused."),this._sync.stop()},e}();!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api",e.CACHE_ONLY="cache_only"}(He||(He={}));var We,Qe=function(){function e(){this._onCacheResult=null,this._onApiResult=null}return e.prototype.invokeCacheResult=function(e,t){this._onCacheResult(e,t)},e.prototype.invokeApiResult=function(e,t){this._onApiResult(e,t)},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),$e=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},Je=function(){function e(){}return e.prototype.isNetworkConnected=function(){return!("undefined"==typeof navigator||!navigator.onLine)},e.ready=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){return"undefined"!=typeof navigator&&navigator&&"boolean"==typeof navigator.onLine?[2,navigator.onLine]:[2,new Promise((function(e,t){a.default.get("https://www.google.com").then((function(){return e(!0)})).catch((function(){return e(!1)}))}))]}))}))},e}();!function(e){e[e.BACKGROUND_SYNC_CLOSE=0]="BACKGROUND_SYNC_CLOSE",e[e.BACKGROUND_SYNC_OPEN=1]="BACKGROUND_SYNC_OPEN",e[e.FILL=2]="FILL",e[e.USER_CALL=3]="USER_CALL"}(We||(We={}));var Xe,Ze=100,et=new je({top:Number.MAX_SAFE_INTEGER,bottom:0}),tt=new Map,nt=function(e){return"sendbird@message/fill/"+e+"/"+$e()},rt=function(){function e(e){var t=this,n=e.iid,r=e.channel,i=e.startingPoint,a=e.filter,s=e.limit,o=void 0===s?100:s;this._hugeGapCheckTimer=null,this._messages=[],this._syncRange=new je(R({},et)),this._hasPrevious=!0,this._hasNext=!0,this._unsentMessages=[],this._iid=n,this._channel=r,this._startingPoint=i,this._filter=a,this._limit=o,this._syncLimit=Math.max(o,Ze),this._eventObserver={onevent:function(e){return P(t,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,this._handleEvent(e)];case 1:return t.sent(),[2]}}))}))}},this._eventHandler={onMessagesAdded:Oe,onMessagesUpdated:Oe,onMessagesDeleted:Oe,onChannelUpdated:Oe,onChannelDeleted:Oe,onHugeGapDetected:Oe};var l=I.get(this._iid);this._localCacheEnabled=l.container.localCacheEnabled,this._localCacheEnabled&&(this._backgroundSync=ze.of(this._iid,this._channel,this._syncLimit),this._backgroundSync.resume()),this._changelogSync=Ke.of(this._iid,this._channel),this._connectionObserver={onConnect:function(){t._checkHugeGap(),t._localCacheEnabled&&t._backgroundSync.resume(),t._changelogSync.resume()},onDisconnect:function(){return P(t,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return[4,Je.ready()];case 1:return e.sent()||(this._previousFillSync.stop(),this._nextFillSync.stop(),this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause()),[2]}}))}))}},this._previousFillSync=new ct(nt("prev"),(function(e){return P(t,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return[4,this._getRemoteMessages({ts:e,prevLimit:this._syncLimit})];case 1:return(t=i.sent()).length>0?(n=Math.min.apply(Math,t.map((function(e){return e.createdAt}))),this._syncRange.top=Math.min(this._syncRange.top,n),r=new Ue(he.MESSAGE_FILL,t[0].sendingStatus),this._addMessagesToView(t,{context:r}),[2,{hasNext:t.length<this._syncLimit||this._syncRange.top>=n,nextParams:this._syncRange.top}]):[2,{hasNext:!1,nextParams:0}]}}))}))})),this._nextFillSync=new ct(nt("next"),(function(e){return P(t,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return[4,this._getRemoteMessages({ts:e,nextLimit:this._syncLimit})];case 1:return(t=i.sent()).length>0?(n=Math.max.apply(Math,t.map((function(e){return e.createdAt}))),this._syncRange.bottom=Math.max(this._syncRange.bottom,n),r=new Ue(he.MESSAGE_FILL,t[0].sendingStatus),this._addMessagesToView(t,{context:r}),[2,{hasNext:t.length<this._syncLimit||this._syncRange.bottom<=n,nextParams:this._syncRange.bottom}]):[2,{hasNext:!1,nextParams:0}]}}))}))})),pe.of(this._iid).addObserver(this._connectionObserver)}return e.prototype._handleEvent=function(e){var t=e.source,n=e.payload,r=void 0===n?{}:n,i=Ri.getInstance(this._iid);switch(e.source){case he.MESSAGE_BACKGROUND:break;case he.MESSAGE_CHANGELOG:var a=r,s=a.channel,o=a.updatedMessages,l=a.deletedMessageIds;if(s&&s.url===this._channel.url){if(o&&o.length>0){this._removeMatchingUnsentMessagesFromView([o]);var u=new Ue(t,o[0].sendingStatus);this._addMessagesToView(o,{context:u})}l&&l.length>0&&(f=this._removeMessagesFromView(l,{})).length>0&&(u=new Ue(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,this._channel,f))}break;case he.LOCAL_MESSAGE_PENDING_CREATED:case he.LOCAL_MESSAGE_RESEND_STARTED:case he.LOCAL_MESSAGE_CANCELED:var c=r,d=(s=c.channel,c.message);u=new Ue(t,d.sendingStatus),s.url===this._channel.url&&this._upsertUnsentMessagesToView([d],{context:u});break;case he.EVENT_MESSAGE_SENT:var h=r;if(s=h.channel,d=h.message,s.url===this._channel.url){var f=this._removeMatchingUnsentMessagesFromView([d]);this._hasNext?f.length>0&&(u=new Ue(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,s,f)):(this._addMessagesToView([d],{}),u=new Ue(t,d.sendingStatus),f.length>0?this._eventHandler.onMessagesUpdated(u,s,[d]):this._eventHandler.onMessagesAdded(u,s,[d]))}break;case he.EVENT_MESSAGE_RECEIVED:var p=r;s=p.channel,d=p.message,s.url!==this._channel.url||this._hasNext||(u=new Ue(t,d.sendingStatus),this._addMessagesToView([d],{context:u}));break;case he.LOCAL_MESSAGE_FAILED:var y=r;s=y.channel,d=y.message,s.url===this._channel.url&&d.sendingStatus===i.MessageSendingStatus.FAILED&&(u=new Ue(t,d.sendingStatus),this._upsertUnsentMessagesToView([d],{context:u}));break;case he.EVENT_MESSAGE_UPDATED:var g=r;s=g.channel,d=g.message,s.url===this._channel.url&&(u=new Ue(t,d.sendingStatus),this._addMessagesToView([d],{context:u,isUpdateOnly:!0}));break;case he.EVENT_MESSAGE_DELETED:var _=r,m=(s=_.channel,_.messageId);s.url===this._channel.url&&(tt.delete(m),(f=this._removeMessagesFromView([m],{})).length>0&&(u=new Ue(t,f[0].sendingStatus),this._eventHandler.onMessagesDeleted(u,this._channel,f)));break;case he.EVENT_DELIVERY_RECEIPT_UPDATED:case he.EVENT_READ_RECEIPT_UPDATED:if((s=r.channel).isGroupChannel()){o=[];for(var v=0,E=this._messages;v<E.length;v++)d=E[v],(tt.get(d.messageId)||0)!==(w=this.channel.getUnreadMemberCount(d))&&(o.push(d),w>0?tt.set(d.messageId,w):tt.delete(d.messageId));o.length>0&&(u=new Ue(t,o[0].sendingStatus),this._eventHandler.onMessagesUpdated(u,s,o))}break;case he.EVENT_USER_LEFT:var b=I.get(this._iid),C=r,S=(s=C.channel,C.user),N=b.get("currentUserId");if(S.userId!==N){o=[];for(var k=0,A=this._messages;k<A.length;k++){var w;d=A[k],(tt.get(d.messageId)||0)!==(w=this.channel.getUnreadMemberCount(d))&&(o.push(d),w>0?tt.set(d.messageId,w):tt.delete(d.messageId))}o.length>0&&(u=new Ue(t,o[0].sendingStatus),this._eventHandler.onMessagesUpdated(u,s,o))}else u=new Te(t),this._eventHandler.onChannelDeleted(u,s.url);break;case he.EVENT_CHANNEL_CHANGED:case he.EVENT_USER_RECEIVED_INVITATION:case he.EVENT_USER_JOINED:case he.EVENT_CHANNEL_FROZEN:case he.EVENT_CHANNEL_UNFROZEN:case he.EVENT_CHANNEL_HIDDEN:case he.EVENT_CHANNEL_UNHIDDEN:case he.EVENT_USER_MUTED:case he.EVENT_USER_UNMUTED:case he.EVENT_TYPING_STATUS_UPDATED:case he.EVENT_OPERATOR_UPDATED:case he.EVENT_CHANNEL_METADATA_UPDATED:case he.EVENT_CHANNEL_METADATA_DELETED:case he.EVENT_CHANNEL_METACOUNTER_UPDATED:case he.EVENT_CHANNEL_METACOUNTER_DELETED:s=r.channel,u=new Te(t),this._eventHandler.onChannelUpdated(u,s);break;case he.EVENT_CHANNEL_DELETED:s=r.channel,u=new Te(t),this._eventHandler.onChannelDeleted(u,s.url)}},e.prototype._createRemoteMessageParams=function(e){var t=e.prevLimit,n=void 0===t?0:t,r=e.nextLimit,i=void 0===r?0:r,a=new(0,j.get(this._iid).MessageListParams);return a.isInclusive=!0,a.prevResultSize=n,a.nextResultSize=i,a.includeMetaArray=!0,a.includeReactions=!0,a.includeThreadInfo=!0,a.includeReplies=!0,a.includeParentMessageText=!0,a},e.prototype._getRemoteMessages=function(e){var t=e.ts,n=e.prevLimit,r=void 0===n?0:n,i=e.nextLimit,a=void 0===i?0:i;return P(this,void 0,void 0,(function(){var e,n,i,s;return L(this,(function(o){switch(o.label){case 0:return e=[],r>0?(i=this._createRemoteMessageParams({prevLimit:r,nextLimit:0}),[4,this._channel.getMessagesByTimestamp(t,i)]):[3,2];case 1:n=o.sent(),e=e.concat(n),this._hasPrevious=n.length>=r,o.label=2;case 2:return a>0?(i=this._createRemoteMessageParams({prevLimit:0,nextLimit:a}),[4,this._channel.getMessagesByTimestamp(t,i)]):[3,4];case 3:s=o.sent(),e=e.concat(s),this._hasNext=s.length>=a,o.label=4;case 4:return e.length>0?[4,this._upsertRemotelyFetchedMessages(e)]:[3,6];case 5:o.sent(),o.label=6;case 6:return[2,e]}}))}))},e.prototype._upsertRemotelyFetchedMessages=function(e,t){return void 0===t&&(t={}),P(this,void 0,void 0,(function(){var n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return n=t.context,r=void 0===n?null:n,i=Ge.of(this._iid),a=e.map((function(e){return e.reqId})),[4,i.removeUnsentMessages({channelUrl:this.channel.url,reqIds:a})];case 1:return s.sent(),this._removeMatchingUnsentMessagesFromView(e,{context:r}),[4,i.upsert(e,ke.SUCCEEDED)];case 2:return s.sent(),this._addMessagesToView(e,{context:r}),[2]}}))}))},e.prototype._checkHugeGap=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,y=this;return L(this,(function(g){switch(g.label){case 0:return g.trys.push([0,12,,13]),e=j.get(this._iid).BaseChannel,t=I.get(this._iid),n=t.get("apiClient"),this._messages.length>0?(r=Ge.of(this._iid),i={from:this._messages[0].createdAt,to:Math.min(this._syncRange.top,this._messages[this._messages.length-1].createdAt),cachedCount:0},a=i,[4,r.countBetween(this._channel.url,this._filter,i.from,i.to)]):[3,8];case 1:return a.cachedCount=g.sent(),s={from:Math.max(this._syncRange.bottom,this._messages[0].createdAt),to:this.hasNext?this._messages[this._messages.length-1].createdAt:Number.MAX_SAFE_INTEGER,cachedCount:0},o=s,[4,r.countBetween(this._channel.url,this._filter,s.from,s.to)];case 2:return o.cachedCount=g.sent(),l={iid:this._iid,channelUrl:this._channel.url,channelType:this._channel.channelType,filter:this._filter,previous:i,next:s},[4,n.checkMessageHugeGap(R(R({},l),l.filter))];case 3:return u=g.sent(),(c={isHugeGap:!!u.is_huge_gap,previousMessages:u.prev_messages.map((function(t){return e.buildMessage(t,y._channel)}))||[],previousHasMore:!!u.prev_hasmore,nextMessages:u.next_messages.map((function(t){return e.buildMessage(t,y._channel)}))||[],nextHasMore:!!u.next_hasmore}).isHugeGap?[3,6]:(h=D(D([],c.previousMessages,!0),c.nextMessages,!0),J.debug("Message collection non-huge gap message fill count: ",h.length),h.length>0?(f=new Ue(he.MESSAGE_FILL,h[0].sendingStatus),[4,this._upsertRemotelyFetchedMessages(h,{context:f})]):[3,5]);case 4:g.sent(),this._extendSyncRange(["prev"],c.previousMessages),this._extendSyncRange(["next"],c.nextMessages),c.previousHasMore&&this._previousFillSync.run(this._syncRange.top),c.nextHasMore&&this._nextFillSync.run(this._syncRange.bottom),g.label=5;case 5:return[3,7];case 6:setTimeout((function(){return y._eventHandler.onHugeGapDetected()}),10),g.label=7;case 7:return[3,11];case 8:return d=Math.floor(this._syncLimit/2),[4,this._getRemoteMessages({ts:this._startingPoint,prevLimit:d,nextLimit:d})];case 9:return(h=g.sent()).length>0?(f=new Ue(he.MESSAGE_FILL,h[0].sendingStatus),[4,this._upsertRemotelyFetchedMessages(h,{context:f})]):[3,11];case 10:g.sent(),this._extendSyncRange(["prev","next"],this._messages),g.label=11;case 11:return[3,13];case 12:return p=g.sent(),J.warn("Message collection huge gap checker error: ",p),this._hugeGapCheckTimer=setTimeout((function(){y._hugeGapCheckTimer=null,y._checkHugeGap()}),3e3),[3,13];case 13:return[2]}}))}))},e.prototype._extendSyncRange=function(e,t){if(t.length>0){var n=t.map((function(e){return e.createdAt}));e.includes("prev")&&(this._syncRange.top=Math.min.apply(Math,D([this._syncRange.top],n,!1))),e.includes("next")&&(this._syncRange.bottom=Math.max.apply(Math,D([this._syncRange.bottom],n,!1)))}},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._addMessagesToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=t.isUpdateOnly,a=void 0!==i&&i,s=Ri.getInstance(this._iid),o=[],l=[],u=[],c=0,d=e;c<d.length;c++){var h=d[c];if(h.sendingStatus===s.MessageSendingStatus.SUCCEEDED){var f=this._messages.map((function(e){return e.messageId})).indexOf(h.messageId);if(this._filter.match(h)){var p=this._channel.getUnreadMemberCount(h);if(tt.set(h.messageId,p),f>=0){if(l.push(h),this._messages[f]=h,h.updatedAt>0){var y=this._updateChildMessagesInView(h);l=l.concat(y)}}else if(!a){var g=Pe(this._messages,h);o.push(h),this._messages.splice(g,0,h)}}else f>=0&&(u.push(h),this._messages.splice(f,1))}}r&&(o.length>0&&this._eventHandler.onMessagesAdded(r,this._channel,o),l.length>0&&this._eventHandler.onMessagesUpdated(r,this._channel,l),u.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,u))},e.prototype._removeMessagesFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a],l=this._messages.map((function(e){return e.messageId})).indexOf(o);if(l>=0){var u=this._messages[l];i.push(u),this._messages.splice(l,1)}}return r&&i.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,i),i},e.prototype._upsertUnsentMessagesToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=[],s=[],o=0,l=e;o<l.length;o++){var u=l[o],c=this._unsentMessages.map((function(e){return e.reqId})).indexOf(u.reqId);if(this._filter.match(u))if(c>=0)a.push(u),this._unsentMessages[c]=u;else{var d=Pe(this._unsentMessages,u);i.push(u),this._unsentMessages.splice(d,0,u)}else c>=0&&(this._unsentMessages.splice(c,1),s.push(u))}r&&(i.length>0&&this._eventHandler.onMessagesAdded(r,this._channel,i),a.length>0&&this._eventHandler.onMessagesUpdated(r,this._channel,a),s.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,s))},e.prototype._removeMatchingUnsentMessagesFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a];if((o.isUserMessage()||o.isFileMessage())&&o._isSentByMe()){var l=this._unsentMessages.map((function(e){return e.reqId})).indexOf(o.reqId);if(l>=0){var u=this._unsentMessages[l];i.push(u),this._unsentMessages.splice(l,1)}}}return r&&i.length>0&&this._eventHandler.onMessagesDeleted(r,this._channel,i),i},e.prototype._removeFailedMessagesFromView=function(e){var t=Ri.getInstance(this._iid),n=[],r=[],i=this._unsentMessages.map((function(e){return e.reqId}));if(e)for(var a=0,s=e;a<s.length;a++){var o=s[a],l=i.indexOf(o.reqId);l>=0&&this._unsentMessages[l].sendingStatus===t.MessageSendingStatus.FAILED?n.push(this._unsentMessages[l]):r.push(this._unsentMessages[l])}else for(var u=0,c=this._unsentMessages;u<c.length;u++)(o=c[u]).sendingStatus===t.MessageSendingStatus.FAILED?n.push(o):r.push(o);return this._unsentMessages=r,n},e._processNextAutoResend=function(e){if(e.isCacheEnabled&&!e.isInBackground&&e.getConnectionState()===e.ConnectionState.OPEN)try{var t=e.getAutoResendQueue();if(t.length>0){e.getIsProcessingAutoResend()||(J.debug("Auto-resend queue started."),e.setIsProcessingAutoResend(!0));var n=t[0];J.debug("Processing auto-resend for message request id: ",n.reqId),j.get(e._iid).GroupChannel.getChannel(n.channelUrl,T.INTERNAL_CALL,(function(t,r){var i;if(e.getErrorFirstCallback()&&(r=(i=[t,r])[0],t=i[1]),r)throw r;n.isUserMessage()?t._autoResendUserMessage(n):n.isFileMessage()&&t._autoResendFileMessage(n)}))}else J.debug("Auto-resend queue finished."),e.setIsProcessingAutoResend(!1)}catch(t){J.warn("Process auto-resend error: ",t),e.setIsProcessingAutoResend(!1)}},e._completeCurrentAndProcessNextAutoResend=function(e,t){if(e.isCacheEnabled&&t._isAutoResendRegistered){var n=e.getAutoResendQueue();if(t.sendingStatus===e.MessageSendingStatus.SUCCEEDED||t.sendingStatus===e.MessageSendingStatus.FAILED&&!ae.isAutoResendableError(t.errorCode))n.length>0&&t.reqId===n[0].reqId&&(n.shift(),this._processNextAutoResend(e));else if(t.sendingStatus===e.MessageSendingStatus.PENDING){if(n.length>0&&n.map((function(e){return e.reqId})).indexOf(t.reqId)>-1)return;n.push(t),!e.getIsProcessingAutoResend()&&n.length>0&&this._processNextAutoResend(e)}}},e._processPendingMessages=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h;return L(this,(function(f){switch(f.label){case 0:return t=Ge.of(e._iid),n=we.of(e._iid),(r=new Re).sendingStatus=e.MessageSendingStatus.PENDING,[4,t.getAllUnsentMessages(r)];case 1:i=f.sent(),a=0,s=i,f.label=2;case 2:return a<s.length?(o=s[a],[4,e.GroupChannel.getChannel(o.channelUrl)]):[3,10];case 3:return l=f.sent(),o._isAutoResendRegistered?(u=(new Date).getTime(),c=o.createdAt+2592e5,u<=c?(-1===(d=e.getAutoResendQueue()).map((function(e){return e.reqId})).indexOf(o.reqId)&&d.push(o),[3,6]):[3,4]):[3,7];case 4:return J.debug("Auto-resend registered pending messaged expired. Expiration date: ",new Date(c).toLocaleString()),(h=o._clone()).sendingStatus=e.MessageSendingStatus.FAILED,h.requestState=e.MessageRequestState.FAILED,h._isAutoResendRegistered=!1,[4,t.upsert([h],ke.UNSENT)];case 5:f.sent(),n.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:l,message:h}}),f.label=6;case 6:return[3,9];case 7:return J.debug("Cached pending message is not auto-resend registered. Changing its sending status to failed: ",o.reqId),(h=o._clone()).sendingStatus=e.MessageSendingStatus.FAILED,h.requestState=e.MessageRequestState.FAILED,h.errorCode=F.ACK_TIMEOUT,[4,t.upsert([h],ke.UNSENT)];case 8:f.sent(),n.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:l,message:h}}),f.label=9;case 9:return a++,[3,2];case 10:return[2]}}))}))},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return this._messages},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){var e=Ri.getInstance(this._iid);return this._unsentMessages.filter((function(t){return t.sendingStatus===e.MessageSendingStatus.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){var e=Ri.getInstance(this._iid);return this._unsentMessages.filter((function(t){return t.sendingStatus===e.MessageSendingStatus.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startingPoint",{get:function(){return this._startingPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){var t=this,n=new Qe;this._messages=[],this._syncRange=new je(R({},et)),this._hasNext=!0,this._hasPrevious=!0;var r=Math.floor(this._limit/2),i=Ge.of(this._iid),a=we.of(this._iid);switch(e){case He.CACHE_ONLY:i.getPreviousAndNextMessages(this._channel.url,this._filter,this._startingPoint).then((function(e){return P(t,void 0,void 0,(function(){var t;return L(this,(function(r){switch(r.label){case 0:return[4,i.getUnsentMessages(this._channel.url,this._filter)];case 1:return t=r.sent(),this._upsertUnsentMessagesToView(t),this._addMessagesToView(e),n.invokeCacheResult(null,e),[2]}}))}))})).catch((function(e){n.invokeCacheResult(e,null)})).finally((function(){a.addObserver(t._eventObserver)}));break;case He.CACHE_AND_REPLACE_BY_API:i.getPreviousAndNextMessages(this._channel.url,this._filter,this._startingPoint).then((function(e){return P(t,void 0,void 0,(function(){var t;return L(this,(function(r){switch(r.label){case 0:return[4,i.getUnsentMessages(this._channel.url,this._filter)];case 1:return t=r.sent(),this._upsertUnsentMessagesToView(t),this._addMessagesToView(e),n.invokeCacheResult(null,e),[2]}}))}))})).catch((function(e){n.invokeCacheResult(e,null)})).finally((function(){t._getRemoteMessages({ts:t._startingPoint,prevLimit:r,nextLimit:r}).then((function(e){t._messages=[],t._addMessagesToView(e),t._extendSyncRange(["prev","next"],t._messages),n.invokeApiResult(null,e)})).catch((function(e){n.invokeApiResult(e,null)})).finally((function(){a.addObserver(t._eventObserver)}))}))}return n},e.prototype.loadPrevious=function(){return P(this,void 0,void 0,(function(){var e,t;return L(this,(function(n){switch(n.label){case 0:return this._hasPrevious?(e=this._messages.length>0?Math.min.apply(Math,this._messages.map((function(e){return e.createdAt}))):Number.MAX_SAFE_INTEGER,[4,Je.ready()]):[3,5];case 1:return n.sent()?[3,3]:(J.debug("Message collection loadPrevious() from the cache."),[4,Ge.of(this._iid).getPreviousMessages(this._channel.url,this._filter,e,this._limit)]);case 2:return t=n.sent(),this._addMessagesToView(t),[2,t];case 3:return J.debug("Message collection loadPrevious() from the server."),[4,this._getRemoteMessages({ts:e,prevLimit:this._limit})];case 4:return t=n.sent(),this._addMessagesToView(t),De(this._syncRange,["prev"],this._messages),[2,t];case 5:return[2,[]]}}))}))},e.prototype.loadNext=function(){return P(this,void 0,void 0,(function(){var e,t;return L(this,(function(n){switch(n.label){case 0:return this._hasNext?(e=this._messages.length>0?Math.max.apply(Math,this._messages.map((function(e){return e.createdAt}))):0,[4,Je.ready()]):[3,5];case 1:return n.sent()?[3,3]:(J.debug("Message collection loadNext() from the cache."),[4,Ge.of(this._iid).getNextMessages(this._channel.url,this._filter,e,this._limit)]);case 2:return t=n.sent(),this._addMessagesToView(t),[2,t];case 3:return J.debug("Message collection loadNext() from the server."),[4,this._getRemoteMessages({ts:e,nextLimit:this._limit})];case 4:return t=n.sent(),this._addMessagesToView(t),De(this._syncRange,["next"],this._messages),[2,t];case 5:return[2,[]]}}))}))},e.prototype.removeFailedMessages=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i;return L(this,(function(a){switch(a.label){case 0:return t=Ri.getInstance(this._iid),n=Ge.of(this._iid),r=e.map((function(e){return e.reqId})),[4,n.removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:t.MessageSendingStatus.FAILED,reqIds:r})];case 1:return i=a.sent(),this._removeFailedMessagesFromView(e),[2,i]}}))}))},e.prototype.removeAllFailedMessages=function(){return P(this,void 0,void 0,(function(){var e;return L(this,(function(t){switch(t.label){case 0:return e=Ri.getInstance(this._iid),[4,Ge.of(this._iid).removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:e.MessageSendingStatus.FAILED})];case 1:return t.sent(),this._removeFailedMessagesFromView(),[2]}}))}))},e.prototype.dispose=function(){this._localCacheEnabled&&(this._previousFillSync.stop(),this._nextFillSync.stop(),this._backgroundSync.pause()),this._changelogSync.pause(),pe.of(this._iid).removeObserver(this._connectionObserver),this._hugeGapCheckTimer&&(clearTimeout(this._hugeGapCheckTimer),this._hugeGapCheckTimer=null),we.of(this._iid).removeObserver(this._eventObserver)},e.prototype.setMessageCollectionHandler=function(e){this._eventHandler=e},e}(),it=new Map,at=new Map,st=new Map,ot=function(){function e(t){var n=this,r=t.key,i=t.concurrentCallLimit,a=void 0===i?2:i,s=t.backOffDelay,o=void 0===s?0:s;this._holdersKey=e.createSemaphoreHoldersKey(r),this._resolversKey=e.createSemaphoreResolversKey(r),this._chainProcessStateKey=e.createChainProcessStateKey(r),this._numLocks=a,this._backOffDelay=o,this._localAcquiredKeys=[],this._localResolversData=[],ee()?(it[this._holdersKey]||(it[this._holdersKey]=[]),at[this._resolversKey]||(at[this._resolversKey]=[])):(window.addEventListener("storage",(function(e){return P(n,void 0,void 0,(function(){var t,n;return L(this,(function(r){if(this._localResolversData.length>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()&&this._hasHighestPriorityResolver())switch(e.key){case this._holdersKey:if(t=JSON.parse(e.oldValue),n=JSON.parse(e.newValue),!t||!n||n.length>=t.length)return[2];this._processChainResolve();break;case this._chainProcessStateKey:if(JSON.parse(e.newValue))return[2];this._processChainResolve();break;default:return[2]}return[2]}))}))})),window.addEventListener("beforeunload",(function(){var e=n._getLocalResolversData(),t=n._localResolversData.map((function(e){return e.key})),r=e.filter((function(e){return t.indexOf(e.key)<0}));r.length>0?window.localStorage.setItem(n._resolversKey,JSON.stringify(r)):window.localStorage.removeItem(n._resolversKey),n._localAcquiredKeys.forEach((function(e){return n.release(e)}))})))}return e.createSemaphoreHoldersKey=function(e){return"collection@semaphore_holders_for:"+e},e.createSemaphoreResolversKey=function(e){return"collection@semaphore_resolvers_for:"+e},e.createChainProcessStateKey=function(e){return"collection@semaphore_chain_process_state_for:"+e},Object.defineProperty(e.prototype,"numLocks",{get:function(){return this._numLocks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backOffDelay",{get:function(){return this._backOffDelay},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numLocksAvailable",{get:function(){if(ee())return this.numLocks-it[this._holdersKey].length;var e=this._getLocalHoldersData();return this.numLocks-e.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitCount",{get:function(){return ee()?at[this._resolversKey].length:this._getLocalResolversData().length},enumerable:!1,configurable:!0}),e.prototype._hasHighestPriorityResolver=function(){var e=this._getLocalResolversData();return e.length>0&&this._localResolversData.map((function(e){return e.key})).indexOf(e[0].key)>=0},e.prototype._isProcessChainAcquireRunning=function(){if(ee())return st[this._chainProcessStateKey];var e=window.localStorage[this._chainProcessStateKey];return void 0!==e&&JSON.parse(e)},e.prototype._setProcessChainAcquireRunning=function(e){ee()?st[this._chainProcessStateKey]=e:e?window.localStorage.setItem(this._chainProcessStateKey,JSON.stringify(e)):window.localStorage.removeItem(this._chainProcessStateKey)},e.prototype._processChainResolve=function(){return P(this,void 0,void 0,(function(){var e;return L(this,(function(t){switch(t.label){case 0:return this.waitCount>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()?(this._setProcessChainAcquireRunning(!0),this._tryResolve()?[4,(n=this._backOffDelay,P(void 0,void 0,void 0,(function(){return L(this,(function(e){return[2,new Promise((function(e){return setTimeout(e,n)}))]}))})))]:[3,2]):[3,3];case 1:t.sent(),t.label=2;case 2:this._setProcessChainAcquireRunning(!1),ee()?this._processChainResolve():(e=new StorageEvent("storage",{key:this._chainProcessStateKey,oldValue:JSON.stringify(!0),newValue:JSON.stringify(!1)}),dispatchEvent(e)),t.label=3;case 3:return[2]}var n}))}))},e.prototype.acquire=function(e){return void 0===e&&(e=We.BACKGROUND_SYNC_CLOSE),P(this,void 0,void 0,(function(){var t,n=this;return L(this,(function(r){return ee()?[2,new Promise((function(t){var r={key:$e(),resolver:function(e){return t(e)},priority:e};switch(e){case We.USER_CALL:case We.FILL:case We.BACKGROUND_SYNC_OPEN:for(var i=at[n._resolversKey],a=-1,s=0;s<i.length&&a<0;s++)e>i[s].priority&&(a=s);if(a>=0){at[n._resolversKey].splice(a,0,r);break}case We.BACKGROUND_SYNC_CLOSE:at[n._resolversKey].push(r)}n._processChainResolve()}))]:(t=this._getLocalResolversData(),[2,new Promise((function(r){var i=$e(),a={key:i,priority:e},s={key:i,resolver:function(e){return r(e)},priority:e};switch(e){case We.USER_CALL:case We.FILL:case We.BACKGROUND_SYNC_OPEN:for(var o=-1,l=0;l<t.length&&o<0;l++)e>t[l].priority&&(o=l);if(o>=0){t.splice(o,0,a),window.localStorage.setItem(n._resolversKey,JSON.stringify(t)),n._localResolversData.splice(o,0,s);break}case We.BACKGROUND_SYNC_CLOSE:t.push(a),window.localStorage.setItem(n._resolversKey,JSON.stringify(t)),n._localResolversData.push(s)}n._processChainResolve()}))])}))}))},e.prototype.release=function(e){if(ee()){if((t=it[this._holdersKey].indexOf(e))>=0)return it[this._holdersKey].splice(t,1),this._processChainResolve(),!0}else{var t,n=JSON.parse(window.localStorage[this._holdersKey]),r=D([],n,!0);if((t=n.indexOf(e))>=0){n.splice(t,1),n.length>0?window.localStorage.setItem(this._holdersKey,JSON.stringify(n)):window.localStorage.removeItem(this._holdersKey),this._localAcquiredKeys.splice(this._localAcquiredKeys.indexOf(e),1);var i=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(r),newValue:JSON.stringify(n)});return dispatchEvent(i),!0}}return!1},e.prototype._tryResolve=function(){if(ee()){if(it[this._holdersKey].length<this.numLocks){var e=$e();return it[this._holdersKey]=D(D([],it[this._holdersKey],!0),[e],!1),(n=at[this._resolversKey].shift()).resolver(e),!0}}else{var t=this._getLocalHoldersData();if(t.length<this.numLocks){e=$e();var n=this._localResolversData.shift(),r=this._getLocalResolversData(),i=r.map((function(e){return e.key})).indexOf(n.key);r.splice(i,1),r.length>0?window.localStorage.setItem(this._resolversKey,JSON.stringify(r)):window.localStorage.removeItem(this._resolversKey),window.localStorage.setItem(this._holdersKey,JSON.stringify(D(D([],t,!0),[e],!1))),this._localAcquiredKeys.push(e);var a=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(D([],t,!0)),newValue:JSON.stringify(D(D([],t,!0),[e],!1))});return dispatchEvent(a),(0,n.resolver)(e),!0}}return!1},e.prototype._getLocalHoldersData=function(){var e=window.localStorage[this._holdersKey];return void 0!==e?JSON.parse(e):[]},e.prototype._getLocalResolversData=function(){var e=window.localStorage[this._resolversKey];return void 0!==e?JSON.parse(e):[]},e}();!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(Xe||(Xe={}));var lt,ut=function(){},ct=function(){function e(e,t,n,r){void 0===n&&(n=2),void 0===r&&(r=10),this._worker=null,this._state=Xe.IDLE,this._retryCount=0,this._retryLimit=3,this._isPaused=!1,this.priority=We.BACKGROUND_SYNC_CLOSE,this.onProgress=ut,this.onStop=ut,this.onError=ut,this.onEnd=ut,this._key=e,this._worker=t,this._semaphore=new ot({key:e,concurrentCallLimit:n,backOffDelay:r})}return Object.defineProperty(e.prototype,"isIdle",{get:function(){return this._state===Xe.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._state===Xe.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDone",{get:function(){return this._state===Xe.END},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),e.prototype.resume=function(e,t){return void 0===t&&(t=!1),this._isPaused=!1,this.isDone&&t&&(this._state=Xe.IDLE),this.run(e)},e.prototype.run=function(e){return P(this,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return this._isPaused||!this.isIdle?[3,5]:(t=this,[4,this._semaphore.acquire(this.priority)]);case 1:t._key=i.sent(),this._state=Xe.RUNNING,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._worker(e)];case 3:return n=i.sent(),this._retryCount=0,this.onProgress(n),n.hasNext?(this._state=Xe.IDLE,this._isPaused?(this._semaphore.release(this._key),this.onStop()):(this.run(n.nextParams),this._semaphore.release(this._key))):(this._state=Xe.END,this._semaphore.release(this._key),this.onEnd(),this._isPaused&&this.onStop()),[3,5];case 4:return r=i.sent(),J.warn("Collection sync run error: ",r),this._state=Xe.IDLE,this._semaphore.release(this._key),this.onError(r),this._retryCount<this._retryLimit?(this._retryCount++,J.debug("Failed collection sync retry count: ",this._retryCount),this.run(e)):(J.debug("Failed collection sync all retries failed."),this.stop(),this.onStop()),[3,5];case 5:return[2]}}))}))},e.prototype.stop=function(){this._isPaused=!0},e}(),dt={},ht=function(){function e(e){var t=this,n=e.iid,r=e.limit,i=void 0===r?vt:r;this._token="",this._sync=null,this._syncRange=new je({top:Number.MAX_SAFE_INTEGER,bottom:0}),this._completed=!1,this._pkIndex=Date.now(),this._iid=n,this._limit=i;var a=j.get(this._iid).GroupChannel,s=I.get(this._iid),o=s.get("currentUserId"),l=s.get("apiClient"),u=s.get("store"),c=Ct.of(this._iid),d=we.of(this._iid),h="sendbird:"+o+"@groupchannel/sync";this._sync=new ct(h,(function(e){return P(t,void 0,void 0,(function(){var e,t,n,r,i,s,o=this;return L(this,(function(f){switch(f.label){case 0:return e={hasNext:!0,nextParams:""},[4,u.get(h)];case 1:return(t=f.sent())&&t.completed?[3,5]:(t&&(this._token=t.token,this._syncRange=t.range,this._pkIndex=t.primaryKeyIndex),n={token:this._token,limit:this._limit,includeEmpty:!0,order:"chronological"},[4,l.loadGroupChannelList(n)]);case 2:return r=f.sent(),i=r.channels.map((function(e){return r.ts&&(e.ts=r.ts),e.cached_primary_key=o._pkIndex--,a.upsert(e)})),this._syncRange.top=Math.min(this._syncRange.top,Math.min.apply(Math,i.map((function(e){return e.createdAt})))),this._syncRange.bottom=Math.max(this._syncRange.bottom,Math.max.apply(Math,i.map((function(e){return e.createdAt})))),e.hasNext=i.length>=this._limit,e.nextParams=this._token=r.next,this._token||(e.hasNext=!1),this._completed=!e.hasNext,J.debug("Group channel collection background sync fetched channels count: ",i.length),[4,c.upsert(i)];case 3:return f.sent(),[4,u.set({key:h,value:{token:this._token,range:this._syncRange,completed:this._completed,primaryKeyIndex:this._pkIndex},generation:1})];case 4:return f.sent(),s={source:he.CHANNEL_BACKGROUND,payload:{channels:i}},d.send(s),[3,6];case 5:J.debug("Group channel collection background sync has finished."),e.hasNext=!1,f.label=6;case 6:return[2,e]}}))}))}))}return e.of=function(t,n){return void 0===n&&(n=vt),dt[t]||(dt[t]=new e({iid:t,limit:n})),dt[t]},Object.defineProperty(e.prototype,"range",{get:function(){return this._syncRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){return this._completed},enumerable:!1,configurable:!0}),e.prototype.resume=function(){J.debug("Group channel collection background sync has resumed."),this._sync.resume("")},e.prototype.pause=function(){J.debug("Group channel collection background sync has paused."),this._sync.stop()},e}(),ft={},pt=function(){function e(e){var t=this,n=e.iid;this._token=0,this._sync=null,this._pkIndex=Date.now(),this._iid=n;var r=j.get(this._iid).GroupChannel,i=I.get(this._iid);this._token=i.get("firstConnectedAt")/1e3;var a=i.get("currentUserId"),s=i.get("store"),o=i.get("apiClient"),l=i.container.localCacheEnabled,u=Ct.of(this._iid),c=we.of(this._iid),d="sendbird:"+a+"@groupchannel/changelogs";this._sync=new ct(d,(function(e){return P(t,void 0,void 0,(function(){var e,t,n,i,a,h,f,p=this;return L(this,(function(y){switch(y.label){case 0:return e={hasNext:!0,nextParams:""},l?[4,s.get(d)]:[3,2];case 1:return n=y.sent(),[3,3];case 2:n=null,y.label=3;case 3:return(t=n)&&(this._token=t.token,this._pkIndex=t.primaryKeyIndex),i={},"number"==typeof this._token?i.ts=this._token:i.token=this._token,[4,o.getMyGroupChannelChangeLogs(i)];case 4:return a=y.sent(),h={updatedChannels:a.updated.map((function(e){return e.cached_primary_key=p._pkIndex--,new r(e)})),deletedChannelUrls:a.deleted},e.hasNext=a.has_more,e.nextParams=this._token=a.next,J.debug("Group channel collection changelog sync update channels count: ",h.updatedChannels.length),J.debug("Group channel collection changelog sync deleted channel urls count: ",h.deletedChannelUrls.length),l?[4,u.upsert(h.updatedChannels)]:[3,8];case 5:return y.sent(),[4,u.remove(h.deletedChannelUrls)];case 6:return y.sent(),[4,s.set({key:d,value:{token:this._token,primaryKeyIndex:this._pkIndex},generation:1})];case 7:y.sent(),y.label=8;case 8:return f={source:he.CHANNEL_CHANGELOG,payload:h},c.send(f),[2,e]}}))}))}))}return e.of=function(t){return ft[t]||(ft[t]=new e({iid:t})),ft[t]},e.prototype.resume=function(){J.debug("Group channel collection changelog sync has resumed."),this._sync.resume(0,!0)},e.prototype.pause=function(){J.debug("Group channel collection changelog sync has paused."),this._sync.stop()},e}(),yt=function(e,t){for(var n=0;n<e.length;n++)if(e[n].url===t.url)return n;return-1},gt=function(e,t,n){if(e.length>0){for(var r=0,i=e.length-1,a=Math.floor((r+i)/2);r<i;){var s=mt(e[a],t,n);if(s>0)i=a,a=Math.floor((r+i)/2);else{if(!(s<0))return a;r=a+1,a=Math.floor((r+i)/2)}}return mt(e[a],t,n)>0?a:a+1}return e.length},_t=function(e,t){return t-e},mt=function(e,t,n){switch(n){case lt.LATEST_LAST_MESSAGE:if(e.lastMessage&&!t.lastMessage)return-1;if(!e.lastMessage&&t.lastMessage)return 1;if(e.lastMessage&&t.lastMessage){var r=e.lastMessage.createdAt;if(0===(a=t.lastMessage.createdAt-r)){var i=e.createdAt;0===(a=t.createdAt-i)&&(a=_t(e.cachedPrimaryKey,t.cachedPrimaryKey))}return a}return r=e.createdAt,0===(a=t.createdAt-r)&&(a=_t(e.cachedPrimaryKey,t.cachedPrimaryKey)),a;case lt.CHRONOLOGICAL:return 0===(a=t.createdAt-e.createdAt)&&(a=_t(e.cachedPrimaryKey,t.cachedPrimaryKey)),a;case lt.CHANNEL_NAME_ALPHABETICAL:var a;return 0===(a=e.name.localeCompare(t.name))&&(a=_t(e.cachedPrimaryKey,t.cachedPrimaryKey)),a}},vt=40;!function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical"}(lt||(lt={}));var Et=function(){function e(e){var t=this,n=e.iid,r=e.filter,i=e.order,a=e.limit,s=void 0===a?20:a;this._channels=[],this._token=null,this._hasMore=!0,this._iid=n,this._filter=r,this._order=i,this._limit=s,this._syncLimit=Math.max(s,vt),this._eventObserver={onevent:function(e){return P(t,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,this._handleEvent(e)];case 1:return t.sent(),[2]}}))}))}},this._eventHandler={onChannelsAdded:Oe,onChannelsUpdated:Oe,onChannelsDeleted:Oe};var o=I.get(this._iid);this._localCacheEnabled=o.container.localCacheEnabled,this._localCacheEnabled&&(this._backgroundSync=ht.of(this._iid,this._syncLimit),this._backgroundSync.resume()),this._changelogSync=pt.of(this._iid),we.of(this._iid).addObserver(this._eventObserver),this._connectionStateObserver={onConnect:function(){t._localCacheEnabled&&t._backgroundSync.resume(),t._changelogSync.resume()},onDisconnect:function(){return P(t,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return[4,Je.ready()];case 1:return e.sent()||(this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause()),[2]}}))}))}},pe.of(this._iid).addObserver(this._connectionStateObserver)}return e.prototype._handleEvent=function(e){var t=this,n=e.source,r=e.payload,i=I.get(this._iid),a=new Te(n);switch(n){case he.CHANNEL_BACKGROUND:break;case he.CHANNEL_CHANGELOG:var s=r,o=s.updatedChannels,l=s.deletedChannelUrls,u=o.filter((function(e){return t._filter.match(e)}));this._addChannelsToView(u,{context:a}),this._removeChannelsFromView(l,{context:a});break;case he.EVENT_USER_DECLINED_INVITATION:var c=i.get("currentUserId"),d=r,h=d.channel;d.invitee.userId===c?this._removeChannelsFromView([h.url],{context:a}):this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_USER_LEFT:c=i.get("currentUserId");var f=r;h=f.channel,f.user.userId===c?this._removeChannelsFromView([h.url],{context:a}):this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_USER_BANNED:case he.EVENT_USER_UNBANNED:break;case he.EVENT_USER_MUTED:case he.EVENT_USER_UNMUTED:case he.EVENT_TYPING_STATUS_UPDATED:case he.EVENT_OPERATOR_UPDATED:case he.EVENT_CHANNEL_METADATA_UPDATED:case he.EVENT_CHANNEL_METADATA_DELETED:case he.EVENT_CHANNEL_METACOUNTER_UPDATED:case he.EVENT_CHANNEL_METACOUNTER_DELETED:h=e.payload.channel,this._addChannelsToView([h],{context:a});break;case he.EVENT_READ_RECEIPT_UPDATED:case he.EVENT_USER_RECEIVED_INVITATION:case he.EVENT_USER_JOINED:case he.EVENT_CHANNEL_FROZEN:case he.EVENT_CHANNEL_UNFROZEN:case he.EVENT_CHANNEL_HIDDEN:case he.EVENT_CHANNEL_UNHIDDEN:case he.EVENT_CHANNEL_CHANGED:h=e.payload.channel,this._filter.match(h)?this._addChannelsToView([h],{context:a}):this._removeChannelsFromView([h.url],{context:a});break;case he.EVENT_CHANNEL_DELETED:var p=r.channelUrl;this._removeChannelsFromView([p],{context:a})}},e.prototype._getRemoteChannels=function(){return P(this,void 0,void 0,(function(){var e,t,n;return L(this,(function(r){switch(r.label){case 0:return e=j.get(this._iid).GroupChannel,[4,I.get(this._iid).get("apiClient").loadGroupChannelList(R(R({},this._filter),{order:this._order,token:this._token,limit:this._limit,userIdsFilter:this._filter.userIdsFilter,searchFilter:(i=this._filter.searchFilter,i.searchQuery&&i.searchFields?{search_query:i.searchQuery,search_fields:i.searchFields.join(",").toLocaleLowerCase()}:{})}))];case 1:return t=r.sent(),n=t.channels.map((function(n){return"number"==typeof t.ts&&(n.ts=t.ts),e.upsert(n)})),[4,Ct.of(this._iid).upsert(n)];case 2:return r.sent(),[2,[n,t.next]]}var i}))}))},e.prototype._addChannelsToView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=[],s=0,o=e;s<o.length;s++){var l=o[s],u=yt(this._channels,l);if(u<0){i.push(l);var c=gt(this._channels,l,this._order);c===this._channels.length?this._channels.push(l):this._channels.splice(c,0,l)}else a.push(l),this._channels[u]=l}r&&(i.length>0&&this._eventHandler.onChannelsAdded(r,i),a.length>0&&this._eventHandler.onChannelsUpdated(r,a))},e.prototype._removeChannelsFromView=function(e,t){void 0===t&&(t={});for(var n=t.context,r=void 0===n?null:n,i=[],a=0,s=e;a<s.length;a++){var o=s[a],l=this._channels.map((function(e){return e.url})).indexOf(o);l>=0&&(i.push(this._channels[l].url),this._channels.splice(l,1))}return r&&i.length>0&&this._eventHandler.onChannelsDeleted(r,i),i},Object.defineProperty(e.prototype,"channelList",{get:function(){return this._channels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMore",{get:function(){return this._hasMore},enumerable:!1,configurable:!0}),e.prototype.loadMore=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i;return L(this,(function(a){switch(a.label){case 0:return this._hasMore?[4,Je.ready()]:[3,5];case 1:return a.sent()?[3,3]:(J.debug("Group channel collection loadMore() from the cache."),e=Ct.of(this._iid),t=e.getNextContainerToken(this._order,this._channels),[4,e.getNextChannels(this._filter,this._order,t,this._limit)]);case 2:return r=a.sent(),this._addChannelsToView(r),[2,r];case 3:return J.debug("Group channel collection loadMore() from the server."),[4,this._getRemoteChannels()];case 4:return n=a.sent(),r=n[0],i=n[1],this._token=i,this._token||(this._hasMore=!1),this._addChannelsToView(r),[2,r];case 5:return[2,[]]}}))}))},e.prototype.dispose=function(){pe.of(this._iid).removeObserver(this._connectionStateObserver),this._localCacheEnabled&&this._backgroundSync.pause(),this._changelogSync.pause(),we.of(this._iid).removeObserver(this._eventObserver)},e.prototype.setGroupChannelCollectionHandler=function(e){this._eventHandler=e},e.GroupChannelOrder=lt,e}(),bt={},Ct=function(){function e(e){var t=e.iid,n=e.collection,r=void 0===n?null:n;this._collection=null,this._pkIndex=Date.now(),this._lastFetchedPrimaryKey=Date.now(),this._iid=t,this._collection=r,bt[t]=this}return e.of=function(e){return bt[e]},e.prototype._serialize=function(e){var t=this._createPk();return e.cachedPrimaryKey=t,R(R({},e.serialize()),{lastMessageCreatedAt:e.lastMessage?e.lastMessage.createdAt:e.createdAt,pk:t})},e.prototype._deserialize=function(e){return e?j.get(this._iid).GroupChannel.buildFromSerializedData(e):null},Object.defineProperty(e.prototype,"_localCacheEnabled",{get:function(){return I.get(this._iid).get("localCacheEnabled")},enumerable:!1,configurable:!0}),e.prototype._createPk=function(){return this._pkIndex--},e.prototype._fetch=function(e,t,n){return P(this,void 0,void 0,(function(){var r,i,a,s,o,l,u,c=this;return L(this,(function(d){switch(d.label){case 0:if(!this._localCacheEnabled)return[3,3];switch(r=Ie.LATEST_LAST_MESSAGE,t){case lt.CHANNEL_NAME_ALPHABETICAL:r=Ie.NAME_ALPHABETICAL;break;case lt.CHRONOLOGICAL:r=Ie.CHRONOLOGICAL;break;case lt.LATEST_LAST_MESSAGE:r=Ie.LATEST_LAST_MESSAGE}return i=n.containerToken,a=i.lastMessageCreatedAt,s=i.createdAt,o=i.name,l=i.lastFetchedPrimaryKey,u={where:function(n){switch(t){case lt.LATEST_LAST_MESSAGE:if(n.lastMessage){if(n.lastMessageCreatedAt>a)return!1;if(n.lastMessageCreatedAt===a&&_t(l,n.pk)>=0)return!1}else{if(n.createdAt>s)return!1;if(n.createdAt===s&&_t(l,n.pk)>=0)return!1}break;case lt.CHANNEL_NAME_ALPHABETICAL:var r=n.name.localeCompare(o);if(r<0)return!1;if(0===r&&_t(l,n.pk)>=0)return!1;break;case lt.CHRONOLOGICAL:if(n.createdAt>s)return!1;if(n.createdAt===s&&_t(l,n.pk)>=0)return!1}return e.match(c._deserialize(n))},index:r},[4,this._collection.query(u)];case 1:return[4,d.sent().fetch({limit:n.limit})];case 2:return[2,d.sent().map((function(e){return c._deserialize(e)}))];case 3:return[2,[]]}}))}))},e.prototype.getNextContainerToken=function(e,t){switch(e){case lt.LATEST_LAST_MESSAGE:return t.length>0?{lastMessageCreatedAt:(n=t[t.length-1]).lastMessage?n.lastMessage.createdAt:null,createdAt:n.createdAt,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{lastMessageCreatedAt:Number.MAX_SAFE_INTEGER,createdAt:Number.MAX_SAFE_INTEGER,lastFetchedPrimaryKey:this._lastFetchedPrimaryKey};case lt.CHRONOLOGICAL:return t.length>0?{createdAt:(n=t[t.length-1]).createdAt,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{createdAt:Number.MAX_SAFE_INTEGER,lastFetchedPrimaryKey:this._lastFetchedPrimaryKey};case lt.CHANNEL_NAME_ALPHABETICAL:var n;return t.length>0?{name:(n=t[t.length-1]).name,lastFetchedPrimaryKey:n.cachedPrimaryKey}:{name:"",lastFetchedPrimaryKey:this._lastFetchedPrimaryKey}}},e.prototype.get=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return this._localCacheEnabled?(t=this._deserialize,[4,this._collection.getByKey(e)]):[3,2];case 1:return[2,t.apply(this,[n.sent()])];case 2:return[2,null]}}))}))},e.prototype.getNextChannels=function(e,t,n,r){return void 0===r&&(r=100),P(this,void 0,void 0,(function(){return L(this,(function(i){switch(i.label){case 0:return[4,this._fetch(e,t,{containerToken:n,limit:r})];case 1:return[2,i.sent()]}}))}))},e.prototype.upsert=function(e){return P(this,void 0,void 0,(function(){var t,n=this;return L(this,(function(r){switch(r.label){case 0:return this._localCacheEnabled?(t=e.map((function(e){return n._serialize(e)})),[4,this._collection.upsertMany(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return this._localCacheEnabled?[4,this._collection.removeIf({url:{"/in":e}})]:[3,3];case 1:return t.sent(),[4,Ri.getInstance(this._iid).clearCachedMessages(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return this._localCacheEnabled?[4,this._collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e}(),St=function(){function e(){this.messageId=null,this.userId=null,this.key=null,this.operation="",this.updatedAt=null}return e.createFromJson=function(e){var t=parseInt(e.msg_id),n=e.user_id,r=e.operation,i=e.reaction,a=e.updated_at;if(t&&"string"==typeof n&&"string"==typeof r&&["add","delete"].indexOf(r.toLowerCase())>=0&&"string"==typeof i&&i&&"number"==typeof a){var s=new this;return s.messageId=t,s.userId=n,s.key=i,s.operation=r.toLowerCase(),s.updatedAt=a,s}return null},e}(),Nt=function e(t){return Object.keys(t).forEach((function(n){t[n]&&"object"==typeof t[n]&&e(t[n])})),Object.freeze(t)},kt=function(){function e(){}return e.serialize=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),Nt(n)},e.serializeWithoutFreeze=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},e.deserialize=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},e}(),At={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},wt=new WeakMap,Tt=function(){function e(t){d(this,e),this.messageId=0,this.messageType=e.MESSAGE_TYPE_BASE,this.channelUrl="",this.data=null,this.customType=null,this.silent=!1,this.createdAt=0,this.updatedAt=0,this.channelType=null,this.metaArrays=[],this.reactions=[],this.mentionType=null,this.mentionedUsers=[],this.mentionedUserIds=[],this.sendingStatus=null,wt.set(this,0),this.parentMessageId=0,this.parentMessageText=null,this.threadInfo=null,this.isReplyToChannel=!1,this.parentMessage=null,this.ogMetaData=null,this.isOperatorMessage=!1,this.appleCriticalAlertOptions=null,this.reqId="",this._isAutoResendRegistered=!1,t&&this.__update(t)}return f(e,[{key:"serialize",value:function(e){var t=this;return kt.serialize(this,(function(n){n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender),n.hasOwnProperty("_isAutoResendRegistered")&&(n.isAutoResendRegistered=n._isAutoResendRegistered,delete n._isAutoResendRegistered),t.appleCriticalAlertOptions&&(n.appleCriticalAlertOptions=t.appleCriticalAlertOptions.serialize()),e&&e(n)}))}},{key:"isIdentical",value:function(e){return!("object"!==c(e)||!e.hasOwnProperty("messageId"))&&(0!==this.messageId&&0!==e.messageId?this.messageId===e.messageId:this.reqId===e.reqId)}},{key:"isEqual",value:function(e){return ae.deepEqual(this,e)}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isUserMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_USER}},{key:"isAdminMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_ADMIN}},{key:"isFileMessage",value:function(){return this.messageType===e.MESSAGE_TYPE_FILE}},{key:"__update",value:function(e){var t=this,n=Ri.getInstance(this._iid),r=j.get(this._iid),i=r.User,a=r.BaseChannel,s=r.BaseMessageParams,o=r.BaseMessage,l=r.Reaction,c=r.MessageMetaArray,d=r.ThreadInfo,h=r.OGMetaData,f=r.AppleCriticalAlertOptions;if(e.hasOwnProperty("msg_id")&&e.msg_id&&(this.messageId=parseInt(e.msg_id)),e.hasOwnProperty("type"))switch(e.type){case"MESG":this.messageType=o.MESSAGE_TYPE_USER;break;case"FILE":this.messageType=o.MESSAGE_TYPE_FILE;break;case"BRDM":case"ADMM":this.messageType=o.MESSAGE_TYPE_ADMIN}e.hasOwnProperty("message_id")&&e.message_id&&(this.messageId=parseInt(e.message_id)),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",e.hasOwnProperty("silent")&&(this.silent=e.silent),this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,e.hasOwnProperty("created_at")&&(this.createdAt=parseInt(e.created_at)),this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):a.CHANNEL_TYPE_GROUP;var p=e.hasOwnProperty("metaarray")?e.metaarray:{},y=e.hasOwnProperty("metaarray_key_order")?e.metaarray_key_order:Object.keys(p).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var g=0;g<y.length;g++){var _=y[g];this.metaArrays.push(new c(_,p[_]||[]))}if(e.hasOwnProperty("sorted_metaarray")){var m=e.sorted_metaarray;Array.isArray(m)&&(this.metaArrays=m.map((function(e){return new c(e.key,e.value)})))}if(this.reactions=[],e.hasOwnProperty("reactions")&&Array.isArray(e.reactions))for(var v=0;v<e.reactions.length;v++){var E=l.createFromJson(e.reactions[v]);E&&this.reactions.push(E)}if(this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:s.MentionType.USERS,this.mentionedUsers=[],e.hasOwnProperty("mentioned_users")&&e.mentioned_users.forEach((function(e){var n=new i(e);t.mentionedUsers.push(n)})),this.mentionedUserIds=[],e.hasOwnProperty("mentioned_user_ids")&&(this.mentionedUserIds=e.mentioned_user_ids),this.sendingStatus=this.messageId>0?n.MessageSendingStatus.SUCCEEDED:n.MessageSendingStatus.FAILED,e.hasOwnProperty("sending_status")&&(this.sendingStatus=e.sending_status),e.hasOwnProperty("root_message_id")&&e.root_message_id&&wt.set(this,parseInt(e.root_message_id)),e.hasOwnProperty("parent_message_id")&&e.parent_message_id&&(this.parentMessageId=parseInt(e.parent_message_id)),this.threadInfo=new d(e.thread_info),this.isReplyToChannel=!!e.hasOwnProperty("is_reply_to_channel")&&e.is_reply_to_channel,e.hasOwnProperty("parent_message_info")){var b=u({},e.parent_message_info);e.parent_message_info.hasOwnProperty("file")&&(b.require_auth=!!e.parent_message_info.file.require_auth);var C={channelType:this.channelType,channelUrl:this.channelUrl};switch(this.parentMessage=a.buildMessage(b,C),this.parentMessage.messageType){case o.MESSAGE_TYPE_USER:this.parentMessageText=this.parentMessage.message;break;case o.MESSAGE_TYPE_FILE:this.parentMessageText=this.parentMessage.name}}e.hasOwnProperty("og_tag")&&(this.ogMetaData=new h(e.og_tag)),e.hasOwnProperty("is_op_msg")&&(this.isOperatorMessage=e.is_op_msg),e.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new f(e.apple_critical_alert_options)),e.hasOwnProperty("is_auto_resend_registered")&&(this._isAutoResendRegistered=e.is_auto_resend_registered),this.reqId=e.hasOwnProperty("req_id")?e.req_id:""}},{key:"getMetaArraysByKeys",value:function(e){return Array.isArray(e)?this.metaArrays.filter((function(t){return e.indexOf(t.key)>-1})):[]}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===c(e)&&e){var t=j.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(r){n.push(new t(r,e[r]))})),this.metaArrays=n}}},{key:"getMetaArrayByKeys",value:function(e){var t={};return this.getMetaArraysByKeys(e).forEach((function(e){t[e.key]=e.value})),t}},{key:"applyReactionEvent",value:function(e){var t=this,n=j.get(this._iid).Reaction,r=null,i=ge.parse(arguments,[new ge({type:St,constraint:function(e){return parseInt(e.messageId)===parseInt(t.messageId)}})]),a=S(i,2);if(r=a[0],e=a[1],!r){for(var s=!1,o=0;o<this.reactions.length;o++)if(this.reactions[o].key===e.key){this.reactions[o]._applyEvent(e),this.reactions[o].isEmpty&&this.reactions.splice(o,1),s=!0;break}s||"add"!==e.operation||this.reactions.push(new n(e.key,[e.userId],e.updatedAt))}}},{key:"_getThreadedMessageList",value:function(t,n,r,i){var a=this,s=j.get(this._iid).ThreadedMessageListParams,o=null,l=ge.parse(arguments,[new ge({type:"number"}),new ge({type:"string",constraint:function(e){return Object.values(At).includes(e)}}),new ge({type:s,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),c=S(l,5);return o=c[0],t=c[1],n=c[2],r=c[3],i=c[4],le(this._iid,(function(i){if(o)i(o,null);else{var s=j.get(a._iid),l=s.GroupChannel,c=s.OpenChannel;a.isGroupChannel()?l.getChannel(a.channelUrl,T.INTERNAL_CALL,(function(s,o){if(Ri.getInstance(a._iid).getErrorFirstCallback()){var l=[s,o];o=l[0],s=l[1]}o?i(o,null):I.get(a._iid).container.apiClient.getMessageList(u(u({channel:s,token:t,tokenType:n},r),{},{shouldReverse:r.reverse,parentMessageId:a.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL})).then((function(e){var t=j.get(a._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,s)})).filter((function(e){return null!==e})),r=n.filter((function(e){return e.messageId===a.messageId}))[0],o=n.filter((function(e){return e.parentMessageId===a.messageId}));i(null,{parentMessage:r,threadedReplies:o})})).catch((function(e){i(e,null)}))})):a.isOpenChannel()&&c.getChannel(a.channelUrl,T.INTERNAL_CALL,(function(s,o){if(Ri.getInstance(a._iid).getErrorFirstCallback()){var l=[s,o];o=l[0],s=l[1]}o?i(o,null):I.get(a._iid).container.apiClient.getMessageList(u(u({channel:s,token:t,tokenType:n},r),{},{shouldReverse:r.reverse,parentMessageId:a.messageId,includeThreadInfo:!0,replyType:e.ReplyType.ALL})).then((function(e){var t=j.get(a._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,s)})).filter((function(e){return null!==e})),r=n.filter((function(e){return e.messageId===a.messageId}))[0],o=n.filter((function(e){return e.parentMessageId===a.messageId}));i(null,{parentMessage:r,threadedReplies:o})})).catch((function(e){i(e,null)}))}))}}),i)}},{key:"getThreadedMessagesByTimestamp",value:function(e,t,n){return this._getThreadedMessageList(e,At.TIMESTAMP,t,n)}},{key:"applyThreadInfoUpdateEvent",value:function(e){var t=this,n=j.get(this._iid).ThreadInfoUpdateEvent,r=null,i=ge.parse(arguments,[new ge({type:n,constraint:function(e){return parseInt(e.targetMessageId)===parseInt(t.messageId)}})]),a=S(i,2);return r=a[0],e=a[1],!r&&(this.threadInfo=e.threadInfo,!0)}},{key:"applyParentMessage",value:function(e){if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1}},{key:"_setRootMessageId",value:function(e){wt.set(this,e)}}],[{key:"MESSAGE_TYPE_BASE",get:function(){return"base"}},{key:"MESSAGE_TYPE_ADMIN",get:function(){return"admin"}},{key:"MESSAGE_TYPE_USER",get:function(){return"user"}},{key:"MESSAGE_TYPE_FILE",get:function(){return"file"}},{key:"SendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"ReplyType",get:function(){return{ALL:"all",NONE:"none",ONLY_REPLY_TO_CHANNEL:"only_reply_to_channel"}}},{key:"getMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.BaseChannel,a=r.MessageRetrievalParams,s=null,o=ge.parse(arguments,[new ge({type:a,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)t(s,null);else{var r=j.get(n._iid),a=r.GroupChannel,o=r.OpenChannel;switch(e.channelType){case i.CHANNEL_TYPE_GROUP:a.getChannel(e.channelUrl,T.INTERNAL_CALL,(function(r,a){if(Ri.getInstance(n._iid).getErrorFirstCallback()){var s=[r,a];a=s[0],r=s[1]}a?t(a,null):I.get(n._iid).container.apiClient.getMessage(u({channel:r},e),(function(e,n){if(e)t(e,null);else{var a=i.buildMessage(n,r);t(null,a)}}))}));break;case i.CHANNEL_TYPE_OPEN:o.getChannel(e.channelUrl,T.INTERNAL_CALL,(function(r,a){if(Ri.getInstance(n._iid).getErrorFirstCallback()){var s=[r,a];a=s[0],r=s[1]}a?t(a,null):I.get(n._iid).container.apiClient.getMessage(u({channel:r},e),(function(e,n){if(e)t(e,null);else{var a=i.buildMessage(n,r);t(null,a)}}))}))}}}),t)}}]),e}(),Ot=function(){function e(e){this.nickname="",this.plainProfileUrl="",this.userId="",this.connectionStatus="",this.lastSeenAt=null,this.metaData={},this.isActive=!0,this.friendDiscoveryKey=null,this.friendName=null,this._preferredLanguages=null,this.requireAuth=null,e&&this.__update(e)}return e.objectify=function(e){var t=e.userId,n=void 0===t?null:t,r=e.nickname,i=void 0===r?"":r,a=e.plainProfileUrl,s=void 0===a?"":a,o=e.connectionStatus,l=void 0===o?"":o,u=e.lastSeenAt,c=void 0===u?0:u,d=e.metaData,h=void 0===d?{}:d,f=e.isActive,p=void 0===f||f,y=e.friendDiscoveryKey,g=void 0===y?null:y,_=e.friendName,m=void 0===_?null:_,v=e.preferredLanguages,E=void 0===v?null:v,b=e.requireAuth;return{user_id:n,nickname:i,profile_url:s,is_online:l,last_seen_at:c,metadata:h,is_active:p,friend_discovery_key:g,friend_name:m,preferred_languages:E,require_auth_for_profile_image:void 0!==b&&b}},e.buildFromSerializedData=function(e){var t=j.get(this._iid).User,n=kt.deserialize(e);return new t(t.objectify(n))},Object.defineProperty(e.prototype,"preferredLanguages",{get:function(){return this._preferredLanguages},enumerable:!1,configurable:!0}),e.prototype.__update=function(t){var n=I.get(this._iid).container.auth;t.hasOwnProperty("guest_id")&&(this.userId=t.guest_id),t.hasOwnProperty("user_id")&&(this.userId=t.user_id),t.hasOwnProperty("name")&&(this.nickname=t.name),t.hasOwnProperty("nickname")&&(this.nickname=t.nickname),t.hasOwnProperty("require_auth_for_profile_image")?this.requireAuth=t.require_auth_for_profile_image:this.requireAuth=null,(t.hasOwnProperty("image")||t.hasOwnProperty("profile_url"))&&(this.plainProfileUrl=t.image||t.profile_url||"",Object.defineProperty(this,"profileUrl",{value:this.requireAuth?this.plainProfileUrl+"?auth="+n.eKey:this.plainProfileUrl,configurable:!0,writable:!1})),t.hasOwnProperty("is_online")?t.is_online===e.NON_AVAILABLE?this.connectionStatus=e.NON_AVAILABLE:this.connectionStatus=t.is_online?e.ONLINE:e.OFFLINE:this.connectionStatus=e.NON_AVAILABLE,t.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(t.last_seen_at):this.lastSeenAt=0,t.hasOwnProperty("metadata")?this.metaData=t.metadata:this.metaData={},t.hasOwnProperty("is_active")?this.isActive=void 0===t.is_active||t.is_active:this.isActive=!0,t.hasOwnProperty("friend_discovery_key")?this.friendDiscoveryKey=t.friend_discovery_key:this.friendDiscoveryKey=null,t.hasOwnProperty("friend_name")?this.friendName=t.friend_name:this.friendName=null,t.hasOwnProperty("preferred_languages")?this._preferredLanguages=t.preferred_languages||null:this._preferredLanguages=null},e.prototype._updateMetaData=function(e,t){var n=this;void 0===t&&(t=!1);var r=j.get(this._iid).GroupChannel;Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]})),Object.keys(r.cachedChannels).forEach((function(e){if(r.cachedChannels.hasOwnProperty(e)){var t=r.cachedChannels[e];t.memberMap.hasOwnProperty(n.userId)&&(t.memberMap[n.userId].metaData=n.metaData)}}))},e.prototype.serialize=function(){return kt.serialize(this,(function(e){e.hasOwnProperty("_preferredLanguages")&&(e.preferredLanguages=e._preferredLanguages,delete e._preferredLanguages)}))},e.prototype.getOriginalProfileUrl=function(){var e="";if(((e=(e=this.plainProfileUrl.indexOf("://")>-1?this.plainProfileUrl.split("/")[2]:this.plainProfileUrl.split("/")[0]).split("?")[0]).indexOf("sendbird.com")>-1||e.indexOf("sendbirdtest.com")>-1||e.indexOf("intoz.com")>-1||e.indexOf("file-local")>-1)&&this.plainProfileUrl.indexOf(e+"/profile_images/")>-1){var t=this.plainProfileUrl.replace("profile_images/","");return t===this.plainProfileUrl?"":t}return""},e.prototype.createMetaData=function(e,t){var n,r=this,i=null;return n=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return Object.keys(e).length>0&&!Array.isArray(e)}}),new ge({type:"callback"})]),i=n[0],e=n[1],t=n[2],le(this._iid,(function(t){i?t(i,null):I.get(r._iid).container.apiClient.createUserMetaData({metaData:e},(function(e,n){e||r._updateMetaData(n),t(e,n)}))}),t)},e.prototype.updateMetaData=function(e,t,n){var r,i=this,a=null;return r=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),a=r[0],e=r[1],t=r[2],n=r[3],le(this._iid,(function(n){a?n(a,null):I.get(i._iid).container.apiClient.updateUserMetaData({metaData:e,upsert:t},(function(e,t){e||i._updateMetaData(t),n(e,t)}))}),n)},e.prototype.deleteMetaData=function(e,t){var n,r=this,i=null;return n=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),i=n[0],e=n[1],t=n[2],le(this._iid,(function(t){if(i)t(i,null);else{var n={};n[e]="",I.get(r._iid).container.apiClient.deleteUserMetaData({metaDataKey:e},(function(e,i){e||r._updateMetaData(n,!0),t(e,i)}))}}),t)},e.prototype.deleteAllMetaData=function(e){var t=this;return le(this._iid,(function(e){var n=t.metaData;I.get(t._iid).container.apiClient.deleteAllUserMetaData({},(function(r,i){r||t._updateMetaData(n,!0),e(r,i)}))}),e)},Object.defineProperty(e,"NON_AVAILABLE",{get:function(){return"nonavailable"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ONLINE",{get:function(){return"online"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OFFLINE",{get:function(){return"offline"},enumerable:!1,configurable:!0}),e}(),It={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},Mt=new WeakMap,Ut=new WeakMap,Rt=function(){function e(t){d(this,e),this.url="",this.channelType=e.CHANNEL_TYPE_BASE,this.name="",this.coverUrl="",this.creator=null,this.createdAt=0,this.data=null,this.customType=null,this.isFrozen=!1,this.isEphemeral=!1,Mt.set(this,{}),Ut.set(this,""),t&&this.__update(t)}return f(e,[{key:"__update",value:function(e){this.url=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.name=e.hasOwnProperty("name")?String(e.name):"",this.coverUrl=e.hasOwnProperty("cover_url")?String(e.cover_url):"",this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?e.custom_type:"",this.isFrozen=!!e.hasOwnProperty("freeze")&&e.freeze,this.isEphemeral=!!e.hasOwnProperty("is_ephemeral")&&e.is_ephemeral,e.hasOwnProperty("created_by")&&null!==e.created_by&&"object"===c(e.created_by)&&Object.keys(e.created_by).length>0?this.creator=new Ot(e.created_by):this.creator=null,e.hasOwnProperty("metadata")&&null!==e.metadata&&e.hasOwnProperty("ts")&&"number"==typeof e.ts&&this._refreshMetaData(e.metadata,e.ts),e.hasOwnProperty("cached_primary_key")&&(this.cachedPrimaryKey=e.cached_primary_key)}},{key:"_addOrUpdateCachedMetaData",value:function(e,t){var n=Mt.get(this);Object.keys(e).forEach((function(r){var i=n[r],a=e[r];i?t>i.updatedAt&&(i.value=a,i.updatedAt=t,i.isRemoved=!1):n[r]={value:a,updatedAt:t,isRemoved:!1}}))}},{key:"_markAsDeletedCachedMetaData",value:function(e,t){var n=Mt.get(this);e.forEach((function(e){var r=n[e];r?t>r.updatedAt&&(r.isRemoved=!0,r.updatedAt=t):n[e]={value:null,updatedAt:t,isRemoved:!0}}))}},{key:"_refreshMetaData",value:function(e,t){var n={};Object.keys(e).forEach((function(r){n[r]={value:e[r],updatedAt:t,isRemoved:!1}})),Mt.set(this,n)}},{key:"_clearCachedMetaData",value:function(){Mt.set(this,{})}},{key:"cachedPrimaryKey",get:function(){return Ut.get(this)},set:function(e){Ut.set(this,e)}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"createOperatorListQuery",value:function(){return new(0,j.get(this._iid).OperatorListQuery)(this)}},{key:"createMessageListQuery",value:function(){return new(0,j.get(this._iid).MessageListQuery)(this)}},{key:"createPreviousMessageListQuery",value:function(){return new(0,j.get(this._iid).PreviousMessageListQuery)(this)}},{key:"createPollListQuery",value:function(){return new(0,j.get(this._iid).PollListQuery)({channelUrl:this.url})}},{key:"createPollVoterListQuery",value:function(e,t){return new(0,j.get(this._iid).PollVoterListQuery)({channelUrl:this.url,pollId:e,optionId:t})}},{key:"serialize",value:function(){var e=this;return kt.serialize(this,(function(t){if(null!==t.lastMessage&&"object"===c(t.lastMessage)){var n=t.lastMessage;n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender,t.lastMessage=n)}t.hasOwnProperty("_messageOffsetTimestamp")&&(t.messageOffsetTimestamp=t._messageOffsetTimestamp,delete t._messageOffsetTimestamp),e.cachedPrimaryKey&&(t.cachedPrimaryKey=e.cachedPrimaryKey)}))}},{key:"getMessageChangeLogsByTimestamp",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"number",constraint:function(e){return e>=0}}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.getMessageChangeLogs({channelUrl:i.url,ts:e,token:null,isOpenChannel:i.isOpenChannel(),includeMetaArray:t,includeReactions:n}).then((function(e){var t=j.get(i._iid).BaseChannel,n={updatedMessages:e.updated.map((function(e){return t.buildMessage(e,i)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getMessageChangeLogsByToken",value:function(e,t,n,r){var i=this,a=null,s=S(ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),5);return a=s[0],e=s[1],t=s[2],n=s[3],r=s[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.getMessageChangeLogs({channelUrl:i.url,ts:null,token:e,isOpenChannel:i.isOpenChannel(),includeMetaArray:t,includeReactions:n}).then((function(e){var t=j.get(i._iid).BaseChannel,n={updatedMessages:e.updated.map((function(e){return t.buildMessage(e,i)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getMessageChangeLogsSinceToken",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.BaseChannel,s=i.MessageChangeLogsParams,o=null,l=ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:s,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),c=S(l,4);return o=c[0],e=c[1],t=c[2],n=c[3],le(this._iid,(function(n){o?n(o,null):I.get(r._iid).container.apiClient.getMessageChangeLogs(u({channelUrl:r.url,ts:null,token:e,isOpenChannel:r.isOpenChannel()},t)).then((function(e){var t={updatedMessages:e.updated.map((function(e){return a.buildMessage(e,r)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};n(null,t)})).catch((function(e){n(e,null)}))}),n)}},{key:"getMessageChangeLogsSinceTimestamp",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.BaseChannel,s=i.MessageChangeLogsParams,o=null,l=ge.parse(arguments,[new ge({type:"number",constraint:function(e){return e>=0}}),new ge({type:s,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),c=S(l,4);return o=c[0],e=c[1],t=c[2],n=c[3],le(this._iid,(function(n){o?n(o,null):I.get(r._iid).container.apiClient.getMessageChangeLogs(u({channelUrl:r.url,timestamp:e,token:null,isOpenChannel:r.isOpenChannel()},t)).then((function(e){var t={updatedMessages:e.updated.map((function(e){return a.buildMessage(e,r)})),deletedMessageIds:e.deleted.map((function(e){return parseInt(e.message_id)})),hasMore:e.has_more,token:e.next};n(null,t)})).catch((function(e){n(e,null)}))}),n)}},{key:"getMyMutedInfo",value:function(e){var t=this;return le(this._iid,(function(e){var n=Ri.getInstance(t._iid);I.get(t._iid).container.apiClient.getMyMutedInfo({channelUrl:t.url,userId:n.currentUser?n.currentUser.userId:null,isGroupChannel:t.isGroupChannel()},(function(t,n){var r=null;t||(r={isMuted:n.is_muted,startAt:n.start_at,endAt:n.end_at,remainingDuration:n.remaining_duration,description:n.description}),e(t,r)}))}),e)}},{key:"_parseMessageListParams",value:function(e){for(var t=new(0,j.get(this._iid).MessageListParams),n=null,r=!1,i=0,a=0,s=!1,o="",l="",u=null,c=!1,d=!1,h=null,f=arguments.length,p=new Array(f>1?f-1:0),y=1;y<f;y++)p[y-1]=arguments[y];switch(e){case"prev":var g=S(ge.parse(p,[new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"string"}),new ge({type:"string"}),new ge({type:"array",optional:!0}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),11);n=g[0],r=g[2],i=g[3],s=g[4],o=g[5],l=g[6],u=g[7],c=g[8],d=g[9],h=g[10];break;case"next":var _=S(ge.parse(p,[new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"string"}),new ge({type:"string"}),new ge({type:"array",optional:!0}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),11);n=_[0],r=_[2],a=_[3],s=_[4],o=_[5],l=_[6],u=_[7],c=_[8],d=_[9],h=_[10];break;case"prevnext":var m=S(ge.parse(p,[new ge({type:"number"}),new ge({type:"number"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"string"}),new ge({type:"string"}),new ge({type:"array",optional:!0}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),11);n=m[0],i=m[2],a=m[3],s=m[4],o=m[5],l=m[6],u=m[7],c=m[8],d=m[9],h=m[10],r=!0}return n?[null,h]:(t.isInclusive=r,t.prevResultSize=i,t.nextResultSize=a,t.reverse=s,t.messageType=o,t.customType=l,""===t.customType&&(t.customType="*"),t.senderUserIds=u,t.includeMetaArray=c,t.includeReactions=d,[t,h])}},{key:"_getMessageList",value:function(e,t,n,r){var i=this,a=j.get(this._iid).MessageListParams,s=null,o=ge.parse(arguments,[new ge({type:"number"}),new ge({type:"string",constraint:function(e){return Object.values(It).includes(e)}}),new ge({type:a,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),l=S(o,5);return s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],le(this._iid,(function(r){s?r(s,null):I.get(i._iid).container.apiClient.getMessageList(u(u({channel:i,token:e,tokenType:t},n),{},{shouldReverse:n.reverse})).then((function(e){var t=j.get(i._iid).BaseChannel,n=e.messages.map((function(e){return t.buildMessage(e,i)})).filter((function(e){return null!==e}));r(null,n)})).catch((function(e){r(e,null)}))}),r)}},{key:"getPreviousMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prev"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.TIMESTAMP,n,r)}},{key:"getNextMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["next"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.TIMESTAMP,n,r)}},{key:"getPreviousAndNextMessagesByTimestamp",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prevnext"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.TIMESTAMP,n,r)}},{key:"getPreviousMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prev"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.MESSAGE_ID,n,r)}},{key:"getNextMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["next"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.MESSAGE_ID,n,r)}},{key:"getPreviousAndNextMessagesByID",value:function(e){var t=S(this._parseMessageListParams.apply(this,["prevnext"].concat(N(ge.toArray(arguments)))),2),n=t[0],r=t[1];return this._getMessageList(e,It.MESSAGE_ID,n,r)}},{key:"getMessagesByTimestamp",value:function(e,t,n){return this._getMessageList(e,It.TIMESTAMP,t,n)}},{key:"getMessagesByMessageId",value:function(e,t,n){return this._getMessageList(e,It.MESSAGE_ID,t,n)}},{key:"_sendUserMessage",value:function(e){var t=this,n=e.reqId,r=e.message,i=e.data,a=e.customType,s=e.metaArrays,o=e.mentionType,l=e.mentionedUserIds,c=e.pushNotificationDeliveryOption,d=e.rootMessageId,h=e.parentMessageId,f=e.translationTargetLanguages,p=e.appleCriticalAlertOptions,y=e.pollId,g=e.silent,_=void 0!==g&&g,m=e.isReplyToChannel,v=e.messageParams,E=e.oldMessage,b=void 0===E?null:E,C=e.isManualResend,S=void 0!==C&&C,N=e.callback,k=j.get(this._iid),A=k.Command,w=k.UserMessage,T=Ri.getInstance(this._iid),O=Ge.of(this._iid),M=Ct.of(this._iid),U=we.of(this._iid),R=I.get(this._iid).container.localCacheEnabled;n||(n=A.generateRequestId());var P={};Array.isArray(f)&&f.forEach((function(e){return P[e]=""}));var L=w.objectify({messageId:0,reqId:n,user:T.currentUser||{},channel:this,message:r,data:i,customType:a,metaArrays:s,mentionType:o,mentionedUserIds:l,rootMessageId:d,parentMessageId:h,translations:P,silent:_,appleCriticalAlertOptions:p,isReplyToChannel:m,messageParams:v,createdAt:(new Date).getTime()}),D=new w(L);if(D.requestState=T.MessageRequestState.PENDING,D.sendingStatus=T.MessageSendingStatus.PENDING,D.requestedMentionUserIds=l,D._messageParams=v,!T.currentUser){var x=new F("Connection should be made first.",F.CONNECTION_REQUIRED),H=new w(L);return H.requestState=T.MessageRequestState.FAILED,H.sendingStatus=T.MessageSendingStatus.FAILED,H.requestedMentionUserIds=l,H.errorCode=x.code,N(x,H),D}return(!t.isGroupChannel()||b&&b._isAutoResendRegistered?Promise.resolve():O.upsert([D],ke.UNSENT).then((function(){U.send({source:S?he.LOCAL_MESSAGE_RESEND_STARTED:he.LOCAL_MESSAGE_PENDING_CREATED,payload:{channel:t,message:D}})}))).then((function(){var e=A.bMessage({channelUrl:t.url,message:r,data:i,customType:a,metaArrays:s,mentionType:o,mentionedUserIds:l,requestId:n,rootMessageId:d,parentMessageId:h,silent:_,translationTargetLanguages:f,pushNotificationDeliveryOption:c,appleCriticalAlertOptions:p,pollId:y,isReplyToChannel:m});D.reqId=e.requestId,t.isGroupChannel()&&T.getConnectionState()!==T.ConnectionState.OPEN&&T.currentUser&&!T.connecting&&!T.reconnecting&&"string"==typeof a&&0===a.indexOf("SB_VIDEOCHAT")?I.get(T._iid).container.apiClient.sendUserMessage({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),message:r,data:i,customType:a,translationTargetLanguages:f,metaArrays:s,mentionType:o,mentionedUserIds:l,pushNotificationDeliveryOption:c,rootMessageId:d,parentMessageId:h,appleCriticalAlertOptions:p,pollId:y,isReplyToChannel:m},(function(e,r){var i=null;if(e){if(D._isAutoResendRegistered&&ae.isAutoResendableError(e.code))return;(i=new w(L)).requestState=T.MessageRequestState.FAILED,i.requestedMentionUserIds=l,b&&(i._isAutoResendRegistered=b._isAutoResendRegistered),e.code===F.REQUEST_CANCELED?(i.sendingStatus=T.MessageSendingStatus.CANCELED,O.removeUnsentMessages({channelUrl:t.url,sendingStatus:T.MessageSendingStatus.PENDING,reqIds:[n]}).then((function(){U.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:t,message:i}})})).catch((function(e){return J.error(e)})).finally((function(){N&&N(new F(e.message,e.code),i)}))):(i.errorCode=e.code,i.sendingStatus=T.MessageSendingStatus.FAILED,R&&ae.isAutoResendableError(e.code)&&(i.sendingStatus=T.MessageSendingStatus.PENDING,i.errorCode=0,i._isAutoResendRegistered=!0),O.upsert([i],ke.UNSENT).then((function(){rt._completeCurrentAndProcessNextAutoResend(T,i),U.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:t,message:i}})})).catch((function(e){return J.error(e)})).finally((function(){var t=i._clone();t.sendingStatus=T.MessageSendingStatus.FAILED,t.errorCode=e.code,t._isAutoResendRegistered=!1,N&&N(new F(e.message,e.code),t)})))}else{for(var a in(i=new w(r)).reqId=n,i.requestState=T.MessageRequestState.SUCCEEDED,i.sendingStatus=T.MessageSendingStatus.SUCCEEDED,b&&(i._isAutoResendRegistered=b._isAutoResendRegistered),t.lastMessage=i,T.channelHandlers)T.channelHandlers[a].onChannelChanged(t);M.upsert([t]).then((function(){U.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).then((function(){return O.removeUnsentMessages({channelUrl:t.url,sendingStatus:T.MessageSendingStatus.PENDING,reqIds:[n]})})).then((function(){return O.upsert([i],ke.SUCCEEDED)})).then((function(){rt._completeCurrentAndProcessNextAutoResend(T,i),U.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:t,message:i}})})).catch((function(e){return J.error(e)})).finally((function(){N&&N(null,i)}))}})):T.sendCommand(e,(function(r,i){if(T.getErrorFirstCallback()){var a=[r,i];i=a[0],r=a[1]}if(i){if(D._isAutoResendRegistered&&ae.isAutoResendableError(i.code))return;var s=new w(L);s.reqId=e.requestId,s.requestState=T.MessageRequestState.FAILED,i.code===F.REQUEST_CANCELED?(s.sendingStatus=T.MessageSendingStatus.CANCELED,t.isGroupChannel()&&O.removeUnsentMessages({channelUrl:t.url,sendingStatus:T.MessageSendingStatus.PENDING,reqIds:[n]}).then((function(){U.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:t,message:s}})})).catch((function(e){return J.error(e)})).finally((function(){N&&N(new F(i.message,i.code),s)}))):(s.sendingStatus=T.MessageSendingStatus.FAILED,s.errorCode=i.code,s.requestedMentionUserIds=l,t.isGroupChannel()?(R&&ae.isAutoResendableError(i.code)&&(s.sendingStatus=T.MessageSendingStatus.PENDING,s.errorCode=0,s._isAutoResendRegistered=!0),O.upsert([s],ke.UNSENT).then((function(){return rt._completeCurrentAndProcessNextAutoResend(T,s),U.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:t,message:s}})})).catch((function(e){J.error(e)})).finally((function(){var e=s._clone();e.sendingStatus=T.MessageSendingStatus.FAILED,e.errorCode=i.code,e._isAutoResendRegistered=!1,N&&N(new F(i.message,i.code),e)}))):N&&N(new F(i.message,i.code),s))}else{var o=new w(u(u({},r.getJsonElement()),{},{messageParams:v}));o.reqId=n,o.requestState=T.MessageRequestState.SUCCEEDED,o.sendingStatus=T.MessageSendingStatus.SUCCEEDED,b&&(o._isAutoResendRegistered=b._isAutoResendRegistered);var c=T.currentUser;if(c&&o._sender&&c.userId===o._sender.userId&&(c.nickname!==o._sender.nickname&&(c.nickname=o._sender.nickname),c.plainProfileUrl!==o._sender.plainProfileUrl&&(c.plainProfileUrl=o._sender.plainProfileUrl),ae.deepEqual(c.metaData,o._sender.metaData)||(c.metaData=o._sender.metaData)),t.isGroupChannel()){t.lastMessage=o,Object.keys(T.channelHandlers).forEach((function(e){T.channelHandlers[e].onChannelChanged(t)}));var d=we.of(t._iid);Ct.of(t._iid).upsert([t]).then((function(){d.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).then((function(){return O.removeUnsentMessages({channelUrl:t.url,sendingStatus:T.MessageSendingStatus.PENDING,reqIds:[n]})})).then((function(){return O.upsert([o],ke.SUCCEEDED)})).then((function(){rt._completeCurrentAndProcessNextAutoResend(T,o),d.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:t,message:o}})})).catch((function(e){J.error(e)})).finally((function(){N&&N(null,o)}))}else N&&N(null,o)}}))})),D}},{key:"sendUserMessage",value:function(){var e=ge.toArray(arguments),t=e.pop(),n=null,r=null,i=j.get(this._iid).UserMessageParams;if("function"==typeof t)if(e[0]instanceof i)null===(r=e[0]).data&&(r.data=""),null===r.customType&&(r.customType="");else if("string"==typeof e[0])switch((r=new i).message=e[0],e.length){case 1:break;case 2:r.data=e[1]||"";break;case 3:r.data=e[1]||"",r.customType=e[2]||"";break;case 4:r.data=e[1]||"",r.customType=e[2]||"",r.translationTargetLanguages=Array.isArray(e[3])?e[3]:[e[3]];break;default:n=ge.error}else n=ge.error;else n=ge.error;var a=I.get(this._iid).container.isErrorFirstInCallback;return!n&&r._validate()&&r.message?this._sendUserMessage(u(u({},r),{},{metaArrays:r.metaArrays,mentionType:r.mentionType,mentionedUserIds:r._mentionedUserIds,rootMessageId:r.rootMessageId,parentMessageId:r.parentMessageId,translationTargetLanguages:r._translationTargetLanguages,messageParams:r,callback:function(e,n){a?t(e,n):t(n,e)}})):(a?t(ge.error,null):t(null,ge.error),null)}},{key:"_autoResendUserMessage",value:function(e){var t=this,n=Ri.getInstance(this._iid);if(n&&n.currentUser){var r=e._messageParams;return new Promise((function(n,i){return t._sendUserMessage(u(u({},r),{},{reqId:e.reqId,metaArrays:r.metaArrays,mentionType:r.mentionType,mentionedUserIds:r._mentionedUserIds,rootMessageId:r.rootMessageId,parentMessageId:r.parentMessageId,translationTargetLanguages:r._translationTargetLanguages,pushNotificationDeliveryOption:r.pushNotificationDeliveryOption,messageParams:r,oldMessage:e,callback:function(e,t){e?i(e):n(t)}}))}))}}},{key:"_autoResendFileMessage",value:function(e){var t=Ri.getInstance(this._iid);if(t&&t.currentUser){var n=this._parsePendingFileMessage(e),r=j.get(this._iid).FileMessageQueue;r.create(this).addJob(new r.Job({fileInfo:n,pendingMessage:e._clone(),requestId:e.reqId,error:n.error,response:null}))}}},{key:"resendUserMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.UserMessage,a=r.UserMessageParams,s=null,o=ge.parse(arguments,[new ge({type:i,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===n.url&&"string"==typeof e.message&&"string"==typeof e.data&&"string"==typeof e.customType&&"object"===c(e.translations)&&!Array.isArray(e.translations)}}),new ge({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)s.message+=" Please check if the failed message is resend-able with `message.isResendable().`",t(s,null);else{var r=Object.keys(e.translations),i=a.PushNotificationDeliveryOption.DEFAULT;n._sendUserMessage(u(u({},e),{},{mentionedUserIds:e.requestedMentionUserIds,translationTargetLanguages:r,pushNotificationDeliveryOption:i,reqId:e.reqId,messageParams:e._messageParams,isManualResend:!0,callback:t}))}}),t)}},{key:"updateUserMessage",value:function(e,t,n,r,i){var a=this,s=j.get(this._iid),o=s.Command,l=s.UserMessage,c=s.UserMessageParams,d=arguments,h=null,f=null;if("number"==typeof e)switch(d.length){case 3:var p=S(ge.parse(d,[new ge({type:"number"}),new ge({type:c}),new ge({type:"callback"})]),4);h=p[0],e=p[1],f=p[2],i=p[3];break;case 5:f=new c;var y=S(ge.parse(d,[new ge({type:"number"}),new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"callback"})]),6);h=y[0],e=y[1],t=y[2],n=y[3],r=y[4],i=y[5],f.message=t,f.data=n,f.customType=r}return le(this._iid,(function(t){if(!h&&f&&f._validate()){var n=o.bUpdateUserMessage(u(u({channelUrl:a.url,messageId:e},f),{},{mentionType:f._mentionType,mentionedUserIds:f._mentionedUserIds})),r=Ri.getInstance(a._iid),i=Ge.of(a._iid),s=we.of(a._iid);r.sendCommand(n,(function(e,n){if(r.getErrorFirstCallback()){var o=[e,n];n=o[0],e=o[1]}var c=null;n||(c=new l(u(u({},e.getJsonElement()),{},{messageParams:f})),a.isGroupChannel()&&i.upsert([c],ke.SUCCEEDED).then((function(){s.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:a,message:c}})})).catch((function(e){J.error(e)}))),t(n,c)}))}else t(ge.error,null)}),i)}},{key:"translateUserMessage",value:function(e,t,n){var r=this,i=Ri.getInstance(this._iid),a=j.get(this._iid).UserMessage,s=null,o=ge.parse(arguments,[new ge({type:a,constraint:function(e){return e.channelUrl===r.url&&e.sendingStatus===i.MessageSendingStatus.SUCCEEDED}}),new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):I.get(r._iid).container.apiClient.translateUserMessage({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),messageId:e.messageId,translationTargetLanguages:t},(function(e,t){var r=null;e||(r=new a(t)),n(e,r)}))}),n)}},{key:"_parsePendingFileMessage",value:function(e){var t=e._messageParams.serialize(),n=t.data,r=t.customType,i=t.fileUrl,a=t.thumbnailSizes,s=t.mentionType,o=t.mentionedUserIds,l=t.metaArrays,u=t.parentMessageId,c=t.pushNotificationDeliveryOption,d=e._messageParams;return{file:d.file?d.file:i,name:e.name,type:e.type,size:e.size,data:n,customType:r,thumbnailSizes:a,metaArrays:l,mentionType:s,mentionedUserIds:o,pushNotificationDeliveryOption:c,rootMessageId:u,parentMessageId:u,appleCriticalAlertOptions:d.appleCriticalAlertOptions,messageParams:e._messageParams,silent:e.silent,error:null,progressHandler:null,callback:null}}},{key:"_parseFileMessageArguments",value:function(e){var t=j.get(this._iid),n=t.BaseMessageParams,r=t.FileMessageParams,i={error:null,file:null,name:null,type:null,size:null,data:"",customType:"",thumbnailSizes:[],metaArrays:[],mentionType:n.MentionType.USERS,mentionedUserIds:[],pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,rootMessageId:null,parentMessageId:null,progressHandler:null,silent:!1,appleCriticalAlertOptions:null,isReplyToChannel:!1,messageParams:null,callback:null};if("function"==typeof e[e.length-1]&&(i.callback=e.pop()),"function"==typeof e[e.length-1]&&(i.progressHandler=e.pop()),e[0]instanceof r)i.file=e[0].file||e[0].fileUrl,i.name=e[0].fileName,i.type=e[0].mimeType,i.size=e[0].fileSize,i.data=e[0].data,i.customType=e[0].customType,i.thumbnailSizes=e[0].thumbnailSizes,i.metaArrays=e[0].metaArrays,i.mentionType=e[0]._mentionType,i.mentionedUserIds=e[0]._mentionedUserIds,i.pushNotificationDeliveryOption=e[0].pushNotificationDeliveryOption?e[0].pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,i.rootMessageId=e[0].rootMessageId,i.parentMessageId=e[0].parentMessageId,i.silent=e[0].silent,e[0]._validate()||(i.error=ge.error),i.appleCriticalAlertOptions=e[0].appleCriticalAlertOptions,i.isReplyToChannel=e[0].isReplyToChannel,i.messageParams=e[0];else if(ae.isFile(e[0])||"string"==typeof e[0]){switch(i.file=e[0],e.length){case 1:break;case 2:i.data=e[1];break;case 3:i.data=e[1],i.customType=e[2];break;case 4:i.data=e[1],i.customType=e[2],i.thumbnailSizes=e[3];break;case 5:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4];break;case 6:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5];break;case 7:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5],i.thumbnailSizes=e[6]}var a=S(ge.parse([i.file,i.name,i.type,i.size,i.data,i.customType,i.thumbnailSizes],[new ge({type:["file","string"]}),new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"number",nullable:!0,constraint:function(e){return e>=0}}),new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"array"})]),8);i.error=a[0],i.file=a[1],i.name=a[2],i.type=a[3],i.size=a[4],i.data=a[5],i.customType=a[6],i.thumbnailSizes=a[7];var s=ae.isFile(i.file);s&&(i.name=i.name||i.file.name,i.type=i.type||i.file.type,i.size=i.size||i.file.size),i.messageParams={mentionType:n.MentionType.USERS,mentionedUserIds:i.mentionedUserIds,cachedMentionedUsers:[],cachedMentionedUserIds:[],metaArrays:i.metaArrays,parentMessageId:i.parentMessageId,pushNotificationDeliveryOption:i.pushNotificationDeliveryOption,appleCriticalAlertOptions:i.appleCriticalAlertOptions,fileName:i.name,mimeType:i.type,fileSize:i.size,data:i.data,customType:i.customType,isUpdate:!1,file:s?i.file:null,fileUrl:s?null:i.file,thumbnailSizes:i.thumbnailSizes}}else i.error=ge.error;return ae.isFile(i.file)&&(i.name=i.name||i.file.name,i.type=i.type||i.file.type,i.size=i.size||i.file.size),i}},{key:"_createTempFileMessage",value:function(e){try{var t=Ri.getInstance(this._iid),n=j.get(this._iid),r=n.Command,i=n.FileMessage,a=u(u({},e),{},{messageId:0,reqId:r.generateRequestId(),user:t.currentUser||{},channel:this,plainUrl:"string"==typeof e.file?e.file:"",thumbnails:e.thumbnailSizes.map((function(e){return{url:"",plainUrl:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}})),sendingStatus:t.MessageSendingStatus.PENDING,createdAt:(new Date).getTime()}),s=i.objectify(a);return new i(s)}catch(e){return null}}},{key:"sendFileMessage",value:function(){var e=this,t=ge.toArray(arguments),n=this._parseFileMessageArguments(t),r=j.get(this._iid).Command,i=null,a=r.generateRequestId();n.error||((i=this._createTempFileMessage(n)).requestedMentionUserIds=n.mentionedUserIds,a=i.reqId);var s=Ri.getInstance(this._iid);if(s&&s.currentUser||(n.error=new F("Connection should be made first.",F.CONNECTION_REQUIRED)),this.isGroupChannel()){var o=Ge.of(this._iid),l=we.of(this._iid);o.upsert([i],ke.UNSENT).then((function(){l.send({source:he.LOCAL_MESSAGE_PENDING_CREATED,payload:{channel:e,message:i}})}))}var u=j.get(this._iid).FileMessageQueue;return u.create(this).addJob(new u.Job({fileInfo:n,pendingMessage:i,requestId:a,error:n.error,response:null})),i}},{key:"sendFileMessages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.progress?n.progress:function(){},i=n.sent?n.sent:function(){},a=n.complete?n.complete:function(){};if(Array.isArray(e)&&e.length>0&&e.length<=20){var s=[];return e.forEach((function(n,o){s.push(t.sendFileMessage(n,r,(function(t,n){i(t,n),o===e.length-1&&a(null)})))})),s}return a(ge.error),null}},{key:"resendFileMessage",value:function(e,t,n){var r=this,i=j.get(this._iid),a=i.FileMessage,s=i.FileMessageParams,o=null,l=ge.parse(arguments,[new ge({type:a,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===r.url&&"string"==typeof e.data&&"string"==typeof e.customType&&Array.isArray(e.thumbnails)}}),new ge({type:"file",optionalIf:function(e){return!!e[0].plainUrl},defaultValue:null}),new ge({type:"callback"})]),u=S(l,4);return o=u[0],e=u[1],t=u[2],n=u[3],le(this._iid,(function(n){if(o)o.message+=" Please check if the failed message is resend-able with `message.isResendable().`",n(o,null);else{var i=new s;e.plainUrl?i.fileUrl=e.plainUrl:i.file=t,i.fileName=e.name,i.fileSize=e.size,i.mimeType=e.type,i.data=e.data,i.customType=e.customType,i.mentionType=e.mentionType,i.mentionedUserIds=e.requestedMentionUserIds,i.metaArrays=e.metaArrays,i.thumbnailSizes=e.thumbnails.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),i.appleCriticalAlertOptions=e.appleCriticalAlertOptions,r.sendFileMessage(i,n)}}),n)}},{key:"updateFileMessage",value:function(e,t,n,r){var i=this,a=j.get(this._iid),s=a.Command,o=a.FileMessage,l=a.FileMessageParams,c=arguments,d=null,h=null;if("number"==typeof e)switch(c.length){case 3:var f=S(ge.parse(c,[new ge({type:"number"}),new ge({type:l}),new ge({type:"callback"})]),4);d=f[0],e=f[1],h=f[2],r=f[3],h&&(h._isUpdate=!0);break;case 4:h=new l;var p=S(ge.parse(c,[new ge({type:"number"}),new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"callback"})]),5);d=p[0],e=p[1],t=p[2],n=p[3],r=p[4],h.data=t,h.customType=n,h._isUpdate=!0}return le(this._iid,(function(t){if(!d&&h&&h._validate()){var n=s.bUpdateFileMessage(u(u({channelUrl:i.url,messageId:e},h),{},{mentionType:h._mentionType,mentionedUserIds:h._mentionedUserIds})),r=Ri.getInstance(i._iid);r.sendCommand(n,(function(e,n){if(r.getErrorFirstCallback()){var a=[e,n];n=a[0],e=a[1]}var s=null;if(!n&&(s=new o(u(u({},e.getJsonElement()),{},{messageParams:h})),i.isGroupChannel())){var l=Ge.of(i._iid),c=we.of(i._iid);l.upsert([s],ke.SUCCEEDED).then((function(){c.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:i,message:s}})})).catch((function(e){J.error(e)}))}t(n,s)}))}else t(ge.error,null)}),r)}},{key:"cancelUploadingFileMessage",value:function(e,t){var n=null,r=S(ge.parse(arguments,[new ge({type:["number","string"]}),new ge({type:"callback"})]),3);n=r[0],e=r[1],t=r[2];var i=I.get(this._iid).container.isErrorFirstInCallback;return n?(i?t(n,null):t(null,n),!1):j.get(this._iid).FileMessageQueue.create(this).cancelUploadItemByRequestId(e,(function(e,n){return i?t(e,n):t(n,e)}))}},{key:"addReaction",value:function(e,t,n){var r=this,i=Ri.getInstance(this._iid),a=j.get(this._iid).ReactionEvent,s=null,o=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):e.sendingStatus===i.MessageSendingStatus.SUCCEEDED?I.get(r._iid).container.apiClient.addReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,r){var i=null;t||(i=a.createFromJson(u(u({},r),{},{msg_id:e.messageId}))),n(t,i)})):n(new F("Cannot add reaction to a non-succeeded message.",F.REQUEST_FAILED),null)}),n)}},{key:"deleteReaction",value:function(e,t,n){var r=this,i=Ri.getInstance(this._iid),a=j.get(this._iid).ReactionEvent,s=null,o=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),l=S(o,4);return s=l[0],e=l[1],t=l[2],n=l[3],le(this._iid,(function(n){s?n(s,null):e.sendingStatus===i.MessageSendingStatus.SUCCEEDED?I.get(r._iid).container.apiClient.deleteReaction({isGroupChannel:e.isGroupChannel(),channelUrl:e.channelUrl,messageId:e.messageId,key:t},(function(t,r){var i=null;t||(i=a.createFromJson(u(u({},r),{},{msg_id:e.messageId}))),n(t,i)})):n(new F("Cannot remove reaction to a non-succeeded message.",F.REQUEST_FAILED),null)}),n)}},{key:"deleteMessage",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return!Array.isArray(e)&&null!==e&&e.hasOwnProperty("messageId")}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.deleteMessage({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),messageId:e.messageId},(function(r,i){if(!r&&n.isGroupChannel()){var a=Ge.of(n._iid),s=we.of(n._iid);a.remove([e.messageId],ke.SUCCEEDED).then((function(){s.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:n,message:e}})})).catch((function(e){return J.error(e)}))}t(r,null)}))}),t)}},{key:"copyUserMessage",value:function(t,n,r){var i=j.get(this._iid);i.Command;var a=i.UserMessage,s=i.BaseMessageParams,o=null,l=S(ge.parse(arguments,[new ge({type:e}),new ge({type:a}),new ge({type:"callback"})]),4);o=l[0],t=l[1],n=l[2],r=l[3];var c=I.get(this._iid).container.isErrorFirstInCallback;if(o)return c?r(ge.error,null):r(null,ge.error),null;if(this.url!==n.channelUrl){var d=new F("The message does not belong to this channel",F.INVALID_PARAMETER);return c?r(d,null):r(null,d),null}var h={},f=Object.keys(n.translations);f.forEach((function(e){return h[e]=""}));var p=s.PushNotificationDeliveryOption.DEFAULT;return t._sendUserMessage(u(u({},n),{},{reqId:null,pushNotificationDeliveryOption:p,translationTargetLanguages:f,rootMessageId:null,parentMessageId:null,parentMessageText:null,messageParams:n._messageParams,callback:r}))}},{key:"copyFileMessage",value:function(t,n,r){var i=this,a=j.get(this._iid),s=a.Command;a.GroupChannel;var o=a.FileMessage,l=a.BaseMessageParams;a.FileMessageParams;var u=a.User,c=null,d=S(ge.parse(arguments,[new ge({type:e}),new ge({type:o}),new ge({type:"callback"})]),4);c=d[0],t=d[1],n=d[2],r=d[3];var h=I.get(this._iid),f=h.container.isErrorFirstInCallback;if(c)return f?r(ge.error,null):r(null,ge.error),null;if(this.url!==n.channelUrl){var p=new F("The message does not belong to this channel");return f?r(p,null):r(null,p),null}var y=Ri.getInstance(this._iid),g=n,_=g.url,m=g.name,v=g.type,E=g.size,b=g.data,C=g.customType,N=g.mentionType,k=g.mentionedUserIds,A=g.mentionedUsers,w=g.metaArrays,T=g.thumbnails,O=g.requireAuth,M=g.messageSurvivalSeconds,U=g.silent,R=g.appleCriticalAlertOptions,P=s.generateRequestId(),L=y.currentUser||{},D=t.url,x=t.isOpenChannel(),H=A.filter((function(e){return new u(u.objectify(e))})),G=l.PushNotificationDeliveryOption.DEFAULT,V=o.objectify({messageId:0,reqId:P,user:L,channel:t,plainUrl:_,name:m,type:v,size:E,data:b,customType:C,mentionType:N,mentionedUserIds:k,mentionedUsers:H,requestedMentionUserIds:k,metaArrays:w,thumbnails:T,requireAuth:O,messageSurvivalSeconds:M,silent:U,createdAt:(new Date).getTime(),appleCriticalAlertOptions:R}),B=new o(V);if(B.requestState=y.MessageRequestState.PENDING,B.sendingStatus=y.MessageSendingStatus.PENDING,!y.currentUser){var z=new F("Connection should be made first.",F.CONNECTION_REQUIRED),Y=new o(V);return Y.requestState=y.MessageRequestState.FAILED,Y.sendingStatus=y.MessageSendingStatus.FAILED,Y.errorCode=z.code,f?r(z,Y):r(Y,z),B}var q=s.bFile({requestId:P,channelUrl:D,url:_,name:m,type:v,size:E,data:b,customType:C,metaArrays:w,mentionType:N,mentionedUserIds:k,thumbnailSizes:T,requireAuth:O,pushNotificationDeliveryOption:G,silent:U,appleCriticalAlertOptions:R});return y.getConnectionState()===y.ConnectionState.OPEN||y.connecting||y.reconnecting?y.sendCommand(q,(function(e,n){if(y.getErrorFirstCallback()){var a=[e,n];n=a[0],e=a[1]}if(n)if(n.code!==F.INVALID_PARAMETER){var s=new o(V);s.requestState=y.MessageRequestState.FAILED,s.sendingStatus=y.MessageSendingStatus.FAILED,n.code!==F.FILE_UPLOAD_CANCEL_FAILED&&n.code!==F.REQUEST_CANCELED||(s.sendingStatus=y.MessageSendingStatus.CANCELED),s.errorCode=n.code,f?r(n,s):r(s,n)}else f?r(n,null):r(null,n);else{var l=new o(e.getJsonElement()),u=l._sender;if(L&&u&&L.userId===u.userId&&(L.nickname!==u.nickname&&(L.nickname=u.nickname),L.plainProfileUrl!==u.plainProfileUrl&&(L.plainProfileUrl=u.plainProfileUrl)),t.isGroupChannel()){t.lastMessage=l,Object.keys(y.channelHandlers).forEach((function(e){y.channelHandlers[e].onChannelChanged(t)}));var c=we.of(i._iid);Ct.of(i._iid).upsert([t]).then((function(){c.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}})})).catch((function(e){J.error(e)})),Ge.of(i._iid).upsert([l]).then((function(){c.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:i,message:l}})})).catch((function(e){J.error(e)}))}f?r(null,l):r(l,null)}})):h.container.apiClient.sendFileMessage({channelUrl:D,isOpenChannel:x,fileUrl:_,fileName:m,fileType:v,fileSize:E,data:b,customType:C,metaArrays:w,mentionType:N,mentionedUserIds:k,thumbnailSizes:T,requireAuth:O,pushNotificationDeliveryOption:G,appleCriticalAlertOptions:R},(function(e,n){if(e)if(e.code!==F.INVALID_PARAMETER){var i=new o(commnad.getJsonElement());i.requestState=y.MessageRequestState.FAILED,i.sendingStatus=y.MessageSendingStatus.FAILED,e.code!==F.FILE_UPLOAD_CANCEL_FAILED&&e.code!==F.REQUEST_CANCELED||(i.sendingStatus=y.MessageSendingStatus.CANCELED),i.errorCode=e.code,f?r(e,i):r(i,e)}else f?r(e,null):r(null,e);else{var a=new o(n),s=a._sender;L&&s&&L.userId===s.userId&&(L.nickname!==s.nickname&&(L.nickname=s.nickname),L.plainProfileUrl!==s.plainProfileUrl&&(L.plainProfileUrl=s.plainProfileUrl)),t.isGroupChannel()&&(t.lastMessage=a,Object.keys(y.channelHandlers).forEach((function(e){y.channelHandlers[e].onChannelChanged(t)}))),f?r(null,a):r(a,null)}})),B}},{key:"addOperators",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.addOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"removeOperators",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.removeOperators({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),operatorUserIds:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getMetaCounters",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,n){return t(e,n)}))}),t)}},{key:"getAllMetaCounters",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(t,n){return e(t,n)}))}),e)}},{key:"createMetaCounters",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.createMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e},(function(e,n){return t(e,n)}))}),t)}},{key:"updateMetaCounters",value:function(e,t,n){var r=this,i=null,a=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.updateMetaCounters({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),metaCounter:e,upsert:t,mode:"set"},(function(e,t){return n(e,t)}))}),n)}},{key:"increaseMetaCounters",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"increase"},(function(e,n){return t(e,n)}))}),t)}},{key:"decreaseMetaCounters",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return"number"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.updateMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaCounter:e,upsert:!1,mode:"decrease"},(function(e,n){var r=null;e||(r={},Object.keys(n).forEach((function(e){r[e]=n[e]}))),t(e,r)}))}),t)}},{key:"deleteMetaCounter",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.deleteMetaCounter({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){return t(e,n)}))}),t)}},{key:"deleteAllMetaCounters",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.deleteAllMetaCounters({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n)}))}),e)}},{key:"getCachedMetaData",value:function(){var e=Mt.get(this),t={};return Object.keys(e).forEach((function(n){var r=e[n];r.isRemoved||(t[n]=r.value)})),t}},{key:"getMetaData",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return Object.keys(e).map((function(t){return e[t]})).every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:e},(function(e,r){if(r&&r.ts){var i=r.metadata;n._addOrUpdateCachedMetaData(i,r.ts),t(e,i)}else t(e,r)}))}),t)}},{key:"getAllMetaData",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel(),keys:[]},(function(n,r){if(r&&r.ts){var i=r.metadata;t._refreshMetaData(i,r.ts),e(n,i)}else e(n,r)}))}),e)}},{key:"createMetaData",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.createMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),metaData:e},(function(e,n){t(e,n&&n.ts?n.metadata:n)}))}),t)}},{key:"updateMetaData",value:function(e,t,n){var r=this,i=null,a=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&!Array.isArray(e)&&Object.keys(e).length>0}}),new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.updateMetaData({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),metaData:e,upsert:t},(function(e,t){n(e,t&&t.ts?t.metadata:t)}))}),n)}},{key:"deleteMetaData",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.deleteMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),key:e},(function(e,n){t(e,n&&n.ts?{}:n)}))}),t)}},{key:"deleteAllMetaData",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.deleteAllMetaData({channelUrl:t.url,isOpenChannel:t.isOpenChannel()},(function(t,n){return e(t,n&&n.ts?{}:n)}))}),e)}},{key:"_updateMessageMetaArray",value:function(e,t,n,r){var i=this;return le(this._iid,(function(r){var a=j.get(i._iid),s=a.Command,o=a.UserMessage,l=a.FileMessage,u=a.AdminMessage,c=null;if(t.isUserMessage()?c=s.bUpdateUserMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n}):t.isFileMessage()&&(c=s.bUpdateFileMessage({channelUrl:e,messageId:t.messageId,metaArrayParams:n})),c){var d=Ri.getInstance(i._iid);d.sendCommand(c,(function(e,n){if(d.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}var a=null;n||(t.isUserMessage()?a=new o(e.getJsonElement()):t.isFileMessage()?a=new l(e.getJsonElement()):t.isAdminMessage()&&(a=new u(e.getJsonElement()))),r(n,a)}))}else r(ge.error,null)}),r)}},{key:"createMessageMetaArrayKeys",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ge({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=[];if(Array.isArray(t))for(var l=0;l<t.length;l++){var u=t[l];o.push(new r(u,[]))}return this._updateMessageMetaArray(this.url,e,{array:o.map((function(e){return e.encode()})),mode:"add",upsert:!0},n)}},{key:"deleteMessageMetaArrayKeys",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e&&""!==e}))}}),new ge({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=[];if(Array.isArray(t))for(var l=0;l<t.length;l++){var u=t[l];o.push(new r(u,[]))}return this._updateMessageMetaArray(this.url,e,{array:o.map((function(e){return e.encode()})),mode:"remove",upsert:!0},n)}},{key:"addMessageMetaArrayValues",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ge({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:o,mode:"add",upsert:!0},n)}},{key:"removeMessageMetaArrayValues",value:function(e,t,n){var r=j.get(this._iid).MessageMetaArray,i=null,a=ge.parse(arguments,[new ge({type:Tt}),new ge({type:"object",constraint:function(e){return e&&(Array.isArray(e)&&e.length>0&&e.every((function(e){return e instanceof r}))||Object.keys(e).length>0&&Object.keys(e).every((function(t){return Array.isArray(e[t])&&e[t].length>0&&e[t].every((function(e){return"string"==typeof e&&e.length>0}))})))}}),new ge({type:"callback"})]),s=S(a,4);if(i=s[0],e=s[1],t=s[2],n=s[3],i)return le(this._iid,(function(e){e(i,null)}),n);var o=Array.isArray(t)?t.map((function(e){return e.encode()})):Object.keys(t).map((function(e){return{key:e,value:t[e]}}));return this._updateMessageMetaArray(this.url,e,{array:o,mode:"remove",upsert:!0},n)}},{key:"report",value:function(e,t,n){var r=this,i=j.get(this._iid).BaseChannel,a=null,s=S(ge.parse(arguments,[new ge({type:i.ReportCategory}),new ge({type:"string"}),new ge({type:"callback"})]),4);return a=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){if(a)n(a,null);else{var i=Ri.getInstance(r._iid);I.get(r._iid).container.apiClient.report({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),reportCategory:e,reportingUserId:i.currentUser?i.currentUser.userId:null,reportDescription:t},(function(e,t){n(e,null)}))}}),n)}},{key:"reportUser",value:function(e,t,n,r){var i=this,a=j.get(this._iid).BaseChannel,s=null,o=S(ge.parse(arguments,[new ge({type:Ot}),new ge({type:a.ReportCategory}),new ge({type:"string"}),new ge({type:"callback"})]),5);return s=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){if(s)r(s,null);else{var a=Ri.getInstance(i._iid);I.get(i._iid).container.apiClient.reportUser({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),reportCategory:t,offendingUserId:e.userId,reportingUserId:a.currentUser?a.currentUser.userId:null,reportDescription:n},(function(e,t){r(e,null)}))}}),r)}},{key:"reportMessage",value:function(e,t,n,r){var i=this,a=j.get(this._iid).BaseChannel,s=null,o=S(ge.parse(arguments,[new ge({type:Tt}),new ge({type:a.ReportCategory}),new ge({type:"string"}),new ge({type:"callback"})]),5);return s=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){if(s)r(s,null);else{var a=Ri.getInstance(i._iid);I.get(i._iid).container.apiClient.reportMessage({messageId:e.messageId,channelUrl:i.url,isOpenChannel:i.isOpenChannel(),reportCategory:t,offendingUserId:e.sender.userId,reportingUserId:a.currentUser?a.currentUser.userId:null,reportDescription:n},(function(e,t){r(e,null)}))}}),r)}}],[{key:"CHANNEL_TYPE_OPEN",get:function(){return"open"}},{key:"CHANNEL_TYPE_GROUP",get:function(){return"group"}},{key:"CHANNEL_TYPE_BASE",get:function(){return"base"}},{key:"MessageTypeFilter",get:function(){return{ALL:"",USER:"MESG",FILE:"FILE",ADMIN:"ADMM"}}},{key:"ReportCategory",get:function(){return{SPAM:"spam",HARASSING:"harassing",SUSPICIOUS:"suspicious",INAPPROPRIATE:"inappropriate"}}},{key:"buildMessage",value:function(e,t){var n=j.get(this._iid),r=n.UserMessage,i=n.FileMessage,a=n.AdminMessage;if(e)switch(e.hasOwnProperty("channel_type")||(e.channel_type=t.channelType),e.type){case"MESG":return new r(e);case"FILE":var s=e.file;return new i(u(u({},e),{},{url:String(s.url),name:String(s.name),type:String(s.type),size:parseInt(s.size),data:String(s.data)}));case"BRDM":case"ADMM":return new a(e)}return null}}]),e}(),Pt=function(){function e(t){d(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0,this.data=t.hasOwnProperty("data")?t.data:null,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):Rt.CHANNEL_TYPE_GROUP)}return f(e,[{key:"isGroupChannel",value:function(){return this.channelType===Rt.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){return this.channelType===Rt.CHANNEL_TYPE_OPEN}}]),e}();Pt.CATEGORY_NONE=0,Pt.CATEGORY_CHANNEL_ENTER=10102,Pt.CATEGORY_CHANNEL_EXIT=10103,Pt.CATEGORY_USER_CHANNEL_MUTE=10201,Pt.CATEGORY_USER_CHANNEL_UNMUTE=10200,Pt.CATEGORY_USER_CHANNEL_BAN=10601,Pt.CATEGORY_USER_CHANNEL_UNBAN=10600,Pt.CATEGORY_CHANNEL_FREEZE=10701,Pt.CATEGORY_CHANNEL_UNFREEZE=10700,Pt.CATEGORY_TYPING_START=10900,Pt.CATEGORY_TYPING_END=10901,Pt.CATEGORY_CHANNEL_JOIN=1e4,Pt.CATEGORY_CHANNEL_LEAVE=10001,Pt.CATEGORY_CHANNEL_OPERATOR_UPDATE=10002,Pt.CATEGORY_CHANNEL_INVITE=10020,Pt.CATEGORY_CHANNEL_DECLINE_INVITE=10022,Pt.CATEGORY_CHANNEL_PROP_CHANGED=11e3,Pt.CATEGORY_CHANNEL_DELETED=12e3,Pt.CATEGORY_CHANNEL_META_DATA_CHANGED=11100,Pt.CATEGORY_CHANNEL_META_COUNTERS_CHANGED=11200,Pt.CATEGORY_CHANNEL_HIDE=13e3,Pt.CATEGORY_CHANNEL_UNHIDE=13001;var Lt=function e(t){d(this,e),t&&(this.category=t.hasOwnProperty("cat")?parseInt(t.cat):0)};Lt.CATEGORY_USER_BLOCK=20001,Lt.CATEGORY_USER_UNBLOCK=2e4,Lt.CATEGORY_FRIEND_DISCOVERED=20900;var Dt=function(){function e(t){d(this,e),this.sb=t,this.cls=j.get(this.sb._iid)}return f(e,[{key:"onRawCommandReceived",value:function(e){var t=this,n=this.cls,r=n.Command,i=n.User,a=n.Member,s=n.RestrictedUser,o=n.BaseChannel,l=n.GroupChannel,d=n.OpenChannel,h=n.UserMessage,f=n.FileMessage,p=n.AdminMessage,y=n.BaseMessageParams,g=n.ReactionEvent,_=n.ReadStatus,m=n.ThreadInfoUpdateEvent,v=n.PollUpdateEvent,E=n.PollVoteEvent,b=n.RestrictionInfo,C=I.get(this.sb._iid),S=C.container,N=S.pinger,k=S.auth,A=S.subscribedUnreadMessageCount,O=S.sessionManager,M=S.ackStateMap,U=new r(e),R=U.getJsonElement();if(R.hasOwnProperty("unread_cnt")&&"object"===c(R.unread_cnt)){var P=!1,L=R.unread_cnt.ts;"number"==typeof L&&L>A.ts&&(A.all!==R.unread_cnt.all&&(P=!0),A.all=R.unread_cnt.all>=0?R.unread_cnt.all:0,R.unread_cnt.custom_types&&Object.keys(R.unread_cnt.custom_types).forEach((function(e){A.custom_types[e]!==R.unread_cnt.custom_types[e]&&(P=!0),A.custom_types[e]=R.unread_cnt.custom_types[e]})),P=P&&A.ts>0,A.ts=L),P&&Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onTotalUnreadMessageCountUpdated(A.all,A.custom_types)}))}var D=U.requestId;if(D){var x=M[D];if(x){clearTimeout(x.timer);var H=x.handler;H&&("EROR"===U.command?H(new F(R.message,R.code),null):H(null,U)),M.hasOwnProperty(D)&&delete M[D]}}else{N&&"LOGI"!==U.command&&N.refreshTimer();var G=Ct.of(this.sb._iid),j=Ge.of(this.sb._iid),V=we.of(this.sb._iid);switch(U.command){case"LOGI":if(this.sb.loginTimer)if(clearTimeout(this.sb.loginTimer),this.sb.loginTimer=null,this.sb.onLoginTimerCancel=null,R.hasOwnProperty("error"))this.sb.isSessionOpened=!1,this.sb.loginHandler(new F(R.message,R.code),null);else{if(this.sb.isSessionOpened=!0,R.hasOwnProperty("key")&&(k.sessionKey=R.key),R.hasOwnProperty("ekey")&&(k.eKey=R.ekey),R.hasOwnProperty("user_id")&&(this.sb.currentUser=new i(R)),"number"==typeof R.ping_interval&&R.ping_interval>0&&C.set("pingInterval",1e3*R.ping_interval),"number"==typeof R.pong_timeout&&R.pong_timeout>0&&C.set("pongTimeout",1e3*R.pong_timeout),"number"==typeof R.login_ts){var B=1e3*R.login_ts;C.set("connectedAt",B),C.container.firstConnectedAt||C.set("firstConnectedAt",B)}if(R.hasOwnProperty("reconnect")&&"object"===c(R.reconnect)){var z=R.reconnect,Y=C.container.wsAdapter;z.hasOwnProperty("interval")&&"number"==typeof z.interval&&(Y.reconnectParams.interval=z.interval),z.hasOwnProperty("max_interval")&&"number"==typeof z.max_interval&&(Y.reconnectParams.maxInterval=z.max_interval),z.hasOwnProperty("mul")&&"number"==typeof z.mul&&(Y.reconnectParams.multiplier=z.mul),z.hasOwnProperty("retry_cnt")&&"number"==typeof z.retry_cnt&&(Y.reconnectParams.retryCount=z.retry_cnt)}"number"==typeof R.max_unread_cnt_on_super_group?C.set("maxUnreadCountOfSuperGroupChannel",R.max_unread_cnt_on_super_group):C.set("maxUnreadCountOfSuperGroupChannel",T.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL),R.profile_image_encryption&&C.set("profileImageEncryption",!0),N&&N.start(),R.hasOwnProperty("file_upload_size_limit")&&R.hasOwnProperty("premium_feature_list")&&R.hasOwnProperty("emoji_hash")&&C.set("appInfo",new Ne(R)),R.hasOwnProperty("concurrent_call_limit")&&R.hasOwnProperty("back_off_delay")&&(C.set("concurrentCallLimit",R.concurrent_call_limit),C.set("backOffDelay",R.back_off_delay)),this.sb.loginHandler(null,this.sb.currentUser)}break;case"EXPR":var q=new F("The session would be expired.",R.reason||F.SESSION_KEY_EXPIRED);O.refreshSessionIfExpiredError(q).then((function(){})).catch((function(){}));break;case"MESG":case"FILE":case"BRDM":case"ADMM":var K=null;if("MESG"===U.command?K=new h(R):"FILE"===U.command?K=new f(R):"BRDM"!==U.command&&"ADMM"!==U.command||(K=new p(R)),K){var W=this.sb.currentUser?this.sb.currentUser.userId:null,Q=K.silent,$=!!R.force_update_last_message,X=K._sender&&K._sender.userId===W;if(K.isGroupChannel()){var Z=l.cachedChannels.hasOwnProperty(K.channelUrl);l.getChannel(K.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var i=[e,n];n=i[0],e=i[1]}if(!n){if(!C.container.appInfo.isSupergroupMackDisabled||!e.isSuper||e.isBroadcast){var a=r.bMessageAck({channelUrl:K.channelUrl,messageId:K.messageId});t.sb.sendCommand(a)}if(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,K._sender&&e.memberMap.hasOwnProperty(K._sender.userId)){var s=e.memberMap[K._sender.userId];s.nickname!==K._sender.nickname&&(s.nickname=K._sender.nickname),s.plainProfileUrl!==K._sender.plainProfileUrl&&(s.plainProfileUrl=K._sender.plainProfileUrl),ae.deepEqual(s.metaData,K._sender.metaData)||(s.metaData=K._sender.metaData),s.isBlockedByMe!==K._sender.isBlockedByMe&&(s.isBlockedByMe=K._sender.isBlockedByMe)}var o=t.sb.currentUser;o&&X&&(o.nickname!==K._sender.nickname&&(o.nickname=K._sender.nickname),o.plainProfileUrl!==K._sender.plainProfileUrl&&(o.plainProfileUrl=K._sender.plainProfileUrl),ae.deepEqual(o.metaData,K._sender.metaData)||(o.metaData=K._sender.metaData));var u=!1;if(K.mentionType===y.MentionType.CHANNEL)X||(u=!0);else if(K.mentionType===y.MentionType.USERS)for(var c=0;c<K.mentionedUsers.length;c++)if(!X&&K.mentionedUsers[c].userId===W){u=!0;break}Q&&!X||(e.isEphemeral||Z)&&((!e.lastMessage||e.lastMessage.createdAt<K.createdAt)&&(e.lastMessage=K),X||e._setGroupChannelUnreadCount(e.unreadMessageCount+1,e.unreadMentionCount+(u?1:0))),$&&(!e.lastMessage||e.lastMessage.createdAt<K.createdAt)&&(e.lastMessage=K),Q&&!X||(G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)}))),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onMessageReceived(e,K),u&&r.onMentionReceived(e,K)})),j.upsert([K]).then((function(){V.send({source:he.EVENT_MESSAGE_RECEIVED,payload:{channel:e,message:K}})})).catch((function(e){t.handleCacheError(e)}))}}))}else K.isOpenChannel()&&d.getChannel(K.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=!1;if(K.mentionType===y.MentionType.CHANNEL)i=!0;else if(K.mentionType===y.MentionType.USERS)for(var a=0;a<K.mentionedUsers.length;a++)if(K.mentionedUsers[a].userId===W){i=!0;break}Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];d.enteredChannels[e.url]&&r.onMessageReceived(e,K),i&&r.onMentionReceived(e,K)})),d.enteredChannels[e.url]&&V.send({source:he.EVENT_MESSAGE_RECEIVED,payload:{channel:e,message:K}})}}))}break;case"MEDI":case"FEDI":case"AEDI":var ee=null;if("MEDI"===U.command?ee=new h(R):"FEDI"===U.command?ee=new f(R):"AEDI"===U.command&&(ee=new p(R)),ee){var te=this.sb.currentUser?this.sb.currentUser.userId:null,ne=ee.silent,re=ee.sender&&ee.sender.userId===te;if(ee.isGroupChannel()){var ie=l.cachedChannels.hasOwnProperty(ee.channelUrl);l.getChannel(ee.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=e.cachedReadReceiptStatus[te],a=i&&i>=ee.createAt,s=t.sb.currentUser;s&&re&&(s.nickname!==ee._sender.nickname&&(s.nickname=ee._sender.nickname),s.plainProfileUrl!==ee._sender.plainProfileUrl&&(s.plainProfileUrl=ee._sender.plainProfileUrl),ae.deepEqual(s.metaData,ee._sender.metaData)||(s.metaData=ee._sender.metaData));var o=!1,l=!1;if(!re&&!a&&R&&R.hasOwnProperty("old_values")){var u=R.old_values.mention_type||ee.mentionType,c=R.old_values.mentioned_user_ids||ee.mentionedUsers.map((function(e){return e.userId}));if(u===y.MentionType.USERS&&ee.mentionType===y.MentionType.USERS){for(var d=!1,h=!1,f=0;f<c.length;f++)if(c[f]===te){d=!0;break}for(var p=0;p<ee.mentionedUsers.length;p++)if(ee.mentionedUsers[p].userId===te){h=!0;break}!d&&h&&(l=!0,!ne&&ie&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}else if(u===y.MentionType.USERS&&ee.mentionType===y.MentionType.CHANNEL){for(var g=!1,_=0;_<c.length;_++)if(c[_]===te){g=!0;break}g||(l=!0,!ne&&ie&&(e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1),o=!0))}}e.lastMessage?e.lastMessage.createdAt<ee.createdAt?(e.lastMessage=ee,o=!0):e.lastMessage.createdAt===ee.createdAt&&e.lastMessage.messageId===ee.messageId&&(ie?e.lastMessage.updatedAt<ee.updatedAt&&(e.lastMessage=ee,o=!0):o=!0):(e.lastMessage=ee,o=!0),ne&&!re||!o||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onMessageUpdated(e,ee),l&&r.onMentionReceived(e,ee)})),j.upsert([ee]).then((function(){V.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:e,message:ee}})})).catch((function(e){t.handleCacheError(e)}))}}))}else ee.isOpenChannel()&&d.getChannel(ee.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageUpdated(e,ee)})),V.send({source:he.EVENT_MESSAGE_UPDATED,payload:{channel:e,message:ee}}))}))}break;case"DELM":var se=String(R.channel_type),oe=String(R.channel_url),le=parseInt(R.msg_id);switch(se){case o.CHANNEL_TYPE_GROUP:l.getChannel(oe,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,le)})),j.remove(["".concat(le)]).then((function(){V.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:e,messageId:le}})})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(oe,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onMessageDeleted(e,le)})),V.send({source:he.EVENT_MESSAGE_DELETED,payload:{channel:e,messageId:le}}))}))}break;case"READ":var ue=new _(R),ce=l.cachedChannels.hasOwnProperty(ue.channelUrl);l.getChannel(ue.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(ce&&e.updateReadReceipt(ue.reader.userId,ue.timestamp),t.sb.currentUser&&(ue.reader.userId===t.sb.currentUser.userId?ce?(e.unreadMessageCount>0||e.unreadMentionCount>0)&&(e._setGroupChannelUnreadCount(0,0),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):0!==e.unreadMessageCount&&0!==e.unreadMentionCount||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReadReceiptUpdated(e)})),V.send({source:he.EVENT_READ_RECEIPT_UPDATED,payload:{channel:e,user:ue.reader}})))}));break;case"MRCT":var de=String(R.channel_type),fe=String(R.channel_url),pe=g.createFromJson(R);switch(de){case o.CHANNEL_TYPE_GROUP:l.getChannel(fe,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,pe)})),j.get("".concat(pe.messageId)).then((function(n){n&&(n.applyReactionEvent(pe),j.upsert([n]).then((function(){V.send({source:he.EVENT_REACTION_UPDATED,payload:{channel:e,reactionEvent:pe}})})).catch((function(e){t.handleCacheError(e)})))})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(fe,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`")):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onReactionUpdated(e,pe)})),V.send({source:he.EVENT_REACTION_UPDATED,payload:{channel:e,reactionEvent:pe}}))}))}break;case"DLVR":var ye=String(R.channel_url),ge=R.hasOwnProperty("updated")?R.updated:null,_e=l.cachedChannels.hasOwnProperty(ye);l.getChannel(ye,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(!n){var i=!1;Object.keys(ge).forEach((function(n){t.sb.currentUser&&n===t.sb.currentUser.userId&&(i=!0),_e&&e.updateDeliveryReceipt(n,parseInt(ge[n]))})),l.cachedChannels[e.url]=e,i&&1===Object.keys(ge).length||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onDeliveryReceiptUpdated(e)})),V.send({source:he.EVENT_DELIVERY_RECEIPT_UPDATED,payload:{channel:e}}))}}));break;case"MTHD":var me=String(R.channel_url),ve=String(R.channel_type),Ee=m.createFromJson(R);switch(ve){case o.CHANNEL_TYPE_GROUP:l.getChannel(me,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,Ee)})),j.get("".concat(Ee.targetMessageId)).then((function(n){n&&(n.applyThreadInfoUpdateEvent(Ee),j.upsert([n]).then((function(){V.send({source:he.EVENT_THREAD_INFO_UPDATED,payload:{channel:e,threadInfoUpdateEvent:Ee}})})).catch((function(e){t.handleCacheError(e)})))})).catch((function(e){t.handleCacheError(e)})))}));break;case o.CHANNEL_TYPE_OPEN:d.getChannel(me,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n||(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onThreadInfoUpdated(e,Ee)})),V.send({source:he.EVENT_THREAD_INFO_UPDATED,payload:{channel:e,threadInfoUpdateEvent:Ee}}))}))}break;case"MCNT":if(R.hasOwnProperty("group_channels")&&Array.isArray(R.group_channels)){var be,Ce=[],Se=w(R.group_channels);try{for(Se.s();!(be=Se.n()).done;){var ke=be.value;if(ke){var Ae=l.cachedChannels[ke.channel_url];Ae&&Ae.isBroadcast&&Ae.setLatestMemberCount(ke.member_count,ke.joined_member_count,ke.ts)&&Ce.push(Ae)}}}catch(e){Se.e(e)}finally{Se.f()}Ce.length>0&&(Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelMemberCountChanged(Ce)})),G.upsert(Ce).then((function(){var e,t=w(Ce);try{for(t.s();!(e=t.n()).done;){var n=e.value;V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:n}})}}catch(e){t.e(e)}finally{t.f()}})).catch((function(e){t.handleCacheError(e)})))}if(R.hasOwnProperty("open_channels")&&Array.isArray(R.open_channels)){var Te,Oe=[],Ie=w(R.open_channels);try{for(Ie.s();!(Te=Ie.n()).done;){var Me=Te.value;if(Me){var Ue=d.cachedChannels[Me.channel_url];Ue&&Ue.setLatestParticipantCount(Me.participant_count,Me.ts)&&Oe.push(Ue)}}}catch(e){Ie.e(e)}finally{Ie.f()}if(Oe.length>0){Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelParticipantCountChanged(Oe)}));var Re,Pe=w(Oe);try{for(Pe.s();!(Re=Pe.n()).done;){var Le=Re.value;V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:Le}})}}catch(e){Pe.e(e)}finally{Pe.f()}}}break;case"PEDI":var De=v.createFromJson(R);Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onPollUpdated(De)}));break;case"VOTE":var xe=E.createFromJson(R);Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onPollVoted(xe)}));break;case"SYEV":var Fe=new Pt(R),He=R.ts;switch(Fe.category){case Pt.CATEGORY_CHANNEL_JOIN:case Pt.CATEGORY_CHANNEL_LEAVE:l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var s=Fe.data.hasOwnProperty("member_count")?Fe.data.member_count:null,o=Fe.data.hasOwnProperty("joined_member_count")?Fe.data.joined_member_count:null,u=!1;if(Fe.category===Pt.CATEGORY_CHANNEL_JOIN)(Fe.data.hasOwnProperty("users")?Fe.data.users:[Fe.data]).forEach((function(n){e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(s,o,R.ts):(n.state=a.JOINED,e.addMember(new a(n),He),e.updateJoinedMemberCount());var r=new i(n);t.sb.currentUser&&r.userId===t.sb.currentUser.userId&&(e.myMemberState="joined",l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){var i=t.sb.channelHandlers[n];i.onUserJoined(e,r),e.isBroadcast&&u&&i.onChannelMemberCountChanged([e])})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_JOINED,payload:{channel:e,user:r}})})).catch((function(e){t.handleCacheError(e)}))}));else{var c=new i(Fe.data);t.sb.currentUser&&c.userId===t.sb.currentUser.userId?(e.isPublic||l.removeCachedChannel(Fe.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)):l.cachedChannels[e.url]=e,e.isSuper||e.isBroadcast?u=e.setLatestMemberCount(s,o,R.ts):(e.removeMember(c),e.updateJoinedMemberCount()),Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserLeft(e,c),e.isBroadcast&&u&&r.onChannelMemberCountChanged([e])})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_LEFT,payload:{channel:e,user:c}})})).catch((function(e){t.handleCacheError(e)}))}}}));break;case Pt.CATEGORY_CHANNEL_OPERATOR_UPDATE:Fe.isGroupChannel()?l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{for(var a=Fe.data.operators.map((function(e){return new i(e)})),s=a.map((function(e){return e.userId})),o=0;o<e.members.length;o++)e.members[o].role=s.indexOf(e.members[o].userId)>=0?l.Role.OPERATOR:l.Role.NONE;e.myRole=t.sb.currentUser&&s.indexOf(t.sb.currentUser.userId)>=0?l.Role.OPERATOR:l.Role.NONE,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,a)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_OPERATOR_UPDATED,payload:{channel:e,operators:a}})})).catch((function(e){t.handleCacheError(e)}))}})):Fe.isOpenChannel()&&d.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):(e.operators=Fe.data.operators.map((function(e){return new i(e)})),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onOperatorUpdated(e,e.operators)})),V.send({source:he.EVENT_OPERATOR_UPDATED,payload:{channel:e,operators:operators}}))}));break;case Pt.CATEGORY_CHANNEL_INVITE:l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var s=null;Fe.data&&Fe.data.inviter&&Object.keys(Fe.data.inviter).length>0&&(s=new i(Fe.data.inviter));for(var o=[],u=0;u<Fe.data.invitees.length;u++){var c=new i(Fe.data.invitees[u]);o.push(c),Fe.data.invitees[u].state=a.INVITED;var d=new a(Fe.data.invitees[u]);if(e.isSuper||e.isBroadcast){var h=Fe.data.hasOwnProperty("member_count")?Fe.data.member_count:null,f=Fe.data.hasOwnProperty("joined_member_count")?Fe.data.joined_member_count:null;e.setLatestMemberCount(h,f,R.ts)}else e.addMember(d,He);t.sb.currentUser&&d.userId===t.sb.currentUser.userId&&(e.isHidden=!1,"joined"!==e.myMemberState&&(e.myMemberState="invited"),e.invitedAt=R.ts,l.cachedChannels[e.url]=e)}Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserReceivedInvitation(e,s,o)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_RECEIVED_INVITATION,payload:{channel:e,inviter:s,invitees:o}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Pt.CATEGORY_CHANNEL_DECLINE_INVITE:l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var a=null;Fe.data&&Fe.data.inviter&&Object.keys(Fe.data.inviter).length>0&&(a=new i(Fe.data.inviter));var s=new i(Fe.data.invitee);if(t.sb.currentUser&&s.userId===t.sb.currentUser.userId&&(e.invitedAt=0,e.myMemberState="none",e.isPublic||l.removeCachedChannel(Fe.channelUrl)),e.isSuper||e.isBroadcast){var o=Fe.data.hasOwnProperty("member_count")?Fe.data.member_count:null,u=Fe.data.hasOwnProperty("joined_member_count")?Fe.data.joined_member_count:null;e.setLatestMemberCount(o,u,R.ts)}else e.removeMember(s);t.sb.currentUser&&s.userId!==t.sb.currentUser.userId&&(l.cachedChannels[e.url]=e),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserDeclinedInvitation(e,a,s)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_DECLINED_INVITATION,payload:{channel:e,inviter:a,invitee:s}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Pt.CATEGORY_TYPING_START:case Pt.CATEGORY_TYPING_END:l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var a=new i(Fe.data);Fe.category===Pt.CATEGORY_TYPING_START?e.updateTypingStatus(a,!0):e.updateTypingStatus(a,!1),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onTypingStatusUpdated(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_TYPING_STATUS_UPDATED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Pt.CATEGORY_CHANNEL_ENTER:case Pt.CATEGORY_CHANNEL_EXIT:d.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var a=Fe.data.hasOwnProperty("participant_count")?Fe.data.participant_count:null,s=e.setLatestParticipantCount(a,R.ts),o=new i(Fe.data);Fe.category===Pt.CATEGORY_CHANNEL_ENTER?(Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserEntered(e,o),s&&r.onChannelParticipantCountChanged([e])})),V.send({source:he.EVENT_CHANNEL_ENTER,payload:{channel:e,user:o}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){var r=t.sb.channelHandlers[n];r.onUserExited(e,o),s&&r.onChannelParticipantCountChanged([e])})),V.send({source:he.EVENT_CHANNEL_EXIT,payload:{channel:e,user:o}}))}}));break;case Pt.CATEGORY_USER_CHANNEL_MUTE:case Pt.CATEGORY_USER_CHANNEL_UNMUTE:var je=Fe.category===Pt.CATEGORY_USER_CHANNEL_MUTE,Ve=u({},Fe.data);je&&(Ve.restriction_type=s.RestrictionType.MUTED);var Be=je?new s(Ve):new i(Fe.data),ze=je?"muted":"unmuted";Fe.isOpenChannel()?d.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):je?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,Be)})),V.send({source:he.EVENT_USER_MUTED,payload:{channel:e,user:Be}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,Be)})),V.send({source:he.EVENT_USER_UNMUTED,payload:{channel:e,user:Be}}))})):l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):(t.sb.currentUser&&Be.userId===t.sb.currentUser.userId&&(e.myMutedState=ze),Array.isArray(e.members)&&e.members.filter((function(e){return e&&e.userId===Be.userId})).forEach((function(e){e.isMuted=je,e.restrictionInfo=new b(Ve)})),je?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserMuted(e,Be)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_MUTED,payload:{channel:e,user:Be}})})).catch((function(e){t.handleCacheError(e)}))):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnmuted(e,Be)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_USER_UNMUTED,payload:{channel:e,user:Be}})})).catch((function(e){t.handleCacheError(e)}))))}));break;case Pt.CATEGORY_USER_CHANNEL_BAN:case Pt.CATEGORY_USER_CHANNEL_UNBAN:var Ye=Fe.category===Pt.CATEGORY_USER_CHANNEL_BAN,qe=u({},Fe.data);Ye&&(qe.restriction_type=s.RestrictionType.BANNED);var Ke=Ye?new s(qe):new i(Fe.data);Fe.isOpenChannel()?d.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):Ye?(t.sb.currentUser&&Ke.userId===t.sb.currentUser.userId&&(delete d.enteredChannels[Fe.channelUrl],t.cls.FileMessageQueue.delete(Fe.channelUrl)),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,Ke)})),V.send({source:he.EVENT_USER_BANNED,payload:{channel:e,user:Ke}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,Ke)})),V.send({source:he.EVENT_USER_UNBANNED,payload:{channel:e,user:Ke}}))})):l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else if(Ye){if(t.sb.currentUser&&Ke.userId===t.sb.currentUser.userId&&(e.isPublic||l.removeCachedChannel(Fe.channelUrl),e.myMemberState="none",e.invitedAt=0,e.joinedAt=0,e._setGroupChannelUnreadCount(0,0)),e.isSuper||e.isBroadcast){var i=Fe.data.hasOwnProperty("member_count")?Fe.data.member_count:null,a=Fe.data.hasOwnProperty("joined_member_count")?Fe.data.joined_member_count:null;e.setLatestMemberCount(i,a,R.ts)}else e.removeMember(Ke),e.updateJoinedMemberCount();Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserBanned(e,Ke)})),V.send({source:he.EVENT_USER_BANNED,payload:{channel:e,user:Ke}})}else Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onUserUnbanned(e,Ke)})),V.send({source:he.EVENT_USER_UNBANNED,payload:{channel:e,user:Ke}})}));break;case Pt.CATEGORY_CHANNEL_FREEZE:case Pt.CATEGORY_CHANNEL_UNFREEZE:Fe.isOpenChannel()?d.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):(e.isFrozen=Fe.data.freeze,d.cachedChannels[e.url]=e,Fe.category===Pt.CATEGORY_CHANNEL_FREEZE?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})),V.send({source:he.EVENT_CHANNEL_FROZEN,payload:{channel:e}})):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})),V.send({source:he.EVENT_CHANNEL_UNFROZEN,payload:{channel:e}})))})):l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):(e.isFrozen=Fe.data.freeze,l.cachedChannels[e.url]=e,Fe.category===Pt.CATEGORY_CHANNEL_FREEZE?(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelFrozen(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_FROZEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelUnfrozen(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_UNFROZEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))))}));break;case Pt.CATEGORY_CHANNEL_DELETED:Fe.isGroupChannel()?l.removeCachedChannel(Fe.channelUrl):d.removeCachedChannel(Fe.channelUrl);var We=Fe.channelUrl,Qe=Fe.isGroupChannel()?"group":"open";Object.keys(this.sb.channelHandlers).forEach((function(e){t.sb.channelHandlers[e].onChannelDeleted(We,Qe)})),G.remove([We]).then((function(){V.send({source:he.EVENT_CHANNEL_DELETED,payload:{channelUrl:We,channelType:Qe}})})).catch((function(e){t.handleCacheError(e)}));break;case Pt.CATEGORY_CHANNEL_PROP_CHANGED:Fe.isOpenChannel()?d.getChannelWithoutCache(Fe.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):(Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}}))})):l.getChannelWithoutCache(Fe.channelUrl,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n)J.debug("Discard command:","`".concat(U.command,"`"),Fe.category);else{var i=e.unreadMessageCount,a=e.unreadMentionCount;e.myCountPreference!==l.CountPreference.ALL&&(e.myCountPreference===l.CountPreference.UNREAD_MESSAGE_COUNT_ONLY?a=0:e.myCountPreference===l.CountPreference.UNREAD_MENTION_COUNT_ONLY?i=0:(i=0,a=0)),e._setGroupChannelUnreadCount(i,a),Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))}}));break;case Pt.CATEGORY_CHANNEL_META_DATA_CHANGED:case Pt.CATEGORY_CHANNEL_META_COUNTERS_CHANGED:var $e=Fe.data.hasOwnProperty("created"),Je=Fe.data.hasOwnProperty("updated"),Xe=Fe.data.hasOwnProperty("deleted");(Fe.isOpenChannel()?d.getChannel(Fe.channelUrl,T.INTERNAL_CALL):l.getChannel(Fe.channelUrl,T.INTERNAL_CALL)).then((function(e){var n=Fe.data.created,r=Fe.data.updated,i=Fe.data.deleted,a=R.ts;$e&&e._addOrUpdateCachedMetaData(n,a),Je&&e._addOrUpdateCachedMetaData(r,a),Xe&&e._markAsDeletedCachedMetaData(i,a),Object.keys(t.sb.channelHandlers).forEach((function(a){var s=t.sb.channelHandlers[a];Fe.category===Pt.CATEGORY_CHANNEL_META_DATA_CHANGED?($e&&s.onMetaDataCreated(e,n),Je&&s.onMetaDataUpdated(e,r),Xe&&s.onMetaDataDeleted(e,i),($e||Je)&&V.send({source:he.EVENT_CHANNEL_METADATA_UPDATED,payload:{channel:e,metaData:u(u({},n),r)}}),Xe&&V.send({source:he.EVENT_CHANNEL_METADATA_DELETED,payload:{channel:e,metaData:u({},i)}})):($e&&s.onMetaCountersCreated(e,n),Je&&s.onMetaCountersUpdated(e,r),Xe&&s.onMetaCountersDeleted(e,i),($e||Je)&&V.send({source:he.EVENT_CHANNEL_METACOUNTER_UPDATED,payload:{channel:e,metaData:u(u({},n),r)}}),Xe&&V.send({source:he.EVENT_CHANNEL_METACOUNTER_DELETED,payload:{channel:e,metaData:u({},i)}}))}))})).catch((function(e){return J.debug("Discard command:","`".concat(U.command,"`"),Fe.category)}));break;case Pt.CATEGORY_CHANNEL_HIDE:case Pt.CATEGORY_CHANNEL_UNHIDE:l.getChannel(Fe.channelUrl,T.INTERNAL_CALL,(function(e,n){if(t.sb.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}n?J.debug("Discard command:","`".concat(U.command,"`"),Fe.category):Fe.category===Pt.CATEGORY_CHANNEL_HIDE?(e.isHidden=!0,Fe.data&&(Fe.data.hasOwnProperty("allow_auto_unhide")&&(e.hiddenState=Fe.data.allow_auto_unhide?l.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:l.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE),Fe.data.hasOwnProperty("hide_previous_messages")&&Fe.data.hide_previous_messages&&e._setGroupChannelUnreadCount(0,0)),R.hasOwnProperty("ts_message_offset")&&(e._messageOffsetTimestamp=R.ts_message_offset),l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelHidden(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_HIDDEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)}))):(e.isHidden=!1,e.hiddenState=l.HiddenState.UNHIDDEN,l.cachedChannels[e.url]=e,Object.keys(t.sb.channelHandlers).forEach((function(n){t.sb.channelHandlers[n].onChannelChanged(e)})),G.upsert([e]).then((function(){V.send({source:he.EVENT_CHANNEL_UNHIDDEN,payload:{channel:e}})})).catch((function(e){t.handleCacheError(e)})))}))}break;case"USEV":var Ze=new Pt(R);switch(Ze.category){case Lt.CATEGORY_USER_BLOCK:case Lt.CATEGORY_USER_UNBLOCK:var et=Ze.data.blocker.user_id,tt=Ze.data.blockee.user_id;Object.keys(l.cachedChannels).forEach((function(e){var n=l.cachedChannels[e];try{t.sb.currentUser&&(t.sb.currentUser.userId===et?n.memberMap[tt].isBlockedByMe=Ze.category===Lt.CATEGORY_USER_BLOCK:t.sb.currentUser.userId===tt&&(n.memberMap[et].isBlockingMe=Ze.category===Lt.CATEGORY_USER_BLOCK))}catch(e){}}));break;case Lt.CATEGORY_FRIEND_DISCOVERED:var nt=Ze.data.friend_discoveries.map((function(e){return new i(e)}));Object.keys(this.sb.userEventHandlers).forEach((function(e){t.sb.userEventHandlers[e].onFriendsDiscovered(nt)}))}break;case"LEAV":case"JOIN":case"PONG":case"MTIO":case"TPST":case"TPEN":break;default:J.debug("Discard command:","`".concat(U.command,"`"))}}}},{key:"handleCacheError",value:function(e){J.error(e)}}]),e}(),xt=200,Ft={},Ht={},Gt=function(){function e(t){d(this,e),this.channel=t,this.uploadQueue=[],this.messageQueue=[],this.latestTimestampToSendMessage=0,j.get(this._iid).FileMessageQueue.queueMap[t.url]=this}return f(e,[{key:"_handleMessageQueueUpdated",value:function(e){var t=this;switch(J.debug("`fileMessageQueue` message queue updated:",this.messageQueue),e){case"add":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue();break;case"update":case"remove":if(this.messageQueue.length>0){var n=j.get(this._iid).FileMessageQueue,r=this.messageQueue[0];if(r)if(r.state===n.State.UPLOADED)if(r.state=n.State.SENDING,navigator&&"boolean"==typeof navigator.onLine)if(navigator.onLine){for(0===this.latestTimestampToSendMessage&&(this.latestTimestampToSendMessage=(new Date).getTime()-xt);(new Date).getTime()-this.latestTimestampToSendMessage<xt;);this.latestTimestampToSendMessage=(new Date).getTime(),this._sendUploadedMessage(r,(function(e,i){r.state=n.State.SENT,r.error=e||null,r.response=i||null,t._handleMessageQueueUpdated("update")}))}else r.state=n.State.SENT,r.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),r.response=null,this._finalizeMessage();else Je.ready().then((function(e){if(e){for(0===t.latestTimestampToSendMessage&&(t.latestTimestampToSendMessage=(new Date).getTime()-xt);(new Date).getTime()-t.latestTimestampToSendMessage<xt;);t.latestTimestampToSendMessage=(new Date).getTime(),t._sendUploadedMessage(r,(function(e,i){r.state=n.State.SENT,r.error=e||null,r.response=i||null,t._handleMessageQueueUpdated("update")}))}else r.state=n.State.SENT,r.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),r.response=null,t._finalizeMessage()}));else r.state===n.State.SENT&&this._finalizeMessage()}}}},{key:"_handleUploadQueueUpdated",value:function(e,t){var n=this;switch(J.debug("`fileMessageQueue` upload queue updated:",this.uploadQueue),e){case"add":var r=j.get(this._iid).FileMessageQueue;t.state=r.State.UPLOADING,t.error?(this.messageQueue.map((function(e){return e.requestId})).indexOf(t.requestId)>-1&&(t.state=r.State.SENT,this._handleMessageQueueUpdated("update")),this._finalizeUpload(t.requestId)):navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?this._uploadFile(t,(function(e){t.error&&t.state===r.State.SENT||(t.state=r.State.UPLOADED),t.fileInfo=e,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId)})):(t.state=r.State.SENT,t.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),t.response=null,this._handleMessageQueueUpdated("update"),this._finalizeUpload(t.requestId)):Je.ready().then((function(e){e?n._uploadFile(t,(function(e){t.error&&t.state===r.State.SENT||(t.state=r.State.UPLOADED),t.fileInfo=e,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId)})):(t.state=r.State.SENT,t.error=new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),t.response=null,n._handleMessageQueueUpdated("update"),n._finalizeUpload(t.requestId))}));break;case"update":break;case"remove":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue()}}},{key:"_moveFirstPendingMessageToUploadQueue",value:function(){var e=j.get(this._iid).FileMessageQueue,t=this.messageQueue.filter((function(t){return t.state===e.State.PENDING}));if(t.length>0){var n=t[0];this.uploadQueue.push(n),this._handleUploadQueueUpdated("add",n)}}},{key:"_sendUploadedMessage",value:function(e,t){var n=j.get(this._iid),r=n.Command,i=n.FileMessage,a=e.fileInfo,s=r.bFile(u(u({},a),{},{requestId:e.requestId,channelUrl:this.channel.url,url:a.file,metaArrays:a.metaArrays})),o=Ri.getInstance(this._iid),l=I.get(this._iid);o.getConnectionState()===o.ConnectionState.OPEN||!o.currentUser||o.connecting||o.reconnecting?o.sendCommand(s,(function(e,n){if(o.getErrorFirstCallback()){var r=[e,n];n=r[0],e=r[1]}if(n){var l=new i(s.getJsonElement());l.requestedMentionUserIds=a.mentionedUserIds,t(n,l)}else{var u=new i(e.getJsonElement());t(null,u)}})):l.container.apiClient.sendFileMessage(u(u({reqId:e.requestId,channelUrl:this.channel.url,isOpenChannel:this.channel.isOpenChannel()},a),{},{fileUrl:a.file,fileName:a.name,fileSize:a.size,fileType:a.type,metaArrays:a.metaArrays}),(function(e,n){var r=new i(e?s.getJsonElement():n);e&&(r.requestedMentionUserIds=a.mentionedUserIds),t(e,r)}))}},{key:"_uploadFile",value:function(e,t){var n=e.fileInfo,r=e.pendingMessage;if("string"!=typeof n.file&&n.file){var i=j.get(this._iid).FileMessageQueue;I.get(this._iid).container.apiClient.uploadFile(u(u({},n),{},{fileType:n.type,channelUrl:this.channel.url,reqId:r?r.reqId:null}),(function(r,a){if(r)e.state=i.State.SENT,e.error=r,e.response=null,t(n);else{var s="object"===c(a)?a:JSON.parse(a);n.file=s.url,n.thumbnailSizes=s.hasOwnProperty("thumbnails")?s.thumbnails:[],n.requireAuth=!!s.hasOwnProperty("require_auth")&&s.require_auth,n.size=s.hasOwnProperty("file_size")?s.file_size:n.size,t(n)}}))}else n.thumbnailSizes=[],n.requireAuth=!1,t(n)}},{key:"_finalizeUpload",value:function(e){var t=this.uploadQueue.map((function(e){return e.requestId})).indexOf(e);if(t>-1){var n=this.uploadQueue.splice(t,1);n.length>0&&this._handleUploadQueueUpdated("remove",n[0])}}},{key:"_finalizeMessage",value:function(){var e=this,t=I.get(this._iid),n=t.container.localCacheEnabled,r=t.container.isErrorFirstInCallback,i=Ri.getInstance(this._iid),a=Ct.of(this._iid),s=Ge.of(this._iid),o=we.of(this._iid),l=j.get(this._iid).FileMessageQueue,u=this.messageQueue[0],c=u.pendingMessage;if(u&&u.state===l.State.SENT){u.state=l.State.DONE;var d=u.response;d&&c&&(d._isAutoResendRegistered=c._isAutoResendRegistered);var h=u.error,f=h?new F(h.message,h.code):null,p=u.fileInfo.callback;if(d&&!h){d.reqId=c.reqId,d.requestState=i.MessageRequestState.SUCCEEDED,d.sendingStatus=i.MessageSendingStatus.SUCCEEDED;var y=i.currentUser;if(y&&d._sender&&y.userId===d._sender.userId&&(y.nickname!==d._sender.nickname&&(y.nickname=d._sender.nickname),y.plainProfileUrl!==d._sender.plainProfileUrl&&(y.plainProfileUrl=d._sender.plainProfileUrl)),this.channel.isGroupChannel())return this.channel.lastMessage=d,Object.keys(i.channelHandlers).forEach((function(t){i.channelHandlers[t].onChannelChanged(e.channel)})),void a.upsert([this.channel]).then((function(){o.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:e.channel}})})).then((function(){return s.removeUnsentMessages({channelUrl:e.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]})})).then((function(){return s.upsert([d],ke.SUCCEEDED)})).then((function(){rt._completeCurrentAndProcessNextAutoResend(i,d),o.send({source:he.EVENT_MESSAGE_SENT,payload:{channel:e.channel,message:d}})})).catch((function(e){return J.error(e)})).finally((function(){p&&(r?p(null,d):p(d,null)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))}if(h){if(d&&d._isAutoResendRegistered&&ae.isAutoResendableError(h.code))return this.messageQueue.shift(),void this._handleMessageQueueUpdated("remove");if(u.pendingMessage&&(d=u.pendingMessage._clone()),d&&h.code!==F.INVALID_PARAMETER)if(d.requestState=i.MessageRequestState.FAILED,h.code===F.FILE_UPLOAD_CANCEL_FAILED||h.code===F.REQUEST_CANCELED){if(d.sendingStatus=i.MessageSendingStatus.CANCELED,this.channel.isGroupChannel())return void s.removeUnsentMessages({channelUrl:this.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]}).then((function(){o.send({source:he.LOCAL_MESSAGE_CANCELED,payload:{channel:e.channel,message:d}})})).catch((function(e){return J.error(e)})).finally((function(){p&&(r?p(f,d):p(d,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))}else if(d.sendingStatus=i.MessageSendingStatus.FAILED,d.errorCode=h.code,d.requestedMentionUserIds=u.fileInfo.mentionedUserIds,h.code===F.FILE_SIZE_LIMIT_EXCEEDED&&d._messageParams&&d._messageParams.file&&(d._messageParams.file=null),this.channel.isGroupChannel())return void(h.code===F.USER_NOT_MEMBER||h.code===F.CHANNEL_NOT_FOUND?a.remove([this.channel.url]).then((function(){return s.removeUnsentMessages({channelUrl:e.channel.url,sendingStatus:i.MessageSendingStatus.PENDING,reqIds:[d.reqId]})})).then((function(){o.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:e.channel,message:d}})})).catch((function(e){return J.error(e)})).finally((function(){p&&(r?p(f,d):p(d,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")})):(n&&ae.isAutoResendableError(h.code)&&(d.sendingStatus=i.MessageSendingStatus.PENDING,d.errorCode=0,d._isAutoResendRegistered=!0),s.upsert([d],ke.UNSENT).then((function(){rt._completeCurrentAndProcessNextAutoResend(i,d),o.send({source:he.LOCAL_MESSAGE_FAILED,payload:{channel:e.channel,message:d}})})).catch((function(e){return J.error(e)})).finally((function(){var t=d._clone();t.sendingStatus=i.MessageSendingStatus.FAILED,t.errorCode=h.code,t._isAutoResendRegistered=!1,p&&(r?p(f,t):p(t,f)),e.messageQueue.shift(),e._handleMessageQueueUpdated("remove")}))))}p&&(r?p(f,d):p(d,f)),this.messageQueue.shift(),this._handleMessageQueueUpdated("remove")}}},{key:"addJob",value:function(e){this.messageQueue.push(e),this._handleMessageQueueUpdated("add")}},{key:"cancelUploadItemByRequestId",value:function(e,t){this._finalizeUpload(e);var n=this.messageQueue.map((function(e){return e.requestId})).indexOf(e);if(n>-1){var r=j.get(this._iid).FileMessageQueue,i=this.messageQueue[n];!i||i.state!==r.State.UPLOADING&&i.state!==r.State.PENDING||(i.state=r.State.SENT,i.response=null,i.error=new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),this._handleMessageQueueUpdated("update"));var a=r.uploadRequest[e];if(a)return"function"==typeof a.abort?a.abort():"function"==typeof a.cancel&&a.cancel("Upload has been canceled."),t(null,!0),!0;t(new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),!1)}else t(new F("Uploading has been completed or canceled.",F.FILE_UPLOAD_CANCEL_FAILED),!1);return!1}}],[{key:"State",get:function(){return{PENDING:"pending",UPLOADING:"uploading",UPLOADED:"uploaded",SENDING:"sending",SENT:"sent",DONE:"done"}}},{key:"getByChannelUrl",value:function(e){return j.get(this._iid).FileMessageQueue.queueMap[e]}},{key:"create",value:function(e){var t=j.get(this._iid).FileMessageQueue;return t.queueMap.hasOwnProperty(e.url)||(t.queueMap[e.url]=new t(e)),t.queueMap[e.url]}},{key:"delete",value:function(e){var t=j.get(this._iid).FileMessageQueue;t.queueMap.hasOwnProperty(e)&&delete t.queueMap[e]}},{key:"clear",value:function(){Ht[this._iid]={}}},{key:"queueMap",get:function(){return Ht[this._iid]||(Ht[this._iid]={}),Ht[this._iid]}},{key:"uploadRequest",get:function(){return Ft[this._iid]||(Ft[this._iid]={}),Ft[this._iid]}}]),e}();Gt.Job=function e(t){var n=t.fileInfo,r=t.requestId,i=t.pendingMessage,a=t.state,s=t.error,o=void 0===s?null:s,l=t.response,u=void 0===l?null:l;d(this,e),this.fileInfo=n,this.requestId=r,this.pendingMessage=i,this.state=a||Gt.State.PENDING,this.error=o,this.response=u};var jt,Vt={},Bt=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,a=void 0===i?256:i,s=e.blockHashBase,o=void 0===s?2:s,l=e.blockHashMultiplier,u=void 0===l?10:l,c=e.blockHashConstant,d=void 0===c?11:c,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,y=void 0!==p&&p;return Vt[t]||(this.itemSizeLimit=r,this.cacheLimit=a,this.blockHashBase=o,this.blockHashMultiplier=u,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=y,Vt[t]=this),Vt[t]}return e.get=function(e){return Vt[e]},e}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"}(jt||(jt={}));var zt,Yt=function(e){function t(t){var n=t.code,r=void 0===n?jt.UNKNOWN_ERROR:n,i=t.message,a=void 0===i?"Unknown error occurred.":i,s=e.call(this,a)||this;return s.code=r,s}return U(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:jt.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:jt.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:jt.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:jt.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:jt.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:jt.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:jt.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:jt.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:jt.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:jt.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:jt.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:jt.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:jt.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:jt.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:jt.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:jt.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:jt.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:jt.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:jt.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:jt.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"}(zt||(zt={}));var qt,Kt=function e(t,n){if(void 0===n&&(n=new WeakMap),"object"==typeof t&&null!==t){if(n.has(t))throw Yt.circularReferenceFound;n.set(t,!0);var r=null;if(Array.isArray(t))r=t.map((function(t){return e(t,n)}));else if(t instanceof RegExp)r=t;else if(t instanceof Date)r=t;else for(var i in r={},t)r[i]=e(t[i],n);return n.delete(t),r}return t},Wt=function(e,t){if(null==t)return 1;if(null==e)return-1;if(typeof e!=typeof t)throw Yt.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},Qt=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},$t=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},Jt=function e(t,n){if(!n)return!1;if("function"!=typeof t){for(var r in t)if(["/and","&&"].includes(r)){if(t[r].some((function(t){return!e(t,n)})))return!1}else if(["/or","||"].includes(r)){if(t[r].every((function(t){return!e(t,n)})))return!1}else if("/where"===r){if(!(0,t[r])(n))return!1}else{var i=r;if("object"==typeof t[i]){var a=t[i];for(var s in a)switch(s){case"/eq":case"=":if((o=n[i])!==(l=a[s]))return!1;break;case"/neq":case"!=":if((o=n[i])===(l=a[s]))return!1;break;case"/gt":case">":var o=n[i],l=a[s];if(!(Wt(o,l)>0))return!1;break;case"/gte":case">=":if(o=n[i],l=a[s],!(Wt(o,l)>=0))return!1;break;case"/lt":case"<":if(o=n[i],l=a[s],!(Wt(o,l)<0))return!1;break;case"/lte":case"<=":if(o=n[i],l=a[s],!(Wt(o,l)<=0))return!1;break;case"/in":if(o=n[i],!(l=a[s]).includes(o))return!1;break;case"/nin":if(o=n[i],(l=a[s]).includes(o))return!1;break;case"/contain":if(o=n[i],l=a[s],!o.includes(l))return!1;break;case"/regex":if(o=n[i],!(l=a[s]).test(o))return!1;break;case"/where":if(o=n[i],!(0,a[s])(o))return!1}}else if("function"==typeof t[i]){if(!t[i](n[i]))return!1}else if(t[i]!==n[i])return!1}return!0}return t(n)},Xt=function(){},Zt=function(){return Promise.resolve()},en=function(e){return e},tn=function(e,t){t(null)};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"}(qt||(qt={}));var nn,rn,an,sn=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,a=e.iterator,s=e.map,o=void 0===s?en:s,l=e.backward,u=void 0===l?Zt:l,c=e.forward,d=void 0===c?Zt:c,h=e.complete,f=void 0===h?Xt:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=o,this._backward=u,this._forward=d,this._iterator=a,this._complete=f}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return P(this,void 0,void 0,(function(){var e,t,n;return L(this,(function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.next=function(){return P(this,void 0,void 0,(function(){var e,t,n;return L(this,(function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),on=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.blockManager,s=e.indexer;this.condition=n,this.backward=i,this._blockManager=a,this._indexer=s}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var a=this._indexer.fields[i],s=1;if("-"===a[0]&&(a=a.slice(1),s=-1),this.condition[a])if("object"==typeof this.condition[a]){var o=s>0?n:t;for(var l in this.condition[a])if(o.includes(l))for(var u=r;u>=0;u--)if(s*Wt(this._indexer.origin[u].columnValues[i],this.condition[a][l])<=0){r=u;break}}else for(u=r;u>=0;u--)if(s*Wt(this._indexer.origin[u].columnValues[i],this.condition[a])<=0){r=u;break}}return Math.min(r+1,this._indexer.origin.length-1)}var c=0;if("function"!=typeof this.condition){var d=function(r){var i=h._indexer.fields[r],a=1;if("-"===i[0]&&(i=i.slice(1),a=-1),h.condition[i])if("object"==typeof h.condition[i])Object.keys(h.condition[i]).forEach((function(s){if((a>0?t:n).includes(s))for(var o=c;o<e._indexer.origin.length;o++)if(a*Wt(e._indexer.origin[o].columnValues[r],e.condition[i][s])>=0){c=o;break}}));else for(var s=c;s<h._indexer.origin.length;s++)if(a*Wt(h._indexer.origin[s].columnValues[r],h.condition[i])>=0){c=s;break}},h=this;for(i=0;i<this._indexer.fields.length;i++)d(i)}return Math.max(c-1,0)},e.prototype.each=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l=this;return L(this,(function(u){switch(u.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[++n]){if(!l._indexer.origin[++t])return!1;n=0}return!0}return!1},i=function(){if(l._indexer.origin[t]){if(!l._indexer.origin[t].keys[--n]){if(!l._indexer.origin[--t])return!1;n=l._indexer.origin[t].keys.length-1}return!0}return!1},a=null,!this._indexer.origin[t])return[3,4];s=this.backward?i:r,u.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if(o=u.sent(),Jt(this.condition,o))return a=o,[3,4];u.label=3;case 3:if(s())return[3,1];u.label=4;case 4:return[4,new Promise((function(s){var o=new sn({initialNextValue:Kt(a),iterator:e,forward:function(){return P(l,void 0,void 0,(function(){var e,a;return L(this,(function(s){switch(s.label){case 0:e=this.backward?i:r,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=s.sent(),Jt(this.condition,a)?[2,Kt(a)]:[3,1];case 3:return[2,null]}}))}))},backward:function(){return P(l,void 0,void 0,(function(){var e,a;return L(this,(function(s){switch(s.label){case 0:e=this.backward?r:i,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return a=s.sent(),Jt(this.condition,a)?[2,Kt(a)]:[3,1];case 3:return[2,null]}}))}))},complete:s});e(o)}))];case 5:return[2,u.sent()]}}))}))},e}(),ln=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.mutex,s=e.blockManager,o=e.indexer;this._mutex=a,this._iterator=new on({condition:n,backward:i,blockManager:s,indexer:o})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),P(this,void 0,void 0,(function(){var t,n,r,i,a=this;return L(this,(function(s){switch(s.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw Yt.collectionQueryNotValid;s.label=1;case 1:return s.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return s.sent(),[4,this._iterator.each((function(e){return P(a,void 0,void 0,(function(){return L(this,(function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]}))}))}))];case 3:return s.sent(),this._mutex.unlock(),[2,r];case 4:throw i=s.sent(),this._mutex.unlock(),i;case 5:return[2]}}))}))},e.prototype.count=function(){return P(this,void 0,void 0,(function(){var e,t,n=this;return L(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each((function(t){return P(n,void 0,void 0,(function(){return L(this,(function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]}))}))}))];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}}))}))},e}(),un=function(e){return"nest@"+e},cn=function(e,t){return un(e)+"/"+t},dn=function(e,t){return cn(e,t)+".metadata"},hn=function(e,t){return cn(e,t)+"/block."},fn=function(e,t){return cn(e,t)+"/blob."},pn=function(e,t,n,r){return void 0===r&&(r=0),""+fn(e,t)+n+"."+r},yn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this._store=r}return e.prototype._makeShards=function(e,t){var n=Math.max(this._store.itemSizeLimit-1024,0);if(n>0){for(var r=Math.ceil(e.data.length/n)+"."+e.type+"."+t,i=[],a=0;a<e.data.length;a+=n){var s=e.data.slice(a,a+n);i.push(s)}return{blobId:r,shards:i}}return{blobId:null,shards:null}},e.prototype._encode=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){var n=new FileReader;n.onload=function(){t({data:n.result,type:e.type})},n.readAsDataURL(e)}))];case 1:return[2,t.sent()]}}))}))},e.prototype._decode=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s;return L(this,(function(o){switch(o.label){case 0:return"undefined"==typeof fetch?[3,3]:[4,fetch(e.data)];case 1:return[4,o.sent().blob()];case 2:return[2,o.sent()];case 3:for(t=[],n=atob(e.data.split(",")[1]),r=0;r<n.length;r+=512){for(i=n.slice(r,r+512),a=new Array(i.length),s=0;s<i.length;s++)a[s]=i.charCodeAt(s);t.push(new Uint8Array(a))}return[2,new Blob(t,{type:e.type})]}}))}))},e.prototype.get=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l;return L(this,(function(u){switch(u.label){case 0:if(t=[],n=e.split("."),r=n[0],i=n[1],!((a=parseInt(r))>0))return[3,6];s=0,u.label=1;case 1:return s<a?(o=pn(this.dbname,this.collectionName,e,s),[4,this._store.get(o)]):[3,4];case 2:if(!(l=u.sent())||!l.d)throw Yt.storeBrokenBlob;t.push(l.d),u.label=3;case 3:return s++,[3,1];case 4:return[4,this._decode({data:t.join(""),type:i})];case 5:return[2,u.sent()];case 6:return[2,null]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t=""+Date.now()),P(this,void 0,void 0,(function(){var n,r,i,a,s,o,l;return L(this,(function(u){switch(u.label){case 0:return n=[],[4,this._encode(e)];case 1:if(r=u.sent(),i=this._makeShards(r,t),a=i.blobId,s=i.shards,!a)return[3,3];for(o=0;o<s.length;o++)l=pn(this.dbname,this.collectionName,a,o),n.push({key:l,value:{d:s[o]},generation:1});return[4,this._store.setMany(n)];case 2:if(u.sent().some((function(e){return e instanceof Error})))throw Yt.storeWriteFailed;return[2,a];case 3:return[2,null]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i;return L(this,(function(a){switch(a.label){case 0:if(t=[],n=e.split(".")[0],!((r=parseInt(n))>0))return[3,2];for(i=0;i<r;i++)t.push(pn(this.dbname,this.collectionName,e,i));return[4,this._store.removeMany(t)];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return e=fn(this.dbname,this.collectionName),t=[],[4,this._store.getAllKeys()];case 1:for(n=s.sent(),r=0,i=n;r<i.length;r++)(a=i[r]).startsWith(e)&&t.push(a);return[4,this._store.removeMany(n)];case 2:return s.sent(),[2]}}))}))},e}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"}(nn||(nn={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(rn||(rn={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(an||(an={}));var gn=[rn.PENDING,rn.VOLATILE],_n={},mn=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return _n[t]||(this.dbname=t,this._items=[],this._limit=r,_n[t]=this),_n[t]}return e.get=function(e){return _n[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=an.DEFAULT),P(this,void 0,void 0,(function(){var r,i;return L(this,(function(a){switch(a.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(i=a.sent())&&(r={key:t,value:i,generation:1,state:n===an.PERSISTENT?rn.PERSISTENT:rn.VOLATILE},this.put(r)),[3,3];case 2:n===an.PERSISTENT&&(r.state=rn.PERSISTENT),a.label=3;case 3:return[2,r]}}))}))},e.prototype.get=function(e,t){void 0===t&&(t=an.DEFAULT);var n=this._items.map((function(e){return e.key})).indexOf(e);if(n>-1){var r=this._items[n];return t===an.PERSISTENT&&(r.state=rn.PERSISTENT),t!==an.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){if(this._limit>0){var t=this._items.map((function(e){return e.key})).indexOf(e.key);if(t>-1)gn.includes(this._items[t].state)&&gn.includes(e.state)?(this._items.splice(t,1),this._items.push(e)):(this._items[t].state=e.state,this._items[t].generation=e.generation,this._items[t].value=e.value);else{this._items.push(e);var n=this._items.filter((function(e){return e.state===rn.VOLATILE})).length-this._limit;if(n>0){for(var r=[],i=0,a=this._items;i<a.length;i++){var s=a[i];s.state===rn.VOLATILE&&n>0?n--:r.push(s)}this._items=r}}}},e.prototype.remove=function(e){var t=this._items.map((function(e){return e.key})).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter((function(t){return!e(t)}))},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter((function(e){return e.state!==rn.VOLATILE}))},e}(),vn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._metadata=null,this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey=function(e,t){return cn(e,t)+"/trans.metadata"}(t,n),this.recordsetKey=function(e,t){return cn(e,t)+"/trans.recordset"}(t,n),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,e),[2,this._reduceRecordSet(t)]}}))}))},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],a=[],s=i.requests.length-1;s>=0;s--){var o=i.requests[s],l=o.data;n[l.key]||(a.unshift(o),n[l.key]=!0)}a.length>0&&(i.requests=a,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i,a,s,o,l,u,c;return L(this,(function(d){switch(d.label){case 0:n=mn.get(this.dbname),r=t.generation,i=t.requests,a=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._store.setMany(i.map((function(e){return R(R({},e.data),{generation:r})})))];case 2:for(s=d.sent(),o=0;o<i.length;o++)s[o]instanceof Error&&(a||(a=s[o]),l=i[o].data,n.put(R(R({},l),{generation:r,state:rn.PERSISTENT})));return[3,4];case 3:return u=d.sent(),a=u,[3,4];case 4:return a?[3,6]:(c=e.filter((function(e){return e.generation!==r})),[4,this._store.set({key:this.recordsetKey,value:c,generation:r})]);case 5:return d.sent(),this._onWrite.forEach((function(e){e(i.map((function(e){return e.data})))})),[3,7];case 6:this._onError.forEach((function(e){return e(a)})),d.label=7;case 7:return[2]}}))}))},e.prototype.init=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i;return L(this,(function(a){switch(a.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=a.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=a.sent(),n=0,r=t,a.label=3;case 3:return n<r.length?(i=r[n],[4,this._applyRecord(t,i)]):[3,6];case 4:a.sent(),a.label=5;case 5:return n++,[3,3];case 6:return[2]}}))}))},e.prototype.on=function(e,t,n){switch(e){case nn.COMMIT:this._onCommit.set(t,n);break;case nn.WRITE:this._onWrite.set(t,n);break;case nn.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){void 0===t&&(t=null),this._requests.push({data:e,options:t}),mn.get(this.dbname).put(R({state:rn.PENDING,generation:this.generation},e))},e.prototype.requestMultipleWrite=function(e,t){void 0===t&&(t=null);for(var n=mn.get(this.dbname),r=0,i=e;r<i.length;r++){var a=i[r];this._requests.push({data:a,options:t}),n.put(R({state:rn.PENDING,generation:this.generation},a))}},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){return mn.get(this.dbname).clearByCondition((function(e){return e.state===rn.PENDING})),this._requests=[],[2]}))}))},e.prototype.commit=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d,h=this;return L(this,(function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},o=e.length-1;o>=0;o--)r=e[o],u=r.data,n[u.key]||(n[u.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return a=f.sent(),[4,this._store.set({key:this.recordsetKey,value:a,generation:this.generation})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata,generation:1})];case 3:for(f.sent(),s=mn.get(this.dbname),o=0;o<t.length;o++)l=t[o],u=l.data,c=l.options,s.put(R(R({},u),{generation:i.generation,state:c&&c.persistent?rn.PERSISTENT:rn.VOLATILE}));this._requests=[],this._onCommit.forEach((function(t){t(e.map((function(e){return e.data})))})),d=Bt.get(this.dbname),setTimeout((function(){try{h._applyRecord(a,i)}catch(e){h._onError.forEach((function(n){return n(e)}))}}),d.transactionApplyDelay),f.label=4;case 4:return[2]}}))}))},e}(),En=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,a=e.limit;this.blockId=t,this.keyName=n,this.limit=a,this._items=D([],i,!0)}return e.createFromCacheItem=function(t){return t?new e(t.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(e){var t=this;return this._items.find((function(n){var r=n[t.keyName];return e===r}))},e.prototype.has=function(e){var t=this;return this._items.map((function(e){return e[t.keyName]})).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map((function(e){return e[t.keyName]})).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),bn=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,a=void 0===i?Qt:i,s=e.transaction,o=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=a,this.metadata=r,this._transaction=s,this._store=o}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,a=""+function(e,t,n){var r=n.base*Math.pow(n.multiplier,t)+n.constant;return(n.hashFunction||Qt)(e,r)}(e,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant}),""+hn(n,r)+i+"."+a;var n,r,i,a},e.prototype._findBlock=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a;return L(this,(function(s){switch(s.label){case 0:t=mn.get(this.dbname),n=this.metadata.blockLevel,s.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=s.sent())&&(a=En.createFromCacheItem(i)).getItemByKey(e))return[2,a];s.label=3;case 3:return n--,[3,1];case 4:return[2,null]}}))}))},e.prototype.getFromBlock=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}}))}))},e.prototype.putToBlock=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i,a,s;return L(this,(function(o){switch(o.label){case 0:return n=Bt.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,mn.get(this.dbname).find(this._store,r)];case 1:return a=o.sent(),(s=a?En.createFromCacheItem(a):new En({blockId:r,keyName:this.keyName,items:[],limit:i})).add(t)?(this._transaction.requestWrite({key:s.blockId,value:s.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.removeFromBlock=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.clearAllBlocks=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a,s;return L(this,(function(o){switch(o.label){case 0:return e=hn(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=o.sent(),n=t.filter((function(t){return t.startsWith(e)})),[4,this._store.removeMany(n)];case 2:for(o.sent(),r=mn.get(this.dbname),i=0,a=n;i<a.length;i++)s=a[i],r.remove(s);return[2]}}))}))},e}(),Cn=function(){function e(e){var t=this,n=e.dbname,r=e.collectionName,i=e.keyName,a=e.fields,s=e.transaction,o=e.store;this._origin=[],this._table=[],this.dbname=n,this.collectionName=r,this.keyName=i,this.fields=a,this.indexerKey=function(e,t,n){return cn(e,t)+"/index."+n}(this.dbname,this.collectionName,this.fields.join(">")),this._transaction=s,this._store=o,this._transaction.on(nn.COMMIT,this.indexerKey,(function(){return t.commit()})),this._transaction.on(nn.ERROR,this.indexerKey,(function(){return t.abort()}))}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=this.indexOf(n),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=this.indexOf(n),i=r[0];if(r[1]){var a=this._table[i].keys.indexOf(t);if(a>-1)return this._table[i].keys.splice(a,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){for(var t,n,r=[],i=0,a=this.fields;i<a.length;i++){var s=a[i];if("-"===s[0]&&(s=s.slice(1)),n=void 0,n=typeof(t=e[s]),null!==t&&"undefined"!==n&&"boolean"!==n&&"number"!==n&&"string"!==n)throw Yt.indexTypesNotMatch;r.push(e[s])}return r},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=Wt(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return P(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,l,u,c,d;return L(this,(function(h){switch(h.label){case 0:return[4,(e=mn.get(this.dbname)).find(this._store,this.indexerKey,an.PERSISTENT)];case 1:return(t=h.sent())?[3,7]:(n=hn(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=h.sent(),i=0,a=r,h.label=3;case 3:return i<a.length?(s=a[i]).startsWith(n)?[4,e.find(this._store,s,an.NO_CACHE)]:[3,5]:[3,6];case 4:for(o=h.sent(),l=En.createFromCacheItem(o),u=0,c=l.items;u<c.length;u++)d=c[u],this._addItem(d);h.label=5;case 5:return i++,[3,3];case 6:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,8];case 7:this._origin=t.value,this._table=Kt(this._origin),h.label=8;case 8:return[2]}}))}))},e.prototype.drop=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return mn.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),[2]}}))}))},e.prototype.addItem=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.removeItem=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.commit=function(){this._origin=this._table,this._table=Kt(this._origin)},e.prototype.abort=function(){this._table=Kt(this._origin)},e}(),Sn=function(){function e(e){var t;this._locked=!1,this._resolvers=[],this.id=(t=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))),this.key=e}return Object.defineProperty(e.prototype,"locked",{get:function(){return this._locked},enumerable:!1,configurable:!0}),e.prototype.wait=function(){var e=this;return new Promise((function(t){e._resolvers.push(t)}))},e.prototype.lock=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return this._locked?[4,this.wait()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this._locked=!0,[2]}}))}))},e.prototype.unlock=function(){this._locked&&(this._resolvers.length>0?this._resolvers.shift()():this._locked=!1)},e}(),Nn=function(){function e(e){var t=this,n=e.dbname,r=e.collectionName,i=e.keyName,a=e.keyHash,s=e.indexes,o=e.store;this._state=zt.INIT,this._metadata=null,this._indexers=[],this.dbname=n,this.name=r,this.keyName=i,this.indexes=D([[i]],s.filter((function(e){return Cn.createKey(e)!==t.keyName})),!0),this._keyHash=a,this._store=o,this._mutex=new Sn(function(e,t){return cn(e,t)+".lock"}(n,r)),this._blobContainer=new yn({dbname:n,collectionName:r,store:o}),this._transaction=new vn({dbname:n,collectionName:r,store:o})}return e.metadataOf=function(e,t,n){return P(this,void 0,void 0,(function(){var r;return L(this,(function(i){switch(i.label){case 0:return r=dn(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.init=function(){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,l,u,c,d,h,f=this;return L(this,(function(p){switch(p.label){case 0:return[4,this._mutex.lock()];case 1:p.sent(),p.label=2;case 2:return p.trys.push([2,9,,10]),t=Bt.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=p.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:for(p.sent(),this._blockManager=new bn({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=D([],this.indexes,!0),i=[],a=r.map((function(e){return Cn.createKey(e)})),s=n?n.indexes.map((function(e){return Cn.createKey(e)})):[],o=0,l=s;o<l.length;o++)u=l[o],a.includes(u)||i.push(Cn.parseKey(u));return(c=[]).push.apply(c,r.map((function(e){var t=new Cn({dbname:f.dbname,collectionName:f.name,keyName:f.keyName,fields:e,transaction:f._transaction,store:f._store});return f._indexers.push(t),t.ensure()}))),c.push.apply(c,i.map((function(e){return new Cn({dbname:f.dbname,collectionName:f.name,keyName:f.keyName,fields:e,transaction:f._transaction,store:f._store}).drop()}))),[4,Promise.all(c)];case 5:return p.sent(),[4,this._transaction.commit()];case 6:return p.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(d=dn(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata,generation:1})]);case 7:p.sent(),p.label=8;case 8:return this._state=zt.READY,this._mutex.unlock(),[3,10];case 9:throw h=p.sent(),this._mutex.unlock(),h;case 10:return[2]}}))}))},e.prototype.close=function(){this._state=zt.CLOSED},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){void 0===e&&(e=null),e||(e=[this.keyName]);for(var t=Cn.createKey(e),n=0,r=this._indexers;n<r.length;n++){var i=r[n];if(t===Cn.createKey(i.fields))return i}return null},e.prototype._upgradeBlockLevel=function(){return P(this,void 0,void 0,(function(){var e;return L(this,(function(t){switch(t.label){case 0:return e=dn(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata,generation:1})];case 1:return t.sent(),[2]}}))}))},e.prototype._requestInsert=function(e){return P(this,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return i.sent()?[3,10]:[4,this._blockManager.putToBlock(t,e)];case 2:return i.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return i.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:i.sent(),i.label=5;case 5:n=0,r=this._indexers,i.label=6;case 6:return n<r.length?[4,r[n].addItem(e)]:[3,9];case 7:i.sent(),i.label=8;case 8:return n++,[3,6];case 9:return[3,11];case 10:throw Yt.collectionInsertDuplicate;case 11:return[2]}}))}))},e.prototype._requestUpsert=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return L(this,(function(l){switch(l.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=l.sent())?[3,10]:[4,this._blockManager.putToBlock(t,e)];case 2:return l.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return l.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:l.sent(),l.label=5;case 5:r=0,i=this._indexers,l.label=6;case 6:return r<i.length?[4,(o=i[r]).addItem(e)]:[3,9];case 7:l.sent(),l.label=8;case 8:return r++,[3,6];case 9:return[3,16];case 10:return[4,this._blockManager.putToBlock(t,e)];case 11:l.sent(),a=0,s=this._indexers,l.label=12;case 12:return a<s.length?0===(o=s[a]).diff(o.getColumnValues(n),o.getColumnValues(e))?[3,15]:[4,o.removeItem(n)]:[3,16];case 13:return l.sent(),[4,o.addItem(e)];case 14:l.sent(),l.label=15;case 15:return a++,[3,12];case 16:return[2]}}))}))},e.prototype._requestUpdate=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=s.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,7];case 2:s.sent(),r=0,i=this._indexers,s.label=3;case 3:return r<i.length?0===(a=i[r]).diff(a.getColumnValues(n),a.getColumnValues(e))?[3,6]:[4,a.removeItem(n)]:[3,7];case 4:return s.sent(),[4,a.addItem(e)];case 5:s.sent(),s.label=6;case 6:return r++,[3,3];case 7:return[2]}}))}))},e.prototype._requestRemove=function(e){return P(this,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=i.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,6];case 2:i.sent(),n=0,r=this._indexers,i.label=3;case 3:return n<r.length?[4,r[n].removeItem(t)]:[3,6];case 4:i.sent(),i.label=5;case 5:return n++,[3,3];case 6:return[2]}}))}))},e.prototype._requestClear=function(){return P(this,void 0,void 0,(function(){var e,t;return L(this,(function(n){switch(n.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:n.sent(),e=0,t=this._indexers,n.label=2;case 2:return e<t.length?[4,t[e].clear()]:[3,5];case 3:n.sent(),n.label=4;case 4:return e++,[3,2];case 5:return[2]}}))}))},e.prototype.getByKey=function(e){return P(this,void 0,void 0,(function(){var t,n;return L(this,(function(r){switch(r.label){case 0:return this._state!==zt.READY?[3,6]:[4,this._mutex.lock()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,Kt(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw Yt.collectionNotReady;case 7:return[2]}}))}))},e.prototype.query=function(e){return void 0===e&&(e={}),this._state===zt.READY?new ln({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward}):null},e.prototype.insertOne=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return this._state!==zt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Yt.collectionKeyNotGiven;return[4,this._requestInsert(Kt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Yt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.insertMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a=this;return L(this,(function(s){switch(s.label){case 0:return this._state!==zt.READY?[3,11]:[4,this._mutex.lock()];case 1:s.sent(),s.label=2;case 2:if(s.trys.push([2,8,,10]),e.some((function(e){return!a._hasPropertyOfKeyName(e)})))throw Yt.collectionKeyNotGiven;t=0,n=e,s.label=3;case 3:return t<n.length?(r=n[t],[4,this._requestInsert(Kt(r))]):[3,6];case 4:s.sent(),s.label=5;case 5:return t++,[3,3];case 6:return[4,this._transaction.commit()];case 7:return s.sent(),this._mutex.unlock(),[2,e];case 8:return i=s.sent(),[4,this._transaction.clear()];case 9:throw s.sent(),this._mutex.unlock(),i;case 10:return[3,12];case 11:throw Yt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.upsertOne=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return this._state!==zt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Yt.collectionKeyNotGiven;return[4,this._requestUpsert(Kt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Yt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.upsertMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a=this;return L(this,(function(s){switch(s.label){case 0:return this._state!==zt.READY?[3,11]:[4,this._mutex.lock()];case 1:s.sent(),s.label=2;case 2:if(s.trys.push([2,8,,10]),e.some((function(e){return!a._hasPropertyOfKeyName(e)})))throw Yt.collectionKeyNotGiven;t=0,n=e,s.label=3;case 3:return t<n.length?(r=n[t],[4,this._requestUpsert(Kt(r))]):[3,6];case 4:s.sent(),s.label=5;case 5:return t++,[3,3];case 6:return[4,this._transaction.commit()];case 7:return s.sent(),this._mutex.unlock(),[2,e];case 8:return i=s.sent(),[4,this._transaction.clear()];case 9:throw s.sent(),this._mutex.unlock(),i;case 10:return[3,12];case 11:throw Yt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.update=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return this._state!==zt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Yt.collectionKeyNotGiven;return[4,this._requestUpdate(Kt(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Yt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.updateIf=function(e,t){return P(this,void 0,void 0,(function(){var n,r,i,a,s,o=this;return L(this,(function(l){switch(l.label){case 0:return this._state!==zt.READY?[3,12]:[4,this._mutex.lock()];case 1:l.sent(),l.label=2;case 2:return l.trys.push([2,9,,11]),n=[],[4,new on({condition:e,blockManager:this._blockManager,indexer:this._getIndexerBy(null)}).each((function(r){return P(o,void 0,void 0,(function(){var i,a;return L(this,(function(s){if(r.error)throw r.stop(),r.error;if(r.hasNext){if(i=r.nextValue,Jt(e,i)&&t.set){if("function"!=typeof t.set)for(a in t.set)i[a]=t.set[a];else t.set(i);n.push(i)}r.next()}else r.stop();return[2]}))}))}))];case 3:l.sent(),r=0,i=n,l.label=4;case 4:return r<i.length?(a=i[r],[4,this._requestUpdate(Kt(a))]):[3,7];case 5:l.sent(),l.label=6;case 6:return r++,[3,4];case 7:return[4,this._transaction.commit()];case 8:return l.sent(),this._mutex.unlock(),[2,n];case 9:return s=l.sent(),[4,this._transaction.clear()];case 10:throw l.sent(),this._mutex.unlock(),s;case 11:return[3,13];case 12:throw this._transaction.clear(),Yt.collectionNotReady;case 13:return[2]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return this._state!==zt.READY?[3,8]:[4,this._mutex.lock()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Yt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.removeIf=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s=this;return L(this,(function(o){switch(o.label){case 0:return this._state!==zt.READY?[3,11]:[4,this._mutex.lock()];case 1:o.sent(),o.label=2;case 2:return o.trys.push([2,9,,10]),t=[],[4,new on({condition:e,blockManager:this._blockManager,indexer:this._getIndexerBy(null)}).each((function(n){return P(s,void 0,void 0,(function(){var r,i;return L(this,(function(a){if(n.error)throw n.stop(),n.error;return n.hasNext?(r=n.nextValue,Jt(e,r)&&(i=r[this.keyName],t.push(i)),n.next()):n.stop(),[2]}))}))}))];case 3:o.sent(),n=0,r=t,o.label=4;case 4:return n<r.length?(i=r[n],[4,this._requestRemove(i)]):[3,7];case 5:o.sent(),o.label=6;case 6:return n++,[3,4];case 7:return[4,this._transaction.commit()];case 8:return o.sent(),this._mutex.unlock(),[2,t];case 9:throw a=o.sent(),this._mutex.unlock(),a;case 10:return[3,12];case 11:throw this._transaction.clear(),Yt.collectionNotReady;case 12:return[2]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){var e;return L(this,(function(t){switch(t.label){case 0:return this._state!==zt.READY?[3,8]:[4,this._mutex.lock()];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Yt.collectionNotReady;case 9:return[2]}}))}))},e.prototype.getBlob=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.saveBlob=function(e,t){return void 0===t&&(t=null),P(this,void 0,void 0,(function(){return L(this,(function(n){switch(n.label){case 0:return[4,this._blobContainer.save(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.removeBlob=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.removeAllBlobs=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return[4,this._blobContainer.clear()];case 1:return e.sent(),[2]}}))}))},e}(),kn={encrypt:function(e){return e},decrypt:function(e){return e}},An={},wn=function(){function e(e){void 0===e&&(e={});var t=e.itemSizeLimit,n=void 0===t?4194304:t,r=e.delay,i=void 0===r?1:r,a=e.encryption,s=void 0===a?kn:a;this._encryption=s,this.itemSizeLimit=n,this.delay=i,this.observer={}}return Object.defineProperty(e.prototype,"rawData",{get:function(){return An[this.dbname]},set:function(e){An[this.dbname]=e},enumerable:!1,configurable:!0}),e.prototype.observe=function(e,t,n){var r=this;this.observer[e]={},t.forEach((function(t){return r.observer[e][t]=n}))},e.prototype.init=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){return this.dbname=e,An[this.dbname]={},[2]}))}))},e.prototype.getAllKeys=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){return[2,Object.keys(An[this.dbname])]}))}))},e.prototype.get=function(e){return P(this,void 0,void 0,(function(){var t,n;return L(this,(function(r){switch(r.label){case 0:return[4,$t(this.delay)];case 1:if(r.sent(),t=this.observer[e],n=t&&t.get?t.get(e):null)throw n;return[2,An[this.dbname][e]?this._encryption.decrypt(An[this.dbname][e]):null]}}))}))},e.prototype.set=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return[4,$t(this.delay)];case 1:if(s.sent(),t=e.key,n=e.value,r=this.observer[t],i=r&&r.set?r.set(t):null)throw i;if(a=this._encryption.encrypt(n),JSON.stringify(a).length<this.itemSizeLimit)return An[this.dbname][t]=a,[2,An[this.dbname][t]];throw Yt.storeItemSizeExceeded}}))}))},e.prototype.setMany=function(e){return P(this,void 0,void 0,(function(){var t,n=this;return L(this,(function(r){switch(r.label){case 0:return[4,$t(this.delay)];case 1:return r.sent(),t=[],e.forEach((function(e){var r=e.key,i=e.value,a=n.observer[r];if(a&&a.set&&a.set(r))t.push(Yt.collectionWriteFailed);else{var s=n._encryption.encrypt(i);JSON.stringify(s).length<n.itemSizeLimit?(An[n.dbname][r]=s,t.push(i)):t.push(Yt.storeItemSizeExceeded)}})),[2,t]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){var t,n;return L(this,(function(r){switch(r.label){case 0:return[4,$t(this.delay)];case 1:if(r.sent(),t=this.observer[e],n=t&&t.remove?t.remove(e):null)throw n;return An[this.dbname][e]&&delete An[this.dbname][e],[2,e]}}))}))},e.prototype.removeMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a;return L(this,(function(s){switch(s.label){case 0:return[4,$t(this.delay)];case 1:for(s.sent(),t=0,n=e;t<n.length;t++){if(r=n[t],i=this.observer[r],a=i&&i.remove?i.remove(r):null)throw a;An[this.dbname][r]&&delete An[this.dbname][r]}return[2,e]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return[4,$t(this.delay)];case 1:return e.sent(),An[this.dbname]={},[2]}}))}))},e}(),Tn="undefined"!=typeof document&&"undefined"!=typeof navigator;Tn&&navigator.userAgent&&navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/");var On=Tn&&navigator.userAgent&&navigator.userAgent.includes("Firefox/")&&!navigator.userAgent.includes("Seamonkey/");Tn&&navigator.userAgent&&navigator.userAgent.includes("Safari/")&&!navigator.userAgent.includes("Chrome/")&&navigator.userAgent.includes("Chromium/"),Tn&&navigator.userAgent&&(navigator.userAgent.includes("OPR/")||navigator.userAgent.includes("Opera/")),Tn&&navigator.userAgent&&navigator.userAgent.includes("Trident/7.0");var In,Mn=Tn&&navigator.userAgent&&navigator.userAgent.includes("Edge/"),Un="NestDBStore",Rn=function(){function e(e){void 0===e&&(e={}),this.itemSizeLimit=104857600;var t=e.encryption,n=void 0===t?kn:t;this._window="undefined"!=typeof window?window:null,this._indexedDB=this._window?this._window.indexedDB||this._window.mozIndexedDB||this._window.webkitIndexedDB||this._window.msIndexedDB:null,this._encryption=n}return e.prototype.init=function(e){return P(this,void 0,void 0,(function(){var t,n=this;return L(this,(function(r){switch(r.label){case 0:return this.dbname=e,[4,new Promise((function(e,t){if(n._window&&Tn)if(On){var r=n._indexedDB.open("_testMozilla");r.onerror=function(){return t(Yt.storeNotAvailableInPrivateBrowsing)},r.onsuccess=function(){return e()}}else Mn?n._window.indexedDB||!n._window.PointerEvent&&!n._window.MSPointerEvent||t(Yt.storeNotAvailableInPrivateBrowsing):e();else t(Yt.storeNotAvailable)}))];case 1:return r.sent(),t=this,[4,new Promise((function(t,r){var i=n._indexedDB.open(e);i.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore(Un,{keyPath:"key"})})),i.addEventListener("success",(function(e){return t(e.target.result)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 2:return t._database=r.sent(),[2]}}))}))},e.prototype.getAllKeys=function(){return P(this,void 0,void 0,(function(){var e=this;return L(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){var r=e._database.transaction(Un,"readonly").objectStore(Un).getAllKeys();r.addEventListener("success",(function(e){return t(e.target.result)})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 1:return[2,t.sent()]}}))}))},e.prototype.get=function(e){return P(this,void 0,void 0,(function(){var t=this;return L(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n,r){var i=t._database.transaction(Un,"readonly").objectStore(Un).get(e);i.addEventListener("success",(function(e){return n(e.target.result?t._encryption.decrypt(e.target.result.value):null)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.set=function(e){return P(this,void 0,void 0,(function(){var t,n,r=this;return L(this,(function(i){switch(i.label){case 0:return t=e.key,n=e.value,[4,new Promise((function(e,i){var a=r._database.transaction(Un,"readwrite").objectStore(Un).put({key:t,value:r._encryption.encrypt(n)});a.addEventListener("success",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){return i(e.target.error)}))}))];case 1:return i.sent(),[2,n]}}))}))},e.prototype.setMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r=this;return L(this,(function(i){switch(i.label){case 0:return t=[],n=this._database.transaction(Un,"readwrite").objectStore(Un),e.forEach((function(e){var i=e.key,a=e.value;t.push(new Promise((function(e){var t=n.put({key:i,value:r._encryption.encrypt(a)});t.addEventListener("success",(function(t){e(t.target.result)})),t.addEventListener("error",(function(){e(Yt.collectionWriteFailed)}))})))})),[4,Promise.all(t)];case 1:return i.sent(),[2,e.map((function(e){return e.value}))]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){var t=this;return L(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n,r){var i=t._database.transaction(Un,"readwrite").objectStore(Un).delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.removeMany=function(e){return P(this,void 0,void 0,(function(){var t;return L(this,(function(n){switch(n.label){case 0:return t=this._database.transaction(Un,"readwrite").objectStore(Un),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){var e=this;return L(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){var r=e._database.transaction(Un,"readwrite").objectStore(Un).clear();r.addEventListener("success",(function(){return t()})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 1:return[2,t.sent()]}}))}))},e}(),Pn=function(){function e(e){var t=e.AsyncStorage,n=e.encryption,r=void 0===n?kn:n;this.itemSizeLimit=6291456,this._asyncStorage=t,this._encryption=r}return e.prototype._isBelonging=function(e){return e.startsWith(this.dbname+"/")},e.prototype._getActualKey=function(e){return this.dbname+"/"+e},e.prototype.init=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){return this.dbname=e,[2]}))}))},e.prototype.getAllKeys=function(){return P(this,void 0,void 0,(function(){var e=this;return L(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substr((e.dbname+"/").length)}))]}}))}))},e.prototype.get=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i;return L(this,(function(a){switch(a.label){case 0:return n=(t=this._encryption).decrypt,i=(r=JSON).parse,[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,n.apply(t,[i.apply(r,[a.sent()])])]}}))}))},e.prototype.set=function(e){return P(this,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:return t=e.key,n=e.value,(r=JSON.stringify(this._encryption.encrypt(n))).length<this.itemSizeLimit?[4,this._asyncStorage.setItem(this._getActualKey(t),r)]:[3,2];case 1:return i.sent(),[2,JSON.parse(r)];case 2:throw Yt.storeItemSizeExceeded}}))}))},e.prototype.setMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return L(this,(function(l){switch(l.label){case 0:t=[],n=0,r=e,l.label=1;case 1:if(!(n<r.length))return[3,8];i=r[n],l.label=2;case 2:return l.trys.push([2,6,,7]),a=i.key,s=i.value,(o=JSON.stringify(this._encryption.encrypt(s))).length<this.itemSizeLimit?[4,this._asyncStorage.setItem(this._getActualKey(a),o)]:[3,4];case 3:return l.sent(),t.push(s),[3,5];case 4:t.push(Yt.storeItemSizeExceeded),l.label=5;case 5:return[3,7];case 6:return l.sent(),t.push(Yt.collectionWriteFailed),[3,7];case 7:return n++,[3,1];case 8:return[2,t]}}))}))},e.prototype.remove=function(e){return P(this,void 0,void 0,(function(){return L(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.removeItem(this._getActualKey(e))];case 1:return t.sent(),[2,e]}}))}))},e.prototype.removeMany=function(e){return P(this,void 0,void 0,(function(){var t,n,r;return L(this,(function(i){switch(i.label){case 0:t=0,n=e,i.label=1;case 1:return t<n.length?(r=n[t],[4,this._asyncStorage.removeItem(this._getActualKey(r))]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},e.prototype.clear=function(){return P(this,void 0,void 0,(function(){var e;return L(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}}))}))},e}(),Ln=!0,Dn=function(){function e(){}return e.off=function(){Ln=!1},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ln&&console.log.apply(console,D(["[NESTDB][LOG]"],e,!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ln&&console.warn.apply(console,D(["[NESTDB][WARNING]"],e,!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ln&&console.error.apply(console,D(["[NESTDB][ERROR]"],e,!1))},e}();!function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"}(In||(In={}));var xn,Fn,Hn,Gn,jn,Vn,Bn,zn=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=In.INIT,this._config=i||new Bt({dbname:t}),this._store=r,this._event={success:Xt,error:Xt,upgrade:tn},this._collections=new Map,this._globalMutex=new Sn(this.name+".lock"),this._config.disableLogger&&Dn.off(),new mn({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.commitSchema=function(e){return P(this,void 0,void 0,(function(){var t=this;return L(this,(function(n){switch(n.label){case 0:return this._state!==In.OPENING?[3,2]:[4,Promise.all(e.map((function(e){return P(t,void 0,void 0,(function(){var t,n,r,i;return L(this,(function(a){switch(a.label){case 0:return t=e.collectionName,n=e.keyName,r=e.index,i=void 0===r?[]:r,this._collections.has(t)||this._collections.set(t,new Nn({dbname:this.name,collectionName:t,keyName:n,keyHash:e.keyHash||null,indexes:i,store:this._store})),[4,this._collections.get(t).init()];case 1:return a.sent(),[2]}}))}))})))];case 1:return n.sent(),[3,3];case 2:throw Yt.databaseSchemaNotOnUpgrade;case 3:return[2]}}))}))},e.prototype.open=function(){var e;return P(this,void 0,void 0,(function(){var t,n,r,i,a=this;return L(this,(function(s){switch(s.label){case 0:return[4,this._globalMutex.lock()];case 1:if(s.sent(),this._state===In.OPENED)return[3,12];this._state=In.OPENING,s.label=2;case 2:return s.trys.push([2,5,,12]),[4,this._store.init(this.name)];case 3:return s.sent(),o=this.name,t=un(o)+".metadata",n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=s.sent())&&void 0!==e?e:n,[2,new Promise((function(e,n){var i=function(e){r.version<a._version?a._event.upgrade(r.version,(function(n){return P(a,void 0,void 0,(function(){var i;return L(this,(function(a){switch(a.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r,generation:this._version})];case 2:return a.sent(),e({continued:!0}),[3,4];case 3:return i=a.sent(),e({continued:!1,err:i}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),a.label=6;case 6:return[2]}}))}))})):e({continued:!1})},s=function t(s){var o=s.continued,l=void 0!==o&&o,u=s.err,c=void 0===u?null:u;if(l)setTimeout((function(){return i(t)}),10);else if(c)Dn.error(c.message),a._globalMutex.unlock(),a._event.error(c),n(c);else{var d=[];r.collectionNames.forEach((function(e){a._collections.has(e)||d.push(P(a,void 0,void 0,(function(){var t,n;return L(this,(function(r){switch(r.label){case 0:return[4,Nn.metadataOf(this.name,e,this._store)];case 1:return(t=r.sent())?(n=new Nn({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))})))})),Promise.all(d).then((function(){a._state=In.OPENED,a._globalMutex.unlock(),a._event.success(),e()})).catch((function(e){Dn.error(e.message),a._globalMutex.unlock(),a._event.error(e),n(e)}))}};i(s)}))];case 5:switch((i=s.sent()).code){case jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,6];case jt.STORE_NOT_AVAILABLE:return[3,8]}return[3,10];case 6:return Dn.warning("Access to the local storage is not allowed in private browsing. Switched to MemoryStore automatically."),this._store=new wn({}),this._globalMutex.unlock(),this._event.error(i),[4,this.open()];case 7:return s.sent(),[3,11];case 8:return Dn.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new wn({}),this._globalMutex.unlock(),this._event.error(i),[4,this.open()];case 9:return s.sent(),[3,11];case 10:throw Dn.error(i.message),this._globalMutex.unlock(),this._event.error(i),i;case 11:return[3,12];case 12:return[2]}var o}))}))},e.prototype.close=function(){this._state=In.CLOSED,this._collections.forEach((function(e){return e.close()}))},e.prototype.reset=function(){return P(this,void 0,void 0,(function(){var e,t=this;return L(this,(function(n){switch(n.label){case 0:return(e=mn.get(this.name))&&e.clearByCondition((function(e){return e.key.startsWith(un(t.name))})),[4,this._store.clear()];case 1:return n.sent(),[2]}}))}))},e.prototype.on=function(e,t){this._event[e]=t},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?tn:Xt)},e.prototype.collection=function(e){return this._collections.get(e)||null},e}(),Yn=function(){function e(){}return e.create=function(){return Math.floor(1e5*Math.random())+"-"+(new Date).getTime()},e}();!function(e){e.AND="AND",e.OR="OR"}(xn||(xn={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(Fn||(Fn={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Hn||(Hn={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper"}(Gn||(Gn={})),function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(jn||(jn={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(Vn||(Vn={})),function(e){e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Bn||(Bn={}));var qn=function(){function e(){this._iid=null,this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:xn.AND},this.includeEmpty=!1,this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.memberStateFilter=Hn.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=Gn.ALL,this.publicChannelFilter=jn.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Vn.ALL,this.hiddenChannelFilter=Bn.UNHIDDEN,this.includeFrozen=!0}return Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype._isFriend=function(e){return!!e.friendDiscoveryKey||!!e.friendName},Object.defineProperty(e.prototype,"iid",{set:function(e){this._iid=e},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={searchQuery:t,searchFields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=xn.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t=new e;t.setSearchFilter(this.searchFilter.searchFields,this.searchFilter.searchQuery),t.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){var t=this._searchFilter,n=t.searchQuery,r=t.searchFields;if(n&&r&&r.length>0&&!r.some((function(t){switch(t){case Fn.CHANNEL_NAME:return e.name.toLowerCase().includes(n.toLowerCase());case Fn.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(n.toLowerCase())}));default:return!0}})))return!1;var i=this._userIdsFilter,a=i.includeMode,s=i.queryType,o=i.userIds,l=I.get(this._iid).get("currentUserId"),u=e.members.map((function(e){return e.userId}));if(a){if(o.length>0)switch(s){case xn.AND:if(o.some((function(e){return!u.includes(e)})))return!1;break;case xn.OR:if(o.every((function(e){return!u.includes(e)})))return!1}}else{if(o.includes(l)||o.push(l),e.members.length>o.length)return!1;if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=D([],e,!0).sort(),r=D([],t,!0).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(o,u))return!1}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^"+this.customTypeStartsWithFilter).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var c=this.nicknameContainsFilter.toLowerCase();if(e.members.every((function(e){return!e.nickname.toLowerCase().includes(c)})))return!1}if(this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.memberStateFilter)switch(this.memberStateFilter){case Hn.JOINED:if("joined"!==e.myMemberState)return!1;break;case Hn.INVITED:if("invited"!==e.myMemberState)return!1;break;case Hn.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case Hn.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Bn.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case Bn.HIDDEN:if(!e.isHidden)return!1;break;case Bn.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case Bn.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Vn.UNREAD_MESSAGE&&0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case jn.PUBLIC:if(!e.isPublic)return!1;break;case jn.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case Gn.SUPER:if(!e.isSuper)return!1;break;case Gn.NON_SUPER:if(e.isSuper)return!1}return!0},e.QueryType=xn,e.SearchField=Fn,e.MemberStateFilter=Hn,e.SuperChannelFilter=Gn,e.PublicChannelFilter=jn,e.UnreadChannelFilter=Vn,e.HiddenChannelFilter=Bn,e}(),Kn=function(){function e(e){var t=e.iid;this._iid=t,this._filter=new qn,this._filter.iid=this._iid,this._order=lt.LATEST_LAST_MESSAGE,this._limit=20}return e.prototype.setFilter=function(e){return this._filter=e.clone(),this._filter.iid=this._iid,this},e.prototype.setOrder=function(e){return this._order=e,this},e.prototype.setLimit=function(e){return this._limit=e,this},e.prototype.build=function(){return new Et({iid:this._iid,filter:this._filter,order:this._order,limit:this._limit})},e}(),Wn=function(){function e(e){var t=e.iid,n=e.channel;this._iid=t,this._channel=n,this._startingPoint=Date.now(),this._filter=new Re,this._limit=100}return e.prototype.setFilter=function(e){return this._filter=e.clone(),this},e.prototype.setStartingPoint=function(e){return this._startingPoint=e,this},e.prototype.setLimit=function(e){return this._limit=e,this},e.prototype.build=function(){return new rt({iid:this._iid,channel:this._channel,startingPoint:this._startingPoint,filter:this._filter,limit:this._limit})},e}(),Qn={},$n={},Jn=new WeakMap,Xn=new WeakMap,Zn=new WeakMap,er=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).channelType=Rt.CHANNEL_TYPE_GROUP,r.isDistinct=!1,r.isSuper=!1,r.isBroadcast=!1,r.isPublic=!1,r.unreadMessageCount=0,r.inviter=null,r.members=[],r.memberMap={},r.lastMessage=null,r.memberCount=0,r.joinedMemberCount=0,r.cachedReadReceiptStatus={},r.cachedDeliveryReceiptStatus=null,r.myPushTriggerOption=n.PushTriggerOption.DEFAULT,r.isPushEnabled,r.isHidden=!1,r.hiddenState=n.HiddenState.UNHIDDEN,r.isDiscoverable=!0,r.myLastRead=0,r.messageSurvivalSeconds=-1,r.invitedAt=0,r.joinedAt=0,r._messageOffsetTimestamp=0,r._cachedLastDeliveredReceipt={sentAt:0,timeout:null},Jn.set(m(r),{}),Xn.set(m(r),{start:0,end:0}),Zn.set(m(r),0),e&&r._update(e),r}return f(n,[{key:"messageOffsetTimestamp",get:function(){return this._messageOffsetTimestamp}},{key:"createMessageCollection",value:function(){return new Wn({iid:this._iid,channel:this})}},{key:"_setGroupChannelUnreadCount",value:function(e,t){try{if("number"==typeof e&&e>=0)if("all"===this.myCountPreference||"unread_message_count_only"===this.myCountPreference)if(this.isSuper||this.isBroadcast){var n=I.get(this._iid).container.maxUnreadCountOfSuperGroupChannel;this.unreadMessageCount=e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&("all"===this.myCountPreference||"unread_mention_count_only"===this.myCountPreference?this.unreadMentionCount=t:this.unreadMentionCount=0)}catch(e){}}},{key:"_update",value:function(e){var t=this,n=j.get(this._iid),r=n.BaseChannel,i=n.GroupChannel,a=n.User,s=n.Member;if(this.isAccessCodeRequired=!!e.is_access_code_required&&e.is_access_code_required,this.isDistinct=!!e.is_distinct&&e.is_distinct,this.isPushEnabled=!!e.is_push_enabled&&e.is_push_enabled,this.isHidden=!!e.hasOwnProperty("is_hidden")&&e.is_hidden,this.myPushTriggerOption=e.push_trigger_option?e.push_trigger_option:i.PushTriggerOption.DEFAULT,this.myCountPreference=e.hasOwnProperty("count_preference")?e.count_preference:i.CountPreference.ALL,this.unreadMessageCount=0,this.unreadMentionCount=0,this._setGroupChannelUnreadCount(parseInt(e.unread_message_count),parseInt(e.unread_mention_count)),e.hasOwnProperty("read_receipt")&&(this.cachedReadReceiptStatus={},Object.keys(e.read_receipt).forEach((function(n){var r=e.read_receipt[n];t.updateReadReceipt(n,parseInt(r))}))),e.hasOwnProperty("delivery_receipt")&&"object"===c(e.delivery_receipt)&&null!==e.delivery_receipt&&(this.cachedDeliveryReceiptStatus||(this.cachedDeliveryReceiptStatus={}),Object.keys(e.delivery_receipt).forEach((function(n){var r=e.delivery_receipt[n];t.updateDeliveryReceipt(n,parseInt(r))}))),e.hasOwnProperty("user_last_read")&&"number"==typeof e.user_last_read?this.myLastRead=e.user_last_read:this.myLastRead=0,e.hasOwnProperty("members")){this.members=[],this.memberMap={};for(var o=0;o<e.members.length;o++){var l=new s(e.members[o]);this.members.push(l),this.memberMap[l.userId]=l}}this.myMemberState=e.member_state||"none",this.myRole=e.my_role||i.Role.NONE,e.hasOwnProperty("is_muted")?"string"==typeof e.is_muted?this.myMutedState=e.is_muted:"boolean"==typeof e.is_muted?this.myMutedState=e.is_muted?"muted":"unmuted":this.myMutedState="unmuted":this.myMutedState="unmuted",e.hasOwnProperty("member_count")&&(this.memberCount=parseInt(e.member_count)),e.hasOwnProperty("joined_member_count")&&(this.joinedMemberCount=parseInt(e.joined_member_count)),e.hasOwnProperty("last_message")&&"object"===c(e.last_message)&&e.last_message?e.last_message instanceof Tt?this.lastMessage=e.last_message:this.lastMessage=r.buildMessage(e.last_message,this):this.lastMessage=null,e.hasOwnProperty("inviter")&&null!==e.inviter&&"object"===c(e.inviter)&&Object.keys(e.inviter).length>0?this.inviter=new a(e.inviter):this.inviter=null,this.invitedAt=e.invited_at||0,this.joinedAt=e.joined_ts||0,e.hasOwnProperty("is_super")&&"boolean"==typeof e.is_super?this.isSuper=e.is_super:this.isSuper=!1,e.hasOwnProperty("is_broadcast")&&"boolean"==typeof e.is_broadcast?this.isBroadcast=e.is_broadcast:this.isBroadcast=!1,e.hasOwnProperty("is_public")&&"boolean"==typeof e.is_public?this.isPublic=e.is_public:this.isPublic=!1,e.hasOwnProperty("hidden_state")?this.hiddenState=e.hidden_state:this.hiddenState=i.HiddenState.UNHIDDEN,e.hasOwnProperty("is_discoverable")&&"boolean"==typeof e.is_discoverable?this.isDiscoverable=e.is_discoverable:this.isDiscoverable=this.isPublic,e.hasOwnProperty("ts_message_offset")&&(this._messageOffsetTimestamp=e.ts_message_offset),e.hasOwnProperty("message_survival_seconds")&&"number"==typeof e.message_survival_seconds&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"addMember",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.isSuper&&!this.isBroadcast){var n=j.get(this._iid).Member,r=this.removeMember(e);r&&r.state===n.JOINED&&(e.state=n.JOINED),this.memberMap[e.userId]=e,this.members.push(e),this.memberCount++,this.updateReadReceipt(e.userId,t),this.updateDeliveryReceipt(e.userId,t)}}},{key:"removeMember",value:function(e){var t=null;if(!this.isSuper&&!this.isBroadcast&&this.memberMap.hasOwnProperty(e.userId)){delete this.memberMap[e.userId];for(var n=0;n<this.members.length;n++){var r=this.members[n];if(r.userId===e.userId){t=r,this.members.splice(n,1);break}}this.memberCount--}return t}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"isIdentical",value:function(e){return e&&this.url===e.url}},{key:"isEqual",value:function(e){return ae.deepEqual(this,e)}},{key:"createMemberListQuery",value:function(){return new(0,j.get(this._iid).MemberListQuery)(this.url)}},{key:"createBannedUserListQuery",value:function(){return new(0,j.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:this.isOpenChannel()})}},{key:"refresh",value:function(e){return j.get(this._iid).GroupChannel.getChannelWithoutCache(this.url,e)}},{key:"updateChannel",value:function(){var e=this,t=ge.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.channelUrl=e.url,r._validate()?I.get(e._iid).container.apiClient.updateGroupChannel(u(u({},r),{},{operatorUserIds:r.operatorUserIds}),(function(e,t){var r=null;e||(r=i.upsert(t)),n(e,r)})):n(ge.error,null)}),n);if(3===t.length){var s=new a;return s.channelUrl=this.url,s.name=t[0],"string"==typeof t[1]?s.coverUrl=t[1]:s.coverImage=t[1],s.data=t[2],this.updateChannel(s,n)}if(4===t.length){var o=new a;return o.channelUrl=this.url,o.isDistinct=t[0],o.name=t[1],"string"==typeof t[1]?o.coverUrl=t[2]:o.coverImage=t[2],o.data=t[3],this.updateChannel(o,n)}if(5===t.length){var l=new a;return l.channelUrl=this.url,l.isDistinct=t[0],l.name=t[1],"string"==typeof t[2]?l.coverUrl=t[2]:l.coverImage=t[2],l.data=t[3],l.customType=t[4],this.updateChannel(l,n)}return le(this._iid,(function(e){return e(ge.error,null)}),n)}},{key:"invite",value:function(e,t){var n=null,r=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return!!e.userId&&"string"==typeof e.userId}))}}),new ge({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){return e(ge.error,null)}),t):this.inviteWithUserIds(e.map((function(e){return e.userId})),t)}},{key:"inviteWithUserIds",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.inviteToGroupChannel({channelUrl:n.url,userIds:e},(function(e,r){var i=null;e||(i=j.get(n._iid).GroupChannel.upsert(r)),t(e,i)}))}),t)}},{key:"acceptInvitation",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string",optional:!0,defaultValue:null}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.acceptInvitation({channelUrl:n.url,accessCode:e},(function(e,r){var i=null;e||((i=j.get(n._iid).GroupChannel.upsert(r)).myMemberState="joined"),t(e,i)}))}),t)}},{key:"declineInvitation",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.declineInvitation({channelUrl:t.url},(function(n,r){var i=null;if(!n){var a=j.get(t._iid).GroupChannel;(i=a.upsert(r)).myMemberState="none",t.isPublic||a.removeCachedChannel(t.url)}e(n,i)}))}),e)}},{key:"join",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string",optional:!0,defaultValue:null}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.joinGroupChannel({channelUrl:n.url,accessCode:e},(function(e,r){var i=null;e||((i=j.get(n._iid).GroupChannel.upsert(r)).myMemberState="joined"),t(e,i)}))}),t)}},{key:"leave",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.leaveGroupChannel({channelUrl:t.url},(function(t,n){return e(t,null)}))}),e)}},{key:"muteUser",value:function(e,t,n,r){return this.muteUserWithUserId(e?e.userId:null,t,n,r)}},{key:"muteUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ge({type:"string",optional:!0,defaultValue:""}),new ge({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.muteUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){r(e,null)}))}),r)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n,r){return this.banUserWithUserId(e?e.userId:null,t,n,r)}},{key:"banUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ge({type:"string"}),new ge({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.banUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!0},(function(e,t){r(e,null)}))}),r)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!0},(function(e,n){t(e,null)}))}),t)}},{key:"updateJoinedMemberCount",value:function(){if(!this.isSuper&&!this.isBroadcast){var e=j.get(this._iid).Member;this.joinedMemberCount=this.members.filter((function(t){return t.state===e.JOINED})).length}}},{key:"setLatestMemberCount",value:function(e,t,n){var r=!1;return"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&n>=Zn.get(this)&&(Zn.set(this,n),r=t!==this.joinedMemberCount||e!==this.memberCount,this.memberCount=e,this.joinedMemberCount=t),r}},{key:"hide",value:function(e,t,n){var r=this,i=null,a=S(ge.parse(arguments,[new ge({type:"boolean",optional:!0,defaultValue:!1}),new ge({type:"boolean",optional:!0,defaultValue:!0}),new ge({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.hideGroupChannel({channelUrl:r.url,hidePreviousMessages:e,allowAutoUnhide:t},(function(i,a){if(!i){var s=j.get(r._iid).GroupChannel;r.isHidden=!0,r.hiddenState=t?s.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:s.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE,e&&r._setGroupChannelUnreadCount(0,0),a.hasOwnProperty("ts_message_offset")&&(r._messageOffsetTimestamp=a.ts_message_offset),s.cachedChannels[r.url]=r}n(i,a)}))}),n)}},{key:"unhide",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.unhideGroupChannel({channelUrl:t.url},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isHidden=!1,t.hiddenState=i.HiddenState.UNHIDDEN,i.cachedChannels[t.url]=t}e(n,r)}))}),e)}},{key:"freeze",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!0},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isFrozen=!0,i.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"unfreeze",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.freeze({channelUrl:t.url,isGroupChannel:!0,freezing:!1},(function(n,r){if(!n){var i=j.get(t._iid).GroupChannel;t.isFrozen=!1,i.cachedChannels[t.url]=t}e(n,null)}))}),e)}},{key:"delete",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.deleteGroupChannel({channelUrl:t.url},(function(n,r){n||j.get(t._iid).GroupChannel.removeCachedChannel(t.url),e(n,r)}))}),e)}},{key:"markAsRead",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).Command,r=Ri.getInstance(t._iid),i=n.bRead({channelUrl:t.url});r.sendCommand(i,(function(n,i){if(r.getErrorFirstCallback()){var a=[n,i];i=a[0],n=a[1]}if(i)e(i,null);else if(r.currentUser){var s=Ct.of(t._iid),o=we.of(t._iid);t.updateReadReceipt(r.currentUser.userId,n.getJsonElement().ts);var l=!1;(t.unreadMessageCount>0||t.unreadMentionCount>0)&&(t._setGroupChannelUnreadCount(0,0),Object.keys(r.channelHandlers).forEach((function(e){r.channelHandlers[e].onChannelChanged(t)})),l=!0),e(null,null),s.upsert([t]).then((function(){l&&o.send({source:he.EVENT_CHANNEL_CHANGED,payload:{channel:t}}),o.send({source:he.EVENT_READ_RECEIPT_UPDATED,payload:{channel:t}})})).catch((function(e){J.error(e)}))}else{var u=new SendBirdException("Connection should be made first.",SendBirdException.CONNECTION_REQUIRED);e(u,null)}}))}),e)}},{key:"getUnreadMemberCount",value:function(e){var t=I.get(this._iid),n=j.get(this._iid).Member,r=t.container.currentUserId;if(e instanceof Tt&&!e.isAdminMessage()&&r&&!this.isSuper&&!this.isBroadcast){for(var i=0,a=e.createdAt,s=this.members,o=0;o<s.length;o++){var l=s[o];r===l.userId||l.state!==n.JOINED||e.sender&&e.sender.userId===l.userId||(this.cachedReadReceiptStatus[l.userId]||0)<a&&i++}return i}return 0}},{key:"getReadReceipt",value:function(e){return this.getUnreadMemberCount(e)}},{key:"markAsDelivered",value:function(){var e=this,t=Ri.getInstance(this._iid),n=t.currentUser?t.currentUser.userId:null;I.get(this._iid).container.apiClient.markAsDelivered({channelUrl:this.url,userId:n},(function(t,r){if(t)J.debug(t);else{var i=r.hasOwnProperty("ts")?r.ts:0;e.updateDeliveryReceipt(n,i)}}))}},{key:"getUndeliveredMemberCount",value:function(e){var t=I.get(this._iid),n=j.get(this._iid).Member,r=t.container.currentUserId;if(this.cachedDeliveryReceiptStatus&&e instanceof Tt&&!e.isAdminMessage()&&r&&!this.isSuper&&!this.isBroadcast){var i,a=e.createdAt,s=0,o=w(this.members);try{for(o.s();!(i=o.n()).done;){var l=i.value;r===l.userId||l.state!==n.JOINED||e.sender&&e.sender.userId===l.userId||this.cachedDeliveryReceiptStatus[l.userId]<a&&s++}}catch(e){o.e(e)}finally{o.f()}return s}return 0}},{key:"getDeliveryReceipt",value:function(e){return this.getUndeliveredMemberCount(e)}},{key:"getReadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ri.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof Tt&&!e.isAdminMessage()){for(var r=[],i=0;i<this.members.length;i++){var a=this.members[i];(t||a.userId!==n.currentUser.userId&&a.userId!==e.sender.userId)&&(this.cachedReadReceiptStatus[a.userId]||0)>=e.createdAt&&r.push(a)}return r}return[]}},{key:"getUnreadMembers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ri.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof Tt&&!e.isAdminMessage()){for(var r=[],i=0;i<this.members.length;i++){var a=this.members[i];(t||a.userId!==n.currentUser.userId&&a.userId!==e.sender.userId)&&(this.cachedReadReceiptStatus[a.userId]||0)<e.createdAt&&r.push(a)}return r}return[]}},{key:"getReadStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Ri.getInstance(this._iid);if(n.currentUser&&!this.isSuper&&!this.isBroadcast){for(var r={},i=Object.keys(this.cachedReadReceiptStatus),a=function(a){var s=i[a];if(!t&&s===n.currentUser.userId)return"continue";var o=e.cachedReadReceiptStatus[s],l=e.members.filter((function(e){return e.userId===s}));r[s]={user:l.length>0?l[0]:null,last_seen_at:parseInt(o)}},s=0;s<i.length;s++)a(s);return r}return{}}},{key:"updateReadReceipt",value:function(e,t){var n=this.cachedReadReceiptStatus[e];if(!n||n<t){this.cachedReadReceiptStatus[e]=t;var r=Ri.getInstance(this._iid);r.currentUser&&e===r.currentUser.userId&&(this.myLastRead=t)}}},{key:"updateDeliveryReceipt",value:function(e,t){if(this.cachedDeliveryReceiptStatus)if(this.cachedDeliveryReceiptStatus.hasOwnProperty(e)){var n=this.cachedDeliveryReceiptStatus[e];(!n||n<t)&&(this.cachedDeliveryReceiptStatus[e]=t)}else this.cachedDeliveryReceiptStatus[e]=t}},{key:"startTyping",value:function(){var e=Ri.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var r=Xn.get(this);if(t-r.start>=n){r.end=0,r.start=t;var i=j.get(this._iid).Command.bTypeStart({channelUrl:this.url,time:r.start});e.sendCommand(i,null)}}},{key:"endTyping",value:function(){var e=Ri.getInstance(this._iid),t=(new Date).getTime(),n=e.Options.typingIndicatorThrottle;("number"!=typeof n||n<1e3||n>9e3)&&(n=1e3);var r=Xn.get(this);if(t-r.end>=n){r.start=0,r.end=t;var i=j.get(this._iid).Command.bTypeEnd({channelUrl:this.url,time:r.end});e.sendCommand(i,null)}}},{key:"invalidateTypingStatus",value:function(){var e=Jn.get(this),t=(new Date).getTime(),n=!1;return Object.keys(e).forEach((function(r){var i=e[r].ts;t-i>=1e4&&(delete e[r],n=!0)})),n}},{key:"getTypingMembers",value:function(){var e=this,t=Jn.get(this),n=[];return Object.keys(t).forEach((function(t){var r=e.memberMap[t];r&&n.push(r)})),n}},{key:"getTypingUsers",value:function(){var e=Jn.get(this),t=[];return Object.keys(e).forEach((function(n){var r=e[n].user;t.push(r)})),t}},{key:"updateTypingStatus",value:function(e,t){var n=Jn.get(this);t?n[e.userId]={user:e,ts:(new Date).getTime()}:delete n[e.userId]}},{key:"isTyping",value:function(){var e=Jn.get(this);return 0!==Object.keys(e).length}},{key:"registerScheduledUserMessage",value:function(e,t){var n=this,r=j.get(this._iid),i=r.ScheduledUserMessage,a=r.ScheduledUserMessageParams,s=null,o=ge.parse(arguments,[new ge({type:a,constraint:function(e){return"string"==typeof e.message&&"string"==typeof e._getScheduleString()}}),new ge({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){s?t(s,null):I.get(n._iid).container.apiClient.registerScheduledUserMessage({groupChannelParams:e,channelUrl:n.url,isOpenChannel:!1},(function(e,r){var a=null;if(!e){a=new i(r);var s=Ri.getInstance(n._iid).currentUser;s&&a._sender&&s.userId===a._sender.userId&&(s.nickname=a._sender.nickname,s.plainProfileUrl=a._sender.plainProfileUrl,s.metaData=a._sender.metaData)}t(e,a)}))}),t)}},{key:"getPushPreference",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(n,r){var i=null;if(!n){try{i=r.enable}catch(e){i=!1}t.isPushEnabled=i}e&&e(n,i)}))}),e)}},{key:"setPushPreference",value:function(e,t){var n=this;return le(this._iid,(function(t){var r=j.get(n._iid).GroupChannel;I.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,enable:e},(function(e,i){e||(n.isPushEnabled=i.enable,n.isPushEnabled||(n.myPushTriggerOption=r.PushTriggerOption.OFF)),t(e,i)}))}),t)}},{key:"getMyPushTriggerOption",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getMyPushTriggerOption({channelUrl:t.url},(function(r,i){var a=null;if(!r){try{a=i.push_trigger_option||n.PushTriggerOption.DEFAULT}catch(e){J.debug(e)}t.myPushTriggerOption=a}e(r,a)}))}),e)}},{key:"setMyPushTriggerOption",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ge.parse(arguments,[new ge({type:r.PushTriggerOption}),new ge({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):I.get(n._iid).container.apiClient.setMyPushTriggerOption({channelUrl:n.url,pushTriggerOption:e},(function(e,r){var i=null;if(!e){try{i=r.push_trigger_option}catch(e){J.debug(e)}n.myPushTriggerOption=i}t(e,i)}))}),t)}},{key:"setMyCountPreference",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ge.parse(arguments,[new ge({type:r.CountPreference}),new ge({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):I.get(n._iid).container.apiClient.setMyCountPreference({channelUrl:n.url,countPreference:e},(function(e,i){var a=null;e||(a=n.myCountPreference=i.count_preference,n._setGroupChannelUnreadCount(n.unreadMessageCount,n.unreadMentionCount),r.cachedChannels[n.url]=n),t(e,a)}))}),t)}},{key:"resetMyHistory",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.resetMyHistory({channelUrl:t.url},(function(n,r){if(!n&&r.hasOwnProperty("ts_message_offset")){var i=j.get(t._iid).GroupChannel;t._messageOffsetTimestamp=r.ts_message_offset,i.cachedChannels[t.url]=t}e(n,r)}))}),e)}}],[{key:"MemberStateFilter",get:function(){return{ALL:"all",JOINED:"joined_only",INVITED:"invited_only",INVITED_BY_FRIEND:"invited_by_friend",INVITED_BY_NON_FRIEND:"invited_by_non_friend"}}},{key:"PushTriggerOption",get:function(){return{DEFAULT:"default",ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"CountPreference",get:function(){return{ALL:"all",UNREAD_MESSAGE_COUNT_ONLY:"unread_message_count_only",UNREAD_MENTION_COUNT_ONLY:"unread_mention_count_only",OFF:"off"}}},{key:"HiddenState",get:function(){return{UNHIDDEN:"unhidden",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"PublicChannelFilter",get:function(){return{ALL:"all",PUBLIC:"public",PRIVATE:"private"}}},{key:"SuperChannelFilter",get:function(){return{ALL:"all",SUPER:"super",NON_SUPER:"nonsuper",BROADCAST_ONLY:"broadcast_only"}}},{key:"UnreadChannelFilter",get:function(){return{ALL:"all",UNREAD_MESSAGE:"unread_message"}}},{key:"HiddenChannelFilter",get:function(){return{UNHIDDEN:"unhidden_only",HIDDEN:"hidden_only",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"Role",get:function(){return{OPERATOR:"operator",NONE:"none"}}},{key:"UnreadItemKey",get:function(){return{GROUP_CHANNEL_UNREAD_MENTION_COUNT:"group_channel_unread_mention_count",NONSUPER_UNREAD_MENTION_COUNT:"non_super_group_channel_unread_mention_count",SUPER_UNREAD_MENTION_COUNT:"super_group_channel_unread_mention_count",GROUP_CHANNEL_UNREAD_MESSAGE_COUNT:"group_channel_unread_message_count",NONSUPER_UNREAD_MESSAGE_COUNT:"non_super_group_channel_unread_message_count",SUPER_UNREAD_MESSAGE_COUNT:"super_group_channel_unread_message_count",GROUP_CHANNEL_INVITATION_COUNT:"group_channel_invitation_count",NONSUPER_INVITATION_COUNT:"non_super_group_channel_invitation_count",SUPER_INVITATION_COUNT:"super_group_channel_invitation_count"}}},{key:"cachedChannels",get:function(){return Qn[this._iid]||(Qn[this._iid]={}),Qn[this._iid]}},{key:"createGroupChannelCollection",value:function(){return new Kn({iid:this._iid})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid),n=t.User,r=t.Member,i=t.GroupChannel,a=t.BaseMessage,s=t.UserMessage,o=t.FileMessage,l=t.AdminMessage,d=kt.deserialize(e),h=function(e){return null!=e&&"object"===c(e)?e.messageType===a.MESSAGE_TYPE_USER?new s(s.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):e.messageType===a.MESSAGE_TYPE_FILE?new o(o.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,mentionedUsers:e.mentionedUsers}))):new l(l.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},mentionedUsers:e.mentionedUsers}))):null}(d.lastMessage);return new i({channel_url:d.url,name:d.name,cover_url:d.coverUrl,data:d.data,custom_type:d.customType,invited_at:d.invitedAt,created_at:d.createdAt/1e3,joined_ts:d.joinedAt,is_access_code_required:d.isAccessCodeRequired,is_distinct:d.isDistinct,is_super:d.isSuper,is_broadcast:d.isBroadcast,is_public:d.isPublic,is_discoverable:d.isDiscoverable,is_hidden:d.isHidden,is_ephemeral:d.isEphemeral,is_muted:d.myMutedState,is_push_enabled:d.isPushEnabled,freeze:d.isFrozen,unread_message_count:d.unreadMessageCount,unread_mention_count:d.unreadMentionCount,push_trigger_option:d.myPushTriggerOption,count_preference:d.myCountPreference,hidden_state:d.hiddenState,member_count:d.memberCount,joined_member_count:d.joinedMemberCount,member_state:d.myMemberState,my_role:d.myRole,user_last_read:d.myLastRead,ts_message_offset:d.messageOffsetTimestamp,message_survival_seconds:d.messageSurvivalSeconds,read_receipt:d.cachedReadReceiptStatus,delivery_receipt:d.cachedDeliveryReceiptStatus,members:d.members.map((function(e){return r.objectify(u({},e))})),last_message:h,created_by:null!==d.creator&&void 0!==d.creator&&"object"===c(d.creator)?n.objectify(d.creator):null,inviter:null!==d.inviter&&void 0!==d.inviter&&"object"===c(d.inviter)?n.objectify(d.inviter):null,cached_primary_key:d.cachedPrimaryKey})}},{key:"upsert",value:function(e){var t=j.get(this._iid).GroupChannel,n=new t(e);if(t.cachedChannels.hasOwnProperty(n.url)){if(n.isEphemeral){var r=t.cachedChannels[n.url];e.last_message=r.lastMessage,e.unread_message_count=r.unreadMessageCount}t.cachedChannels[n.url].update(e)}else t.cachedChannels[n.url]=n;return t.cachedChannels[n.url]}},{key:"removeCachedChannel",value:function(e){var t=j.get(this._iid),n=t.GroupChannel,r=t.FileMessageQueue;n.cachedChannels[e]&&delete n.cachedChannels[e],r.delete(e)}},{key:"clearCache",value:function(){Qn[this._iid]={},j.get(this._iid).FileMessageQueue.clear()}},{key:"getChannel",value:function(e,t){var n=null,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"callback"})]),a=S(i,4);if(n=a[0],e=a[1],r=a[2],t=a[3],n)return le(this._iid,(function(e){e(n,null)}),t);var s=j.get(this._iid).GroupChannel;return s.cachedChannels[e]?le(this._iid,(function(t){t(null,s.cachedChannels[e])}),t):s.getChannelWithoutCache(e,r,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,r=null,i=null,a=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"callback"})]),s=S(a,4);return r=s[0],e=s[1],i=s[2],t=s[3],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getGroupChannel({channelUrl:e,internalCall:i,showMember:!0},(function(e,r){var i=null;e||(i=n.upsert(r)),t(e,i)}))}),t)}},{key:"createDistinctChannelIfNotExist",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannelParams,i=null,a=ge.parse(arguments,[new ge({type:r,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),s=S(a,3);return i=s[0],e=s[1],t=s[2],le(this._iid,(function(t){i?t(i,null):(e.isPublic||(e.accessCode=null),I.get(n._iid).container.apiClient.createGroupChannel(u(u({},e),{},{isDistinct:!0}),(function(e,r){var i=null;if(!e){var a=j.get(n._iid).GroupChannel;i={channel:new a(r),isCreated:r.is_created},a.cachedChannels[i.channel.url]=i.channel}t(e,i)})))}),t)}},{key:"createChannel",value:function(){var e=this,t=ge.toArray(arguments),n=void 0;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.isPublic||(r.accessCode=null),r._validate()?I.get(e._iid).container.apiClient.createGroupChannel(r,(function(e,t){var r=null;e||(r=new i(t),i.cachedChannels[r.url]=r),n(e,r)})):n(ge.error,null)}),n);if(Array.isArray(t[0])){var s=new a;switch(t.length){case 1:s.addUsers(t[0]);break;case 2:s.addUsers(t[0]),s.isDistinct=t[1];break;case 3:s.addUsers(t[0]),s.isDistinct=t[1],s.customType=t[2];break;case 5:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4];break;case 6:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4],s.customType=t[5];break;default:return le(this._iid,(function(e){return e(ge.error,null)}),n)}return n?i.createChannel(s,n):i.createChannel(s)}return le(this._iid,(function(e){return e(ge.error,null)}),n)}},{key:"createChannelWithUserIds",value:function(){var e=ge.toArray(arguments),t=void 0;"function"==typeof e[e.length-1]&&(t=e.pop());var n=j.get(this._iid),r=n.GroupChannel,i=new(0,n.GroupChannelParams);switch(e.length){case 1:i.addUserIds(e[0]);break;case 2:i.addUserIds(e[0]),i.isDistinct=e[1];break;case 3:i.addUserIds(e[0]),i.isDistinct=e[1],i.customType=e[2];break;case 5:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4];break;case 6:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4],i.customType=e[5];break;default:return le(this._iid,(function(e){return e(ge.error,null)}),t)}return r.createChannel(i,t)}},{key:"createMyGroupChannelListQuery",value:function(){return new(0,j.get(this._iid).GroupChannelListQuery)}},{key:"createPublicGroupChannelListQuery",value:function(){return new(0,j.get(this._iid).PublicGroupChannelListQuery)}},{key:"markAsReadAllLastSentAt",get:function(){return $n[this._iid]||0},set:function(e){$n[this._iid]=e}},{key:"getChannelCount",value:function(e,t){return Ri.getInstance(this._iid).getGroupChannelCount(e,t)}},{key:"getUnreadItemCount",value:function(e,t){return Ri.getInstance(this._iid).getUnreadItemCount(e,t)}},{key:"getTotalUnreadMessageCount",value:function(){var e=ge.toArray(arguments),t="function"==typeof e[e.length-1]?e.pop():null,n=Ri.getInstance(this._iid);return n.getTotalUnreadMessageCount.apply(n,N(e).concat([t]))}},{key:"getTotalUnreadChannelCount",value:function(e){return Ri.getInstance(this._iid).getTotalUnreadChannelCount(e)}}]),n}(Rt),tr=function(e){function t(t){var n=e.call(this,t)||this;return n.state="",n.role="",n.isMuted=!1,n.isBlockedByMe=!1,n.isBlockingMe=!1,n.restrictionInfo=null,t&&n._update(t),n}return U(t,e),t.objectify=function(e){var t=j.get(this._iid),n=t.User,r=t.RestrictedUser,i=t.RestrictionInfo,a=e.state,s=e.role,o=void 0===s?"":s,l=e.isMuted,u=void 0!==l&&l,c=e.isBlockedByMe,d=void 0!==c&&c,h=e.isBlockingMe,f=void 0!==h&&h,p=e.restrictionInfo,y=void 0===p?null:p,g=u?r.objectify(e):n.objectify(e);if(g.state=a,g.role=o,g.is_muted=u,g.is_blocked_by_me=d,g.is_blocking_me=f,y){var _=i.objectify(y);g.restriction_type=_.restriction_type,g.muted_description=_.description,g.muted_end_at=_.end_at}return g},t.buildFromSerializedData=function(e){var t=j.get(this._iid).Member,n=kt.deserialize(e);return new t(t.objectify(R({},n)))},t.prototype._update=function(e){var t=j.get(this._iid),n=t.RestrictedUser,r=t.RestrictionInfo;this.state=e.state,this.role=e.role||er.Role.NONE,e.hasOwnProperty("is_muted")&&(this.isMuted=e.is_muted),e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me),e.hasOwnProperty("is_blocking_me")&&(this.isBlockingMe=e.is_blocking_me),this.isMuted&&(this.restrictionInfo=new r(e),this.restrictionInfo.restrictionType=n.RestrictionType.MUTED)},t.prototype.parse=function(e){this._update(e)},Object.defineProperty(t,"JOINED",{get:function(){return"joined"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INVITED",{get:function(){return"invited"},enumerable:!1,configurable:!0}),t}(Ot),nr=function(e){function t(t){var n=e.call(this,t)||this;return n.role="",n.isBlockedByMe=!1,t&&n._update(t),n}return U(t,e),t.objectify=function(e){var t=j.get(this._iid).User,n=e.role,r=void 0===n?"":n,i=e.isBlockedByMe,a=void 0!==i&&i,s=t.objectify(e);return s.role=r,s.is_blocked_by_me=a,s},t.buildFromSerializedData=function(e){var t=j.get(this._iid).Sender,n=kt.deserialize(e);return new t(t.objectify(R({},n)))},t.prototype.parse=function(e){this._update(e)},t.prototype._update=function(e){this.role=e.role||er.Role.NONE,e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me)},t}(Ot),rr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).restrictionInfo=null,e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=j.get(this._iid).RestrictionInfo;this.restrictionInfo=new t(e)}}],[{key:"RestrictionType",get:function(){return{MUTED:"muted",BANNED:"banned"}}},{key:"objectify",value:function(e){var t=j.get(this._iid),n=t.User,r=t.RestrictionInfo,i=e.restrictionInfo,a=void 0===i?{}:i;return u(u({},n.objectify(e)),r.objectify(a))}}]),n}(Ot),ir=function(){function e(e){this.emojiHash=null,this.emojiCategories=null,e&&this._update(e)}return e.prototype._update=function(e){var t=j.get(this._iid).EmojiCategory;this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new t(e)})):[]},e}(),ar=function(){function e(e){this.id=null,this.name=null,this.url=null,this.emojis=null,e&&this._update(e)}return e.prototype._update=function(e){var t=j.get(this._iid).Emoji;this.id=e.id||0,this.name=e.name||"",this.url=e.url||"",this.emojis=e.emojis?e.emojis.map((function(e){return new t(e)})):[]},e}(),sr=function(){function e(e){this.key=null,this.url=null,e&&this._update(e)}return e.prototype._update=function(e){this.key=e.key,this.url=e.url},e}(),or={},lr={},ur=new WeakMap,cr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).channelType=Rt.CHANNEL_TYPE_OPEN,r.participantCount=0,ur.set(m(r),0),r.operators=[],e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=j.get(this._iid).User;e.hasOwnProperty("participant_count")&&(this.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&Array.isArray(e.operators)&&(this.operators=e.operators.map((function(e){return new t(e)})))}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"createParticipantListQuery",value:function(){return new(0,j.get(this._iid).ParticipantListQuery)({channelUrl:this.url})}},{key:"createMutedUserListQuery",value:function(){return new(0,j.get(this._iid).MutedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"createBannedUserListQuery",value:function(){return new(0,j.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"isOperator",value:function(e){return!!e&&this.isOperatorWithUserId(e.userId)}},{key:"isOperatorWithUserId",value:function(e){return this.operators.map((function(e){return e.userId})).indexOf(e)>-1}},{key:"refresh",value:function(e){return j.get(this._iid).OpenChannel.getChannelWithoutCache(this.url,e)}},{key:"enter",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).Command.bEnter({channelUrl:t.url}),r=Ri.getInstance(t._iid);r.sendCommand(n,(function(n,i){if(r.getErrorFirstCallback()){var a=[n,i];i=a[0],n=a[1]}i?(i=i?new F(i.message,i.code):null,e(i,null)):(j.get(t._iid).OpenChannel.enteredChannels[t.url]=t,we.of(t._iid).send({source:he.EVENT_CHANNEL_ENTER,payload:{channel:t}}),t.refresh((function(){return e(null,null)})))}))}),e)}},{key:"exit",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.Command,i=n.FileMessageQueue,a=r.bExit({channelUrl:t.url}),s=Ri.getInstance(t._iid);s.sendCommand(a,(function(n,r){if(s.getErrorFirstCallback()){var a=[n,r];r=a[0],n=a[1]}r?(r=r?new F(r.message,r.code):null,e(r,null)):(delete j.get(t._iid).OpenChannel.enteredChannels[t.url],i.delete(t.url),we.of(t._iid).send({source:he.EVENT_CHANNEL_EXIT,payload:{channel:t}}),e(null,null))}))}),e)}},{key:"updateChannel",value:function(){var e=this,t=ge.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.OpenChannel,a=r.OpenChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r.channelUrl=e.url,r._validate()?I.get(e._iid).container.apiClient.updateOpenChannel(r,(function(e,t){var r=null;e||(r=i.upsert(t)),n(e,r)})):n(ge.error,null)}),n);if(3===t.length){var s=new a;return s.channelUrl=this.url,s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=this.operators.map((function(e){return e.userId})),this.updateChannel(s,n)}if(4===t.length){var o=new a;return o.channelUrl=this.url,o.name=t[0],o.coverUrlOrImage=t[1],o.data=t[2],Array.isArray(t[3])&&(o.operatorUserIds=t[3]),this.updateChannel(o,n)}if(5===t.length){var l=new a;return l.channelUrl=this.url,l.name=t[0],l.coverUrlOrImage=t[1],l.data=t[2],Array.isArray(t[3])&&(l.operatorUserIds=t[3]),l.customType=t[4],this.updateChannel(l,n)}return le(this._iid,(function(e){return e(ge.error,null)}),n)}},{key:"updateChannelWithOperatorUserIds",value:function(){var e=ge.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return this.updateChannel.apply(this,N(e).concat([t]));default:return le(this._iid,(function(e){return e(ge.error,null)}),t)}}},{key:"muteUser",value:function(e,t,n,r){return this.muteUserWithUserId(e?e.userId:null,t,n,r)}},{key:"muteUserWithUserId",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ge({type:"string",optional:!0,defaultValue:""}),new ge({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.muteUser({channelUrl:i.url,userId:e,description:n,seconds:t,isGroupChannel:!1},(function(e,t){r(e,null)}))}),r)}},{key:"unmuteUser",value:function(e,t){return this.unmuteUserWithUserId(e?e.userId:null,t)}},{key:"unmuteUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.unmuteUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"banUser",value:function(e,t,n){return this.banUserWithUserId(e?e.userId:null,t,n)}},{key:"banUserWithUserId",value:function(e,t,n){var r=this,i=null,a=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return e>=-1}}),new ge({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.banUser({channelUrl:r.url,userId:e,description:null,seconds:t,isGroupChannel:!1},(function(e,t){n(e,null)}))}),n)}},{key:"unbanUser",value:function(e,t){return this.unbanUserWithUserId(e?e.userId:null,t)}},{key:"unbanUserWithUserId",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.unbanUser({channelUrl:n.url,userId:e,isGroupChannel:!1},(function(e,n){t(e,null)}))}),t)}},{key:"setLatestParticipantCount",value:function(e,t){var n=!1;return"number"==typeof e&&"number"==typeof t&&t>=ur.get(this)&&(ur.set(this,t),n=e!==this.participantCount,this.participantCount=e),n}},{key:"delete",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.deleteOpenChannel({channelUrl:t.url},(function(n,r){n||(delete j.get(t._iid).OpenChannel.cachedChannels[t.url],j.get(t._iid).FileMessageQueue.delete(t.url)),e(n,r)}))}),e)}}],[{key:"cachedChannels",get:function(){return or[this._iid]||(or[this._iid]={}),or[this._iid]}},{key:"enteredChannels",get:function(){return lr[this._iid]||(lr[this._iid]={}),lr[this._iid]}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid),n=t.User,r=t.OpenChannel,i=kt.deserialize(e);return new r({channel_url:i.url,name:i.name,cover_url:i.coverUrl,data:i.data,custom_type:i.customType,created_at:i.createdAt/1e3,freeze:i.isFrozen,is_ephemeral:i.isEphemeral,participant_count:i.participantCount,operators:i.operators.map((function(e){return n.objectify(e)}))})}},{key:"getChannel",value:function(e,t){var n=null,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"callback"})]),a=S(i,4);if(n=a[0],e=a[1],r=a[2],t=a[3],n)return le(this._iid,(function(e){e(n,null)}),t);var s=j.get(this._iid).OpenChannel;return s.cachedChannels[e]?le(this._iid,(function(t){t(null,s.cachedChannels[e])}),t):s.getChannelWithoutCache(e,r,t)}},{key:"getChannelWithoutCache",value:function(e,t){var n=this,r=null,i=null,a=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"string",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"callback"})]),s=S(a,4);return r=s[0],e=s[1],i=s[2],t=s[3],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getOpenChannel({channelUrl:e,internalCall:i},(function(e,r){var i=null;e||(i=j.get(n._iid).OpenChannel.upsert(r)),t(e,i)}))}),t)}},{key:"createChannel",value:function(){var e=this,t=ge.toArray(arguments),n=null;"function"==typeof t[t.length-1]&&(n=t.pop());var r=j.get(this._iid),i=r.OpenChannel,a=r.OpenChannelParams;if(t[0]instanceof a&&1===t.length)return le(this._iid,(function(n){var r=t[0];r._validate()?I.get(e._iid).container.apiClient.createOpenChannel(r,(function(t,r){var i=null;t||(i=j.get(e._iid).OpenChannel.upsert(r)),n(t,i)})):n(ge.error,null)}),n);var s=new a;switch(t.length){case 0:break;case 1:s.name=t[0];break;case 2:s.name=t[0],s.coverUrlOrImage=t[1];break;case 3:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2];break;case 4:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=t[3];break;case 5:s.name=t[0],s.coverUrlOrImage=t[1],s.data=t[2],s.operatorUserIds=t[3],s.customType=t[4];break;default:return le(this._iid,(function(e){return e(ge.error,null)}),n)}return n?i.createChannel(s,n):i.createChannel(s)}},{key:"createChannelWithOperatorUserIds",value:function(){var e=ge.toArray(arguments),t=void 0;switch("function"==typeof e[e.length-1]&&(t=e.pop()),e.length){case 4:case 5:return this.createChannel.apply(this,N(e).concat([t]));default:return le(this._iid,(function(e){return e(ge.error,null)}),t)}}},{key:"upsert",value:function(e){var t=new(0,j.get(this._iid).OpenChannel)(e);return this.cachedChannels.hasOwnProperty(t.url)?this.cachedChannels[t.url].update(e):this.cachedChannels[t.url]=t,this.cachedChannels[t.url]}},{key:"removeCachedChannel",value:function(e){this.cachedChannels[e]&&delete this.cachedChannels[e],j.get(this._iid).FileMessageQueue.delete(e)}},{key:"clearCache",value:function(){or[this._iid]={},j.get(this._iid).FileMessageQueue.clear()}},{key:"clearEnteredChannels",value:function(){lr[this._iid]={}}},{key:"createOpenChannelListQuery",value:function(){return new(0,j.get(this._iid).OpenChannelListQuery)}}]),n}(Rt),dr="default",hr=function(){function e(e){this.name=dr,this.volume=1,e&&this._update(e)}return e.prototype._update=function(e){e.hasOwnProperty("name")&&(this.name=e.name),e.hasOwnProperty("volume")&&(this.volume=e.volume)},e.objectify=function(e){var t=e.name,n=void 0===t?dr:t,r=e.volume;return{name:n,volume:void 0===r?1:r}},e.prototype.serialize=function(){return kt.serialize(this)},e}(),fr=function(){function e(e,t){void 0===t&&(t=[]),this.key=e,this.value=Array.isArray(t)&&t.every((function(e){return"string"==typeof e}))?t:[]}return e.prototype.encode=function(){return{key:this.key,value:this.value||[]}},e}(),pr=new WeakMap,yr=function(){function e(t){d(this,e),this._mentionType=e.MentionType.USERS,this._mentionedUserIds=[],this._cachedMentionedUsers=[],this._cachedMentionedUserIds=[],this._metaArrays=[],pr.set(this,null),this._parentMessageId=null,this.data=null,this.customType=null,this.pushNotificationDeliveryOption=null,this.appleCriticalAlertOptions=null,this.isReplyToChannel=!1,t&&this._update(t)}return f(e,[{key:"mentionType",get:function(){return this._mentionType},set:function(e){var t=j.get(this._iid).BaseMessageParams;Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(e)>-1&&(this._mentionType=e)}},{key:"mentionedUserIds",get:function(){return this._cachedMentionedUserIds},set:function(e){if(Array.isArray(e))for(var t=Ri.getInstance(this._iid),n=0;n<e.length;n++){var r=e[n];if("string"!=typeof r){this._cachedMentionedUserIds=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r)<0&&t.currentUser&&t.currentUser.userId!==r&&(this._cachedMentionedUserIds.push(r),this._mentionedUserIds.push(r))}}},{key:"mentionedUsers",get:function(){return this._cachedMentionedUsers},set:function(e){if(Array.isArray(e))for(var t=Ri.getInstance(this._iid),n=0;n<e.length;n++){var r=e[n];if(!r.hasOwnProperty("userId")){this._cachedMentionedUsers=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r.userId)<0&&t.currentUser&&t.currentUser.userId!==r.userId&&(this._cachedMentionedUsers.push(r),this._mentionedUserIds.push(r.userId))}}},{key:"metaArrayKeys",get:function(){return this._metaArrays.map((function(e){return e.key}))},set:function(e){var t=j.get(this._iid).MessageMetaArray,n={};if(Array.isArray(e)){this._metaArrays=[];for(var r=0;r<e.length;r++)"string"!=typeof e[r]||n[e[r]]||(n[e[r]]=!0,this._metaArrays.push(new t(e[r])))}}},{key:"metaArrays",get:function(){return this._metaArrays},set:function(e){var t=j.get(this._iid).MessageMetaArray;if(Array.isArray(e)){this._metaArrays=[];for(var n=0;n<e.length;n++){var r=e[n];if(r instanceof t){var i,a=this._metaArrays.map((function(e){return e.key})).indexOf(r.key);a<0?this._metaArrays.push(r):(i=this._metaArrays[a].value).push.apply(i,N(r.value))}}}}},{key:"rootMessageId",get:function(){return pr.get(this)}},{key:"parentMessageId",get:function(){return this._parentMessageId},set:function(e){pr.set(this,e),this._parentMessageId=e}},{key:"_serialize",value:function(e){return kt.serialize(this,(function(t){t.hasOwnProperty("_mentionType")&&(t.mentionType=t._mentionType,delete t._mentionType),t.hasOwnProperty("_mentionedUserIds")&&(t.mentionedUserIds=t._mentionedUserIds,delete t._mentionedUserIds),t.hasOwnProperty("_cachedMentionedUsers")&&(t.cachedMentionedUsers=t._cachedMentionedUsers,delete t._cachedMentionedUsers),t.hasOwnProperty("_cachedMentionedUserIds")&&(t.cachedMentionedUserIds=t._cachedMentionedUserIds,delete t._cachedMentionedUserIds),t.hasOwnProperty("_metaArrays")&&(t.metaArrays=t._metaArrays,delete t._metaArrays),t.hasOwnProperty("_parentMessageId")&&(t.parentMessageId=t._parentMessageId,delete t._parentMessageId),e&&e(t)}))}},{key:"_update",value:function(e){e.hasOwnProperty("mention_type")&&(this._mentionType=e.mention_type),e.hasOwnProperty("mentioned_user_ids")&&(this._mentionedUserIds=e.mentioned_user_ids),e.hasOwnProperty("cached_mentioned_users")&&(this._cachedMentionedUsers=e.cached_mentioned_users),e.hasOwnProperty("cached_mentioned_user_ids")&&(this._cachedMentionedUserIds=e.cached_mentioned_user_ids),e.hasOwnProperty("meta_arrays")&&(this._metaArrays=e.meta_arrays.map((function(e){return new fr(e.key,e.value)}))),e.hasOwnProperty("parent_message_id")&&(this.parentMessageId=e.parent_message_id),e.hasOwnProperty("data")&&(this.data=e.data),e.hasOwnProperty("custom_type")&&(this.customType=e.custom_type),e.hasOwnProperty("push_notification_delivery_option")&&(this.pushNotificationDeliveryOption=e.push_notification_delivery_option),e.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new hr(e.apple_critical_alert_options)),e.hasOwnProperty("is_reply_to_channel")&&(this.isReplyToChannel=e.is_reply_to_channel)}},{key:"_validate",value:function(){var e=j.get(this._iid),t=e.BaseMessageParams,n=e.MessageMetaArray,r=pr.get(this);return Object.keys(t.MentionType).map((function(e){return t.MentionType[e]})).indexOf(this.mentionType)>-1&&this._mentionedUserIds.every((function(e){return"string"==typeof e}))&&Array.isArray(this._metaArrays)&&this._metaArrays.every((function(e){return e instanceof n}))&&("number"==typeof r||null===r)&&("number"==typeof this._parentMessageId||null===this._parentMessageId)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&(null===this.pushNotificationDeliveryOption||Object.keys(t.PushNotificationDeliveryOption).map((function(e){return t.PushNotificationDeliveryOption[e]})).indexOf(this.pushNotificationDeliveryOption)>-1)&&(null===this.appleCriticalAlertOptions||this.appleCriticalAlertOptions instanceof hr)&&"boolean"==typeof this.isReplyToChannel}}],[{key:"_objectify",value:function(t){var n=t.mentionType,r=void 0===n?e.MentionType.USERS:n,i=t.mentionedUserIds,a=void 0===i?[]:i,s=t.cachedMentionedUsers,o=void 0===s?[]:s,l=t.cachedMentionedUserIds,u=void 0===l?[]:l,c=t.metaArrays,d=void 0===c?[]:c,h=t.parentMessageId,f=void 0===h?null:h,p=t.pushNotificationDeliveryOption,y=void 0===p?null:p,g=t.appleCriticalAlertOptions,_=void 0===g?null:g,m=t.isReplyToChannel;return{mention_type:r,mentioned_user_ids:a,cached_mentioned_users:o,cached_mentioned_user_ids:u,meta_arrays:d,parent_message_id:f,push_notification_delivery_option:y,apple_critical_alert_options:_,is_reply_to_channel:void 0!==m&&m}}},{key:"MentionType",get:function(){return{USERS:"users",CHANNEL:"channel"}}},{key:"PushNotificationDeliveryOption",get:function(){return{DEFAULT:"default",SUPPRESS:"suppress"}}}]),e}(),gr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).message=null,r.pollId=void 0,r._translationTargetLanguages=[],e&&r._update(e),r}return f(n,[{key:"serialize",value:function(){return C(g(n.prototype),"_serialize",this).call(this,(function(e){e.hasOwnProperty("_translationTargetLanguages")&&(e.translationTargetLanguages=e._translationTargetLanguages,delete e._translationTargetLanguages)}))}},{key:"targetLanguages",get:function(){return this.translationTargetLanguages},set:function(e){this.translationTargetLanguages=e}},{key:"translationTargetLanguages",get:function(){return this._translationTargetLanguages},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("string"!=typeof e[t])return void(this._translationTargetLanguages=[]);this._translationTargetLanguages=e}}},{key:"_update",value:function(e){C(g(n.prototype),"_update",this).call(this,e),e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("translation_target_languages")&&(this._translationTargetLanguages=e.translation_target_languages),e.hasOwnProperty("poll_id")&&(this.pollId=e.poll_id)}},{key:"_validate",value:function(){return C(g(n.prototype),"_validate",this).call(this)&&("string"==typeof this.message||null===this.message)&&Array.isArray(this.translationTargetLanguages)&&this.translationTargetLanguages.every((function(e){return"string"==typeof e}))&&("number"==typeof this.pollId||null===this.pollId||void 0===this.pollId)}}],[{key:"objectify",value:function(e){var t=e.message,n=void 0===t?null:t,r=e.data,i=void 0===r?null:r,a=e.customType,s=void 0===a?null:a,o=e.translationTargetLanguages,l=void 0===o?[]:o,c=e.pollId,d=void 0===c?void 0:c;return u(u({},yr._objectify(e)),{},{message:n,data:i,custom_type:s,translation_target_languages:l,poll_id:d})}}]),n}(yr),_r=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=Tt.MESSAGE_TYPE_USER,r.message=null,r._sender=null,r.translations={},r.requestState=null,r.requestedMentionUserIds=[],r.errorCode=0,r.messageSurvivalSeconds=-1,r.plugins=[],r.poll=null,r._messageParams=null,e&&r._update(e),r}return f(n,[{key:"applyPollUpdateEvent",value:function(e){var t=j.get(this._iid),n=t.Poll,r=t.PollUpdateEvent,i=null,a=ge.parse(arguments,[new ge({type:r,constraint:function(e){return Object.values(n.Status).includes(e.status)}})]),s=S(a,2);if(i=s[0],e=s[1],!i&&this.poll&&this.poll.id===e.poll.id){if(e.status===n.Status.REMOVED)return this.poll=new n(n.objectify(this.poll)),this.poll.details.status=e.status,!0;if(this.poll.details.updatedAt<e.poll.details.updatedAt)return this.poll=e.poll,!0}return!1}},{key:"applyPollVoteEvent",value:function(e){var t=j.get(this._iid).PollVoteEvent,n=null,r=S(ge.parse(arguments,[new ge({type:t})]),2);if(n=r[0],e=r[1],!n&&this.poll&&this.poll.id===e.pollId){var i,a=w(this.poll.details.options);try{for(a.s();!(i=a.n()).done;)if(i.value._applyEvent(e))return!0}catch(n){a.e(n)}finally{a.f()}}return!1}},{key:"_update",value:function(e){var t=Ri.getInstance(this._iid),n=j.get(this._iid),r=n.Sender,i=n.Plugin,a=n.Poll;this.message=String(e.message),this._sender=new r(e.user),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.translations=e.hasOwnProperty("translations")?e.translations:{},this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds),this.plugins=[],e.hasOwnProperty("plugins")&&Array.isArray(e.plugins)&&(this.plugins=e.plugins.map((function(e){return new i(e)}))),this.poll=null,e.hasOwnProperty("poll")&&(this.poll=new a(e.poll)),e.hasOwnProperty("message_params")&&(this._messageParams=new gr(e.message_params))}},{key:"sender",get:function(){var e=Ri.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(this._sender&&e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),ae.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=Ri.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ae.isResendableError(this.errorCode)}},{key:"serialize",value:function(){var e=this;return C(g(n.prototype),"serialize",this).call(this,(function(t){e._messageParams&&(t.messageParams=e._messageParams.serialize())}))}},{key:"messageParams",get:function(){return this._messageParams}},{key:"_clone",value:function(){return j.get(this._iid).UserMessage.buildFromSerializedData(this.serialize())}},{key:"_isSentByMe",value:function(){var e=Ri.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.SUCCEEDED&&0===this.updatedAt&&this._sender&&this._sender.userId===e.currentUser.userId}}],[{key:"objectify",value:function(e){var t=Ri.getInstance(this._iid),n=j.get(this._iid),r=n.BaseChannel,i=n.BaseMessageParams,a=n.Sender,s=n.User,o=n.UserMessage,l=n.FileMessage,c=n.AdminMessage,d=n.ThreadInfo,h=n.OGMetaData,f=n.Plugin,p=n.AppleCriticalAlertOptions,y=n.Poll,g=n.UserMessageParams,_=e.messageId,m=e.messageType,v=void 0===m?Tt.MESSAGE_TYPE_BASE:m,E=e.reqId,b=void 0===E?"":E,C=e.user,S=e.channel,N=void 0===S?null:S,k=e.channelUrl,A=void 0===k?"":k,w=e.channelType,T=void 0===w?r.CHANNEL_TYPE_OPEN:w,O=e.message,I=e.data,M=void 0===I?"":I,U=e.customType,R=void 0===U?"":U,P=e.mentionType,L=void 0===P?i.MentionType.USERS:P,D=e.mentionedUsers,x=void 0===D?[]:D,F=e.mentionedUserIds,H=void 0===F?[]:F,G=e.requestedMentionUserIds,V=void 0===G?[]:G,B=e.reactions,z=void 0===B?[]:B,Y=e.metaArrays,q=void 0===Y?[]:Y,K=e.rootMessageId,W=void 0===K?0:K,Q=e.parentMessageId,$=void 0===Q?0:Q,J=e.parentMessageText,X=void 0===J?"":J,Z=e.threadInfo,ee=void 0===Z?null:Z,te=e.isReplyToChannel,ne=void 0!==te&&te,re=e.parentMessage,ie=void 0===re?null:re,ae=e.translations,se=void 0===ae?{}:ae,oe=e.sendingStatus,le=e.errorCode,ue=void 0===le?0:le,ce=e.silent,de=void 0!==ce&&ce,he=e.isGlobalBlocked,fe=void 0!==he&&he,pe=e.messageSurvivalSeconds,ye=void 0===pe?-1:pe,ge=e.ogMetaData,_e=void 0===ge?null:ge,me=e.isOperatorMessage,ve=void 0!==me&&me,Ee=e.plugins,be=void 0===Ee?[]:Ee,Ce=e.appleCriticalAlertOptions,Se=e.poll,Ne=void 0===Se?null:Se,ke=e.createdAt,Ae=e.updatedAt,we=void 0===Ae?0:Ae,Te=e.messageParams,Oe=void 0===Te?null:Te,Ie=e.isAutoResendRegistered,Me=void 0!==Ie&&Ie,Ue={};switch(Ue.req_id=b,Ue.msg_id=_,v){case Tt.MESSAGE_TYPE_USER:Ue.type="MESG";break;case Tt.MESSAGE_TYPE_FILE:Ue.type="FILE";break;case Tt.MESSAGE_TYPE_ADMIN:Ue.type="ADMM"}if(Ue.user=a.objectify(u({},C)),Ue.channel_url=N?N.url:A,Ue.channel_type=N?N.channelType:T,Ue.message=O,Ue.data=M,Ue.custom_type=R,Ue.translations=se,Ue.is_global_block=!!fe,Ue.ts=ke,Ue.updated_at=we,Ue.mention_type=L,Ue.mentioned_users=x.map((function(e){return s.objectify(e)})),Ue.mentioned_user_ids=H,Ue.requested_mention_user_ids=V,Ue.reactions=z.map((function(e){return e.serialize()})),Ue.metaarray={},q.forEach((function(e){var t=e.key;Ue.metaarray[t]=e.value})),Ue.metaarray_key_order=q.map((function(e){return e.key})),Ue.root_message_id=W,Ue.parent_message_id=$,Ue.parent_message_text=X,ee&&(Ue.thread_info=d.objectify(ee)),Ue.is_reply_to_channel=ne,ie)switch(ie.messageType){case Tt.MESSAGE_TYPE_USER:Ue.parent_message_info=o._objectifySerializedData(ie);break;case Tt.MESSAGE_TYPE_FILE:Ue.parent_message_info=l._objectifySerializedData(ie);break;case Tt.MESSAGE_TYPE_ADMIN:Ue.parent_message_info=c._objectifySerializedData(ie)}return Ue.sending_status=_>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,oe&&(Ue.sending_status=oe),Ue.silent=!!de,Ue.error_code=ue,Ue.message_survival_seconds=ye,_e&&(Ue.og_tag=h.objectify(_e)),Ue.is_op_msg=!!ve,Ue.plugins=be.map((function(e){return f.objectify(e)})),Ne&&(Ue.poll=y.objectify(Ne)),Ce&&(Ue.apple_critical_alert_options=p.objectify(Ce)),Oe&&(Ue.message_params=g.objectify(Oe)),Ue.is_auto_resend_registered=Me,Ue}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,y,g,_,m,v,E,b,C,S,N,k,A,w,T,O){return this.objectify({messageId:t,reqId:e,user:n,channel:r,message:i,data:a,customType:s,mentionType:f,mentionedUsers:p,mentionedUserIds:v,requestedMentionUserIds:b,reactions:h,metaArrays:d,rootMessageId:y,parentMessageId:g,parentMessageText:_,threadInfo:m,translations:o,sendingStatus:E,errorCode:C,isGlobalBlocked:l,messageSurvivalSeconds:S,ogMetaData:N,isOperatorMessage:k,plugins:A,appleCriticalAlertOptions:w,poll:T,createdAt:u,updatedAt:c,messageParams:O})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).UserMessage,n=kt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).UserMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,messageParams:e.messageParams?new gr(gr.objectify(e.messageParams)):null}))}}]),n}(Tt),mr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).fileName=null,r.mimeType=null,r.fileSize=null,r._isUpdate=!1,r._file=null,r._fileType=null,r._fileUrl=null,r._thumbnailSizes=[],e&&r._update(e),r}return f(n,[{key:"serialize",value:function(){return C(g(n.prototype),"_serialize",this).call(this,(function(e){e.hasOwnProperty("_isUpdate")&&(e.isUpdate=e._isUpdate,delete e._isUpdate),e.hasOwnProperty("_file")&&(e.file=e._file,delete e._file),e.hasOwnProperty("_fileType")&&(e.fileType=e._fileType,delete e._fileType),e.hasOwnProperty("_fileUrl")&&(e.fileUrl=e._fileUrl,delete e._fileUrl),e.hasOwnProperty("_thumbnailSizes")&&(e.thumbnailSizes=e._thumbnailSizes,delete e._thumbnailSizes)}))}},{key:"file",get:function(){return this._file},set:function(e){ae.isFile(e)&&(this._fileUrl=null,this._file=e,se.isFile(e)?this._fileType=x.FILE:se.isBlob(e)?this._fileType=x.BLOB:se.isFileLikeObject(e)?this._fileType=x.BLOB_LIKE_OBJECT:"string"==typeof e&&(this._fileType=x.URL))}},{key:"fileType",get:function(){return this._fileType}},{key:"fileUrl",get:function(){return this._fileUrl},set:function(e){"string"==typeof e&&(this._fileUrl=e,this._file=null)}},{key:"thumbnailSizes",get:function(){return this._thumbnailSizes},set:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("object"!==c(e[t])||"number"!=typeof e[t].maxWidth||"number"!=typeof e[t].maxHeight)return void(this._thumbnailSizes=[]);this._thumbnailSizes=e}}},{key:"_update",value:function(e){C(g(n.prototype),"_update",this).call(this,e),e.hasOwnProperty("file_name")&&(this.fileName=e.file_name),e.hasOwnProperty("mime_type")&&(this.mimeType=e.mime_type),e.hasOwnProperty("file_size")&&(this.fileSize=e.file_size),e.hasOwnProperty("is_update")&&(this._isUpdate=e.is_update),e.hasOwnProperty("file")&&(this._file=e.file),e.hasOwnProperty("file_type")&&(this._fileType=e.file_type),e.hasOwnProperty("file_url")&&(this._fileUrl=e.file_url),e.hasOwnProperty("thumbnail_sizes")&&(this._thumbnailSizes=e.thumbnail_sizes)}},{key:"_validate",value:function(){return C(g(n.prototype),"_validate",this).call(this)&&(this._isUpdate||ae.isFile(this.file)||"string"==typeof this.fileUrl)&&("string"==typeof this.fileName||null===this.fileName)&&("string"==typeof this.mimeType||null===this.mimeType)&&("number"==typeof this.fileSize||null===this.fileSize)&&(null===this._thumbnailSizes||this._thumbnailSizes.every((function(e){return"object"===c(e)&&e.maxWidth>0&&e.maxHeight>0})))}}],[{key:"objectify",value:function(e){var t=e.fileName,n=void 0===t?null:t,r=e.mimeType,i=void 0===r?null:r,a=e.fileSize,s=void 0===a?null:a,o=e.data,l=void 0===o?null:o,c=e.customType,d=void 0===c?null:c,h=e.isUpdate,f=void 0!==h&&h,p=e.file,y=void 0===p?null:p,g=e.fileType,_=void 0===g?null:g,m=e.fileUrl,v=void 0===m?null:m,E=e.thumbnailSizes,b=void 0===E?[]:E;return u(u({},yr._objectify(e)),{},{file_name:n,mime_type:i,file_size:s,data:l,custom_type:d,is_update:f,file:y,file_type:_,file_url:v,thumbnail_sizes:b})}}]),n}(yr),vr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=Tt.MESSAGE_TYPE_FILE,r.plainUrl=null,r.name="File",r.size=0,r.type=null,r.thumbnails=[],r._sender=null,r.requireAuth=null,r.requestState=null,r.requestedMentionUserIds=[],r.errorCode=0,r.messageSurvivalSeconds=-1,r._messageParams=null,e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){var t=Ri.getInstance(this._iid),n=I.get(this._iid).container.auth,r=j.get(this._iid).Sender;if(this._sender=new r(e.user),this.requireAuth=!!e.hasOwnProperty("require_auth")&&e.require_auth,e.hasOwnProperty("url")&&(this.plainUrl=e.url.split("?auth=")[0]),this.name=e.hasOwnProperty("name")?e.name:"File",this.size=parseInt(e.size)||0,this.type=e.type,e.hasOwnProperty("custom")&&(this.data=e.custom),e.hasOwnProperty("file")){var i=e.file;i.hasOwnProperty("url")&&(this.plainUrl=i.url),i.hasOwnProperty("name")&&(this.name=i.name),i.hasOwnProperty("size")&&(this.size=i.size),i.hasOwnProperty("type")&&(this.type=i.type),i.hasOwnProperty("custom")&&(this.data=i.custom)}if(Object.defineProperty(this,"url",{value:this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(n.eKey):this.plainUrl,configurable:!0,writable:!1}),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.thumbnails=e.hasOwnProperty("thumbnails")?e.thumbnails:[],this.requireAuth)for(var a=0;a<this.thumbnails.length;a++)this.thumbnails[a].plainUrl=String(this.thumbnails[a].url).split("?auth=")[0],this.thumbnails[a].url=this.requireAuth?"".concat(this.thumbnails[a].plainUrl,"?auth=").concat(n.eKey):this.thumbnails[a].plainUrl;this.requestState=this.messageId>0?t.MessageRequestState.SUCCEEDED:t.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===t.MessageSendingStatus.CANCELED&&(this.requestState=t.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds),e.hasOwnProperty("message_params")&&(this._messageParams=new mr(e.message_params))}},{key:"sender",get:function(){var e=Ri.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(this._sender&&e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),ae.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"isResendable",value:function(){var e=Ri.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ae.isResendableError(this.errorCode)}},{key:"serialize",value:function(){var e=this;return C(g(n.prototype),"serialize",this).call(this,(function(t){e._messageParams&&(t.messageParams=e._messageParams.serialize())}))}},{key:"messageParams",get:function(){return this._messageParams}},{key:"_clone",value:function(){var e=j.get(this._iid).FileMessage.buildFromSerializedData(this.serialize());if(this._messageParams&&e._messageParams){var t=this._messageParams.file;t&&se.isBlob(t)&&(e._messageParams.file=t.slice())}return e}},{key:"_isSentByMe",value:function(){var e=Ri.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.SUCCEEDED&&0===this.updatedAt&&this._sender&&this._sender.userId===e.currentUser.userId}}],[{key:"objectify",value:function(e){var t=Ri.getInstance(this._iid),n=j.get(this._iid),r=n.BaseChannel,i=n.BaseMessageParams,a=n.Sender,s=n.User,o=n.UserMessage,l=n.FileMessage,c=n.AdminMessage,d=n.ThreadInfo,h=n.OGMetaData,f=n.FileMessageParams,p=n.AppleCriticalAlertOptions,y=e.messageId,g=e.messageType,_=void 0===g?Tt.MESSAGE_TYPE_BASE:g,m=e.reqId,v=void 0===m?"":m,E=e.user,b=void 0===E?{}:E,C=e.channel,S=e.plainUrl,N=e.name,k=void 0===N?null:N,A=e.type,w=e.size,T=void 0===w?0:w,O=e.data,I=void 0===O?"":O,M=e.customType,U=void 0===M?"":M,R=e.mentionType,P=void 0===R?i.MentionType.USERS:R,L=e.mentionedUsers,D=void 0===L?[]:L,x=e.mentionedUserIds,F=void 0===x?[]:x,H=e.requestedMentionUserIds,G=void 0===H?[]:H,V=e.reactions,B=void 0===V?[]:V,z=e.metaArrays,Y=void 0===z?[]:z,q=e.rootMessageId,K=void 0===q?0:q,W=e.parentMessageId,Q=void 0===W?0:W,$=e.parentMessageText,J=void 0===$?"":$,X=e.threadInfo,Z=void 0===X?null:X,ee=e.isReplyToChannel,te=void 0!==ee&&ee,ne=e.parentMessage,re=void 0===ne?null:ne,ie=e.thumbnails,ae=void 0===ie?[]:ie,se=e.requireAuth,oe=void 0!==se&&se,le=e.sendingStatus,ue=e.errorCode,ce=void 0===ue?0:ue,de=e.silent,he=void 0!==de&&de,fe=e.isGlobalBlocked,pe=void 0!==fe&&fe,ye=e.messageSurvivalSeconds,ge=void 0===ye?-1:ye,_e=e.ogMetaData,me=void 0===_e?null:_e,ve=e.isOperatorMessage,Ee=void 0!==ve&&ve,be=e.appleCriticalAlertOptions,Ce=e.createdAt,Se=e.updatedAt,Ne=void 0===Se?0:Se,ke=e.messageParams,Ae=void 0===ke?null:ke,we=e.isAutoResendRegistered,Te=void 0!==we&&we,Oe={};switch(Oe.req_id=v,Oe.msg_id=y,_){case Tt.MESSAGE_TYPE_USER:Oe.type="MESG";break;case Tt.MESSAGE_TYPE_FILE:Oe.type="FILE";break;case Tt.MESSAGE_TYPE_ADMIN:Oe.type="ADMM"}Oe.user=a.objectify(u({},b)),Oe.channel_url=C.url,Oe.channel_type=C.channelType===r.CHANNEL_TYPE_OPEN?r.CHANNEL_TYPE_OPEN:r.CHANNEL_TYPE_GROUP,Oe.url=S,Oe.name=k,Oe.type=A,Oe.size=T,Oe.custom=I,Oe.custom_type=U,Oe.thumbnails=ae,Oe.require_auth=oe,Oe.is_global_block=!!pe,Oe.ts=Ce,Oe.updated_at=Ne,Oe.mention_type=P,Oe.mentioned_users=D.map((function(e){return s.objectify(e)})),Oe.mentioned_user_ids=F,Oe.requested_mention_user_ids=G,Oe.reactions=B.map((function(e){return e.serialize()})),Oe.metaarray={};for(var Ie=0;Ie<Y.length;Ie++){var Me=Y[Ie].key;Oe.metaarray[Me]=Y[Ie].value}if(Oe.metaarray_key_order=Y.map((function(e){return e.key})),Oe.root_message_id=K,Oe.parent_message_id=Q,Oe.parent_message_text=J,Z&&(Oe.thread_info=d.objectify(Z)),Oe.is_reply_to_channel=te,re)switch(re.messageType){case r.MESSAGE_TYPE_USER:Oe.parent_message_info=o._objectifySerializedData(re);break;case r.MESSAGE_TYPE_FILE:Oe.parent_message_info=l._objectifySerializedData(re);break;case r.MESSAGE_TYPE_ADMIN:Oe.parent_message_info=c._objectifySerializedData(re)}return Oe.sending_status=y>0?t.MessageSendingStatus.SUCCEEDED:t.MessageSendingStatus.FAILED,le&&(Oe.sending_status=le),Oe.silent=!!he,Oe.error_code=ce,Oe.message_survival_seconds=ge,me&&(Oe.og_tag=h.objectify(me)),Oe.is_op_msg=!!Ee,be&&(Oe.apple_critical_alert_options=p.objectify(be)),Ae&&(Oe.message_params=f.objectify(Ae)),Oe.is_auto_resend_registered=Te,Oe}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,y,g,_,m,v,E,b,C,S,N,k,A,w,T,O,I,M){return this.objectify({messageId:t,reqId:e,user:n,channel:r,plainUrl:i,name:a,type:s,size:o,data:l,customType:u,mentionType:_,mentionedUsers:m,mentionedUserIds:S,requestedMentionUserIds:k,reactions:g,metaArrays:y,rootMessageId:v,parentMessageId:E,parentMessageText:b,threadInfo:C,thumbnails:h,requireAuth:f,sendingStatus:N,errorCode:A,isGlobalBlocked:c,messageSurvivalSeconds:w,ogMetaData:T,isOperatorMessage:O,appleCriticalAlertOptions:I,createdAt:d,updatedAt:p,messageParams:M})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).FileMessage,n=kt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).FileMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType},user:e.sender,messageParams:e.messageParams?new mr(mr.objectify(e.messageParams)):null}))}}]),n}(Tt),Er=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).messageType=Tt.MESSAGE_TYPE_ADMIN,r.message="",r.translations={},e&&r._update(e),r}return f(n,[{key:"_update",value:function(e){this.message=String(e.message),this.translations=e.hasOwnProperty("translations")?e.translations:{}}}],[{key:"objectify",value:function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.BaseMessageParams,i=t.UserMessage,a=t.FileMessage,s=t.AdminMessage,o=t.User,l=t.ThreadInfo,u=t.OGMetaData,c=e.messageId,d=e.messageType,h=void 0===d?Tt.MESSAGE_TYPE_BASE:d,f=e.channel,p=e.message,y=e.data,g=void 0===y?"":y,_=e.customType,m=void 0===_?"":_,v=e.mentionType,E=void 0===v?r.MentionType.USERS:v,b=e.mentionedUsers,C=void 0===b?[]:b,S=e.reactions,N=void 0===S?[]:S,k=e.metaArrays,A=void 0===k?[]:k,w=e.rootMessageId,T=void 0===w?0:w,O=e.parentMessageId,I=void 0===O?0:O,M=e.parentMessageText,U=void 0===M?"":M,R=e.threadInfo,P=void 0===R?null:R,L=e.isReplyToChannel,D=void 0!==L&&L,x=e.parentMessage,F=void 0===x?null:x,H=e.translations,G=void 0===H?{}:H,V=e.silent,B=void 0!==V&&V,z=e.ogMetaData,Y=void 0===z?null:z,q=e.createdAt,K=e.updatedAt,W=void 0===K?0:K,Q={msg_id:c,channel_url:f.url,channel_type:f.channelType===n.CHANNEL_TYPE_OPEN?n.CHANNEL_TYPE_OPEN:n.CHANNEL_TYPE_GROUP,message:p,data:g,custom_type:m,silent:B,ts:q,updated_at:W};switch(h){case Tt.MESSAGE_TYPE_USER:Q.type="MESG";break;case Tt.MESSAGE_TYPE_FILE:Q.type="FILE";break;case Tt.MESSAGE_TYPE_ADMIN:Q.type="ADMM"}Q.translations=G,Q.mention_type=E,Q.mentioned_users=C.map((function(e){return o.objectify(e)})),Q.reactions=N.map((function(e){return e.serialize()})),Q.metaarray={};for(var $=0;$<A.length;$++){var J=A[$].key;Q.metaarray[J]=A[$].value}if(Q.metaarray_key_order=A.map((function(e){return e.key})),Q.root_message_id=T,Q.parent_message_id=I,Q.parent_message_text=U,P&&(Q.thread_info=l.objectify(P)),Q.is_reply_to_channel=D,F)switch(F.messageType){case n.MESSAGE_TYPE_USER:Q.parent_message_info=i._objectifySerializedData(F);break;case n.MESSAGE_TYPE_FILE:Q.parent_message_info=a._objectifySerializedData(F);break;case n.MESSAGE_TYPE_ADMIN:Q.parent_message_info=s._objectifySerializedData(F)}return Y&&(Q.og_tag=u.objectify(Y)),Q}},{key:"build",value:function(e,t,n,r,i,a,s,o,l,u,c,d,h,f,p,y,g){return this.objectify({messageId:e,channel:t,message:n,data:r,customType:i,mentionType:c,mentionedUsers:d,reactions:u,metaArrays:l,rootMessageId:h,parentMessageId:f,parentMessageText:p,threadInfo:y,translations:a,ogMetaData:g,createdAt:s,updatedAt:o})}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).AdminMessage,n=kt.deserialize(e);return new t(this._objectifySerializedData(n))}},{key:"_objectifySerializedData",value:function(e){return j.get(this._iid).AdminMessage.objectify(u(u({},e),{},{channel:{url:e.channelUrl,channelType:e.channelType}}))}}]),n}(Tt),br=function(){function e(t){d(this,e);var n=j.get(this._iid),r=n.BaseMessage,i=n.BaseMessageParams;this.scheduledId=0,this.scheduledDateTimeString="",this.scheduledTimezone="",this.status=e.Status.SCHEDULED,this.createdAt=0,this.updatedAt=0,this._messageType=r.MESSAGE_TYPE_BASE,this._sender=null,this._channelType="",this.channelUrl="",this.message="",this.customType="",this.data="",this.metaArrays=[],this.mentionType=i.MentionType.USERS,this.mentionedUsers=[],this.pushNotificationDeliveryOption=i.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=[],this.errorMessage="",this.errorCode=0,this.appleCriticalAlertOptions=null,t&&this._update(t)}return f(e,[{key:"sender",get:function(){var e=Ri.getInstance(this._iid),t=j.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var n=t.cachedChannels[this.channelUrl];if(n){var r=n.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.plainProfileUrl!==r.plainProfileUrl&&(this._sender.plainProfileUrl=r.plainProfileUrl),ae.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"_update",value:function(t){var n=this,r=j.get(this._iid),i=r.User,a=r.Sender,s=r.BaseMessageParams,o=r.MessageMetaArray,l=r.AppleCriticalAlertOptions;this.scheduledId=t.hasOwnProperty("scheduled_id")?parseInt(t.scheduled_id):0,this.scheduledDateTimeString=t.hasOwnProperty("scheduled_dt")?String(t.scheduled_dt):"",this.scheduledTimezone=t.hasOwnProperty("scheduled_timezone")?String(t.scheduled_timezone):"",this.status=t.hasOwnProperty("status")?String(t.status):"",this.createdAt=t.hasOwnProperty("created_at")?parseInt(t.created_at):0,this.updatedAt=t.hasOwnProperty("updated_at")?parseInt(t.updated_at):0,this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this._channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):"",this._messageType=t.hasOwnProperty("type")?String(t.type):"",this._sender=t.hasOwnProperty("user")?new a(t.user):null,this.message=t.hasOwnProperty("message")?String(t.message):"",this.customType=t.hasOwnProperty("custom_type")?String(t.custom_type):"",this.data=t.hasOwnProperty("data")?String(t.data):"";var u=t.hasOwnProperty("metaarray")?t.metaarray:{},c=t.hasOwnProperty("metaarray_key_order")?t.metaarray_key_order:Object.keys(u).sort((function(e,t){return e.localeCompare(t)}));this.metaArrays=[];for(var d=0;d<c.length;d++){var h=c[d];this.metaArrays.push(new o(h,u[h]||[]))}this.mentionType=t.hasOwnProperty("mention_type")?t.mention_type:s.MentionType.USERS,this.mentionedUsers=[],t.hasOwnProperty("mentioned_users")&&t.mentioned_users.forEach((function(e){var t=new i(e);n.mentionedUsers.push(t)})),this.pushNotificationDeliveryOption=t.hasOwnProperty("push_option")?t.push_option:s.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=t.hasOwnProperty("translation_target_langs")?t.translation_target_langs:[],this.status===e.Status.FAILED&&(t.hasOwnProperty("error")&&t.error.hasOwnProperty("message")&&(this.errorMessage=String(t.error.message)),t.hasOwnProperty("error")&&t.error.hasOwnProperty("code")&&(this.errorCode=parseInt(t.error.code))),t.hasOwnProperty("apple_critical_alert_options")&&(this.appleCriticalAlertOptions=new l(t.apple_critical_alert_options))}},{key:"isOpenChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=j.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_GROUP}},{key:"metaArray",get:function(){var e={};return this.metaArrays.forEach((function(t){e[t.key]=t.value})),e},set:function(e){if("object"===c(e)&&e){var t=j.get(this._iid).MessageMetaArray,n=[];Object.keys(e).forEach((function(r){n.push(new t(r,e[r]))})),this.metaArrays=n}}}],[{key:"Status",get:function(){return{SCHEDULED:"scheduled",SENT:"sent",CANCELED:"canceled",FAILED:"failed"}}}]),e}(),Cr=function(){function e(){this.threadInfo=null,this.targetMessageId=0,this.channelUrl=null,this.channelType=null}return e.createFromJson=function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.ThreadInfo,i=e.thread_info,a=e.root_message_id,s=e.channel_url,o=e.channel_type;if(i&&"object"==typeof i&&("string"==typeof a||"number"==typeof a)&&"string"==typeof s&&"string"==typeof o&&[n.CHANNEL_TYPE_GROUP,n.CHANNEL_TYPE_OPEN].includes(o)){var l=new this;return l.threadInfo=new r(i),l.targetMessageId=parseInt(a+""),l.channelUrl=s,l.channelType=o,l}return null},e}(),Sr=function(){function e(){d(this,e),this.poll=null,this.status=null}return f(e,null,[{key:"createFromJson",value:function(e){var t=j.get(this._iid).Poll,n=e.poll;if("object"===c(n)){var r=new this;return r.poll=new t(n),r.status=n.status,r}return null}}]),e}(),Nr=function(){function e(){d(this,e),this.pollId=null,this.updatedVoteCounts=null,this.votedAt=null}return f(e,null,[{key:"createFromJson",value:function(e){var t=e.poll_id,n=e.updated_vote_counts,r=e.ts;if("number"==typeof t&&Array.isArray(e.updated_vote_counts)&&"number"==typeof r){var i=new this;return i.pollId=t,i.updatedVoteCounts=n.map((function(e){return{optionId:e.option_id,voteCount:e.vote_count}})),i.votedAt=r,i}return null}}]),e}(),kr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this.metaDataKeyFilter="",this.metaDataValuesFilter=[],this.nicknameStartsWithFilter=null,this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)&&"string"==typeof t.metaDataKeyFilter&&Array.isArray(t.metaDataValuesFilter)&&!!t.metaDataKeyFilter==t.metaDataValuesFilter.length>0&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter)?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadUserList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),Ar=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._isOpenChannel=!1,this._channelUrl=null,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadBannedUserList(u(u({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).RestrictedUser,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.banned_list.map((function(e){var t=new a(e);return t.restrictionInfo.restrictionType=a.RestrictionType.BANNED,t}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),wr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIdsFilter)?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadBlockedUserList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),Tr=function(){function e(){d(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasMore?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadFriendList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasMore=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),Or=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=e.ORDER_LATEST_LAST_MESSAGE,this._token="",this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:e.QueryType.AND},this._userIdsExactFilter=[],this._userIdsIncludeFilter=[],this._userIdsIncludeFilterQueryType=e.QueryType.AND,this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.memberStateFilter=er.MemberStateFilter.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=er.SuperChannelFilter.ALL,this.publicChannelFilter=er.PublicChannelFilter.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=er.UnreadChannelFilter.ALL,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.hiddenChannelFilter=er.HiddenChannelFilter.UNHIDDEN,this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"userIdsExactFilter",get:function(){return this._userIdsExactFilter},set:function(e){Array.isArray(e)&&(this._userIdsExactFilter=e,this._userIdsIncludeFilter=[],this._userIdsFilter.userIds=this._userIdsExactFilter,this._userIdsFilter.includeMode=!1)}},{key:"userIdsIncludeFilter",get:function(){return this._userIdsIncludeFilter},set:function(e){Array.isArray(e)&&(this._userIdsIncludeFilter=e,this._userIdsExactFilter=[],this._userIdsFilter.userIds=this._userIdsIncludeFilter,this._userIdsFilter.includeMode=!0)}},{key:"userIdsIncludeFilterQueryType",get:function(){return this._userIdsIncludeFilterQueryType},set:function(t){Object.keys(e.QueryType).map((function(t){return e.QueryType[t]})).indexOf(t)>-1&&(this._userIdsIncludeFilterQueryType=t.toUpperCase(),this._userIdsFilter.queryType=this._userIdsIncludeFilterQueryType)}},{key:"setSearchFilter",value:function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={search_query:t,search_fields:e.join(",").toLocaleLowerCase()})}},{key:"serialize",value:function(){return kt.serialize(this,(function(e){e.isLoading=!1}))}},{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.GroupChannel,i=n.GroupChannelListQuery;!("number"==typeof t.limit&&t.limit>0&&"boolean"==typeof t.includeEmpty&&"string"==typeof t.order&&[i.ORDER_CHRONOLOGICAL,i.ORDER_LATEST_LAST_MESSAGE,i.CHANNEL_NAME_ALPHABETICAL,i.METADATA_VALUE_ALPHABETICAL].indexOf(t.order.toLowerCase())>-1&&Array.isArray(t._userIdsExactFilter)&&Array.isArray(t._userIdsIncludeFilter)&&Array.isArray(t.customTypesFilter)&&Array.isArray(t.channelUrlsFilter)&&Object.keys(i.QueryType).map((function(e){return i.QueryType[e]})).indexOf(t._userIdsIncludeFilterQueryType.toUpperCase())>-1&&Object.keys(r.MemberStateFilter).map((function(e){return r.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(r.SuperChannelFilter).map((function(e){return r.SuperChannelFilter[e]})).indexOf(t.superChannelFilter)>-1&&Object.keys(r.PublicChannelFilter).map((function(e){return r.PublicChannelFilter[e]})).indexOf(t.publicChannelFilter)>-1&&Object.keys(r.UnreadChannelFilter).map((function(e){return r.UnreadChannelFilter[e]})).indexOf(t.unreadChannelFilter)>-1&&Object.keys(r.HiddenChannelFilter).map((function(e){return r.HiddenChannelFilter[e]})).indexOf(t.hiddenChannelFilter)>-1)||"string"!=typeof t.customTypeStartsWithFilter&&null!==t.customTypeStartsWithFilter||"string"!=typeof t.nicknameContainsFilter||"string"!=typeof t.channelNameContainsFilter||"string"!=typeof t.metadataOrderKeyFilter&&null!==t.metadataOrderKeyFilter||"string"!=typeof t.metadataKey&&null!==t.metadataKey||!Array.isArray(t.metadataValues)||!t.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof t.metadataValueStartsWith&&null!==t.metadataValueStartsWith||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ge.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadGroupChannelList(u(u({},t),{},{token:t._token,userIdsFilter:t._userIdsFilter,searchFilter:t._searchFilter})).then((function(n){var r=j.get(t._iid).GroupChannel,i=String(n.next);t._token=i,t.hasNext=!!i;var a=n.channels;if(!a||!Array.isArray(a))throw new F("Failed at loading group channels.",F.MALFORMED_DATA);var s=a.map((function(e){return"number"==typeof n.ts&&(e.ts=n.ts),r.upsert(e)}));t.isLoading=!1,e(null,s)})).catch((function(n){t.isLoading=!1,e(n,null)}))):e(null,[])}),e)}}],[{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}},{key:"QueryType",get:function(){return{AND:"AND",OR:"OR"}}},{key:"SearchField",get:function(){return{MEMBER_NICKNAME:"member_nickname",CHANNEL_NAME:"channel_name"}}},{key:"buildFromSerializedData",value:function(e){var t=j.get(this._iid).GroupChannel,n=kt.deserialize(e),r=t.createMyGroupChannelListQuery();return Object.keys(n).forEach((function(e){r.hasOwnProperty(e)&&(r[e]=n[e])})),r}}]),e}(),Ir=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.mutedMemberFilter=e.MutedMemberFilter.ALL,this.memberStateFilter=er.MemberStateFilter.ALL,this.nicknameStartsWithFilter=null,this.order=e.Order.MEMBER_NICKNAME_ALPHABETICAL,this._token="",this._channelUrl=t}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid),r=n.GroupChannel,i=n.Member,a=n.MemberListQuery;"number"==typeof t.limit&&t.limit>0&&Object.keys(a.MutedMemberFilter).map((function(e){return a.MutedMemberFilter[e]})).indexOf(t.mutedMemberFilter)>-1&&Object.keys(r.MemberStateFilter).map((function(e){return r.MemberStateFilter[e]})).indexOf(t.memberStateFilter)>-1&&Object.keys(a.Order).map((function(e){return a.Order[e]})).indexOf(t.order)>-1&&("string"==typeof t.nicknameStartsWithFilter||null===t.nicknameStartsWithFilter)?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadMemberList(u(u({},t),{},{channelUrl:t._channelUrl,token:t._token}),(function(n,r){var a=null;if(!n){var s=String(r.next);t._token=s,t.hasNext=!!s,a=r.members.map((function(e){return new i(e)}))}t.isLoading=!1,e(n,a)}))):e(null,[]):e(ge.error,null)}),e)}}],[{key:"MutedMemberFilter",get:function(){return{ALL:"all",MUTED:"muted",UNMUTED:"unmuted"}}},{key:"Order",get:function(){return{MEMBER_NICKNAME_ALPHABETICAL:"member_nickname_alphabetical",OPERATOR_THEN_MEMBER_ALPHABETICAL:"operator_then_member_alphabetical"}}}]),e}(),Mr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t.channelUrl&&(this._channelUrl=t.channelUrl),t.isOpenChannel&&(this._isOpenChannel=t.isOpenChannel)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadMutedUserList(u(u({},t),{},{channelUrl:t._channelUrl,isOpenChannel:t._isOpenChannel,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).RestrictedUser,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.muted_list.map((function(e){var t=new a(e);return t.restrictionInfo.restrictionType=a.RestrictionType.MUTED,t}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),Ur=function(){function e(){d(this,e),this.limit=20,this.isLoading=!1,this.hasNext=!0,this.nameKeyword=null,this.urlKeyword=null,this.customTypes=[],this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){!("number"==typeof t.limit&&t.limit>0&&Array.isArray(t.customTypes))||"string"!=typeof t.nameKeyword&&null!==t.nameKeyword||"string"!=typeof t.urlKeyword&&null!==t.urlKeyword||"boolean"!=typeof t.includeFrozen||"boolean"!=typeof t.includeMetaData?e(ge.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadOpenChannelList(u(u({},t),{},{token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).OpenChannel,s=String(r.next);t._token=s,t.hasNext=!!s;var o=r.channels;o&&Array.isArray(o)?i=o.map((function(e){return"number"==typeof r.ts&&(e.ts=r.ts),a.upsert(e)})):n=new F("Failed at loading open channels.",F.MALFORMED_DATA)}t.isLoading=!1,e(n,i)}))):e(null,[])}),e)}}]),e}(),Rr=new WeakMap,Pr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",Rr.set(this,t)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){if("number"==typeof t.limit&&t.limit>0)if(t.isLoading)e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else if(t.hasNext){t.isLoading=!0;var n=Rr.get(t);I.get(t._iid).container.apiClient.loadOperatorList(u(u({},t),{},{token:t._token,channelUrl:n.url,isOpenChannel:n.isOpenChannel()}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.operators.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))}else e(null,[]);else e(ge.error,null)}),e)}}]),e}(),Lr=new WeakMap,Dr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",t&&Lr.set(this,t.channelUrl)}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadParticipantList(u(u({},t),{},{channelUrl:Lr.get(t),token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.participants.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),xr=new WeakMap,Fr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.limit,i=void 0===r?20:r,a=n.reverse,s=void 0!==a&&a,o=n.exactMatch,l=void 0!==o&&o,u=n.channelUrl,c=void 0===u?"":u,h=n.channelCustomType,f=void 0===h?"":h,p=n.messageTimestampFrom,y=void 0===p?null:p,g=n.messageTimestampTo,_=void 0===g?null:g,m=n.order,v=void 0===m?"score":m,E=n.advancedQuery,b=void 0!==E&&E,C=n.targetFields,S=void 0===C?null:C;d(this,e),this.isLoading=!1,this.hasNext=!0,xr.set(this,{keyword:t,limit:i,reverse:s,exactMatch:l,channelUrl:c,channelCustomType:f,messageTimestampFrom:y,messageTimestampTo:_,order:v,advancedQuery:b,targetFields:S,previousToken:"",nextToken:""})}return f(e,[{key:"key",get:function(){return xr.get(this).keyword}},{key:"limit",get:function(){return xr.get(this).limit}},{key:"reverse",get:function(){return xr.get(this).reverse}},{key:"exactMatch",get:function(){return xr.get(this).exactMatch}},{key:"channelUrl",get:function(){return xr.get(this).channelUrl}},{key:"channelCustomType",get:function(){return xr.get(this).channelCustomType}},{key:"messageTimestampFrom",get:function(){return xr.get(this).messageTimestampFrom}},{key:"messageTimestampTo",get:function(){return xr.get(this).messageTimestampTo}},{key:"order",get:function(){return xr.get(this).order}},{key:"next",value:function(e){var t=this,n=j.get(this._iid),r=n.BaseChannel,i=n.GroupChannel,a=n.OpenChannel;return le(this._iid,(function(e){var n=xr.get(t),s=n.keyword,o=n.limit,l=n.reverse,u=n.exactMatch,c=n.channelUrl,d=n.channelCustomType,h=n.messageTimestampFrom,f=n.messageTimestampTo,p=n.order,y=n.advancedQuery,g=n.targetFields,_=n.nextToken;!("number"==typeof o&&o>0&&o<=1e3&&"boolean"==typeof l&&"boolean"==typeof u)||"string"!=typeof c&&null!==c||"string"!=typeof d&&null!==d||"number"!=typeof h&&null!==h||"number"!=typeof f&&null!==f||!(["score","ts"].indexOf(p)>=0)||"boolean"!=typeof y&&null!==y||!Array.isArray(g)&&null!==g?e(ge.error,null):t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.searchMessages({keyword:s,limit:o,reverse:l,exactMatch:u,channelUrl:c,channelCustomType:d,messageTimestampFrom:h,messageTimestampTo:f,order:p,advancedQuery:y,targetFields:g,nextToken:_},(function(n,s){var o=null;n||(o=[],s.results.forEach((function(e){if(e.channel.hasOwnProperty("members")){var t=new i(e.channel);i.cachedChannels[t.url]=t,o.push(r.buildMessage(e,t))}else{var n=new a(e.channel);a.cachedChannels[n.url]=n,o.push(r.buildMessage(e,n))}})),t.hasNext=s.has_next,xr.get(t).nextToken=s.end_cursor),t.isLoading=!1,e(n,o)}))):e(null,[])}),e)}}]),e}(),Hr=new WeakMap,Gr=new WeakMap,jr=function(){function e(t){d(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,Gr.set(this,Number.MAX_SAFE_INTEGER),Hr.set(this,t),this.reverse=!1,this.messageTypeFilter=null,this.customTypeFilter=null,this.customTypesFilter=[],this.senderUserIdsFilter=[],this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1,this.includePollDetails=!1}return f(e,[{key:"load",value:function(e,t,n,r){var i=this,a=j.get(this._iid),s=a.BaseChannel,o=a.BaseMessage,l=null,u=ge.parse(arguments,[new ge({type:"number",optional:!0,defaultValue:this.limit}),new ge({type:"boolean",optional:!0,defaultValue:this.reverse}),new ge({type:["string","number"],optional:!0,defaultValue:this.messageTypeFilter,constraint:function(e){return Object.keys(s.MessageTypeFilter).map((function(e){return s.MessageTypeFilter[e]})).indexOf(e)>-1||[0,1,2,3].indexOf(e)>-1}}),new ge({type:"callback"})]),c=S(u,5);return l=c[0],e=c[1],t=c[2],n=c[3],r=c[4],le(this._iid,(function(r){if(("string"!=typeof i.customTypeFilter&&null!==i.customTypeFilter||!Array.isArray(i.customTypesFilter)||!i.customTypesFilter.every((function(e){return"string"==typeof e||null===e}))||!Array.isArray(i.senderUserIdsFilter)||!i.senderUserIdsFilter.every((function(e){return"string"==typeof e}))||"boolean"!=typeof i.includeMetaArray||null!==i.includeReaction&&"boolean"!=typeof i.includeReaction||null!==i.includeReactions&&"boolean"!=typeof i.includeReactions||"boolean"!=typeof i.includeThreadInfo||null!==i.includeReplies&&"boolean"!=typeof i.includeReplies||!(null===i.replyType||"string"==typeof i.replyType&&Object.values(o.ReplyType).includes(i.replyType))||null!==i.includeParentMessageText&&"boolean"!=typeof i.includeParentMessageText||null!==i.includeParentMessageInfo&&"boolean"!=typeof i.includeParentMessageInfo||"boolean"!=typeof i.showSubchannelMessagesOnly)&&(l=ge.error),l)r(l,null);else{if(i.limit=e,i.reverse=t,i.messageTypeFilter=n,"number"==typeof i.messageTypeFilter)switch(i.messageTypeFilter){case 0:i.messageTypeFilter=s.MessageTypeFilter.ALL;break;case 1:i.messageTypeFilter=s.MessageTypeFilter.USER;break;case 2:i.messageTypeFilter=s.MessageTypeFilter.FILE;break;case 3:i.messageTypeFilter=s.MessageTypeFilter.ADMIN}if(i.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else if(i.hasMore){i.isLoading=!0;var a=Hr.get(i);I.get(i._iid).container.apiClient.getMessageList({channel:a,token:Gr.get(i)||(new Date).getTime()+1e4,tokenType:"timestamp",isInclusive:!1,prevResultSize:e,nextResultSize:0,shouldReverse:t,messageType:i.messageTypeFilter,customType:i.customTypeFilter,customTypes:i.customTypesFilter,senderUserIds:i.senderUserIdsFilter,includeMetaArray:i.includeMetaArray,includeReaction:i.includeReaction,includeReactions:i.includeReactions,includeReplies:i.includeReplies,includeParentMessageText:i.includeParentMessageText,includeThreadInfo:i.includeThreadInfo,replyType:i.replyType,includeParentMessageInfo:i.includeParentMessageInfo,showSubchannelMessagesOnly:i.showSubchannelMessagesOnly,includePollDetails:i.includePollDetails}).then((function(t){var n=t.messages.map((function(e){return s.buildMessage(e,a)}));(0===n.length||n.length<e)&&(i.hasMore=!1);var o=Gr.get(i);Gr.set(i,Math.min.apply(Math,N(n.map((function(e){return e.createdAt}))).concat([o]))),i.isLoading=!1,r(null,n)})).catch((function(e){i.isLoading=!1,r(e,null)}))}else r(null,[])}}),r)}}]),e}(),Vr=function(){function e(){d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=Or.ORDER_LATEST_LAST_MESSAGE,this._token="",this.channelNameContainsFilter="",this.channelUrlsFilter=[],this.customTypesFilter=[],this.customTypeStartsWithFilter=null,this.superChannelFilter=er.SuperChannelFilter.ALL,this.membershipFilter=e.MembershipType.JOINED,this.metadataOrderKeyFilter=null,this.metadataKey=null,this.metadataValues=[],this.metadataValueStartsWith=null,this.includeFrozen=!0,this.includeMetaData=!0}return f(e,[{key:"next",value:function(t){var n=this;return le(this._iid,(function(t){var r=j.get(n._iid).GroupChannel;!("number"==typeof n.limit&&n.limit>0&&"boolean"==typeof n.includeEmpty&&"string"==typeof n.order&&[e.ORDER_CHRONOLOGICAL,e.CHANNEL_NAME_ALPHABETICAL,e.METADATA_VALUE_ALPHABETICAL,e.ORDER_LATEST_LAST_MESSAGE].indexOf(n.order.toLowerCase())>-1&&Array.isArray(n.customTypesFilter)&&Array.isArray(n.channelUrlsFilter)&&Object.keys(e.MembershipType).map((function(t){return e.MembershipType[t]})).indexOf(n.membershipFilter)>-1&&Object.keys(r.SuperChannelFilter).map((function(e){return r.SuperChannelFilter[e]})).indexOf(n.superChannelFilter)>-1)||"string"!=typeof n.customTypeStartsWithFilter&&null!==n.customTypeStartsWithFilter||"string"!=typeof n.channelNameContainsFilter||"string"!=typeof n.metadataOrderKeyFilter&&null!==n.metadataOrderKeyFilter||"string"!=typeof n.metadataKey&&null!==n.metadataKey||!Array.isArray(n.metadataValues)||!n.metadataValues.every((function(e){return"string"==typeof e}))||"string"!=typeof n.metadataValueStartsWith&&null!==n.metadataValueStartsWith||"boolean"!=typeof n.includeFrozen||"boolean"!=typeof n.includeMetaData?t(ge.error,null):n.isLoading?t(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):n.hasNext?(n.isLoading=!0,I.get(n._iid).container.apiClient.loadPublicGroupChannelList(u(u({},n),{},{token:n._token}),(function(e,i){var a=null;if(!e){var s=String(i.next);n._token=s,n.hasNext=!!s;var o=i.channels;o&&Array.isArray(o)?a=o.map((function(e){return"number"==typeof i.ts&&(e.ts=i.ts),r.upsert(e)})):e=new F("Failed at loading group channels.",F.MALFORMED_DATA)}n.isLoading=!1,t(e,a)}))):t(null,[])}),t)}}],[{key:"MembershipType",get:function(){return{ALL:"all",JOINED:"joined"}}},{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}}]),e}(),Br=new WeakMap,zr=new WeakMap,Yr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,r=void 0===n?null:n,i=t.token,a=void 0===i?"":i,s=t.limit,o=void 0===s?20:s;d(this,e),this.channelUrl=r,this.token=a,this.limit=o,Br.set(this,!1),zr.set(this,!0)}return f(e,[{key:"isLoading",get:function(){return!!Br.get(this)}},{key:"hasNext",get:function(){return!!zr.get(this)}},{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"string"==typeof t.channelUrl&&"number"==typeof t.limit&&t.limit>0&&t.limit<=100?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(Br.set(t,!0),I.get(t._iid).container.apiClient.getPollList(u({},t),(function(n,r){if(n)Br.set(t,!1),e(n,null);else{var i=j.get(t._iid).Poll,a=r.hasOwnProperty("polls")&&Array.isArray(r.polls)?r.polls.map((function(e){return new i(e)})):[],s=r.hasOwnProperty("next")&&r.next?String(r.next):"";t.token=s,Br.set(t,!1),zr.set(t,!!s),e(null,a)}}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),qr=new WeakMap,Kr=new WeakMap,Wr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,r=void 0===n?null:n,i=t.pollId,a=void 0===i?null:i,s=t.optionId,o=void 0===s?null:s,l=t.token,u=void 0===l?"":l,c=t.limit,h=void 0===c?100:c;d(this,e),this.channelUrl=r,this.pollId=a,this.optionId=o,this.token=u,this.limit=h,qr.set(this,!1),Kr.set(this,!0)}return f(e,[{key:"isLoading",get:function(){return!!qr.get(this)}},{key:"hasNext",get:function(){return!!Kr.get(this)}},{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"string"==typeof t.channelUrl&&"number"==typeof t.pollId&&"number"==typeof t.optionId&&"number"==typeof t.limit&&t.limit>0&&t.limit<=100?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(qr.set(t,!0),I.get(t._iid).container.apiClient.getPollOptionVoterList(u({},t),(function(n,r){if(n)qr.set(t,!1),e(n,null);else{var i=j.get(t._iid).User,a=r.hasOwnProperty("voters")&&Array.isArray(r.voters)?r.voters.map((function(e){return new i(e)})):[],s=r.hasOwnProperty("next")&&r.next?String(r.next):"";t.token=s,qr.set(t,!1),Kr.set(t,!!s),e(null,a)}}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),Qr=function(){function e(){d(this,e),this.isDistinct=null,this.isSuper=null,this.isBroadcast=null,this.isPublic=null,this.channelUrl=null,this.isEphemeral=null,this.isDiscoverable=null,this.isStrict=null,this.name=null,this.data=null,this.customType=null,this.channelCover=null,this.coverUrl=null,this.coverImage=null,this.accessCode=null,this.messageSurvivalSeconds=null,this._invitedUserIds=[];var t=null;Object.defineProperty(this,"operators",{set:function(e){Array.isArray(e)&&e.filter((function(e){return e.hasOwnProperty("userId")})).length===e.length&&(t=e.map((function(e){return e.userId})))}}),Object.defineProperty(this,"operatorUserIds",{get:function(){return t},set:function(e){Array.isArray(e)&&e.filter((function(e){return"string"==typeof e})).length===e.length&&(t=e)}})}return f(e,[{key:"_validate",value:function(){return Array.isArray(this._invitedUserIds)&&this._invitedUserIds.every((function(e){return"string"==typeof e}))&&("string"==typeof this.channelUrl||null===this.channelUrl)&&("string"==typeof this.coverUrl||null===this.coverUrl)&&(ae.isFile(this.coverImage)||null===this.coverImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("boolean"==typeof this.isDistinct||null===this.isDistinct)&&("boolean"==typeof this.isSuper||null===this.isSuper)&&("boolean"==typeof this.isBroadcast||null===this.isBroadcast)&&("boolean"==typeof this.isPublic||null===this.isPublic)&&("boolean"==typeof this.isEphemeral||null===this.isEphemeral)&&("boolean"==typeof this.isDiscoverable||null===this.isDiscoverable)&&("boolean"==typeof this.isStrict||null===this.isStrict)&&(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.accessCode||null===this.accessCode)&&("number"==typeof this.messageSurvivalSeconds||null===this.messageSurvivalSeconds)}},{key:"addUsers",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return e.hasOwnProperty("userId")&&"string"==typeof e.userId})).map((function(e){return e.userId}));(t=this._invitedUserIds).push.apply(t,N(n))}}},{key:"addUser",value:function(e){e.hasOwnProperty("userId")&&"string"==typeof e.userId&&this._invitedUserIds.push(e.userId)}},{key:"addUserIds",value:function(e){if(Array.isArray(e)){var t,n=e.filter((function(e){return"string"==typeof e}));(t=this._invitedUserIds).push.apply(t,N(n))}}},{key:"addUserId",value:function(e){"string"==typeof e&&this._invitedUserIds.push(e)}}]),e}(),$r=function(){function e(){d(this,e),this.channelUrl=null,this.name=null,this.coverUrlOrImage=null,this.data=null,this.customType=null,this._operatorUserIds=[]}return f(e,[{key:"operatorUserIds",get:function(){return this._operatorUserIds},set:function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this._operatorUserIds=e)}},{key:"operators",set:function(e){Array.isArray(e)&&e.every((function(e){return e.hasOwnProperty("userId")}))&&(this._operatorUserIds=e.map((function(e){return e.userId})))}},{key:"_validate",value:function(){return(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every((function(e){return"string"==typeof e}))||null===this.operatorUserIds)&&("string"==typeof this.coverUrlOrImage||ae.isFile(this.coverUrlOrImage)||null===this.coverUrlOrImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("string"==typeof this.channelUrl&&/^\w+$/.test(this.channelUrl)||null===this.channelUrl)}}]),e}(),Jr=function(e){y(n,e);var t=E(n);function n(e){var r;return d(this,n),(r=t.call(this)).year=null,r.month=null,r.day=null,r.hour=null,r.min=null,r.timezone=null,r._scheduledDateTimeString=null,e&&r._update(e),r}return f(n,[{key:"scheduledDateTimeString",get:function(){return this._scheduledDateTimeString?this._scheduledDateTimeString:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2):null},set:function(e){e&&"string"==typeof e&&(this._scheduledDateTimeString=e)}},{key:"_update",value:function(e){e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("year")&&(this.year=e.year),e.hasOwnProperty("month")&&(this.month=e.month),e.hasOwnProperty("day")&&(this.day=e.day),e.hasOwnProperty("hour")&&(this.hour=e.hour),e.hasOwnProperty("min")&&(this.min=e.min),e.hasOwnProperty("timezone")&&(this.timezone=e.timezone)}},{key:"_getScheduleString",value:function(){return this.scheduledDateTimeString?this.scheduledDateTimeString+" "+this.timezone:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&this.month>=1&&this.month<=12&&"number"==typeof this.day&&this.day>=1&&this.day<=31&&"number"==typeof this.hour&&this.hour>=0&&this.hour<=24&&"number"==typeof this.min&&this.min>=0&&this.min<=60&&"string"==typeof this.timezone&&this.timezone.length>0?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2)+" "+this.timezone:null}},{key:"setSchedule",value:function(e,t,n,r,i,a){"number"==typeof e&&4===e.toString().length&&"number"==typeof t&&t>=1&&t<=12&&"number"==typeof n&&n>=1&&n<=31&&"number"==typeof r&&r>=0&&r<=24&&"number"==typeof i&&i>=0&&i<=60&&"string"==typeof a&&a.length>0&&(this.scheduledDateTimeString=e.toString()+"-"+("0"+t.toString()).substr(-2)+"-"+("0"+n.toString()).substr(-2)+" "+("0"+r.toString()).substr(-2)+":"+("0"+i.toString()).substr(-2),this.timezone=a)}}]),n}(gr),Xr=function e(){d(this,e),this.channelCustomTypesFilter=[],this.superChannelFilter=er.SuperChannelFilter.ALL},Zr=function(){function e(){d(this,e),this.channelUrl=null,this.channelType=null,this.messageId=0,this.includeMetaArray=!1,this.includeReactions=!1,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.includeParentMessageInfo=null,this.includePollDetails=!1}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid).BaseChannel;return"string"==typeof this.channelUrl&&"string"==typeof this.channelType&&[e.CHANNEL_TYPE_BASE,e.CHANNEL_TYPE_OPEN,e.CHANNEL_TYPE_GROUP].includes(this.channelType)&&"number"==typeof this.messageId&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),ei=function(){function e(){d(this,e);var t=j.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.showSubchannelMessagesOnly=!1,this.includePollDetails=!1}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid),t=e.BaseChannel,n=e.BaseMessage;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(t.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(n.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.showSubchannelMessagesOnly&&"boolean"==typeof this.includePollDetails}},{key:"belongsTo",value:function(e){var t=j.get(this._iid),n=t.BaseChannel,r=t.UserMessageParams,i=t.FileMessageParams,a=t.BaseMessage;if(this.messageType!==n.MessageTypeFilter.ALL){if(e instanceof r&&this.messageType!==n.MessageTypeFilter.USER)return!1;if(e instanceof i&&this.messageType!==n.MessageTypeFilter.FILE)return!1}if(Array.isArray(this.customTypes)&&this.customTypes.length>0&&!this.customTypes.includes(e.customType))return!1;if("string"==typeof this.customType&&this.customType!==e.customType)return!1;if(Array.isArray(this.senderUserIds)&&this.senderUserIds.length>0){var s=Ri.getInstance(e._iid);if(!s||!s.currentUser||!this.senderUserIds.includes(s.currentUser.userId))return!1}if("string"==typeof this.replyType&&e.parentMessageId){if(this.replyType===a.ReplyType.NONE)return!1;if(this.replyType===a.ReplyType.ONLY_REPLY_TO_CHANNEL&&!e.isReplyToChannel)return!1}else if(!1===this.includeReplies&&e.parentMessageId)return!1;return!0}}]),e}(),ti=function(){function e(){d(this,e);var t=j.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=t.MessageTypeFilter.ALL,this.customType=null,this.customTypes=[],this.senderUserIds=null,this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeParentMessageText=null,this.includeParentMessageInfo=null,this.includePollDetails=!1}return f(e,[{key:"_validate",value:function(){var e=j.get(this._iid).BaseChannel;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(e.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e||null===e}))&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every((function(e){return"string"==typeof e}))||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),ni=function(){function e(){d(this,e),this.includeMetaArray=!1,this.includeReaction=null,this.includeReactions=null,this.includeReplies=null,this.includeParentMessageText=null,this.includeThreadInfo=!1,this.replyType=null,this.includeParentMessageInfo=null,this.includePollDetails=!1}return f(e,[{key:"_validate",value:function(){return"boolean"==typeof this.includeMetaArray&&(null===this.includeReaction||"boolean"==typeof this.includeReaction)&&(null===this.includeReactions||"boolean"==typeof this.includeReactions)&&"boolean"==typeof this.includeThreadInfo&&(null===this.includeReplies||"boolean"==typeof this.includeReplies)&&(null===this.replyType||"string"==typeof this.replyType&&Object.values(BaseMessage.ReplyType).includes(this.replyType))&&(null===this.includeParentMessageText||"boolean"==typeof this.includeParentMessageText)&&(null===this.includeParentMessageInfo||"boolean"==typeof this.includeParentMessageInfo)&&"boolean"==typeof this.includePollDetails}}]),e}(),ri=function(){function e(){d(this,e),this.customTypes=[],this.includeEmpty=!1,this.includeFrozen=!0}return f(e,[{key:"_validate",value:function(){return(Array.isArray(this.customTypes)&&this.customTypes.every((function(e){return"string"==typeof e}))||null===this.customTypes)&&("boolean"==typeof this.includeEmpty||null===this.includeEmpty)&&"boolean"==typeof this.includeFrozen}}]),e}(),ii=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.title,r=void 0===n?null:n,i=t.options,a=void 0===i?null:i,s=t.data,o=void 0===s?null:s,l=t.isAnonymous,u=void 0===l?null:l,c=t.allowUserSuggestion,h=void 0===c?null:c,f=t.allowMultipleVotes,p=void 0===f?null:f,y=t.closeAt,g=void 0===y?null:y;d(this,e),this.title=r,this.options=a,this.data=o,this.isAnonymous=u,this.allowUserSuggestion=h,this.allowMultipleVotes=p,this.closeAt=g}return f(e,[{key:"_validate",value:function(){return"string"==typeof this.title&&(Array.isArray(this.options)&&this.options.length>0&&this.options.every((function(e){return"string"==typeof e}))||null===this.options)&&("string"==typeof this.data||null==this.data)&&("boolean"==typeof this.isAnonymous||null===this.isAnonymous)&&("boolean"==typeof this.allowUserSuggestion||null===this.allowUserSuggestion)&&("boolean"==typeof this.allowMultipleVotes||null===this.allowMultipleVotes)&&("number"==typeof this.closeAt||null===this.closeAt)}}]),e}(),ai=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.channelUrl,r=void 0===n?null:n,i=t.pollId,a=void 0===i?null:i,s=t.showPartialVoters,o=void 0!==s&&s;d(this,e),this.channelUrl=r,this.pollId=a,this.showPartialVoters=o}return f(e,[{key:"_validate",value:function(){return"string"==typeof this.channelUrl&&"number"==typeof this.pollId&&"boolean"==typeof this.showPartialVoters}}]),e}(),si=function(){this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}},oi=function(){this.onFriendsDiscovered=function(){},this.onTotalUnreadMessageCountUpdated=function(){}},li=function e(){d(this,e),this.onMessageReceived=function(e,t){},this.onMessageUpdated=function(e,t){},this.onMessageDeleted=function(e,t){},this.onReadReceiptUpdated=function(e){},this.onReactionUpdated=function(e,t){},this.onDeliveryReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,t){},this.onUserLeft=function(e,t){},this.onOperatorUpdated=function(e,t){},this.onUserEntered=function(e,t){},this.onUserExited=function(e,t){},this.onUserMuted=function(e,t){},this.onUserUnmuted=function(e,t){},this.onUserBanned=function(e,t){},this.onUserUnbanned=function(e,t){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e,t){},this.onUserReceivedInvitation=function(e,t,n){},this.onUserDeclinedInvitation=function(e,t,n){},this.onMetaDataCreated=function(e,t){},this.onMetaDataUpdated=function(e,t){},this.onMetaDataDeleted=function(e,t){},this.onMetaCountersCreated=function(e,t){},this.onMetaCountersUpdated=function(e,t){},this.onMetaCountersDeleted=function(e,t){},this.onChannelHidden=function(e){},this.onMentionReceived=function(e,t){},this.onThreadInfoUpdated=function(e,t){},this.onChannelMemberCountChanged=function(e){},this.onChannelParticipantCountChanged=function(e){},this.onPollUpdated=function(e){},this.onPollVoted=function(e){}},ui=function e(t){if(d(this,e),t){var n=j.get(this._iid),r=n.User,i=n.BaseChannel;this.reader=new r(t.user),this.timestamp=parseInt(t.ts),this.channelUrl=t.hasOwnProperty("channel_url")?String(t.channel_url):"",this.channelType=t.hasOwnProperty("channel_type")?String(t.channel_type):i.CHANNEL_TYPE_GROUP}},ci=function(){function e(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=0),this.key=e,this.userIds=t,this.updatedAt=n;for(var r={},i=0,a=this.userIds;i<a.length;i++)r[a[i]]=this.updatedAt;this._version=r}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.createFromJson=function(e){var t=e.key,n=e.user_ids,r=e.updated_at;return"string"==typeof t&&t&&Array.isArray(n)&&n.length>0&&"number"==typeof r?new this(t,n,r):null},e.prototype.serialize=function(){return{key:this.key,user_ids:this.userIds,updated_at:this.updatedAt}},e.prototype._applyEvent=function(e){if(e.key===this.key&&(!this._version[e.userId]||this._version[e.userId]<e.updatedAt)){var t=this.userIds.indexOf(e.userId);switch(e.operation){case"add":t<0&&this.userIds.push(e.userId);break;case"delete":t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}},e}(),di=function(){function e(e){this.replyCount=0,this.mostRepliedUsers=[],this.lastRepliedAt=0,this.updatedAt=0,e&&this._update(e)}return e.objectify=function(e){var t=j.get(this._iid).User,n=e.replyCount,r=void 0===n?0:n,i=e.mostRepliedUsers,a=void 0===i?[]:i,s=e.lastRepliedAt,o=void 0===s?0:s,l=e.updatedAt,u=void 0===l?0:l,c={};return c.reply_count=r,Array.isArray(a)&&a.every((function(e){return e instanceof t}))&&(c.most_replies=a.map((function(e){return t.objectify(e)}))),c.last_replied_at=o,c.updated_at=u,c},e.build=function(e,t,n,r){return this.objectify({replyCount:e,mostRepliedUsers:t,lastRepliedAt:n,updatedAt:r})},e.prototype._update=function(e){var t=j.get(this._iid).User;e.hasOwnProperty("reply_count")&&(this.replyCount=parseInt(e.reply_count)),e.hasOwnProperty("most_replies")&&Array.isArray(e.most_replies)&&e.most_replies.every((function(e){return"object"==typeof e}))&&(this.mostRepliedUsers=e.most_replies.map((function(e){return new t(e)}))),e.hasOwnProperty("last_replied_at")&&(this.lastRepliedAt=parseInt(e.last_replied_at)),e.hasOwnProperty("updated_at")&&(this.updatedAt=parseInt(e.updated_at))},e}(),hi=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e&&this._update(e)}return e.objectify=function(e){var t=j.get(this._iid).OGImage,n=e.title,r=void 0===n?null:n,i=e.url,a=void 0===i?null:i,s=e.description,o=void 0===s?null:s,l=e.defaultImage,u=void 0===l?null:l,c={};return c["og:title"]=r,c["og:url"]=a,c["og:description"]=o,u&&(c["og:image"]=t.objectify(u)),c},e.prototype._update=function(e){var t=j.get(this._iid).OGImage;e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new t(e["og:image"]))},e}(),fi=function(){function e(e){this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,e&&this._update(e)}return e.objectify=function(e){var t=e.url,n=void 0===t?null:t,r=e.secureUrl,i=void 0===r?null:r,a=e.type,s=void 0===a?null:a,o=e.width,l=void 0===o?0:o,u=e.height,c=void 0===u?0:u,d=e.alt,h=void 0===d?null:d,f={};return f.url=n,f.secure_url=i,f.type=s,f.width=l,f.height=c,f.alt=h,f},e.prototype._update=function(e){e.hasOwnProperty("url")&&(this.url=e.url),e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=parseInt(e.width)),e.hasOwnProperty("height")&&(this.height=parseInt(e.height)),e.hasOwnProperty("alt")&&(this.alt=e.alt)},e}(),pi=function(){function e(e){this.type=null,this.vendor=null,this.detail={},e&&this._update(e)}return e.objectify=function(e){var t=e.type,n=void 0===t?"":t,r=e.vendor,i=void 0===r?"":r,a=e.detail,s=void 0===a?{}:a,o={};return o.type=n,o.vendor=i,o.detail=s,o},e.prototype._update=function(e){this.type=e.hasOwnProperty("type")?e.type:"",this.vendor=e.hasOwnProperty("vendor")?e.vendor:"",e.hasOwnProperty("detail")&&"object"==typeof e.detail&&!Array.isArray(e.detail)&&(this.detail=e.detail)},e}(),yi=function(){function e(t){d(this,e),this.id=0,this.title="",this.details=null,this._update(t)}return f(e,[{key:"update",value:function(e,t){var n=this,r=j.get(this._iid).PollParams,i=null,a=ge.parse(arguments,[new ge({type:r,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),s=S(a,3);return i=s[0],e=s[1],t=s[2],le(this._iid,(function(t){if(i)t(i,null);else{var r={text:e.data};I.get(n._iid).container.apiClient.updatePoll(u(u({pollId:n.id},e),{},{data:r}),(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Poll)(r);t(null,i)}}))}}),t)}},{key:"delete",value:function(e){var t=this,n=null,r=S(ge.parse(arguments,[new ge({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):I.get(t._iid).container.apiClient.deletePoll({pollId:t.id},(function(t,n){e(t||null,null)}))}),e)}},{key:"addOption",value:function(e,t,n){var r=this,i=null,a=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"string"}),new ge({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.addPollOption({channelUrl:e,pollId:r.id,text:t},(function(e,t){if(e)n(e,null);else{var i=new(0,j.get(r._iid).Poll)(t);n(null,i)}}))}),n)}},{key:"vote",value:function(e,t,n){var r=this,i=null,a=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"array",constraint:function(e){return e.every((function(e){return"number"==typeof e}))}}),new ge({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.votePoll({channelUrl:e,pollId:r.id,optionIds:t},(function(e,t){if(e)n(e,null);else{var i=new(0,j.get(r._iid).Poll)(t);n(null,i)}}))}),n)}},{key:"close",value:function(e){var t=this,n=null,r=S(ge.parse(arguments,[new ge({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):I.get(t._iid).container.apiClient.closePoll({pollId:t.id},(function(n,r){if(n)e(n,null);else{var i=new(0,j.get(t._iid).Poll)(r);e(null,i)}}))}),e)}},{key:"_update",value:function(e){var t=j.get(this._iid).PollDetails;this.id=parseInt(e.id),this.title=e.title,e.hasOwnProperty("options")&&e.hasOwnProperty("is_anonymous")&&e.hasOwnProperty("allow_user_suggestion")&&e.hasOwnProperty("allow_multiple_votes")&&e.hasOwnProperty("close_at")&&e.hasOwnProperty("voter_count")&&e.hasOwnProperty("status")&&e.hasOwnProperty("created_by")&&e.hasOwnProperty("created_at")&&e.hasOwnProperty("updated_at")&&(this.details=new t(e))}}],[{key:"Status",get:function(){return{OPEN:"open",CLOSED:"closed",REMOVED:"removed"}}},{key:"objectify",value:function(e){var t=j.get(this._iid).PollDetails,n=e.id,r=void 0===n?0:n,i=e.title,a=void 0===i?"":i,s=e.details,o=void 0===s?null:s,l=u({},o?t.objectify(o):{});return l.id=r,l.title=a,l}},{key:"get",value:function(e,t){var n=this,r=j.get(this._iid).PollRetrievalParams,i=null,a=ge.parse(arguments,[new ge({type:r,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),s=S(a,3);return i=s[0],e=s[1],t=s[2],le(this._iid,(function(t){i?t(i,null):I.get(n._iid).container.apiClient.getPoll(u({},e),(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Poll)(r);t(null,i)}}))}),t)}},{key:"create",value:function(e,t){var n=this,r=j.get(this._iid).PollParams,i=null,a=ge.parse(arguments,[new ge({type:r,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),s=S(a,3);return i=s[0],e=s[1],t=s[2],le(this._iid,(function(t){if(i)t(i,null);else{var r={text:e.data};I.get(n._iid).container.apiClient.createPoll(u(u({},e),{},{data:r}),(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Poll)(r);t(null,i)}}))}}),t)}}]),e}(),gi=function(){function e(t){d(this,e),this.options=[],this.data=null,this.isAnonymous=!1,this.allowUserSuggestion=!1,this.allowMultipleVotes=!1,this.closeAt=-1,this.voterCount=0,this.votedOptionIds=[],this.status="",this.createdBy=null,this.createdAt=0,this.updatedAt=0,this._update(t)}return f(e,[{key:"_update",value:function(e){var t=j.get(this._iid).PollOption;e.hasOwnProperty("options")&&Array.isArray(e.options)&&(this.options=e.options.map((function(e){return new t(e)})));try{this.data=JSON.parse(e.data)}catch(t){this.data=e.data}this.isAnonymous=!!e.hasOwnProperty("is_anonymous")&&e.is_anonymous,this.allowUserSuggestion=!!e.hasOwnProperty("allow_user_suggestion")&&e.allow_user_suggestion,this.allowMultipleVotes=!!e.hasOwnProperty("allow_multiple_votes")&&e.allow_multiple_votes,this.closeAt=parseInt(e.close_at),this.voterCount=parseInt(e.voter_count),e.hasOwnProperty("voted_option_ids")&&Array.isArray(e.voted_option_ids)&&(this.votedOptionIds=e.voted_option_ids.map((function(e){return parseInt(e)}))),this.status=e.status,this.createdBy=e.created_by,this.createdAt=parseInt(e.created_at),this.updatedAt=parseInt(e.updated_at)}}],[{key:"objectify",value:function(e){var t=j.get(this._iid).PollOption,n=e.options,r=void 0===n?[]:n,i=e.data,a=void 0===i?null:i,s=e.isAnonymous,o=void 0!==s&&s,l=e.allowUserSuggestion,u=void 0!==l&&l,c=e.allowMultipleVotes,d=void 0!==c&&c,h=e.closeAt,f=void 0===h?-1:h,p=e.voterCount,y=void 0===p?0:p,g=e.votedOptionIds,_=void 0===g?[]:g,m=e.status,v=void 0===m?"":m,E=e.createdBy,b=void 0===E?"":E,C=e.createdAt,S=void 0===C?0:C,N=e.updatedAt,k=void 0===N?0:N,A={};return A.options=r.map((function(e){return t.objectify(e)})),A.data=JSON.stringify(a),A.is_anonymous=o,A.allow_user_suggestion=u,A.allow_multiple_votes=d,A.close_at=f,A.voter_count=y,A.voted_option_ids=_,A.status=v,A.created_by=b,A.created_at=S,A.updated_at=k,A}}]),e}(),_i=new WeakMap,mi=function(){function e(t){d(this,e),this.pollId=0,this.id=0,this.text="",this.voteCount=0,this.partialVoters=[],this.createdBy="",this.createdAt=0,this.updatedAt=0,_i.set(this,null),this._update(t)}return f(e,[{key:"lastVotedAt",get:function(){return _i.get(this)}},{key:"update",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.updatePollOption({pollId:n.pollId,optionId:n.id,text:e},(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Poll)(r);t(null,i)}}))}),t)}},{key:"delete",value:function(e){var t=this,n=null,r=S(ge.parse(arguments,[new ge({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):I.get(t._iid).container.apiClient.deletePollOption({pollId:t.pollId,optionId:t.id},(function(t,n){e(t||null,null)}))}),e)}},{key:"_applyEvent",value:function(e){return this.id===e.optionId&&this.lastVotedAt<e.votedAt&&(this.voteCount=e.voteCount,_i.set(this,e.votedAt),!0)}},{key:"_update",value:function(e){var t=j.get(this._iid).User;this.pollId=parseInt(e.poll_id),this.id=parseInt(e.id),this.text=e.text,this.voteCount=parseInt(e.vote_count),e.hasOwnProperty("partial_voter_list")&&Array.isArray(e.partial_voter_list)&&(this.partialVoters=e.partial_voter_list.map((function(e){return new t(e)}))),this.createdBy=e.created_by,this.createdAt=parseInt(e.created_at),this.updatedAt=parseInt(e.updated_at)}}],[{key:"VoteAction",get:function(){return{CAST:"cast",CANCEL:"cancel"}}},{key:"objectify",value:function(e){var t=j.get(this._iid).User,n=e.pollId,r=void 0===n?0:n,i=e.id,a=void 0===i?0:i,s=e.text,o=void 0===s?"":s,l=e.voteCount,u=void 0===l?0:l,c=e.partialVoters,d=void 0===c?[]:c,h=e.createdBy,f=void 0===h?"":h,p=e.createdAt,y=void 0===p?0:p,g=e.updatedAt,_=void 0===g?0:g,m={};return m.poll_id=r,m.id=a,m.text=o,m.vote_count=u,Array.isArray(d)&&(m.partial_voter_list=d.filter((function(e){return e instanceof t})).map((function(e){return t.objectify(e)}))),m.created_by=f,m.created_at=y,m.updated_at=_,m}},{key:"get",value:function(e,t,n,r){var i=this,a=null,s=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"number"}),new ge({type:"number"}),new ge({type:"callback"})]),5);return a=s[0],e=s[1],t=s[2],n=s[3],r=s[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.getPollOption({channelUrl:e,pollId:t,optionId:n},(function(e,t){if(e)r(e,null);else{var n=new(0,j.get(i._iid).PollOption)(t);r(null,n)}}))}),r)}}]),e}(),vi=function(){function e(t){d(this,e),this.restrictionType=null,this.description=null,this.endAt=-1,t&&this._update(t)}return f(e,[{key:"_update",value:function(e){e.hasOwnProperty("restriction_type")&&(this.restrictionType=e.restriction_type),e.hasOwnProperty("description")?this.description=e.description:e.hasOwnProperty("muted_description")&&(this.description=e.muted_description),e.hasOwnProperty("end_at")?this.endAt=parseInt(e.end_at):e.hasOwnProperty("muted_end_at")&&(this.endAt=parseInt(e.muted_end_at))}}],[{key:"objectify",value:function(e){var t=e.restrictionType,n=void 0===t?null:t,r=e.description,i=void 0===r?null:r,a=e.endAt,s=void 0===a?-1:a,o={};return o.restriction_type=n,o.description=i,o.end_at=s,o}}]),e}(),Ei=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];d(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIds=t,this.metaDataKey="",this.metaDataValues=[],this._token=""}return f(e,[{key:"next",value:function(e){var t=this;return le(this._iid,(function(e){"number"==typeof t.limit&&t.limit>0&&Array.isArray(t.userIds)&&"string"==typeof t.metaDataKey&&Array.isArray(t.metaDataValues)&&!!t.metaDataKey==t.metaDataValues.length>0?t.isLoading?e(new F("Query in progress.",F.QUERY_IN_PROGRESS),null):t.hasNext?(t.isLoading=!0,I.get(t._iid).container.apiClient.loadUserList(u(u({},t),{},{userIdsFilter:t.userIds,metaDataKeyFilter:t.metaDataKey,metaDataValuesFilter:t.metaDataValues,token:t._token}),(function(n,r){var i=null;if(!n){var a=j.get(t._iid).User,s=String(r.next);t._token=s,t.hasNext=!!s,i=r.users.map((function(e){return new a(e)}))}t.isLoading=!1,e(n,i)}))):e(null,[]):e(ge.error,null)}),e)}}]),e}(),bi=new WeakMap,Ci=function(){function e(t){d(this,e),this.isLoading=!1,bi.set(this,t)}return f(e,[{key:"prev",value:function(e,t,n,r){var i=arguments,a=this;return le(this._iid,(function(r){var s,o=j.get(a._iid).BaseChannel,l=S(ge.parse(i,[new ge({type:"number"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"function"})]),5);if(s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],s)r(s,null);else if(a.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{a.isLoading=!0;var u=bi.get(a);I.get(a._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:0,shouldReverse:n,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return o.buildMessage(e,u)}));a.isLoading=!1,r(null,t)})).catch((function(e){a.isLoading=!1,r(e,null)}))}}),r)}},{key:"next",value:function(e,t,n,r){var i=arguments,a=this;return le(this._iid,(function(r){var s,o=j.get(a._iid).BaseChannel,l=S(ge.parse(i,[new ge({type:"number"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"function"})]),5);if(s=l[0],e=l[1],t=l[2],n=l[3],r=l[4],s)r(s,null);else if(a.isLoading)r(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{a.isLoading=!0;var u=bi.get(a);I.get(a._iid).container.apiClient.getMessageList({channelUrl:u.url,channelType:u.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:0,nextResultSize:t,shouldReverse:n,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return o.buildMessage(e,u)}));a.isLoading=!1,r(null,t)})).catch((function(e){a.isLoading=!1,r(e,null)}))}}),r)}},{key:"load",value:function(e,t,n,r,i){var a=arguments,s=this;return le(this._iid,(function(i){var o,l=j.get(s._iid).BaseChannel,u=S(ge.parse(a,[new ge({type:"number"}),new ge({type:"number"}),new ge({type:"number"}),new ge({type:"boolean"}),new ge({type:"callback"})]),6);if(o=u[0],e=u[1],t=u[2],n=u[3],r=u[4],i=u[5],o)i(o,null);else if(s.isLoading)i(new F("Query in progress.",F.QUERY_IN_PROGRESS),null);else{s.isLoading=!0;var c=bi.get(s);I.get(s._iid).container.apiClient.getMessageList({channelUrl:c.url,channelType:c.channelType,token:e,tokenType:"timestamp",isInclusive:!1,prevResultSize:t,nextResultSize:n,shouldReverse:r,messageType:"",customType:""}).then((function(e){var t=e.messages.map((function(e){return l.buildMessage(e,c)}));s.isLoading=!1,i(null,t)})).catch((function(e){s.isLoading=!1,i(e,null)}))}}),i)}}]),e}(),Si=0,Ni=1,ki=2,Ai=function(){function e(t){var n=this;if(d(this,e),this.state=Si,this._value=null,this._reason=null,"function"!=typeof t)throw"Promise resolver ".concat(t," is not a function");t((function(e){n.state===Si&&(n.state=Ni,n._value=e)}),(function(e){n.state===Si&&(n.state=ki,n._reason=e)}))}return f(e,[{key:"length",get:function(){return 1}},{key:"then",value:function(t,n){var r=this,i=this;switch(this.state){case Si:setTimeout((function(){return r.then(t,n)}),100);break;case Ni:t&&"function"==typeof t&&(i=t(this._value));break;case ki:n&&"function"==typeof n&&(i=n(this._reason))}return i instanceof e?i:this}},{key:"catch",value:function(t){var n=this,r=this;switch(this.state){case Si:setTimeout((function(){return n.catch(t)}),100);break;case Ni:break;case ki:r=t(this._reason)}return r instanceof e?r:this}},{key:"finally",value:function(t){var n=this,r=this;switch(this.state){case Si:setTimeout((function(){return n.finally(t)}),100);break;case Ni:case ki:r=t()}return r instanceof e?r:this}}],[{key:"all",value:function(t){return new e((function(n,r){if(Array.isArray(t)||"string"==typeof t)if(t.length>0){for(var i=[],a=0;a<t.length;a++)t[a]instanceof e?i.push(t[a]):i.push(e.resolve(t[a]));var s=new Array(i.length).fill(null),o=i.length,l=function(e,t,i){t?r(t):(o--,s[e]=i,o<=0&&n(s))};i.forEach((function(e,t){e.then((function(e){l(t,null,e)})).catch((function(e){l(t,e,null)}))}))}else n([]);else r(new Error("Uncaught (in promise) TypeError: ".concat(c(t)," ").concat(t," is not iterable")))}))}},{key:"resolve",value:function(t){return new e((function(e){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}}]),e}(),wi=function(){"undefined"==typeof Promise&&("undefined"!=typeof window?window.Promise=Ai:"undefined"!=typeof n.g?n.g.Promise=Ai:"undefined"!=typeof self?self.Promise=Ai:"undefined"!=typeof globalThis&&(globalThis.Promise=Ai)),Object.values||(Object.values=function(e){return Object.keys(e).map((function(t){return e[t]}))}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{value:Math.pow(2,53)-1})},Ti=3e5,Oi=null,Ii={},Mi=!1,Ui=null,Ri=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),wi();var r=!1;if((n.newInstance||!Oi||Oi&&n.appId!==Oi.getApplicationId()&&Oi.getConnectionState()===Oi.ConnectionState.CLOSED)&&(r=!0,Oi=this),r){try{if(!n.hasOwnProperty("appId"))return J.warn("Must be set appId."),Oi=null,null}catch(e){return J.warn("Must be set appId."),Oi=null,null}var i=Yn.create();Object.defineProperty(this,"_iid",{get:function(){return i}}),Ii[i]=this,this.customApiHost=null,this.customWsHost=null,this.connecting=!1,this.reconnecting=!1,this.isReconnectingOnError=!1,this.connectionCallbacks=[],this.ConnectionManager=new _e(this),this.GCMPushToken="",this.APNSPushToken="",this.PUSH_TEMPLATE_DEFAULT="default",this.PUSH_TEMPLATE_ALTERNATIVE="alternative",this.currentUser=null,this.isSessionOpened=!1,this.globalTimer,this.loginTimer,this.reconnectTimer,this.loginHandler=null,this.onLoginTimerCancel,this.onReconnectTimerCancel,this.BaseChannel={MessageTypeFilter:Rt.MessageTypeFilter},this.GroupChannelFilter=qn,this.MessageFilter=Re,this.GroupChannelCollection={GroupChannelOrder:lt},this.MessageCollection={MessageCollectionInitPolicy:He},this.CollectionEventSource=he,this._currentUserId=null;var a={User:Ot,Member:tr,RestrictedUser:rr,GroupChannel:er,OpenChannel:cr,UserMessage:_r,FileMessage:vr,AdminMessage:Er,GroupChannelListQuery:Or,MemberListQuery:Ir,GroupChannelParams:Qr,OpenChannelParams:$r,BaseMessageParams:yr,UserMessageParams:gr,FileMessageParams:mr,ScheduledUserMessageParams:Jr,GroupChannelTotalUnreadMessageCountParams:Xr,MessageRetrievalParams:Zr,MessageListParams:ei,ThreadedMessageListParams:ti,MessageChangeLogsParams:ni,GroupChannelChangeLogsParams:ri,PollParams:ii,PollRetrievalParams:ai,MessageMetaArray:fr,UserEventHandler:oi,SessionHandler:me,ChannelHandler:li,ConnectionHandler:si,AppleCriticalAlertOptions:hr,Poll:yi,PollOption:mi},s={SessionManager:ve,BaseChannel:Rt,BaseMessage:Tt,UserListQuery:Ei,ApplicationUserListQuery:kr,BannedUserListQuery:Ar,BlockedUserListQuery:wr,FriendListQuery:Tr,MutedUserListQuery:Mr,OpenChannelListQuery:Ur,OperatorListQuery:Pr,ParticipantListQuery:Dr,MessageListQuery:Ci,PreviousMessageListQuery:jr,MessageSearchQuery:Fr,PublicGroupChannelListQuery:Vr,PollListQuery:Yr,PollVoterListQuery:Wr,ScheduledUserMessage:br,ThreadInfo:di,ThreadInfoUpdateEvent:Cr,OGMetaData:hi,OGImage:fi,Plugin:pi,Command:Ce,Sender:nr,ReadStatus:ui,Reaction:ci,ReactionEvent:St,Emoji:sr,EmojiCategory:ar,EmojiContainer:ir,PollDetails:gi,PollUpdateEvent:Sr,PollVoteEvent:Nr,RestrictionInfo:vi,FileMessageQueue:Gt},o=new j(this._iid,u(u({},a),s));this.BaseMessage={ReplyType:Tt.ReplyType,getMessage:o.BaseMessage.getMessage.bind(o.BaseMessage)},Object.keys(o).forEach((function(e){a[e]&&(t[e]=o[e])}));var l={encrypt:function(e){return e},decrypt:function(e){return e}};I.create(i,{appId:n.appId,pinger:new Z(this),apiClient:new ce(this),wsAdapter:new ye(this),commandHandler:new Dt(this),onlineDetector:new Ee(this),ackStateMap:{},subscribedUnreadMessageCount:{all:0,custom_types:{},ts:0},maxUnreadCountOfSuperGroupChannel:T.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,nestdb:null,currentUserId:null,localCacheEnabled:"boolean"==typeof n.localCacheEnabled&&n.localCacheEnabled,localCacheLock:new X,debugCache:!1,encryption:l,store:new Rn({encryption:l}),preference:null,auth:new H,appInfo:null,pingInterval:15e3,pongTimeout:5e3,connectedAt:0,extensions:{},supportedExtensionKeys:["sb_uikit","sb_syncmanager"],getUserAgentWithExtensions:function(e){var t=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",n=e.sb_uikit?"u".concat(e.sb_uikit):"";return"JS/c".concat(T.SDK_VERSION,"/").concat(t,"/").concat(n)},sessionManager:new o.SessionManager(this),stateChangeEnabled:!0,isInBackground:!1,closedByGoingBackground:!1,isErrorFirstInCallback:!1,autoResendQueue:[],isProcessingAutoResend:!1}),this.userEventHandlers={},this.channelHandlers={},this.connectionHandlers={},this.Options={_useMemberAsMessageSender:!0,get UseMemberAsMessageSender(){return this._useMemberAsMessageSender},set UseMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},get useMemberAsMessageSender(){return this._useMemberAsMessageSender},set useMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},_typingIndicatorThrottle:1e3,get typingIndicatorThrottle(){return this._typingIndicatorThrottle},set typingIndicatorThrottle(e){"number"==typeof e&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},_websocketResponseTimeout:1e4,get websocketResponseTimeout(){return this._websocketResponseTimeout},set websocketResponseTimeout(e){"number"==typeof e&&e>=5e3&&e<=Ti&&(this._websocketResponseTimeout=e)},includePollDetails:!1},pe.of(i).addObserver({onConnect:function(){t.isCacheEnabled&&!t.getIsProcessingAutoResend()&&(0===t.getAutoResendQueue().length?rt._processPendingMessages(t).then((function(){rt._processNextAutoResend(t)})):rt._processNextAutoResend(t))},onDisconnect:function(){}})}return Oi}return f(e,[{key:"ConnectionState",get:function(){return{CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSED:"CLOSED"}}},{key:"MessageRequestState",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",SUCCEEDED:"succeeded"}}},{key:"MessageSendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"pushTokenRegistrationState",get:function(){return{SUCCESS:"success",PENDING:"pending",ERROR:"error"}}},{key:"PushTriggerOption",get:function(){return{ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"appInfo",get:function(){return I.get(this._iid).container.appInfo}},{key:"isCacheEnabled",get:function(){return I.get(this._iid).container.localCacheEnabled}},{key:"ekey",get:function(){var e=I.get(this._iid).container.auth;return e?e.eKey:""}},{key:"getApplicationId",value:function(){return I.get(this._iid).get("appId")}},{key:"getCurrentUserId",value:function(){return this.currentUser?this.currentUser.userId:null}},{key:"getDebugMode",value:function(){return Mi}},{key:"setDebugMode",value:function(e){Mi=e,J.mode=e?J.Mode.DEBUG:J.Mode.PRODUCTION}},{key:"getErrorFirstCallback",value:function(){return I.get(this._iid).container.isErrorFirstInCallback}},{key:"setErrorFirstCallback",value:function(e){"boolean"==typeof e&&I.get(this._iid).set("isErrorFirstInCallback",e)}},{key:"getAutoResendQueue",value:function(){return I.get(this._iid).container.autoResendQueue}},{key:"getIsProcessingAutoResend",value:function(){return I.get(this._iid).container.isProcessingAutoResend}},{key:"setIsProcessingAutoResend",value:function(e){I.get(this._iid).set("isProcessingAutoResend",e)}},{key:"getCurrentApiHost",value:function(){return this.customApiHost?this.customApiHost:"https://api.sendbird.com"}},{key:"clearCurrentApiHost",value:function(){this.customApiHost=null}},{key:"getCurrentWsHost",value:function(){return this.customWsHost?this.customWsHost:"wss://ws.sendbird.com"}},{key:"clearCurrentWsHost",value:function(){this.customWsHost=null}},{key:"getConnectionState",value:function(){try{var e=I.get(this._iid).container.wsAdapter;return this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:e.client?this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:this.isSessionOpened?e.client.getConnectionState():this.ConnectionState.CLOSED:this.ConnectionState.CLOSED}catch(e){return this.ConnectionState.CLOSED}}},{key:"getPendingGCMToken",value:function(){return this.GCMPushToken}},{key:"getPendingAPNSToken",value:function(){return this.APNSPushToken}},{key:"hasLoggedIn",value:function(){var e=I.get(this._iid);return this.currentUser&&e.get("auth").hasSession()}},{key:"getLastConnectedAt",value:function(){var e=I.get(this._iid);return this.getConnectionState()===this.ConnectionState.OPEN&&this.currentUser?e.get("connectedAt"):0}},{key:"getMemoryStoreForDebugging",value:function(){var e=I.get(this._iid);return e.container.debugCache&&e.container.store instanceof wn?e.container.store:null}},{key:"useMemoryAsDatabaseForDebugging",value:function(){var e=I.get(this._iid);e.container.debugCache=!0,e.container.store=new wn}},{key:"useAsyncStorageAsDatabase",value:function(e){var t=I.get(this._iid);t.container.store=new Pn({AsyncStorage:e,encryption:t.container.encryption})}},{key:"initializeDatabase",value:function(e,t){var n=this,r=I.get(this._iid),i=r.container,a=i.appId,s=i.nestdb,o=i.store,l=i.localCacheEnabled;return le(this._iid,(function(t){if(l)if(s)t(null);else{var i=r.container.nestdb=new zn({name:"sendbird=".concat(a,"-").concat(e,".db"),version:1,store:o});i.on("upgrade",(function(e,t){0===e?i.commitSchema([{collectionName:"GroupChannel",keyName:"url",index:[Ie.NAME_ALPHABETICAL,Ie.CHRONOLOGICAL,Ie.LATEST_LAST_MESSAGE]},{collectionName:"SucceededMessage",keyName:"messageId",keyHash:function(e,t){return Math.floor(parseInt(e)/t)},index:[Me.LATEST,Me.CHILD_MESSAGE_FIRST]},{collectionName:"UnsentMessage",keyName:"reqId",index:[Me.LATEST_UNSENT,Me.CHILD_MESSAGE_FIRST]}]).then((function(){return t()})).catch((function(e){throw e})):t()})),i.on("error",(function(e){e?e.code===jt.STORE_NOT_AVAILABLE||e.code===jt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING?t(null):(J.error("Database initialize failed with an error: ",e),t(e)):t(null)})),i.on("success",(function(){r.container.currentUserId=e,new Ct({iid:n._iid,collection:i.collection("GroupChannel")}),new Ge({iid:n._iid,collections:{succeeded:i.collection("SucceededMessage"),unsent:i.collection("UnsentMessage")}}),J.debug("Database initialize succeeded."),t(null)})),i.open()}else r.container.currentUserId=e,new Ct({iid:n._iid,collection:null}),new Ge({iid:n._iid,collections:{succeeded:null,unsent:null}}),t(null)}),t)}},{key:"clearCachedData",value:function(){var e=I.get(this._iid),t=e.container,n=t.localCacheEnabled,r=t.nestdb;return new Promise((function(t,i){n&&r?(r.close(),r.reset().then((function(){J.debug("Database clear succeeded."),e.container.nestdb=null,t()})).catch((function(e){J.error("Database clear failed with an error: ",e),i(e)}))):t()}))}},{key:"connect",value:function(e,t,n,r,i){var a=this,s=I.get(this._iid),o=s.container,l=o.wsAdapter,u=o.onlineDetector,c=o.localCacheEnabled;s.remove("firstConnectedAt"),u&&u.start();var d=null,h=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||3===e.length}}),new ge({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ge({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new ge({type:"callback"})]),f=S(h,6);return d=f[0],e=f[1],t=f[2],n=f[3],r=f[4],i=f[5],(n||r)&&J.debug("Please note that apiHost and wsHost are for internal use only."),le(this._iid,(function(i){if(d)i(d,null);else if(a.customApiHost=n,a.customWsHost=r,a.connecting=!0,a.reconnecting=!1,a.isReconnectingOnError=!1,a.reconnectTimer&&(clearTimeout(a.reconnectTimer),a.reconnectTimer=null,a.onReconnectTimerCancel=null),a.getConnectionState()===a.ConnectionState.OPEN&&a.currentUser&&a.currentUser.userId===e)a.connecting=!1,i(null,a.currentUser);else if(c&&(a._currentUserId=e),a.connectionCallbacks.push(i),1===a.connectionCallbacks.length){l.disconnect({clearSession:!0,err:null},null);var o=s.container,u=o.nestdb,h=o.localCacheLock;u?l.connect(e,t):h.lock((function(n){a.initializeDatabase(e).then((function(){n(),l.connect(e,t)})).catch((function(e){s.container.localCacheEnabled=!1,n(),i(e,null)}))}))}}),i)}},{key:"reconnect",value:function(){var e=this,t=I.get(this._iid).container,n=t.wsAdapter,r=t.auth,i=t.localCacheLock;if(r.sessionKey&&this.currentUser){var a=!0;return n.reconnectCount>0&&(a=!1),i.lock((function(t){n.disconnect({clearSession:!1,err:new F("Connection has been canceled.",F.CONNECTION_CANCELED)},null),n.reconnectCount=0,n.reconnect(e.currentUser.userId,a),t()})),!0}return!1}},{key:"disconnect",value:function(e){var t=this;return le(this._iid,(function(e){var n=I.get(t._iid).container,r=n.localCacheLock,i=n.wsAdapter,a=n.onlineDetector;a&&a.stop(),r.lock((function(n){i.disconnect({clearSession:!0,err:new F("Connection has been canceled.",F.CONNECTION_CANCELED)},(function(){t.clearCachedData().finally((function(){n(),e(null)}))}))}))}),e)}},{key:"setBackgroundState",value:function(){var e=I.get(this._iid),t=e.container,n=t.wsAdapter,r=t.stateChangeEnabled;!t.isInBackground&&r&&(e.set("isInBackground",!0),this.getConnectionState()!==this.ConnectionState.CLOSED?(e.set("closedByGoingBackground",!0),n.disconnect({clearSession:!1,err:new F("Websocket connection failed.",F.WEBSOCKET_CONNECTION_FAILED)},null),pe.of(this._iid).invokeDisconnect()):e.set("closedByGoingBackground",!1))}},{key:"isInBackground",get:function(){return I.get(this._iid).container.isInBackground}},{key:"setForegroundState",value:function(){var e=I.get(this._iid),t=e.container,n=t.wsAdapter,r=t.stateChangeEnabled,i=t.isInBackground,a=t.closedByGoingBackground;i&&r&&(e.set("isInBackground",!1),a&&this.currentUser&&n.reconnect(this.currentUser.userId,!0))}},{key:"enableStateChange",value:function(){I.get(this._iid).set("enableStateChange",!0)}},{key:"disableStateChange",value:function(){I.get(this._iid).set("enableStateChange",!1)}},{key:"addExtension",value:function(e,t){var n=I.get(this._iid).container,r=n.extensions;n.supportedExtensionKeys.indexOf(e)>-1&&(r[e]=t)}},{key:"createUserListQuery",value:function(e){return new(0,j.get(this._iid).UserListQuery)(e)}},{key:"createApplicationUserListQuery",value:function(){return new(0,j.get(this._iid).ApplicationUserListQuery)}},{key:"createBlockedUserListQuery",value:function(){return new(0,j.get(this._iid).BlockedUserListQuery)}},{key:"createFriendListQuery",value:function(){return new(0,j.get(this._iid).FriendListQuery)}},{key:"createMessageSearchQuery",value:function(e,t){return new(0,j.get(this._iid).MessageSearchQuery)(e,t)}},{key:"sendCommand",value:function(e,t){var n=this;return le(this._iid,(function(t){n.ConnectionManager.ready((function(r,i){if(r)t(r,null);else{var a=I.get(n._iid).container,s=a.wsAdapter,o=a.ackStateMap;if(null==s||null==s.client||s.client.getConnectionState()!==n.ConnectionState.OPEN||n.getConnectionState()!==n.ConnectionState.OPEN)return void t(new F("Connection is not valid. Please reconnect.",F.WEBSOCKET_CONNECTION_CLOSED),null);if(e.isAckRequired){var l=e.requestId,u={handler:t,timer:setTimeout((function(){t(new F("Command received no ack.",F.ACK_TIMEOUT),null),delete o[l]}),n.Options.websocketResponseTimeout)};o[l]=u,s.client.send(e,(function(e){e&&(clearTimeout(u.timer),t(e,null))}))}else s.client.send(e,t)}}),!1)}),t).catch((function(e){J.error(e)}))}},{key:"setSessionHandler",value:function(e){I.get(this._iid).container.sessionManager.setHandler(e)}},{key:"addUserEventHandler",value:function(e,t){t instanceof j.get(this._iid).UserEventHandler&&(this.userEventHandlers[e]=t)}},{key:"removeUserEventHandler",value:function(e){delete this.userEventHandlers[e]}},{key:"removeAllUserEventHandler",value:function(){this.userEventHandlers={}}},{key:"addChannelHandler",value:function(e,t){t instanceof j.get(this._iid).ChannelHandler&&(this.channelHandlers[e]=t)}},{key:"removeChannelHandler",value:function(e){delete this.channelHandlers[e]}},{key:"removeAllChannelHandlers",value:function(){this.channelHandlers={}}},{key:"addConnectionHandler",value:function(e,t){t instanceof j.get(this._iid).ConnectionHandler&&(this.connectionHandlers[e]=t)}},{key:"removeConnectionHandler",value:function(e){delete this.connectionHandlers[e]}},{key:"removeAllConnectionHandlers",value:function(){this.connectionHandlers={}}},{key:"updateCurrentUserInfo",value:function(e,t,n){var r=this,i=null,a=S(ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:"string",nullable:!0}),new ge({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.updateCurrentUserInfo({nickname:e,profileUrl:t},(function(i,a){var s=null;i||(r.currentUser&&(e&&(r.currentUser.nickname=e),t&&(r.currentUser.plainProfileUrl=t)),s=r.currentUser),n(i,s)}))}),n)}},{key:"updateCurrentUserInfoWithProfileImage",value:function(e,t,n){var r=this,i=null,a=S(ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:"file",nullable:!0}),new ge({type:"callback"})]),4);return i=a[0],e=a[1],t=a[2],n=a[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.updateCurrentUserInfo({nickname:e,profileImage:t},(function(t,i){var a=null;t||(r.currentUser&&(e&&(r.currentUser.nickname=e),i.profile_url&&(r.currentUser.plainProfileUrl=i.profile_url)),a=r.currentUser),n(t,a)}))}),n)}},{key:"updateCurrentUserInfoWithPreferredLanguages",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.updateCurrentUserInfo({preferredLanguages:e},(function(r,i){var a=null;r||(n.currentUser&&e&&(n.currentUser._preferredLanguages=e),a=n.currentUser),t(r,a)}))}),t)}},{key:"registerGCMPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,n.pushTokenRegistrationState.ERROR):n.currentUser?I.get(n._iid).container.apiClient.registerGCMPushToken({token:e},(function(e,r){var i=n.pushTokenRegistrationState.ERROR;e||(n.GCMPushToken="",i=n.pushTokenRegistrationState.SUCCESS),t(e,i)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):n.currentUser?I.get(n._iid).container.apiClient.unregisterGCMPushToken({token:e},(function(e,n){t(e,null)})):(n.GCMPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterGCMPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.unregisterAllGCMPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"registerAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,n.pushTokenRegistrationState.ERROR):n.currentUser?I.get(n._iid).container.apiClient.registerAPNSPushToken({token:e},(function(e,r){var i=n.pushTokenRegistrationState.ERROR;e||(n.APNSPushToken="",i=n.pushTokenRegistrationState.SUCCESS),t(e,i)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenForCurrentUser",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e.length>0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):n.currentUser?I.get(n._iid).container.apiClient.unregisterAPNSPushToken({token:e},(function(e,n){t(e,null)})):(n.APNSPushToken=e,t(null,n.pushTokenRegistrationState.PENDING))}),t)}},{key:"unregisterAPNSPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.unregisterAllAPNSPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"unregisterPushTokenAllForCurrentUser",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.unregisterAllPushTokens({},(function(t,n){e(t,null)}))}),e)}},{key:"getMyGroupChannelChangeLogsByToken",value:function(e,t,n,r){var i=this,a=null,s=S(ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ge({type:"callback"})]),5);a=s[0],e=s[1],t=s[2],n=s[3],r=s[4];var o=j.get(this._iid).GroupChannelChangeLogsParams,l=null;if(a){var c=ge.parse(arguments,[new ge({type:"string",nullable:!0}),new ge({type:o,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),d=S(c,4);a=d[0],e=d[1],l=d[2],r=d[3]}else(l=new o).customTypes=t,l.includeEmpty=n,l.includeFrozen=!0;return le(this._iid,(function(t){a?t(a,null):I.get(i._iid).container.apiClient.getMyGroupChannelChangeLogs(u({ts:null,token:e},l)).then((function(e){var n=j.get(i._iid).GroupChannel,r=e.updated.map((function(e){return new n(e)})),a=e.deleted,s=e.has_more,o=e.next;t(null,{updatedChannels:r,deletedChannelUrls:a,hasMore:s,token:o})})).catch((function(e){t(e,null)}))}),r)}},{key:"getMyGroupChannelChangeLogsByTimestamp",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"number",constraint:function(e){return e>=0}}),new ge({type:"array",optional:!0,nullable:!0,defaultValue:null}),new ge({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new ge({type:"callback"})]),o=S(s,5);a=o[0],e=o[1],t=o[2],n=o[3],r=o[4];var l=j.get(this._iid).GroupChannelChangeLogsParams,c=null;if(a){var d=ge.parse(arguments,[new ge({type:"number",constraint:function(e){return e>=0}}),new ge({type:l,constraint:function(e){return e._validate()}}),new ge({type:"callback"})]),h=S(d,4);a=h[0],e=h[1],c=h[2],r=h[3]}else(c=new l).customTypes=t,c.includeEmpty=n,c.includeFrozen=!0;return le(this._iid,(function(t){a?t(a,null):I.get(i._iid).container.apiClient.getMyGroupChannelChangeLogs(u({ts:e,token:null},c)).then((function(e){var n=j.get(i._iid).GroupChannel,r=e.updated.map((function(e){return new n(e)})),a=e.deleted,s=e.has_more,o=e.next;t(null,{updatedChannels:r,deletedChannelUrls:a,hasMore:s,token:o})})).catch((function(e){t(e,null)}))}),r)}},{key:"getChannelInvitationPreference",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getChannelInvitationPreference({},(function(t,n){var r=null;t||(r={autoAccept:n.auto_accept}),e(t,r)}))}),e)}},{key:"setChannelInvitationPreference",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"boolean"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.setChannelInvitationPreference({isAutoAccept:e},(function(e,n){var r=null;e||(r={autoAccept:n.auto_accept}),t(e,r)}))}),t)}},{key:"getDoNotDisturb",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getDoNotDisturb({},(function(t,n){var r=null;t||(r={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone}),e(t,r)}))}),e)}},{key:"setDoNotDisturb",value:function(e,t,n,r,i,a,s){var o=this,l=null,u=ge.parse(arguments,[new ge({type:"boolean"}),new ge({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ge({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ge({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new ge({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new ge({type:"string"}),new ge({type:"callback"})]),c=S(u,8);return l=c[0],e=c[1],t=c[2],n=c[3],r=c[4],i=c[5],a=c[6],s=c[7],le(this._iid,(function(s){l?s(l,null):I.get(o._iid).container.apiClient.setDoNotDisturb({doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:a},(function(e,t){var n=null;e||(n={doNotDisturbOn:t.do_not_disturb,startHour:t.start_hour,startMin:t.start_min,endHour:t.end_hour,endMin:t.end_min,timezone:t.timezone}),s(e,n)}))}),s)}},{key:"getSnoozePeriod",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getSnoozePeriod({},(function(t,n){var r=null;t||(r={isSnoozeOn:n.snooze_enabled,startTs:n.snooze_start_ts,endTs:n.snooze_end_ts}),e(t,r)}))}),e)}},{key:"setSnoozePeriod",value:function(e,t,n,r){var i=this,a=null,s=ge.parse(arguments,[new ge({type:"boolean"}),new ge({type:"number",constraint:function(e){return e>0}}),new ge({type:"number",constraint:function(e){return e>0}}),new ge({type:"callback"})]),o=S(s,5);return a=o[0],e=o[1],t=o[2],n=o[3],r=o[4],le(this._iid,(function(r){a?r(a,null):I.get(i._iid).container.apiClient.setSnoozePeriod({snoozeOn:e,startTs:t,endTs:n},(function(e,t){var n=null;e||(n={isSnoozeOn:t.snooze_enabled,startTs:t.snooze_start_ts,endTs:t.snooze_end_ts}),r(e,n)}))}),r)}},{key:"blockUser",value:function(e,t){var n=null,r=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ge({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){e(n,null)}),t):this.blockUserWithUserId(e.userId,t)}},{key:"blockUserWithUserId",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.blockUser({blockedUserId:e},(function(e,n){var r=null;e||(r=new Ot(n)),t(e,r)}))}),t)}},{key:"unblockUser",value:function(e,t){var n=null,r=ge.parse(arguments,[new ge({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new ge({type:"callback"})]),i=S(r,3);return n=i[0],e=i[1],t=i[2],n?le(this._iid,(function(e){e(n,null)}),t):this.unblockUserWithUserId(e.userId,t)}},{key:"unblockUserWithUserId",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"string",constraint:function(e){return e&&(!n.currentUser||e!==n.currentUser.userId)}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.unblockUser({unblockedUserId:e},(function(e,n){t(e,null)}))}),t)}},{key:"getPushTriggerOption",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getPushTriggerOption({},(function(t,n){e(t,n?n.push_trigger_option:null)}))}),e)}},{key:"setPushTriggerOption",value:function(e,t){var n=this;return le(this._iid,(function(t){Object.keys(n.PushTriggerOption).map((function(e){return n.PushTriggerOption[e]})).indexOf(e)>-1?I.get(n._iid).container.apiClient.setPushTriggerOption({pushTriggerOption:e},(function(e,n){t(e,n?n.push_trigger_option:null)})):t(ge.error,null)}),t)}},{key:"getGroupChannelCount",value:function(e,t){var n=this,r=j.get(this._iid).GroupChannel,i=null,a=S(ge.parse(arguments,[new ge({type:r.MemberStateFilter,optional:!0,defaultValue:r.MemberStateFilter.ALL}),new ge({type:"callback"})]),3);return i=a[0],e=a[1],t=a[2],le(this._iid,(function(t){i?t(i,null):I.get(n._iid).container.apiClient.getGroupChannelCount({memberStateFilter:e},(function(e,n){var r=null;e||(r=parseInt(n.group_channel_count)),t(e,r)}))}),t)}},{key:"getTotalUnreadChannelCount",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getTotalUnreadChannelCount({},(function(t,n){var r=null;t||(r=parseInt(n.unread_count)),e(t,r)}))}),e)}},{key:"getTotalUnreadMessageCount",value:function(e,t){var n=this,r=j.get(this._iid),i=r.GroupChannel,a=r.GroupChannelTotalUnreadMessageCountParams,s=null,o=ge.parse(arguments,[new ge({type:"object",optional:!0,defaultValue:null,constraint:function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))||e instanceof a}}),new ge({type:"callback"})]),l=S(o,3);return s=l[0],e=l[1],t=l[2],le(this._iid,(function(t){if(s)t(s,null);else{var r=i.SuperChannelFilter.ALL;if(e instanceof a){var o=e;e=o.channelCustomTypesFilter,r=o.superChannelFilter}I.get(n._iid).container.apiClient.getTotalUnreadMessageCount({customTypesFilter:e,superChannelFilter:r},(function(e,n){var r=null;e||(r=parseInt(n.unread_count)),t(e,r)}))}}),t)}},{key:"getUnreadItemCount",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.length>0&&e.every((function(e){return Object.keys(er.UnreadItemKey).map((function(e){return er.UnreadItemKey[e]})).indexOf(e)>-1}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){if(r)t(r,null);else{var i=e.filter((function(t,n){return e.indexOf(t)===n}));I.get(n._iid).container.apiClient.getUnreadItemCount({keys:i},(function(e,n){t(e,n)}))}}),t)}},{key:"getSubscribedTotalUnreadMessageCount",value:function(){var e=I.get(this._iid).container.subscribedUnreadMessageCount;return e.all>=0?e.all:0}},{key:"getSubscribedCustomTypeTotalUnreadMessageCount",value:function(){var e=I.get(this._iid).container.subscribedUnreadMessageCount;if(Object.keys(e.custom_types).length>0){var t=0;return Object.keys(e.custom_types).forEach((function(n){t+=e.custom_types[n]})),t}return 0}},{key:"getSubscribedCustomTypeUnreadMessageCount",value:function(e){if(e&&"string"==typeof e){var t=I.get(this._iid).container.subscribedUnreadMessageCount;return t.custom_types.hasOwnProperty(e)?t.custom_types[e]:0}return 0}},{key:"getMyPushTokensByToken",value:function(e,t,n){var r=this,i=null,a=ge.parse(arguments,[new ge({type:"string"}),new ge({type:"string",constraint:function(e){return["gcm","apns","apns_voip"].indexOf(e)>-1}}),new ge({type:"callback"})]),s=S(a,4);return i=s[0],e=s[1],t=s[2],n=s[3],le(this._iid,(function(n){i?n(i,null):I.get(r._iid).container.apiClient.getPushTokens({ts:null,token:e,type:t},(function(e,t){if(e)n(e,null);else{var r=t.type;n(null,{deviceTokens:t.device_tokens,type:r?r.toLowerCase():"unknown",hasMore:t.has_more,token:t.token})}}))}),n)}},{key:"getPushTemplate",value:function(e){var t=this;return le(this._iid,(function(e){I.get(t._iid).container.apiClient.getPushTemplate({},(function(t,n){var r=null;t||(r=n.name.toString()),e(t,r)}))}),e)}},{key:"setPushTemplate",value:function(e,t){var n=this;return le(this._iid,(function(t){[n.PUSH_TEMPLATE_DEFAULT,n.PUSH_TEMPLATE_ALTERNATIVE].indexOf(e)>-1?I.get(n._iid).container.apiClient.setPushTemplate({templateName:e},(function(e,n){var r=null;e||(r=n.name.toString()),t(e,r)})):t(ge.error,null)}),t)}},{key:"markAsReadAll",value:function(e){var t=this;return le(this._iid,(function(e){var n=j.get(t._iid).GroupChannel,r=(new Date).getTime();r-n.markAsReadAllLastSentAt<1e3?e(new F("MarkAsRead rate limit exceeded.",F.MARK_AS_READ_RATE_LIMIT_EXCEEDED),null):(n.markAsReadAllLastSentAt=r,I.get(t._iid).container.apiClient.markAsReadAll({channelUrls:null},(function(i,a){i||Object.keys(n.cachedChannels).forEach((function(e){t.currentUser&&n.cachedChannels[e].updateReadReceipt(t.currentUser.userId,r),n.cachedChannels[e]._setGroupChannelUnreadCount(0,0)})),e(i,null)})))}),e)}},{key:"markAsReadWithChannelUrls",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){if(r)t(r,null);else{var i=(new Date).getTime();I.get(n._iid).container.apiClient.markAsReadAll({channelUrls:e},(function(r,a){r||e.forEach((function(e){er.cachedChannels[e]&&(n.currentUser&&er.cachedChannels[e].updateReadReceipt(n.currentUser.userId,i),er.cachedChannels[e]._setGroupChannelUnreadCount(0,0))})),t(r,null)}))}}),t)}},{key:"markAsDelivered",value:function(e){"string"==typeof e&&j.get(this._iid).GroupChannel.getChannel(e,T.INTERNAL_CALL,(function(e,t){e||t.markAsDelivered()}))}},{key:"getFriendChangeLogsByToken",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string",optional:!0,defaultValue:null}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getFriendChangeLogsByToken({token:e},(function(e,r){var i=null;if(!e){var a=j.get(n._iid).User;i={updatedUsers:r.updated.map((function(e){return new a(e)})),deletedUserIds:r.deleted,hasMore:r.has_more,token:r.next}}t(e,i)}))}),t)}},{key:"uploadFriendDiscoveries",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return e.hasOwnProperty("friendDiscoveryKey")}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.uploadFriendDiscoveries({discoveries:e},(function(e,n){t(e,n)}))}),t)}},{key:"deleteFriendDiscovery",value:function(e,t){var n=null,r=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return n=r[0],e=r[1],t=r[2],n?le(this._iid,(function(e){e(n,null)}),t):this.deleteFriendDiscoveries([e],t)}},{key:"deleteFriendDiscoveries",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.deleteFriendDiscoveries({discoveryKeys:e},(function(e,n){t(e,n)}))}),t)}},{key:"addFriends",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.addFriends({userIds:e},(function(e,r){var i=null;if(!e){var a=j.get(n._iid).User;i=r.users.map((function(e){return new a(e)}))}t(e,i)}))}),t)}},{key:"deleteFriend",value:function(e,t){var n=null,r=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return n=r[0],e=r[1],t=r[2],n?le(this._iid,(function(e){e(n,null)}),t):this.deleteFriends([e],t)}},{key:"deleteFriends",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"array",constraint:function(e){return e.every((function(e){return"string"==typeof e}))}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.deleteFriends({userIds:e},(function(e,n){t(e,n)}))}),t)}},{key:"getAllEmoji",value:function(e){var t=this,n=null,r=S(ge.parse(arguments,[new ge({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):I.get(t._iid).container.apiClient.getAllEmoji((function(n,r){if(n)e(n,null);else{var i=new(0,j.get(t._iid).EmojiContainer)(r);e(null,i)}}))}),e)}},{key:"getEmojiCategory",value:function(e,t){var n=this,r=null,i=ge.parse(arguments,[new ge({type:"number",constraint:function(e){return e>=0}}),new ge({type:"callback"})]),a=S(i,3);return r=a[0],e=a[1],t=a[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getEmojiCategory({categoryId:e},(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).EmojiCategory)(r);t(null,i)}}))}),t)}},{key:"getEmoji",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"string"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.getEmoji({emojiKey:e},(function(e,r){if(e)t(e,null);else{var i=new(0,j.get(n._iid).Emoji)(r);t(null,i)}}))}),t)}},{key:"getAllowFriendDiscovery",value:function(e){var t=this,n=null,r=S(ge.parse(arguments,[new ge({type:"callback"})]),2);return n=r[0],e=r[1],le(this._iid,(function(e){n?e(n,null):I.get(t._iid).container.apiClient.getAllowFriendDiscovery((function(t,n){var r=n.allow_friend_discovery;t?e(t,null):e(null,r)}))}),e)}},{key:"setAllowFriendDiscovery",value:function(e,t){var n=this,r=null,i=S(ge.parse(arguments,[new ge({type:"boolean"}),new ge({type:"callback"})]),3);return r=i[0],e=i[1],t=i[2],le(this._iid,(function(t){r?t(r,null):I.get(n._iid).container.apiClient.setAllowFriendDiscovery({allowFriendDiscovery:e},(function(n,r){n?t(n,null):t(null,e)}))}),t)}},{key:"clearCachedMessages",value:function(e){var t=this,n=Ge.of(this._iid);if(n){var r=I.get(this._iid).container.store;return Promise.all(e.map((function(e){return new Promise((function(i,a){n.clearByChannelUrl(e).then((function(){var n=Be(t._currentUserId,e);return r.remove(n)})).then((function(){var n=qe(t._currentUserId,e);return r.remove(n)})).then((function(){i()})).catch((function(e){a(e)}))}))})))}return Promise.resolve([])}},{key:"_getCurrentUserDataKey",value:function(){return"sendbird:".concat(this._currentUserId,"@currentUserData")}},{key:"_populateVaultFromCurrentUserData",value:function(e){var t=I.get(this._iid),n=t.container.auth,r=j.get(this._iid).User,i=e.currentUser,a=e.maxUnreadCountOfSuperGroupChannel,s=e.profileImageEncryption,o=e.sessionKey,l=e.eKey,u=e.appInfo,c=e.connectedAt,d=e.firstConnectedAt,h=e.concurrentCallLimit,f=e.backOffDelay;i&&(this.currentUser=r.buildFromSerializedData(i)),a&&t.set("maxUnreadCountOfSuperGroupChannel",a),s&&t.set("profileImageEncryption",s),n?(o&&(n.sessionKey=o),l&&(n.ekey=l)):J.debug("Auth should have been created when populating current user data."),u&&t.set("appInfo",new Ne(u)),c&&t.set("connectedAt",c),d&&t.set("firstConnectedAt",d),h&&t.set("concurrentCallLimit",h),f&&t.set("backOffDelay",f)}}],[{key:"version",get:function(){return T.SDK_VERSION}},{key:"LogLevel",get:function(){return J.supportedLogLevels}},{key:"getInstance",value:function(e){return e?Ii[e]:Oi}},{key:"getLogLevel",value:function(){return J.logLevel}},{key:"setLogLevel",value:function(e){var t=Object.values(J.supportedLogLevels);if(t.includes(e))J.logLevel=e;else{J.logLevel=J.defaultLogLevel;var n=t.map((function(e){return"'".concat(e,"'")})).join(", ");J.warn("`logLevel` parameter should be one of","".concat(n,","),"not `'".concat(e,"'`."),"Set to default log level","`".concat(J.defaultLogLevel,"`."))}}},{key:"getAppVersion",value:function(){return Ui}},{key:"setAppVersion",value:function(e){"string"==typeof e&&ee()&&(Ui=e)}}]),e}();return Ri}(n(4569),n(7403),n(5559))},7403:function(e){e.exports="object"==typeof self?self.FormData:window.FormData},5559:function(e){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},8593:function(e){"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".21343c86.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="sendbird-chat-sample-react:";n.l=function(r,i,a,s){if(e[r])e[r].push(i);else{var o,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[i];var h=function(t,n){o.onerror=o.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=function(t,r){var i,a,s=r[0],o=r[1],l=r[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);u<s.length;u++)a=s[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunksendbird_chat_sample_react=self.webpackChunksendbird_chat_sample_react||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e=n(2791),t=n(4164);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(l){o=!0,i=l}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return a}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var o=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),l=Math.abs,u=String.fromCharCode,c=Object.assign;function d(e){return e.trim()}function h(e,t,n){return e.replace(t,n)}function f(e,t){return e.indexOf(t)}function p(e,t){return 0|e.charCodeAt(t)}function y(e,t,n){return e.slice(t,n)}function g(e){return e.length}function _(e){return e.length}function m(e,t){return t.push(e),e}var v=1,E=1,b=0,C=0,S=0,N="";function k(e,t,n,r,i,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:v,column:E,length:s,return:""}}function A(e,t){return c(k("",null,null,"",null,null,0),e,{length:-e.length},t)}function w(){return S=C>0?p(N,--C):0,E--,10===S&&(E=1,v--),S}function T(){return S=C<b?p(N,C++):0,E++,10===S&&(E=1,v++),S}function O(){return p(N,C)}function I(){return C}function M(e,t){return y(N,e,t)}function U(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function R(e){return v=E=1,b=g(N=e),C=0,[]}function P(e){return N="",e}function L(e){return d(M(C-1,F(91===e?e+2:40===e?e+1:e)))}function D(e){for(;(S=O())&&S<33;)T();return U(e)>2||U(S)>3?"":" "}function x(e,t){for(;--t&&T()&&!(S<48||S>102||S>57&&S<65||S>70&&S<97););return M(e,I()+(t<6&&32==O()&&32==T()))}function F(e){for(;T();)switch(S){case e:return C;case 34:case 39:34!==e&&39!==e&&F(S);break;case 40:41===e&&F(e);break;case 92:T()}return C}function H(e,t){for(;T()&&e+S!==57&&(e+S!==84||47!==O()););return"/*"+M(t,C-1)+"*"+u(47===e?e:T())}function G(e){for(;!U(O());)T();return M(e,C)}var j="-ms-",V="-moz-",B="-webkit-",z="comm",Y="rule",q="decl",K="@keyframes";function W(e,t){for(var n="",r=_(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function Q(e,t,n,r){switch(e.type){case"@import":case q:return e.return=e.return||e.value;case z:return"";case K:return e.return=e.value+"{"+W(e.children,r)+"}";case Y:e.value=e.props.join(",")}return g(n=W(e.children,r))?e.return=e.value+"{"+n+"}":""}function $(e,t){switch(function(e,t){return(((t<<2^p(e,0))<<2^p(e,1))<<2^p(e,2))<<2^p(e,3)}(e,t)){case 5103:return B+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return B+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return B+e+V+e+j+e+e;case 6828:case 4268:return B+e+j+e+e;case 6165:return B+e+j+"flex-"+e+e;case 5187:return B+e+h(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return B+e+j+"flex-item-"+h(e,/flex-|-self/,"")+e;case 4675:return B+e+j+"flex-line-pack"+h(e,/align-content|flex-|-self/,"")+e;case 5548:return B+e+j+h(e,"shrink","negative")+e;case 5292:return B+e+j+h(e,"basis","preferred-size")+e;case 6060:return B+"box-"+h(e,"-grow","")+B+e+j+h(e,"grow","positive")+e;case 4554:return B+h(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return h(h(h(e,/(zoom-|grab)/,B+"$1"),/(image-set)/,B+"$1"),e,"")+e;case 5495:case 3959:return h(e,/(image-set\([^]*)/,B+"$1$`$1");case 4968:return h(h(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+B+e+e;case 4095:case 3583:case 4068:case 2532:return h(e,/(.+)-inline(.+)/,B+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(g(e)-1-t>6)switch(p(e,t+1)){case 109:if(45!==p(e,t+4))break;case 102:return h(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+V+(108==p(e,t+3)?"$3":"$2-$3"))+e;case 115:return~f(e,"stretch")?$(h(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==p(e,t+1))break;case 6444:switch(p(e,g(e)-3-(~f(e,"!important")&&10))){case 107:return h(e,":",":"+B)+e;case 101:return h(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+B+(45===p(e,14)?"inline-":"")+"box$3$1"+B+"$2$3$1"+j+"$2box$3")+e}break;case 5936:switch(p(e,t+11)){case 114:return B+e+j+h(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return B+e+j+h(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return B+e+j+h(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return B+e+j+e+e}return e}function J(e){return P(X("",null,null,null,[""],e=R(e),0,[0],e))}function X(e,t,n,r,i,a,s,o,l){for(var c=0,d=0,p=s,y=0,_=0,v=0,E=1,b=1,C=1,S=0,N="",k=i,A=a,M=r,U=N;b;)switch(v=S,S=T()){case 40:if(108!=v&&58==U.charCodeAt(p-1)){-1!=f(U+=h(L(S),"&","&\f"),"&\f")&&(C=-1);break}case 34:case 39:case 91:U+=L(S);break;case 9:case 10:case 13:case 32:U+=D(v);break;case 92:U+=x(I()-1,7);continue;case 47:switch(O()){case 42:case 47:m(ee(H(T(),I()),t,n),l);break;default:U+="/"}break;case 123*E:o[c++]=g(U)*C;case 125*E:case 59:case 0:switch(S){case 0:case 125:b=0;case 59+d:_>0&&g(U)-p&&m(_>32?te(U+";",r,n,p-1):te(h(U," ","")+";",r,n,p-2),l);break;case 59:U+=";";default:if(m(M=Z(U,t,n,c,d,i,o,N,k=[],A=[],p),a),123===S)if(0===d)X(U,t,M,M,k,a,p,o,A);else switch(y){case 100:case 109:case 115:X(e,M,M,r&&m(Z(e,M,M,0,0,i,o,N,i,k=[],p),A),i,A,p,o,r?k:A);break;default:X(U,M,M,M,[""],A,0,o,A)}}c=d=_=0,E=C=1,N=U="",p=s;break;case 58:p=1+g(U),_=v;default:if(E<1)if(123==S)--E;else if(125==S&&0==E++&&125==w())continue;switch(U+=u(S),S*E){case 38:C=d>0?1:(U+="\f",-1);break;case 44:o[c++]=(g(U)-1)*C,C=1;break;case 64:45===O()&&(U+=L(T())),y=O(),d=p=g(N=U+=G(I())),S++;break;case 45:45===v&&2==g(U)&&(E=0)}}return a}function Z(e,t,n,r,i,a,s,o,u,c,f){for(var p=i-1,g=0===i?a:[""],m=_(g),v=0,E=0,b=0;v<r;++v)for(var C=0,S=y(e,p+1,p=l(E=s[v])),N=e;C<m;++C)(N=d(E>0?g[C]+" "+S:h(S,/&\f/g,g[C])))&&(u[b++]=N);return k(e,t,n,0===i?Y:o,u,c,f)}function ee(e,t,n){return k(e,t,n,z,u(S),y(e,2,-2),0)}function te(e,t,n,r){return k(e,t,n,q,y(e,0,r),y(e,r+1,-1),r)}var ne=function(e,t,n){for(var r=0,i=0;r=i,i=O(),38===r&&12===i&&(t[n]=1),!U(i);)T();return M(e,C)},re=function(e,t){return P(function(e,t){var n=-1,r=44;do{switch(U(r)){case 0:38===r&&12===O()&&(t[n]=1),e[n]+=ne(C-1,t,n);break;case 2:e[n]+=L(r);break;case 4:if(44===r){e[++n]=58===O()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=u(r)}}while(r=T());return e}(R(e),t))},ie=new WeakMap,ae=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ie.get(n))&&!r){ie.set(e,!0);for(var i=[],a=re(t,i),s=n.props,o=0,l=0;o<a.length;o++)for(var u=0;u<s.length;u++,l++)e.props[l]=i[o]?a[o].replace(/&\f/g,s[u]):s[u]+" "+a[o]}}},se=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},oe=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case q:e.return=$(e.value,e.length);break;case K:return W([A(e,{value:h(e.value,"@","@"+B)})],r);case Y:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return W([A(e,{props:[h(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return W([A(e,{props:[h(t,/:(plac\w+)/,":-webkit-input-$1")]}),A(e,{props:[h(t,/:(plac\w+)/,":-moz-$1")]}),A(e,{props:[h(t,/:(plac\w+)/,j+"input-$1")]})],r)}return""}))}}],le=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||oe;var i,a,s={},l=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;l.push(e)}));var u,c,d=[Q,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=_(e);return function(n,r,i,a){for(var s="",o=0;o<t;o++)s+=e[o](n,r,i,a)||"";return s}}([ae,se].concat(r,d));a=function(e,t,n,r){u=n,W(J(e?e+"{"+t.styles+"}":t.styles),h),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new o({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:a};return f.sheet.hydrate(l),f};var ue=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},ce={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var de=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}},he=/[A-Z]|^ms/g,fe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,pe=function(e){return 45===e.charCodeAt(1)},ye=function(e){return null!=e&&"boolean"!==typeof e},ge=de((function(e){return pe(e)?e:e.replace(he,"-$&").toLowerCase()})),_e=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(fe,(function(e,t,n){return ve={name:t,styles:n,next:ve},t}))}return 1===ce[e]||pe(e)||"number"!==typeof t||0===t?t:t+"px"};function me(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return ve={name:n.name,styles:n.styles,next:ve},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)ve={name:r.name,styles:r.styles,next:ve},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=me(e,t,n[i])+";";else for(var a in n){var s=n[a];if("object"!==typeof s)null!=t&&void 0!==t[s]?r+=a+"{"+t[s]+"}":ye(s)&&(r+=ge(a)+":"+_e(a,s)+";");else if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=me(e,t,s);switch(a){case"animation":case"animationName":r+=ge(a)+":"+o+";";break;default:r+=a+"{"+o+"}"}}else for(var l=0;l<s.length;l++)ye(s[l])&&(r+=ge(a)+":"+_e(a,s[l])+";")}return r}(e,t,n);case"function":if(void 0!==e){var i=ve,a=n(e);return ve=i,me(e,t,a)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var ve,Ee=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var be=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";ve=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,i+=me(n,t,a)):i+=a[0];for(var s=1;s<e.length;s++)i+=me(n,t,e[s]),r&&(i+=a[s]);Ee.lastIndex=0;for(var o,l="";null!==(o=Ee.exec(i));)l+="-"+o[1];return{name:ue(i)+l,styles:i,next:ve}};function Ce(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var Se=function(e,t,n){!function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)}(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0);i=i.next}while(void 0!==i)}};function Ne(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function ke(e,t,n){var r=[],i=Ce(e,r,n);return r.length<2?n:i+t(r)}var Ae,we,Te,Oe,Ie,Me,Ue,Re,Pe,Le,De,xe,Fe,He,Ge,je,Ve,Be,ze,Ye,qe,Ke,We,Qe,$e,Je,Xe,Ze,et,tt,nt=function e(t){for(var n="",r=0;r<t.length;r++){var i=t[r];if(null!=i){var a=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))a=e(i);else for(var s in a="",i)i[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=i}a&&(n&&(n+=" "),n+=a)}}return n},rt=function(e){var t=le(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=be(n,t.registered,void 0);return Se(t,i,!1),t.key+"-"+i.name};return{css:n,cx:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return ke(t.registered,n,nt(r))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=be(n,t.registered);Ne(t,i)},keyframes:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=be(n,t.registered),a="animation-"+i.name;return Ne(t,{name:i.name,styles:"@keyframes "+a+"{"+i.styles+"}"}),a},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Ce.bind(null,t.registered),merge:ke.bind(null,t.registered,n)}},it=rt({key:"css"}),at=(it.flush,it.hydrate,it.cx,it.merge,it.getRegisteredStyles,it.injectGlobal,it.keyframes,it.css),st=(it.sheet,it.cache,at(Ae||(Ae=s(["\n"])))),ot=at(we||(we=s(["\n  padding: 50px 0;\n  height: calc(100% - 100px);\n  width: 200px;\n  border-right: solid 1px;\n"]))),lt=at(Te||(Te=s(["\n  padding: 6px 0;\n"]))),ut=at(Oe||(Oe=s(["\n  margin: 0;\n  padding: 10px 0;\n  font-weight: 500;\n"]))),ct=at(Ie||(Ie=s(["\n  display: flex;\n  width: calc(100% - 200px);\n"]))),dt=at(Me||(Me=s(["\n  padding: 50px 0;\n  border-right: solid 1px;\n  height: calc(100% - 100px);\n  width: 200px;\n"]))),ht=at(Ue||(Ue=s(["\n  display: flex;\n  width: 200px;\n  padding: 10px 0;\n  margin: 0;\n  font-weight: 500;\n  justify-content: center;\n"]))),ft=at(Re||(Re=s(["\n  display: flex;\n  width: 18px;\n  height: 18px;\n  justify-content: center;\n  align-items: center;\n"]))),pt=at(Pe||(Pe=s(["\n  display: flex;\n  padding: 6px 20px;\n  max-width: 200px;\n  justify-content: space-between;\n"]))),yt=at(Le||(Le=s(["\n  max-width: 130px;\n  width: 100%;\n  text-align: left;\n  &:hover {\n    cursor: pointer;\n    div:first-child {\n      color: blueviolet;\n    }\n  }\n"]))),gt=at(De||(De=s(["\n  width: 100%;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"]))),_t=at(xe||(xe=s(["\n  width: 100%;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  opacity: 0.5;\n  margin-top: 8px;\n"]))),mt=at(Fe||(Fe=s(["\n  padding: 6px 20px;\n  max-width: 180px;\n  &:hover {\n    cursor: pointer;\n    color: blueviolet;\n  }\n"]))),vt=at(He||(He=s(["\n  margin: 0 auto;\n  padding: 10px 0;\n  border: solid 1px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n"]))),Et=at(Ge||(Ge=s(["\n  width: calc(100% - 200px);\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n"]))),bt=(at(je||(je=s(["\n  \n"]))),at(Ve||(Ve=s(["\n  display: flex;\n  padding: 0 20px;\n  justify-content: space-between;\n  align-items: center;\n  height: 60px;\n  border-bottom: black solid 1px;\n"])))),Ct=at(Be||(Be=s(["\n  display: flex;\n"]))),St=at(ze||(ze=s(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  max-height: calc(100vh - 180px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 10px 0;\n"]))),Nt=at(Ye||(Ye=s(["\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  width: 100%;\n  box-sizing: border-box;\n  padding: 0 20px;\n  margin-bottom: 8px;\n  border: 1px solid transparent;\n"]))),kt=at(qe||(qe=s(["\n  font-weight: 600;\n  color: #673AB7;\n  cursor: initial;\n  align-items: center;\n  display: inline;\n  justify-content: flex-start;\n  flex-direction: column;\n"]))),At=at(Ke||(Ke=s(["\n  display: inline;\n"]))),wt=at(We||(We=s(["\n  cursor: pointer;\n  display: inline;\n  margin-left: 6px;\n  font-size: 12px;\n  padding: 2px;\n\n  &:hover {\n    color: red;\n    opacity: 1;\n    fontWeight: 600;\n  }\n"]))),Tt=at(Qe||(Qe=s(["\n  vertical-align: middle;\n  text-align: center;\n  width: 18px;\n  height: 18px;\n  line-height: 17px;\n  margin-left: 8px;\n  font-size: 12px;\n  color: #fff;\n  font-weight: 500;\n  border-radius: 50%;\n  -webkit-border-radius: 50%;\n  -moz-border-radius: 50%;\n  -ms-border-radius: 50%;\n  -o-border-radius: 50%;\n  background: #DC5960;\n"]))),Ot=at($e||($e=s(["\n  display: flex;\n"]))),It=at(Je||(Je=s(["\n  display: flex;\n  padding: 20px;\n  border-top: 1px solid #e0e2e5;\n  background-color: #fff;\n"]))),Mt=at(Xe||(Xe=s(["\n  display: flex;\n  font-size: 15px;\n  width: 100%;\n  height: 38px;\n  padding: 7px 8px 6px 8px;\n  box-sizing: border-box;\n  border: 1px solid #e0e2e5;\n  background-color: #fff;\n"]))),Ut=at(Ze||(Ze=s(["\n  width: 100%;\n  outline: none;\n  border: 0;\n  resize: none;\n  line-height: 1.4;\n  background-color: #fff;\n  overflow: hidden;\n"]))),Rt=at(et||(et=s(["\n  display: flex;\n  width: 36px;\n  height: 36px;\n  border: 1px solid #e0e2e5;\n  border-left: 0;\n  background-color: #fff;\n  cursor: pointer;\n  background-image: url(https://dxstmhyqfqr1o.cloudfront.net/web-basic/icon-attach-file-normal.png);\n  background-position: center;\n  background-size: 20px;\n  background-repeat: no-repeat;\n"])));function Pt(){return Pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pt.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(tt||(tt={}));var Lt=function(e){return e};var Dt="beforeunload",xt="popstate";function Ft(e){e.preventDefault(),e.returnValue=""}function Ht(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function Gt(){return Math.random().toString(36).substr(2,8)}function jt(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,s=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),s&&"#"!==s&&(n+="#"===s.charAt(0)?s:"#"+s),n}function Vt(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Bt(e,t){if(!e)throw new Error(t)}var zt=(0,e.createContext)(null);var Yt=(0,e.createContext)(null);var qt=(0,e.createContext)({outlet:null,matches:[]});function Kt(e){Bt(!1)}function Wt(t){var n=t.basename,r=void 0===n?"/":n,i=t.children,a=void 0===i?null:i,s=t.location,o=t.navigationType,l=void 0===o?tt.Pop:o,u=t.navigator,c=t.static,d=void 0!==c&&c;Jt()&&Bt(!1);var h=fn(r),f=(0,e.useMemo)((function(){return{basename:h,navigator:u,static:d}}),[h,u,d]);"string"===typeof s&&(s=Vt(s));var p=s,y=p.pathname,g=void 0===y?"/":y,_=p.search,m=void 0===_?"":_,v=p.hash,E=void 0===v?"":v,b=p.state,C=void 0===b?null:b,S=p.key,N=void 0===S?"default":S,k=(0,e.useMemo)((function(){var e=dn(g,h);return null==e?null:{pathname:e,search:m,hash:E,state:C,key:N}}),[h,g,m,E,C,N]);return null==k?null:(0,e.createElement)(zt.Provider,{value:f},(0,e.createElement)(Yt.Provider,{children:a,value:{location:k,navigationType:l}}))}function Qt(t){var n=t.children,r=t.location;return function(t,n){Jt()||Bt(!1);var r=(0,e.useContext)(qt).matches,i=r[r.length-1],a=i?i.params:{},s=(i&&i.pathname,i?i.pathnameBase:"/");i&&i.route;0;var o,l=Xt();if(n){var u,c="string"===typeof n?Vt(n):n;"/"===s||(null==(u=c.pathname)?void 0:u.startsWith(s))||Bt(!1),o=c}else o=l;var d=o.pathname||"/",h="/"===s?d:d.slice(s.length)||"/",f=function(e,t,n){void 0===n&&(n="/");var r=dn(("string"===typeof t?Vt(t):t).pathname||"/",n);if(null==r)return null;var i=nn(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,s=0;null==a&&s<i.length;++s)a=on(i[s],r);return a}(t,{pathname:h});0;return ln(f&&f.map((function(e){return Object.assign({},e,{params:Object.assign({},a,e.params),pathname:hn([s,e.pathname]),pathnameBase:"/"===e.pathnameBase?s:hn([s,e.pathnameBase])})})),r)}(tn(n),r)}function $t(t){Jt()||Bt(!1);var n=(0,e.useContext)(zt),r=n.basename,i=n.navigator,a=en(t),s=a.hash,o=a.pathname,l=a.search,u=o;if("/"!==r){var c=function(e){return""===e||""===e.pathname?"/":"string"===typeof e?Vt(e).pathname:e.pathname}(t),d=null!=c&&c.endsWith("/");u="/"===o?r+(d?"/":""):hn([r,o])}return i.createHref({pathname:u,search:l,hash:s})}function Jt(){return null!=(0,e.useContext)(Yt)}function Xt(){return Jt()||Bt(!1),(0,e.useContext)(Yt).location}function Zt(){Jt()||Bt(!1);var t=(0,e.useContext)(zt),n=t.basename,r=t.navigator,i=(0,e.useContext)(qt).matches,a=Xt().pathname,s=JSON.stringify(i.map((function(e){return e.pathnameBase}))),o=(0,e.useRef)(!1);return(0,e.useEffect)((function(){o.current=!0})),(0,e.useCallback)((function(e,t){if(void 0===t&&(t={}),o.current)if("number"!==typeof e){var i=cn(e,JSON.parse(s),a);"/"!==n&&(i.pathname=hn([n,i.pathname])),(t.replace?r.replace:r.push)(i,t.state)}else r.go(e)}),[n,r,s,a])}function en(t){var n=(0,e.useContext)(qt).matches,r=Xt().pathname,i=JSON.stringify(n.map((function(e){return e.pathnameBase})));return(0,e.useMemo)((function(){return cn(t,JSON.parse(i),r)}),[t,i,r])}function tn(t){var n=[];return e.Children.forEach(t,(function(t){if((0,e.isValidElement)(t))if(t.type!==e.Fragment){t.type!==Kt&&Bt(!1);var r={caseSensitive:t.props.caseSensitive,element:t.props.element,index:t.props.index,path:t.props.path};t.props.children&&(r.children=tn(t.props.children)),n.push(r)}else n.push.apply(n,tn(t.props.children))})),n}function nn(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=""),e.forEach((function(e,i){var a={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(a.relativePath.startsWith(r)||Bt(!1),a.relativePath=a.relativePath.slice(r.length));var s=hn([r,a.relativePath]),o=n.concat(a);e.children&&e.children.length>0&&(!0===e.index&&Bt(!1),nn(e.children,t,o,s)),(null!=e.path||e.index)&&t.push({path:s,score:sn(s,e.index),routesMeta:o})})),t}var rn=/^:\w+$/,an=function(e){return"*"===e};function sn(e,t){var n=e.split("/"),r=n.length;return n.some(an)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!an(e)})).reduce((function(e,t){return e+(rn.test(t)?3:""===t?1:10)}),r)}function on(e,t){for(var n=e.routesMeta,r={},i="/",a=[],s=0;s<n.length;++s){var o=n[s],l=s===n.length-1,u="/"===i?t:t.slice(i.length)||"/",c=un({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);var d=o.route;a.push({params:r,pathname:hn([i,c.pathname]),pathnameBase:fn(hn([i,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(i=hn([i,c.pathnameBase]))}return a}function ln(t,n){return void 0===n&&(n=[]),null==t?null:t.reduceRight((function(r,i,a){return(0,e.createElement)(qt.Provider,{children:void 0!==i.route.element?i.route.element:r,value:{outlet:r,matches:n.concat(t.slice(0,a+1))}})}),null)}function un(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return r.push(t),"([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i+=n?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)";return[new RegExp(i,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),r=a(n,2),i=r[0],s=r[1],o=t.match(i);if(!o)return null;var l=o[0],u=l.replace(/(.)\/+$/,"$1"),c=o.slice(1);return{params:s.reduce((function(e,t,n){if("*"===t){var r=c[n]||"";u=l.slice(0,l.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return e}}(c[n]||""),e}),{}),pathname:l,pathnameBase:u,pattern:e}}function cn(e,t,n){var r,i="string"===typeof e?Vt(e):e,a=""===e||""===i.pathname?"/":i.pathname;if(null==a)r=n;else{var s=t.length-1;if(a.startsWith("..")){for(var o=a.split("/");".."===o[0];)o.shift(),s-=1;i.pathname=o.join("/")}r=s>=0?t[s]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?Vt(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,s=n.hash,o=void 0===s?"":s,l=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:l,search:pn(a),hash:yn(o)}}(i,r);return a&&"/"!==a&&a.endsWith("/")&&!l.pathname.endsWith("/")&&(l.pathname+="/"),l}function dn(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=e.charAt(t.length);return n&&"/"!==n?null:e.slice(t.length)||"/"}var hn=function(e){return e.join("/").replace(/\/\/+/g,"/")},fn=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},pn=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},yn=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""};function gn(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(u){return void n(u)}o.done?t(l):Promise.resolve(l).then(r,i)}function _n(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){gn(a,r,i,s,o,"next",e)}function o(e){gn(a,r,i,s,o,"throw",e)}s(void 0)}))}}function mn(e){if(null==e)throw new TypeError("Cannot destructure undefined")}var vn=n(7757),En=n.n(vn),bn=n(8037),Cn=n.n(bn),Sn=e.createContext(null);var Nn=function(e){e()},kn=function(){return Nn};var An={notify:function(){},get:function(){return[]}};function wn(e,t){var n,r=An;function i(){s.onStateChange&&s.onStateChange()}function a(){n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){var e=kn(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}var s={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=An)},getListeners:function(){return r}};return s}var Tn="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?e.useLayoutEffect:e.useEffect;var On=function(t){var n=t.store,r=t.context,i=t.children,a=(0,e.useMemo)((function(){var e=wn(n);return e.onStateChange=e.notifyNestedSubs,{store:n,subscription:e}}),[n]),s=(0,e.useMemo)((function(){return n.getState()}),[n]);Tn((function(){var e=a.subscription;return e.trySubscribe(),s!==n.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[a,s]);var o=r||Sn;return e.createElement(o.Provider,{value:a},i)};n(2110),n(7441);function In(){return(0,e.useContext)(Sn)}function Mn(t){void 0===t&&(t=Sn);var n=t===Sn?In:function(){return(0,e.useContext)(t)};return function(){return n().store}}var Un=Mn();function Rn(e){void 0===e&&(e=Sn);var t=e===Sn?Un:Mn(e);return function(){return t().dispatch}}var Pn=Rn(),Ln=function(e,t){return e===t};function Dn(t){void 0===t&&(t=Sn);var n=t===Sn?In:function(){return(0,e.useContext)(t)};return function(t,r){void 0===r&&(r=Ln);var i=n(),a=function(t,n,r,i){var a,s=(0,e.useReducer)((function(e){return e+1}),0)[1],o=(0,e.useMemo)((function(){return wn(r,i)}),[r,i]),l=(0,e.useRef)(),u=(0,e.useRef)(),c=(0,e.useRef)(),d=(0,e.useRef)(),h=r.getState();try{if(t!==u.current||h!==c.current||l.current){var f=t(h);a=void 0!==d.current&&n(f,d.current)?d.current:f}else a=d.current}catch(p){throw l.current&&(p.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),p}return Tn((function(){u.current=t,c.current=h,d.current=a,l.current=void 0})),Tn((function(){function e(){try{var e=r.getState();if(e===c.current)return;var t=u.current(e);if(n(t,d.current))return;d.current=t,c.current=e}catch(p){l.current=p}s()}return o.onStateChange=e,o.trySubscribe(),e(),function(){return o.tryUnsubscribe()}}),[r,o]),a}(t,r,i.store,i.subscription);return(0,e.useDebugValue)(a),a}}var xn,Fn=Dn();function Hn(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}xn=t.unstable_batchedUpdates,Nn=xn;var Gn,jn="C4326D35-C1B2-4A6A-BA4A-F3A4882EA501",Vn="SandBird",Bn="SandBird",zn="https://api-staging.sendbird.com",Yn="wss://ws-staging.sendbird.com",qn=function(){var e=_n(En().mark((function e(){var t,n;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Cn().getInstance(),e.next=3,t.connect(Vn,zn,Yn);case 3:return e.next=5,t.updateCurrentUserInfo(decodeURIComponent(Bn),"");case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Kn=function(){var e=_n(En().mark((function e(){var t,n,r;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Cn().getInstance(),(n=t.createApplicationUserListQuery()).limit=15,r=[],!n.hasNext||n.isLoading){e.next=8;break}return e.next=7,n.next();case 7:r=e.sent;case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Wn=n(184),Qn=function(e){var t=e.userId,n=e.isSelected,r=e.onUserSelect;return(0,Wn.jsx)("div",{style:{color:n?"green":"black"},className:mt,onClick:function(){return r(t)},children:t})},$n=function(t){var n=t.dialogState,r=t.createChannel,i=t.inviteUsers,s=t.closeDialog,o=a((0,e.useState)(!0),2),l=o[0],u=o[1],c=a((0,e.useState)([]),2),d=c[0],h=c[1],f=a((0,e.useState)([]),2),p=f[0],y=f[1];(0,e.useEffect)((function(){n!==Rr.CLOSED&&(p.length>0&&y([]),Kn().then((function(e){return h(e)})).catch((function(e){return alert("getUserList error: "+e)})).finally((function(){return u(!1)})))}),[n]);var g=function(e){var t=Hn(p),n=t.indexOf(e);n>=0?t.splice(n,1):t.push(e),y(t)};return l?null:(0,Wn.jsxs)("div",{className:vt,children:[d.map((function(e,t){return(0,Wn.jsx)(Qn,{userId:e.userId,isSelected:p.indexOf(e.userId)>=0,onUserSelect:g},t)})),(0,Wn.jsxs)("div",{style:{margin:"10px 20px",display:"flex"},children:[(0,Wn.jsx)("button",{style:{marginRight:"10px"},onClick:function(){switch(n){case Rr.CREATE:r(p);break;case Rr.INVITE:i(p);break;default:return}},children:"Submit"}),(0,Wn.jsx)("button",{onClick:s,children:"Close"})]})]})},Jn=function(e,t){var n=new(Cn().getInstance().FileMessageParams);return n.file=t,new Promise((function(t,r){e.sendFileMessage(n,(function(e,n){n&&r(n),t(e)}))}))},Xn=function(){var e=_n(En().mark((function e(t,n){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.deleteMessage(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Zn=function(){var e=_n(En().mark((function e(t,n){var r,i,a;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Cn().getInstance(),(i=new r.GroupChannelParams).addUserIds(t),i.operatorUserIds=[Vn],i.accessCode=null!==n&&void 0!==n?n:"",e.next=7,r.GroupChannel.createChannel(i);case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),er=function(){var e=_n(En().mark((function e(t){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tr=function(){var e=_n(En().mark((function e(t){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.leave();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nr=function(){var e=_n(En().mark((function e(t,n){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.inviteWithUserIds(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rr=function(){var e=_n(En().mark((function e(t){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.markAsRead();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ir=function(e,t){return t.sender&&function(e){var t=Cn().getInstance();return e.userId===t.currentUser.userId}(t.sender)?e.getUnreadMemberCount(t):0},ar=function(){var e=_n(En().mark((function e(t,n){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.deleteMessage(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),sr=function(t){var n=t.channel,r=a((0,e.useState)(""),2),i=r[0],s=r[1],o=a((0,e.useState)(null),2),l=o[0],u=o[1],c=function(){var e=_n(En().mark((function e(t){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.currentTarget.files&&t.currentTarget.files.length>0)){e.next=5;break}if(u(t.currentTarget.files[0]),!l){e.next=5;break}return e.next=5,Jn(n,l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=_n(En().mark((function e(){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isGroupChannel()){e.next=9;break}return e.prev=1,e.next=4,rr(n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),alert("Mark group channel as read error: "+e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return(0,Wn.jsxs)("div",{className:It,children:[(0,Wn.jsx)("div",{className:Mt,children:(0,Wn.jsx)("input",{className:Ut,placeholder:"Write a chat...",onClick:d,onKeyPress:function(e){"Enter"===e.key&&!e.shiftKey&&i?(e.preventDefault(),function(e,t){var n=new(Cn().getInstance().UserMessageParams);return n.message=t,new Promise((function(t,r){e.sendUserMessage(n,(function(e,n){n&&r(n),t(e)}))}))}(n,i).then((function(){n.isGroupChannel()&&n.endTyping(),s("")})).catch((function(e){return alert("sendUserMessage error: "+e)}))):n.isGroupChannel()&&n.startTyping()},onChange:function(e){var t=e.currentTarget.value;s(t)},value:i})}),(0,Wn.jsx)("label",{className:Rt,children:(0,Wn.jsx)("input",{type:"file",style:{display:"none"},onChange:c,onClick:d})})]})},or=n(2426),lr=n.n(or),ur=function(e){e.channel;var t=e.message,n=e.deleteMessage;return(0,Wn.jsxs)("div",{className:Ot,children:[(0,Wn.jsx)("img",{src:t.sender?t.sender.profileUrl:void 0,alt:"Profile"}),(0,Wn.jsxs)("div",{style:{display:"inline-block"},children:[(0,Wn.jsxs)("div",{children:["$",t.sender?t.sender.nickname:null]}),(0,Wn.jsxs)("div",{children:["$",t.plainUrl]}),(0,Wn.jsxs)("div",{children:["$",lr()(t.createdAt).fromNow()]})]}),(0,Wn.jsx)("button",{onClick:function(){return n(t)},children:"x"})]})},cr=function(e,t){for(var n=e.length-1;n>=0;n--)if(t.createdAt>e[n].createdAt)return n+1;return 0},dr=function(e,t){for(var n=Hn(t),r=[],i=0;i<e.length;i++){var a=e[i];if(n.length>0){var s=a.isUserMessage()||a.isFileMessage()?Number(a.reqId):a.messageId,o=n.map((function(e){return e.isUserMessage()||e.isFileMessage()?Number(e.reqId):e.messageId})),l=o.indexOf(s);if(l>=0){o.splice(l,1),r.push(n.splice(l,1)[0]);continue}}r.push(a)}for(;n.length>0;){var u=n[0];r.splice(cr(r,u),0,u),n.splice(0,1)}return r},hr=function(e,t){for(var n=Hn(t),r=Hn(e);n.length>0;){var i=r.map((function(e){return e.messageId})),a=i.indexOf(n[0].messageId);a>=0&&(i.splice(a,1),r.splice(a,1)),n.splice(0,1)}return r},fr=function(e){return lr()(e).fromNow()},pr=void 0,yr=function(t){var n=t.channel,r=t.message,i=t.deleteMessage,s=a((0,e.useState)(fr(r.createdAt)),2),o=s[0],l=s[1],u=a((0,e.useState)(0),2),c=u[0],d=u[1];(0,e.useEffect)((function(){n.isGroupChannel()&&d(ir(n,r))}),[]);return(0,Wn.jsxs)("div",{className:Nt,id:r.messageId?r.messageId.toString():r.reqId,children:[(0,Wn.jsx)("div",{className:kt,children:r.sender?r.sender.nickname:null}),(0,Wn.jsxs)("div",{className:At,children:[":\xa0",r.message]}),(0,Wn.jsx)("div",{className:wt,onMouseEnter:function(){l("DELETE")}.bind(pr),onMouseLeave:function(){l(fr(r.createdAt))}.bind(pr),onClick:function(){return i(r)},children:o}),(0,Wn.jsx)("div",{className:Tt,style:c>0?{display:"none"}:{},children:c})]})},gr=function(t){var n=t.channel,r=t.isLoading,i=Fn((function(e){return e.messageListReducer.messageList})),a=(0,e.useRef)(null);return(0,Wn.jsx)("div",{className:St,onScroll:function(){if(a.current){var e=a.current;e.scrollTop,e.scrollHeight,e.clientHeight}},ref:a,children:r?null:i.map((function(e,t){return e.isFileMessage()?(0,Wn.jsx)(ur,{channel:n,message:e,deleteMessage:function(e){return Xn(n,e)}},t):(0,Wn.jsx)(yr,{channel:n,message:e,deleteMessage:function(e){return ar(n,e)}},t)}))})},_r=function(e,t){var n=e.map((function(e){return e.url})).indexOf(t.url);return n>=0?e[n]:null},mr=function(e,t){return!!(t&&e.indexOf(t.url)>=0)},vr=function(e){return e.members.map((function(e){return e.nickname})).join(", ")};!function(e){e.SET_CHANNEL="SET_CHANNEL",e.UPDATE_CHANNEL="UPDATE_CHANNEL",e.DELETE_CHANNEL="DELETE_CHANNEL",e.LEAVE_CHANNEL="LEAVE_CHANNEL",e.INVITE_USERS="INVITE_USERS"}(Gn||(Gn={}));var Er,br={channel:null},Cr=function(e){var t=e.openInviteUsersDialog,n=Fn((function(e){return e.channelReducer.channel})),r=Pn(),i=function(){var e=_n(En().mark((function e(){return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return e.next=3,tr(n);case 3:r({type:Gn.LEAVE_CHANNEL});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Wn.jsxs)("div",{className:bt,children:[(0,Wn.jsx)("div",{children:vr(n)}),(0,Wn.jsxs)("div",{className:Ct,children:[(0,Wn.jsx)("button",{onClick:t,children:"ADD USERS"}),(0,Wn.jsx)("button",{style:{marginLeft:"12px"},onClick:i,children:"LEAVE"})]})]})};!function(e){e.SET_MESSAGES="SET_MESSAGES",e.UPSERT_MESSAGES="UPSERT_MESSAGES",e.DELETE_MESSAGES="DELETE_MESSAGES"}(Er||(Er={}));var Sr={messageList:[]},Nr=function(t){var n=t.groupChannel,r=t.openInviteUsersDialog,i=a((0,e.useState)(!0),2),s=i[0],o=i[1],l=Pn();return(0,e.useEffect)((function(){var e=Cn().getInstance(),t=new e.MessageFilter,r=n.createMessageCollection().setFilter(t).setStartingPoint(Date.now()).setLimit(10).build();r.setMessageCollectionHandler({onMessagesAdded:function(e,t,n){l({type:Er.UPSERT_MESSAGES,payload:n})},onMessagesUpdated:function(e,t,n){l({type:Er.UPSERT_MESSAGES,payload:n})},onMessagesDeleted:function(e,t,n){l({type:Er.DELETE_MESSAGES,payload:n})},onChannelUpdated:function(e,t){},onChannelDeleted:function(e,t){r.dispose()},onHugeGapDetected:function(){r.dispose()}}),r.initialize(e.MessageCollection.MessageCollectionInitPolicy.CACHE_AND_REPLACE_BY_API).onCacheResult((function(e,t){console.log("MessageCollection.onCacheResult: ",e,t),e||l({type:Er.SET_MESSAGES,payload:t}),o(!1)})).onApiResult((function(e,t){console.log("MessageCollection.onApiResult: ",e,t),e||l({type:Er.SET_MESSAGES,payload:t}),o(!1)}))}),[n]),(0,Wn.jsxs)("div",{className:Et,children:[(0,Wn.jsx)(Cr,{openInviteUsersDialog:r}),(0,Wn.jsx)(gr,{channel:n,isLoading:s}),(0,Wn.jsx)(sr,{channel:n})]})};function kr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(n),!0).forEach((function(t){kr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tr,Or=function(e,t,n){var r=Cn().getInstance(),i=t.createdAt-e.createdAt;switch(n){case r.GroupChannelCollection.GroupChannelOrder.LATEST_LAST_MESSAGE:if(e.lastMessage&&!t.lastMessage)return-1;if(!e.lastMessage&&t.lastMessage)return 1;if(e.lastMessage&&t.lastMessage){var a=e.lastMessage.createdAt;if(0===(i=t.lastMessage.createdAt-a)){var s=e.createdAt;i=t.createdAt-s}return i}var o=e.createdAt;return t.createdAt-o;case r.GroupChannelCollection.GroupChannelOrder.CHANNEL_NAME_ALPHABETICAL:return i=e.name.localeCompare(t.name);case r.GroupChannelCollection.GroupChannelOrder.CHRONOLOGICAL:default:return i}},Ir=function(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Mr(e,i,n)}return e},Mr=function(e,t,n){var r=e.map((function(e){return e.url})),i=r.indexOf(t.url),a=function(e,t,n){if(e.length>0){for(var r=0,i=e.length-1,a=Math.floor((r+i)/2);r<i;){var s=Or(e[a],t,n);if(s>0)i=a,a=Math.floor((r+i)/2);else{if(!(s<0))return a;r=a+1,a=Math.floor((r+i)/2)}}return Or(e[a],t,n)>0?a:a+1}return e.length}(e,t,n);i<0?e.splice(a,0,t):a===i?e[a]=t:(e.splice(i,1),i<a&&a--,e.splice(a,0,t))},Ur=function(e,t){for(var n=[],r=e.length,i=0;t.length>0&&i<r;){var a=e[i],s=t.indexOf(a.url);s>=0?t.splice(s,1):n.push(a),i++}return i<e.length&&(n=n.concat(e.slice(i))),n};!function(e){e.SET_CHANNELS="SET_CHANNELS",e.UPSERT_CHANNELS="UPSERT_CHANNELS",e.DELETE_CHANNELS="DELETE_CHANNELS"}(Tr||(Tr={}));var Rr,Pr={groupChannelList:[],groupChannelCollection:null,order:"latest_last_message"},Lr=function(e){var t=e.channel,n=e.index,r=e.setCurrentChannel,i=e.currentChannel,a=e.deleteChannel;return(0,Wn.jsxs)("div",{className:pt,children:[(0,Wn.jsxs)("div",{className:yt,onClick:function(){return r(t)},children:[(0,Wn.jsx)("div",{className:gt,style:i&&t.url===i.url?{color:"green"}:{},children:"".concat(vr(t))}),(0,Wn.jsx)("div",{className:_t,children:t.lastMessage&&t.lastMessage.isUserMessage()?t.lastMessage.message:null})]}),(0,Wn.jsx)("button",{className:ft,onClick:function(){return a(t,n)},children:"x"})]},n)},Dr=function(e){var t=e.openDialog;return(0,Wn.jsxs)("div",{className:ht,children:[(0,Wn.jsx)("p",{style:{marginRight:"10px"},children:"Group Channels"}),(0,Wn.jsx)("button",{className:ft,onClick:function(){return t()},children:"+"})]})},xr=function(t){var n=t.openCreateChannelDialog,r=t.currentChannel,i=t.setCurrentChannel,a=t.deleteCurrentChannel,s=t.updateCurrentChannel,o=Cn().getInstance(),l=Fn((function(e){return e.groupChannelListReducer})),u=l.groupChannelCollection,c=l.groupChannelList,d=Pn();(0,e.useEffect)((function(){if(!u){var e=o.GroupChannelCollection.GroupChannelOrder.LATEST_LAST_MESSAGE,t=new o.GroupChannelFilter;t.includeEmpty=!0;var n=o.GroupChannel.createGroupChannelCollection().setOrder(e).setLimit(100).setFilter(t).build();n.setGroupChannelCollectionHandler({onChannelsAdded:function(e,t){d({type:Tr.UPSERT_CHANNELS,payload:t})},onChannelsUpdated:function(e,t){d({type:Tr.UPSERT_CHANNELS,payload:t}),s(t)},onChannelsDeleted:function(e,t){d({type:Tr.DELETE_CHANNELS,payload:t}),a(t)}}),n.loadMore().then((function(e){d({type:Tr.SET_CHANNELS,payload:{groupChannelList:e,groupChannelCollection:n}})})).catch((function(e){return alert("groupChannelCollection loadMore error: "+e)}))}}),[u]);var h=function(e,t){er(e).catch((function(e){return alert("GroupChat deleteChannel error: "+e)}))};return(0,Wn.jsxs)("div",{className:dt,children:[(0,Wn.jsx)(Dr,{openDialog:n}),c.map((function(e,t){return(0,Wn.jsx)(Lr,{channel:e,index:t,setCurrentChannel:i,currentChannel:r,deleteChannel:h},t)}))]})};!function(e){e.CREATE="CREATE",e.INVITE="INVITE",e.CLOSED="CLOSED"}(Rr||(Rr={}));var Fr=function(t){mn(t);var n=a((0,e.useState)(Rr.CLOSED),2),r=n[0],i=n[1],s=a((0,e.useState)(),2),o=s[0],l=s[1],u=Fn((function(e){return e.channelReducer.channel})),c=Pn();(0,e.useEffect)((function(){if(!o){var e=Cn().getInstance();l(e)}}),[]);var d=function(e){c({type:Gn.SET_CHANNEL,payload:e})},h=function(){var e=_n(En().mark((function e(t){var n;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zn(t);case 3:n=e.sent,i(Rr.CLOSED),d(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Create group channel error: "+e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=_n(En().mark((function e(t){var n;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nr(u,t);case 3:n=e.sent,i(Rr.CLOSED),d(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Invite userIds to group channel error: "+e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return(0,Wn.jsxs)("div",{className:ct,children:[r!==Rr.CLOSED?(0,Wn.jsx)($n,{dialogState:r,createChannel:h,inviteUsers:f,closeDialog:function(){i(Rr.CLOSED)}}):null,(0,Wn.jsx)(xr,{openCreateChannelDialog:function(){i(Rr.CREATE)},setCurrentChannel:d,currentChannel:u,deleteCurrentChannel:function(e){c({type:Gn.DELETE_CHANNEL,payload:e})},updateCurrentChannel:function(e){c({type:Gn.UPDATE_CHANNEL,payload:e})}}),u?(0,Wn.jsx)(Nr,{groupChannel:u,openInviteUsersDialog:function(){i(Rr.INVITE)}}):null]})},Hr=function(){var e=_n(En().mark((function e(t){var n,r,i;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Cn().getInstance(),(r=new n.OpenChannelParams).name=t,e.next=5,n.OpenChannel.createChannel(r);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gr=function(t){var n=t.setCurrentChannel,r=t.setIsDialogOpen,i=a((0,e.useState)(""),2),s=i[0],o=i[1],l=function(){var e=_n(En().mark((function e(){var t;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Hr(s);case 3:t=e.sent,n(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Create open channel error: "+e.t0);case 10:return e.prev=10,r(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();return(0,Wn.jsxs)("form",{className:vt,onSubmit:l,children:[(0,Wn.jsxs)("label",{children:["Name:",(0,Wn.jsx)("input",{type:"text",value:s,onChange:function(e){e.preventDefault();var t=e.currentTarget.value;o(t)}})]}),(0,Wn.jsx)("input",{type:"submit",value:"Create"})]})},jr=function(e){e.openChannel;return(0,Wn.jsx)("div",{className:Et})},Vr=function(t){mn(t);var n=a((0,e.useState)([]),2),r=(n[0],n[1],a((0,e.useState)(!1),2)),i=r[0],s=r[1],o=a((0,e.useState)(),2),l=o[0],u=o[1];Cn().getInstance();return(0,Wn.jsxs)("div",{children:[i?(0,Wn.jsx)(Gr,{setCurrentChannel:u,setIsDialogOpen:s}):null,l?(0,Wn.jsx)(jr,{openChannel:l}):null]})};function Br(){return Br=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Br.apply(this,arguments)}function zr(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var Yr=["onClick","reloadDocument","replace","state","target","to"];function qr(t){var n=t.basename,r=t.children,i=t.window,s=(0,e.useRef)();null==s.current&&(s.current=function(e){void 0===e&&(e={});var t=e.window,n=void 0===t?document.defaultView:t,r=n.history;function i(){var e=n.location,t=e.pathname,i=e.search,a=e.hash,s=r.state||{};return[s.idx,Lt({pathname:t,search:i,hash:a,state:s.usr||null,key:s.key||"default"})]}var a=null;n.addEventListener(xt,(function(){if(a)d.call(a),a=null;else{var e=tt.Pop,t=i(),n=t[0],r=t[1];if(d.length){if(null!=n){var s=l-n;s&&(a={action:e,location:r,retry:function(){_(-1*s)}},_(s))}}else g(e)}}));var s=tt.Pop,o=i(),l=o[0],u=o[1],c=Ht(),d=Ht();function h(e){return"string"===typeof e?e:jt(e)}function f(e,t){return void 0===t&&(t=null),Lt(Pt({pathname:u.pathname,hash:"",search:""},"string"===typeof e?Vt(e):e,{state:t,key:Gt()}))}function p(e,t){return[{usr:e.state,key:e.key,idx:t},h(e)]}function y(e,t,n){return!d.length||(d.call({action:e,location:t,retry:n}),!1)}function g(e){s=e;var t=i();l=t[0],u=t[1],c.call({action:s,location:u})}function _(e){r.go(e)}null==l&&(l=0,r.replaceState(Pt({},r.state,{idx:l}),""));var m={get action(){return s},get location(){return u},createHref:h,push:function e(t,i){var a=tt.Push,s=f(t,i);if(y(a,s,(function(){e(t,i)}))){var o=p(s,l+1),u=o[0],c=o[1];try{r.pushState(u,"",c)}catch(d){n.location.assign(c)}g(a)}},replace:function e(t,n){var i=tt.Replace,a=f(t,n);if(y(i,a,(function(){e(t,n)}))){var s=p(a,l),o=s[0],u=s[1];r.replaceState(o,"",u),g(i)}},go:_,back:function(){_(-1)},forward:function(){_(1)},listen:function(e){return c.push(e)},block:function(e){var t=d.push(e);return 1===d.length&&n.addEventListener(Dt,Ft),function(){t(),d.length||n.removeEventListener(Dt,Ft)}}};return m}({window:i}));var o=s.current,l=a((0,e.useState)({action:o.action,location:o.location}),2),u=l[0],c=l[1];return(0,e.useLayoutEffect)((function(){return o.listen(c)}),[o]),(0,e.createElement)(Wt,{basename:n,children:r,location:u.location,navigationType:u.action,navigator:o})}var Kr=(0,e.forwardRef)((function(t,n){var r=t.onClick,i=t.reloadDocument,a=t.replace,s=void 0!==a&&a,o=t.state,l=t.target,u=t.to,c=zr(t,Yr),d=$t(u),h=function(t,n){var r=void 0===n?{}:n,i=r.target,a=r.replace,s=r.state,o=Zt(),l=Xt(),u=en(t);return(0,e.useCallback)((function(e){if(0===e.button&&(!i||"_self"===i)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)){e.preventDefault();var n=!!a||jt(l)===jt(u);o(t,{replace:n,state:s})}}),[l,o,u,a,s,i,t])}(u,{replace:s,state:o,target:l});return(0,e.createElement)("a",Br({},c,{href:d,onClick:function(e){r&&r(e),e.defaultPrevented||i||h(e)},ref:n,target:l}))}));var Wr=[{name:"Group Channel",path:"basic-samples/group-channel"},{name:"Open Channel",path:"/basic-samples/open-channel"}],Qr=function(e){var t=e.name;return(0,Wn.jsx)("div",{className:lt,children:(0,Wn.jsx)("p",{children:t})})},$r=function(){return(0,Wn.jsxs)("div",{className:ot,children:[(0,Wn.jsx)("div",{className:ut,children:"Basic Samples"}),Wr.map((function(e,t){return(0,Wn.jsx)(Kr,{to:e.path,children:(0,Wn.jsx)(Qr,wr({},e))},t)}))]})},Jr=function(){return(0,Wn.jsxs)("div",{className:st,children:[(0,Wn.jsx)("h1",{children:"Home"}),(0,Wn.jsx)("p",{children:"Welcome to SendBird Chat SDK samples for React."})]})},Xr=function(){var t=a((0,e.useState)(!0),2),n=t[0],r=t[1],i=a((0,e.useState)(),2),s=(i[0],i[1]);return(0,e.useEffect)((function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];new(Cn())({appId:jn,localCacheEnabled:e})}(),qn().then((function(e){return s(e)})).catch((function(e){return alert("getUserList error: "+e)})).finally((function(){return r(!1)}))}),[]),n?null:(0,Wn.jsxs)("div",{className:"App",children:[(0,Wn.jsx)($r,{}),(0,Wn.jsxs)(Qt,{children:[(0,Wn.jsx)(Kt,{path:"/",element:(0,Wn.jsx)(Jr,{})}),(0,Wn.jsx)(Kt,{path:"/basic-samples/group-channel",element:(0,Wn.jsx)(Fr,{})}),(0,Wn.jsx)(Kt,{path:"/basic-samples/open-channel",element:(0,Wn.jsx)(Vr,{})})]})]})},Zr=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),a(e),s(e)}))};function ei(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ti="function"===typeof Symbol&&Symbol.observable||"@@observable",ni=function(){return Math.random().toString(36).substring(7).split("").join(".")},ri={INIT:"@@redux/INIT"+ni(),REPLACE:"@@redux/REPLACE"+ni(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ni()}};function ii(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var ai=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"===typeof e[i]&&(n[i]=e[i])}var a,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:ri.INIT}))throw new Error(ei(12));if("undefined"===typeof n(void 0,{type:ri.PROBE_UNKNOWN_ACTION()}))throw new Error(ei(13))}))}(n)}catch(o){a=o}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,i={},o=0;o<s.length;o++){var l=s[o],u=n[l],c=e[l],d=u(c,t);if("undefined"===typeof d){t&&t.type;throw new Error(ei(14))}i[l]=d,r=r||d!==c}return(r=r||s.length!==Object.keys(e).length)?i:e}}({channelReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:br,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Gn.SET_CHANNEL:return{channel:t.payload};case Gn.UPDATE_CHANNEL:if(e.channel){var n=_r(t.payload,e.channel);if(n)return{channel:n}}return e;case Gn.DELETE_CHANNEL:return e.channel&&mr(t.payload,e.channel)?{channel:null}:e;case Gn.LEAVE_CHANNEL:return{channel:null};default:return e}},groupChannelListReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Tr.SET_CHANNELS:return wr(wr({},e),{},{groupChannelList:t.payload.groupChannelList,groupChannelCollection:t.payload.groupChannelCollection});case Tr.UPSERT_CHANNELS:return wr(wr({},e),{},{groupChannelList:Ir(e.groupChannelList,t.payload,e.order)});case Tr.DELETE_CHANNELS:return wr(wr({},e),{},{groupChannelList:Ur(e.groupChannelList,t.payload)});default:return e}},messageListReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Er.SET_MESSAGES:return{messageList:t.payload};case Er.UPSERT_MESSAGES:return{messageList:dr(e.messageList,t.payload)};case Er.DELETE_MESSAGES:return{messageList:hr(e.messageList,t.payload)};default:return e}}}),si=function e(t,n,r){var i;if("function"===typeof n&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error(ei(0));if("function"===typeof n&&"undefined"===typeof r&&(r=n,n=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error(ei(1));return r(e)(t,n)}if("function"!==typeof t)throw new Error(ei(2));var a=t,s=n,o=[],l=o,u=!1;function c(){l===o&&(l=o.slice())}function d(){if(u)throw new Error(ei(3));return s}function h(e){if("function"!==typeof e)throw new Error(ei(4));if(u)throw new Error(ei(5));var t=!0;return c(),l.push(e),function(){if(t){if(u)throw new Error(ei(6));t=!1,c();var n=l.indexOf(e);l.splice(n,1),o=null}}}function f(e){if(!ii(e))throw new Error(ei(7));if("undefined"===typeof e.type)throw new Error(ei(8));if(u)throw new Error(ei(9));try{u=!0,s=a(s,e)}finally{u=!1}for(var t=o=l,n=0;n<t.length;n++){(0,t[n])()}return e}function p(e){if("function"!==typeof e)throw new Error(ei(10));a=e,f({type:ri.REPLACE})}function y(){var e,t=h;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(ei(11));function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[ti]=function(){return this},e}return f({type:ri.INIT}),(i={dispatch:f,subscribe:h,getState:d,replaceReducer:p})[ti]=y,i}(ai);t.render((0,Wn.jsx)(On,{store:si,children:(0,Wn.jsx)(qr,{children:(0,Wn.jsx)(Xr,{})})}),document.getElementById("root")),Zr()}()}();
//# sourceMappingURL=main.257e50aa.js.map